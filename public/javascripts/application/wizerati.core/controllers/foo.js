function ClusterIcon(cluster, styles) {
    cluster.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView), this.cluster_ = cluster,
        this.className_ = cluster.getMarkerClusterer().getClusterClass(),
        this.styles_ = styles, this.center_ = null, this.div_ = null, this.sums_ = null, this.visible_ = !1, this.setMap(cluster.getMap())
}
function Cluster(mc) {
    this.markerClusterer_ = mc, this.map_ = mc.getMap(), this.gridSize_ = mc.getGridSize(), this.minClusterSize_ = mc.getMinimumClusterSize(), this.averageCenter_ = mc.getAverageCenter(), this.printable_ = mc.getPrintable(), this.markers_ = [], this.center_ = null, this.bounds_ = null, this.clusterIcon_ = new ClusterIcon(this, mc.getStyles())
}
function MarkerClusterer(map, opt_markers, opt_options) {
    this.extend(MarkerClusterer, google.maps.OverlayView), opt_markers = opt_markers || [], opt_options = opt_options || {}, this.markers_ = [], this.clusters_ = [], this.listeners_ = [], this.activeMap_ = null, this.ready_ = !1, this.gridSize_ = opt_options.gridSize || 60, this.minClusterSize_ = opt_options.minimumClusterSize || 2, this.maxZoom_ = opt_options.maxZoom || null, this.styles_ = opt_options.styles || [], this.title_ = opt_options.title || "", this.zoomOnClick_ = !0, void 0 !== opt_options.zoomOnClick && (this.zoomOnClick_ = opt_options.zoomOnClick), this.averageCenter_ = !1, void 0 !== opt_options.averageCenter && (this.averageCenter_ = opt_options.averageCenter), this.ignoreHidden_ = !1, void 0 !== opt_options.ignoreHidden && (this.ignoreHidden_ = opt_options.ignoreHidden), this.printable_ = !1, void 0 !== opt_options.printable && (this.printable_ = opt_options.printable), this.imagePath_ = opt_options.imagePath || MarkerClusterer.IMAGE_PATH, this.imageExtension_ = opt_options.imageExtension || MarkerClusterer.IMAGE_EXTENSION, this.imageSizes_ = opt_options.imageSizes || MarkerClusterer.IMAGE_SIZES, this.calculator_ = opt_options.calculator || MarkerClusterer.CALCULATOR, this.batchSize_ = opt_options.batchSize || MarkerClusterer.BATCH_SIZE, this.batchSizeIE_ = opt_options.batchSizeIE || MarkerClusterer.BATCH_SIZE_IE, this.clusterClass_ = opt_options.clusterClass || "cluster", -1 !== navigator.userAgent.toLowerCase().indexOf("msie") && (this.batchSize_ = this.batchSizeIE_), this.setupStyles_(), this.addMarkers(opt_markers, !0), this.setMap(map)
}
!function ($, undefined) {
    function focusable(element, isTabIndexNotNaN) {
        var map, mapName, img, nodeName = element.nodeName.toLowerCase();
        return"area" === nodeName ? (map = element.parentNode, mapName = map.name, element.href && mapName && "map" === map.nodeName.toLowerCase() ? (img = $("img[usemap=#" + mapName + "]")[0], !!img && visible(img)) : !1) : (/input|select|textarea|button|object/.test(nodeName) ? !element.disabled : "a" === nodeName ? element.href || isTabIndexNotNaN : isTabIndexNotNaN) && visible(element)
    }

    function visible(element) {
        return $.expr.filters.visible(element) && !$(element).parents().addBack().filter(function () {
            return"hidden" === $.css(this, "visibility")
        }).length
    }

    var uuid = 0, runiqueId = /^ui-id-\d+$/;
    $.ui = $.ui || {}, $.extend($.ui, {version: "1.10.3", keyCode: {BACKSPACE: 8, COMMA: 188, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, LEFT: 37, NUMPAD_ADD: 107, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, NUMPAD_ENTER: 108, NUMPAD_MULTIPLY: 106, NUMPAD_SUBTRACT: 109, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SPACE: 32, TAB: 9, UP: 38}}), $.fn.extend({focus: function (orig) {
        return function (delay, fn) {
            return"number" == typeof delay ? this.each(function () {
                var elem = this;
                setTimeout(function () {
                    $(elem).focus(), fn && fn.call(elem)
                }, delay)
            }) : orig.apply(this, arguments)
        }
    }($.fn.focus), scrollParent: function () {
        var scrollParent;
        return scrollParent = $.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function () {
            return/(relative|absolute|fixed)/.test($.css(this, "position")) && /(auto|scroll)/.test($.css(this, "overflow") + $.css(this, "overflow-y") + $.css(this, "overflow-x"))
        }).eq(0) : this.parents().filter(function () {
            return/(auto|scroll)/.test($.css(this, "overflow") + $.css(this, "overflow-y") + $.css(this, "overflow-x"))
        }).eq(0), /fixed/.test(this.css("position")) || !scrollParent.length ? $(document) : scrollParent
    }, zIndex: function (zIndex) {
        if (zIndex !== undefined)return this.css("zIndex", zIndex);
        if (this.length)for (var position, value, elem = $(this[0]); elem.length && elem[0] !== document;) {
            if (position = elem.css("position"), ("absolute" === position || "relative" === position || "fixed" === position) && (value = parseInt(elem.css("zIndex"), 10), !isNaN(value) && 0 !== value))return value;
            elem = elem.parent()
        }
        return 0
    }, uniqueId: function () {
        return this.each(function () {
            this.id || (this.id = "ui-id-" + ++uuid)
        })
    }, removeUniqueId: function () {
        return this.each(function () {
            runiqueId.test(this.id) && $(this).removeAttr("id")
        })
    }}), $.extend($.expr[":"], {data: $.expr.createPseudo ? $.expr.createPseudo(function (dataName) {
        return function (elem) {
            return!!$.data(elem, dataName)
        }
    }) : function (elem, i, match) {
        return!!$.data(elem, match[3])
    }, focusable: function (element) {
        return focusable(element, !isNaN($.attr(element, "tabindex")))
    }, tabbable: function (element) {
        var tabIndex = $.attr(element, "tabindex"), isTabIndexNaN = isNaN(tabIndex);
        return(isTabIndexNaN || tabIndex >= 0) && focusable(element, !isTabIndexNaN)
    }}), $("<a>").outerWidth(1).jquery || $.each(["Width", "Height"], function (i, name) {
        function reduce(elem, size, border, margin) {
            return $.each(side, function () {
                size -= parseFloat($.css(elem, "padding" + this)) || 0, border && (size -= parseFloat($.css(elem, "border" + this + "Width")) || 0), margin && (size -= parseFloat($.css(elem, "margin" + this)) || 0)
            }), size
        }

        var side = "Width" === name ? ["Left", "Right"] : ["Top", "Bottom"], type = name.toLowerCase(), orig = {innerWidth: $.fn.innerWidth, innerHeight: $.fn.innerHeight, outerWidth: $.fn.outerWidth, outerHeight: $.fn.outerHeight};
        $.fn["inner" + name] = function (size) {
            return size === undefined ? orig["inner" + name].call(this) : this.each(function () {
                $(this).css(type, reduce(this, size) + "px")
            })
        }, $.fn["outer" + name] = function (size, margin) {
            return"number" != typeof size ? orig["outer" + name].call(this, size) : this.each(function () {
                $(this).css(type, reduce(this, size, !0, margin) + "px")
            })
        }
    }), $.fn.addBack || ($.fn.addBack = function (selector) {
        return this.add(null == selector ? this.prevObject : this.prevObject.filter(selector))
    }), $("<a>").data("a-b", "a").removeData("a-b").data("a-b") && ($.fn.removeData = function (removeData) {
        return function (key) {
            return arguments.length ? removeData.call(this, $.camelCase(key)) : removeData.call(this)
        }
    }($.fn.removeData)), $.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), $.support.selectstart = "onselectstart"in document.createElement("div"), $.fn.extend({disableSelection: function () {
        return this.bind(($.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function (event) {
            event.preventDefault()
        })
    }, enableSelection: function () {
        return this.unbind(".ui-disableSelection")
    }}), $.extend($.ui, {plugin: {add: function (module, option, set) {
        var i, proto = $.ui[module].prototype;
        for (i in set)proto.plugins[i] = proto.plugins[i] || [], proto.plugins[i].push([option, set[i]])
    }, call: function (instance, name, args) {
        var i, set = instance.plugins[name];
        if (set && instance.element[0].parentNode && 11 !== instance.element[0].parentNode.nodeType)for (i = 0; i < set.length; i++)instance.options[set[i][0]] && set[i][1].apply(instance.element, args)
    }}, hasScroll: function (el, a) {
        if ("hidden" === $(el).css("overflow"))return!1;
        var scroll = a && "left" === a ? "scrollLeft" : "scrollTop", has = !1;
        return el[scroll] > 0 ? !0 : (el[scroll] = 1, has = el[scroll] > 0, el[scroll] = 0, has)
    }})
}(jQuery), function ($, undefined) {
    var uuid = 0, slice = Array.prototype.slice, _cleanData = $.cleanData;
    $.cleanData = function (elems) {
        for (var elem, i = 0; null != (elem = elems[i]); i++)try {
            $(elem).triggerHandler("remove")
        } catch (e) {
        }
        _cleanData(elems)
    }, $.widget = function (name, base, prototype) {
        var fullName, existingConstructor, constructor, basePrototype, proxiedPrototype = {}, namespace = name.split(".")[0];
        name = name.split(".")[1], fullName = namespace + "-" + name, prototype || (prototype = base, base = $.Widget), $.expr[":"][fullName.toLowerCase()] = function (elem) {
            return!!$.data(elem, fullName)
        }, $[namespace] = $[namespace] || {}, existingConstructor = $[namespace][name], constructor = $[namespace][name] = function (options, element) {
            return this._createWidget ? (arguments.length && this._createWidget(options, element), void 0) : new constructor(options, element)
        }, $.extend(constructor, existingConstructor, {version: prototype.version, _proto: $.extend({}, prototype), _childConstructors: []}), basePrototype = new base, basePrototype.options = $.widget.extend({}, basePrototype.options), $.each(prototype, function (prop, value) {
            return $.isFunction(value) ? (proxiedPrototype[prop] = function () {
                var _super = function () {
                    return base.prototype[prop].apply(this, arguments)
                }, _superApply = function (args) {
                    return base.prototype[prop].apply(this, args)
                };
                return function () {
                    var returnValue, __super = this._super, __superApply = this._superApply;
                    return this._super = _super, this._superApply = _superApply, returnValue = value.apply(this, arguments), this._super = __super, this._superApply = __superApply, returnValue
                }
            }(), void 0) : (proxiedPrototype[prop] = value, void 0)
        }), constructor.prototype = $.widget.extend(basePrototype, {widgetEventPrefix: existingConstructor ? basePrototype.widgetEventPrefix : name}, proxiedPrototype, {constructor: constructor, namespace: namespace, widgetName: name, widgetFullName: fullName}), existingConstructor ? ($.each(existingConstructor._childConstructors, function (i, child) {
            var childPrototype = child.prototype;
            $.widget(childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto)
        }), delete existingConstructor._childConstructors) : base._childConstructors.push(constructor), $.widget.bridge(name, constructor)
    }, $.widget.extend = function (target) {
        for (var key, value, input = slice.call(arguments, 1), inputIndex = 0, inputLength = input.length; inputLength > inputIndex; inputIndex++)for (key in input[inputIndex])value = input[inputIndex][key], input[inputIndex].hasOwnProperty(key) && value !== undefined && (target[key] = $.isPlainObject(value) ? $.isPlainObject(target[key]) ? $.widget.extend({}, target[key], value) : $.widget.extend({}, value) : value);
        return target
    }, $.widget.bridge = function (name, object) {
        var fullName = object.prototype.widgetFullName || name;
        $.fn[name] = function (options) {
            var isMethodCall = "string" == typeof options, args = slice.call(arguments, 1), returnValue = this;
            return options = !isMethodCall && args.length ? $.widget.extend.apply(null, [options].concat(args)) : options, isMethodCall ? this.each(function () {
                var methodValue, instance = $.data(this, fullName);
                return instance ? $.isFunction(instance[options]) && "_" !== options.charAt(0) ? (methodValue = instance[options].apply(instance, args), methodValue !== instance && methodValue !== undefined ? (returnValue = methodValue && methodValue.jquery ? returnValue.pushStack(methodValue.get()) : methodValue, !1) : void 0) : $.error("no such method '" + options + "' for " + name + " widget instance") : $.error("cannot call methods on " + name + " prior to initialization; attempted to call method '" + options + "'")
            }) : this.each(function () {
                var instance = $.data(this, fullName);
                instance ? instance.option(options || {})._init() : $.data(this, fullName, new object(options, this))
            }), returnValue
        }
    }, $.Widget = function () {
    }, $.Widget._childConstructors = [], $.Widget.prototype = {widgetName: "widget", widgetEventPrefix: "", defaultElement: "<div>", options: {disabled: !1, create: null}, _createWidget: function (options, element) {
        element = $(element || this.defaultElement || this)[0], this.element = $(element), this.uuid = uuid++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = $.widget.extend({}, this.options, this._getCreateOptions(), options), this.bindings = $(), this.hoverable = $(), this.focusable = $(), element !== this && ($.data(element, this.widgetFullName, this), this._on(!0, this.element, {remove: function (event) {
            event.target === element && this.destroy()
        }}), this.document = $(element.style ? element.ownerDocument : element.document || element), this.window = $(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
    }, _getCreateOptions: $.noop, _getCreateEventData: $.noop, _create: $.noop, _init: $.noop, destroy: function () {
        this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
    }, _destroy: $.noop, widget: function () {
        return this.element
    }, option: function (key, value) {
        var parts, curOption, i, options = key;
        if (0 === arguments.length)return $.widget.extend({}, this.options);
        if ("string" == typeof key)if (options = {}, parts = key.split("."), key = parts.shift(), parts.length) {
            for (curOption = options[key] = $.widget.extend({}, this.options[key]), i = 0; i < parts.length - 1; i++)curOption[parts[i]] = curOption[parts[i]] || {}, curOption = curOption[parts[i]];
            if (key = parts.pop(), value === undefined)return curOption[key] === undefined ? null : curOption[key];
            curOption[key] = value
        } else {
            if (value === undefined)return this.options[key] === undefined ? null : this.options[key];
            options[key] = value
        }
        return this._setOptions(options), this
    }, _setOptions: function (options) {
        var key;
        for (key in options)this._setOption(key, options[key]);
        return this
    }, _setOption: function (key, value) {
        return this.options[key] = value, "disabled" === key && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!value).attr("aria-disabled", value), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
    }, enable: function () {
        return this._setOption("disabled", !1)
    }, disable: function () {
        return this._setOption("disabled", !0)
    }, _on: function (suppressDisabledCheck, element, handlers) {
        var delegateElement, instance = this;
        "boolean" != typeof suppressDisabledCheck && (handlers = element, element = suppressDisabledCheck, suppressDisabledCheck = !1), handlers ? (element = delegateElement = $(element), this.bindings = this.bindings.add(element)) : (handlers = element, element = this.element, delegateElement = this.widget()), $.each(handlers, function (event, handler) {
            function handlerProxy() {
                return suppressDisabledCheck || instance.options.disabled !== !0 && !$(this).hasClass("ui-state-disabled") ? ("string" == typeof handler ? instance[handler] : handler).apply(instance, arguments) : void 0
            }

            "string" != typeof handler && (handlerProxy.guid = handler.guid = handler.guid || handlerProxy.guid || $.guid++);
            var match = event.match(/^(\w+)\s*(.*)$/), eventName = match[1] + instance.eventNamespace, selector = match[2];
            selector ? delegateElement.delegate(selector, eventName, handlerProxy) : element.bind(eventName, handlerProxy)
        })
    }, _off: function (element, eventName) {
        eventName = (eventName || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, element.unbind(eventName).undelegate(eventName)
    }, _delay: function (handler, delay) {
        function handlerProxy() {
            return("string" == typeof handler ? instance[handler] : handler).apply(instance, arguments)
        }

        var instance = this;
        return setTimeout(handlerProxy, delay || 0)
    }, _hoverable: function (element) {
        this.hoverable = this.hoverable.add(element), this._on(element, {mouseenter: function (event) {
            $(event.currentTarget).addClass("ui-state-hover")
        }, mouseleave: function (event) {
            $(event.currentTarget).removeClass("ui-state-hover")
        }})
    }, _focusable: function (element) {
        this.focusable = this.focusable.add(element), this._on(element, {focusin: function (event) {
            $(event.currentTarget).addClass("ui-state-focus")
        }, focusout: function (event) {
            $(event.currentTarget).removeClass("ui-state-focus")
        }})
    }, _trigger: function (type, event, data) {
        var prop, orig, callback = this.options[type];
        if (data = data || {}, event = $.Event(event), event.type = (type === this.widgetEventPrefix ? type : this.widgetEventPrefix + type).toLowerCase(), event.target = this.element[0], orig = event.originalEvent)for (prop in orig)prop in event || (event[prop] = orig[prop]);
        return this.element.trigger(event, data), !($.isFunction(callback) && callback.apply(this.element[0], [event].concat(data)) === !1 || event.isDefaultPrevented())
    }}, $.each({show: "fadeIn", hide: "fadeOut"}, function (method, defaultEffect) {
        $.Widget.prototype["_" + method] = function (element, options, callback) {
            "string" == typeof options && (options = {effect: options});
            var hasOptions, effectName = options ? options === !0 || "number" == typeof options ? defaultEffect : options.effect || defaultEffect : method;
            options = options || {}, "number" == typeof options && (options = {duration: options}), hasOptions = !$.isEmptyObject(options), options.complete = callback, options.delay && element.delay(options.delay), hasOptions && $.effects && $.effects.effect[effectName] ? element[method](options) : effectName !== method && element[effectName] ? element[effectName](options.duration, options.easing, callback) : element.queue(function (next) {
                $(this)[method](), callback && callback.call(element[0]), next()
            })
        }
    })
}(jQuery), function ($) {
    var mouseHandled = !1;
    $(document).mouseup(function () {
        mouseHandled = !1
    }), $.widget("ui.mouse", {version: "1.10.3", options: {cancel: "input,textarea,button,select,option", distance: 1, delay: 0}, _mouseInit: function () {
        var that = this;
        this.element.bind("mousedown." + this.widgetName,function (event) {
            return that._mouseDown(event)
        }).bind("click." + this.widgetName, function (event) {
            return!0 === $.data(event.target, that.widgetName + ".preventClickEvent") ? ($.removeData(event.target, that.widgetName + ".preventClickEvent"), event.stopImmediatePropagation(), !1) : void 0
        }), this.started = !1
    }, _mouseDestroy: function () {
        this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && $(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
    }, _mouseDown: function (event) {
        if (!mouseHandled) {
            this._mouseStarted && this._mouseUp(event), this._mouseDownEvent = event;
            var that = this, btnIsLeft = 1 === event.which, elIsCancel = "string" == typeof this.options.cancel && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : !1;
            return btnIsLeft && !elIsCancel && this._mouseCapture(event) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
                that.mouseDelayMet = !0
            }, this.options.delay)), this._mouseDistanceMet(event) && this._mouseDelayMet(event) && (this._mouseStarted = this._mouseStart(event) !== !1, !this._mouseStarted) ? (event.preventDefault(), !0) : (!0 === $.data(event.target, this.widgetName + ".preventClickEvent") && $.removeData(event.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (event) {
                return that._mouseMove(event)
            }, this._mouseUpDelegate = function (event) {
                return that._mouseUp(event)
            }, $(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), event.preventDefault(), mouseHandled = !0, !0)) : !0
        }
    }, _mouseMove: function (event) {
        return $.ui.ie && (!document.documentMode || document.documentMode < 9) && !event.button ? this._mouseUp(event) : this._mouseStarted ? (this._mouseDrag(event), event.preventDefault()) : (this._mouseDistanceMet(event) && this._mouseDelayMet(event) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, event) !== !1, this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event)), !this._mouseStarted)
    }, _mouseUp: function (event) {
        return $(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, event.target === this._mouseDownEvent.target && $.data(event.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(event)), !1
    }, _mouseDistanceMet: function (event) {
        return Math.max(Math.abs(this._mouseDownEvent.pageX - event.pageX), Math.abs(this._mouseDownEvent.pageY - event.pageY)) >= this.options.distance
    }, _mouseDelayMet: function () {
        return this.mouseDelayMet
    }, _mouseStart: function () {
    }, _mouseDrag: function () {
    }, _mouseStop: function () {
    }, _mouseCapture: function () {
        return!0
    }})
}(jQuery), function ($) {
    $.widget("ui.draggable", $.ui.mouse, {version: "1.10.3", widgetEventPrefix: "drag", options: {addClasses: !0, appendTo: "parent", axis: !1, connectToSortable: !1, containment: !1, cursor: "auto", cursorAt: !1, grid: !1, handle: !1, helper: "original", iframeFix: !1, opacity: !1, refreshPositions: !1, revert: !1, revertDuration: 500, scope: "default", scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, snap: !1, snapMode: "both", snapTolerance: 20, stack: !1, zIndex: !1, drag: null, start: null, stop: null}, _create: function () {
        "original" !== this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
    }, _destroy: function () {
        this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
    }, _mouseCapture: function (event) {
        var o = this.options;
        return this.helper || o.disabled || $(event.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(event), this.handle ? ($(o.iframeFix === !0 ? "iframe" : o.iframeFix).each(function () {
            $("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width: this.offsetWidth + "px", height: this.offsetHeight + "px", position: "absolute", opacity: "0.001", zIndex: 1e3}).css($(this).offset()).appendTo("body")
        }), !0) : !1)
    }, _mouseStart: function (event) {
        var o = this.options;
        return this.helper = this._createHelper(event), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), $.ui.ddmanager && ($.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offsetParent = this.helper.offsetParent(), this.offsetParentCssPosition = this.offsetParent.css("position"), this.offset = this.positionAbs = this.element.offset(), this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left}, this.offset.scroll = !1, $.extend(this.offset, {click: {left: event.pageX - this.offset.left, top: event.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(event), this.originalPageX = event.pageX, this.originalPageY = event.pageY, o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt), this._setContainment(), this._trigger("start", event) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), $.ui.ddmanager && !o.dropBehaviour && $.ui.ddmanager.prepareOffsets(this, event), this._mouseDrag(event, !0), $.ui.ddmanager && $.ui.ddmanager.dragStart(this, event), !0)
    }, _mouseDrag: function (event, noPropagation) {
        if ("fixed" === this.offsetParentCssPosition && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(event), this.positionAbs = this._convertPositionTo("absolute"), !noPropagation) {
            var ui = this._uiHash();
            if (this._trigger("drag", event, ui) === !1)return this._mouseUp({}), !1;
            this.position = ui.position
        }
        return this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), $.ui.ddmanager && $.ui.ddmanager.drag(this, event), !1
    }, _mouseStop: function (event) {
        var that = this, dropped = !1;
        return $.ui.ddmanager && !this.options.dropBehaviour && (dropped = $.ui.ddmanager.drop(this, event)), this.dropped && (dropped = this.dropped, this.dropped = !1), "original" !== this.options.helper || $.contains(this.element[0].ownerDocument, this.element[0]) ? ("invalid" === this.options.revert && !dropped || "valid" === this.options.revert && dropped || this.options.revert === !0 || $.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped) ? $(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
            that._trigger("stop", event) !== !1 && that._clear()
        }) : this._trigger("stop", event) !== !1 && this._clear(), !1) : !1
    }, _mouseUp: function (event) {
        return $("div.ui-draggable-iframeFix").each(function () {
            this.parentNode.removeChild(this)
        }), $.ui.ddmanager && $.ui.ddmanager.dragStop(this, event), $.ui.mouse.prototype._mouseUp.call(this, event)
    }, cancel: function () {
        return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
    }, _getHandle: function (event) {
        return this.options.handle ? !!$(event.target).closest(this.element.find(this.options.handle)).length : !0
    }, _createHelper: function (event) {
        var o = this.options, helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event])) : "clone" === o.helper ? this.element.clone().removeAttr("id") : this.element;
        return helper.parents("body").length || helper.appendTo("parent" === o.appendTo ? this.element[0].parentNode : o.appendTo), helper[0] === this.element[0] || /(fixed|absolute)/.test(helper.css("position")) || helper.css("position", "absolute"), helper
    }, _adjustOffsetFromHelper: function (obj) {
        "string" == typeof obj && (obj = obj.split(" ")), $.isArray(obj) && (obj = {left: +obj[0], top: +obj[1] || 0}), "left"in obj && (this.offset.click.left = obj.left + this.margins.left), "right"in obj && (this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left), "top"in obj && (this.offset.click.top = obj.top + this.margins.top), "bottom"in obj && (this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top)
    }, _getParentOffset: function () {
        var po = this.offsetParent.offset();
        return"absolute" === this.cssPosition && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) && (po.left += this.scrollParent.scrollLeft(), po.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && $.ui.ie) && (po = {top: 0, left: 0}), {top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
        if ("relative" === this.cssPosition) {
            var p = this.element.position();
            return{top: p.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: p.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
        }
        return{top: 0, left: 0}
    }, _cacheMargins: function () {
        this.margins = {left: parseInt(this.element.css("marginLeft"), 10) || 0, top: parseInt(this.element.css("marginTop"), 10) || 0, right: parseInt(this.element.css("marginRight"), 10) || 0, bottom: parseInt(this.element.css("marginBottom"), 10) || 0}
    }, _cacheHelperProportions: function () {
        this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
    }, _setContainment: function () {
        var over, c, ce, o = this.options;
        return o.containment ? "window" === o.containment ? (this.containment = [$(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, $(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, $(window).scrollLeft() + $(window).width() - this.helperProportions.width - this.margins.left, $(window).scrollTop() + ($(window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], void 0) : "document" === o.containment ? (this.containment = [0, 0, $(document).width() - this.helperProportions.width - this.margins.left, ($(document).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], void 0) : o.containment.constructor === Array ? (this.containment = o.containment, void 0) : ("parent" === o.containment && (o.containment = this.helper[0].parentNode), c = $(o.containment), ce = c[0], ce && (over = "hidden" !== c.css("overflow"), this.containment = [(parseInt(c.css("borderLeftWidth"), 10) || 0) + (parseInt(c.css("paddingLeft"), 10) || 0), (parseInt(c.css("borderTopWidth"), 10) || 0) + (parseInt(c.css("paddingTop"), 10) || 0), (over ? Math.max(ce.scrollWidth, ce.offsetWidth) : ce.offsetWidth) - (parseInt(c.css("borderRightWidth"), 10) || 0) - (parseInt(c.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (over ? Math.max(ce.scrollHeight, ce.offsetHeight) : ce.offsetHeight) - (parseInt(c.css("borderBottomWidth"), 10) || 0) - (parseInt(c.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = c), void 0) : (this.containment = null, void 0)
    }, _convertPositionTo: function (d, pos) {
        pos || (pos = this.position);
        var mod = "absolute" === d ? 1 : -1, scroll = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent;
        return this.offset.scroll || (this.offset.scroll = {top: scroll.scrollTop(), left: scroll.scrollLeft()}), {top: pos.top + this.offset.relative.top * mod + this.offset.parent.top * mod - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top) * mod, left: pos.left + this.offset.relative.left * mod + this.offset.parent.left * mod - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left) * mod}
    }, _generatePosition: function (event) {
        var containment, co, top, left, o = this.options, scroll = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, pageX = event.pageX, pageY = event.pageY;
        return this.offset.scroll || (this.offset.scroll = {top: scroll.scrollTop(), left: scroll.scrollLeft()}), this.originalPosition && (this.containment && (this.relative_container ? (co = this.relative_container.offset(), containment = [this.containment[0] + co.left, this.containment[1] + co.top, this.containment[2] + co.left, this.containment[3] + co.top]) : containment = this.containment, event.pageX - this.offset.click.left < containment[0] && (pageX = containment[0] + this.offset.click.left), event.pageY - this.offset.click.top < containment[1] && (pageY = containment[1] + this.offset.click.top), event.pageX - this.offset.click.left > containment[2] && (pageX = containment[2] + this.offset.click.left), event.pageY - this.offset.click.top > containment[3] && (pageY = containment[3] + this.offset.click.top)), o.grid && (top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY, pageY = containment ? top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3] ? top : top - this.offset.click.top >= containment[1] ? top - o.grid[1] : top + o.grid[1] : top, left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX, pageX = containment ? left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2] ? left : left - this.offset.click.left >= containment[0] ? left - o.grid[0] : left + o.grid[0] : left)), {top: pageY - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top), left: pageX - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left)}
    }, _clear: function () {
        this.helper.removeClass("ui-draggable-dragging"), this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
    }, _trigger: function (type, event, ui) {
        return ui = ui || this._uiHash(), $.ui.plugin.call(this, type, [event, ui]), "drag" === type && (this.positionAbs = this._convertPositionTo("absolute")), $.Widget.prototype._trigger.call(this, type, event, ui)
    }, plugins: {}, _uiHash: function () {
        return{helper: this.helper, position: this.position, originalPosition: this.originalPosition, offset: this.positionAbs}
    }}), $.ui.plugin.add("draggable", "connectToSortable", {start: function (event, ui) {
        var inst = $(this).data("ui-draggable"), o = inst.options, uiSortable = $.extend({}, ui, {item: inst.element});
        inst.sortables = [], $(o.connectToSortable).each(function () {
            var sortable = $.data(this, "ui-sortable");
            sortable && !sortable.options.disabled && (inst.sortables.push({instance: sortable, shouldRevert: sortable.options.revert}), sortable.refreshPositions(), sortable._trigger("activate", event, uiSortable))
        })
    }, stop: function (event, ui) {
        var inst = $(this).data("ui-draggable"), uiSortable = $.extend({}, ui, {item: inst.element});
        $.each(inst.sortables, function () {
            this.instance.isOver ? (this.instance.isOver = 0, inst.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = this.shouldRevert), this.instance._mouseStop(event), this.instance.options.helper = this.instance.options._helper, "original" === inst.options.helper && this.instance.currentItem.css({top: "auto", left: "auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", event, uiSortable))
        })
    }, drag: function (event, ui) {
        var inst = $(this).data("ui-draggable"), that = this;
        $.each(inst.sortables, function () {
            var innermostIntersecting = !1, thisSortable = this;
            this.instance.positionAbs = inst.positionAbs, this.instance.helperProportions = inst.helperProportions, this.instance.offset.click = inst.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (innermostIntersecting = !0, $.each(inst.sortables, function () {
                return this.instance.positionAbs = inst.positionAbs, this.instance.helperProportions = inst.helperProportions, this.instance.offset.click = inst.offset.click, this !== thisSortable && this.instance._intersectsWith(this.instance.containerCache) && $.contains(thisSortable.instance.element[0], this.instance.element[0]) && (innermostIntersecting = !1), innermostIntersecting
            })), innermostIntersecting ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = $(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function () {
                return ui.helper[0]
            }, event.target = this.instance.currentItem[0], this.instance._mouseCapture(event, !0), this.instance._mouseStart(event, !0, !0), this.instance.offset.click.top = inst.offset.click.top, this.instance.offset.click.left = inst.offset.click.left, this.instance.offset.parent.left -= inst.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= inst.offset.parent.top - this.instance.offset.parent.top, inst._trigger("toSortable", event), inst.dropped = this.instance.element, inst.currentItem = inst.element, this.instance.fromOutside = inst), this.instance.currentItem && this.instance._mouseDrag(event)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", event, this.instance._uiHash(this.instance)), this.instance._mouseStop(event, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), inst._trigger("fromSortable", event), inst.dropped = !1)
        })
    }}), $.ui.plugin.add("draggable", "cursor", {start: function () {
        var t = $("body"), o = $(this).data("ui-draggable").options;
        t.css("cursor") && (o._cursor = t.css("cursor")), t.css("cursor", o.cursor)
    }, stop: function () {
        var o = $(this).data("ui-draggable").options;
        o._cursor && $("body").css("cursor", o._cursor)
    }}), $.ui.plugin.add("draggable", "opacity", {start: function (event, ui) {
        var t = $(ui.helper), o = $(this).data("ui-draggable").options;
        t.css("opacity") && (o._opacity = t.css("opacity")), t.css("opacity", o.opacity)
    }, stop: function (event, ui) {
        var o = $(this).data("ui-draggable").options;
        o._opacity && $(ui.helper).css("opacity", o._opacity)
    }}), $.ui.plugin.add("draggable", "scroll", {start: function () {
        var i = $(this).data("ui-draggable");
        i.scrollParent[0] !== document && "HTML" !== i.scrollParent[0].tagName && (i.overflowOffset = i.scrollParent.offset())
    }, drag: function (event) {
        var i = $(this).data("ui-draggable"), o = i.options, scrolled = !1;
        i.scrollParent[0] !== document && "HTML" !== i.scrollParent[0].tagName ? (o.axis && "x" === o.axis || (i.overflowOffset.top + i.scrollParent[0].offsetHeight - event.pageY < o.scrollSensitivity ? i.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop + o.scrollSpeed : event.pageY - i.overflowOffset.top < o.scrollSensitivity && (i.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop - o.scrollSpeed)), o.axis && "y" === o.axis || (i.overflowOffset.left + i.scrollParent[0].offsetWidth - event.pageX < o.scrollSensitivity ? i.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft + o.scrollSpeed : event.pageX - i.overflowOffset.left < o.scrollSensitivity && (i.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft - o.scrollSpeed))) : (o.axis && "x" === o.axis || (event.pageY - $(document).scrollTop() < o.scrollSensitivity ? scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed) : $(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity && (scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed))), o.axis && "y" === o.axis || (event.pageX - $(document).scrollLeft() < o.scrollSensitivity ? scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed) : $(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity && (scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed)))), scrolled !== !1 && $.ui.ddmanager && !o.dropBehaviour && $.ui.ddmanager.prepareOffsets(i, event)
    }}), $.ui.plugin.add("draggable", "snap", {start: function () {
        var i = $(this).data("ui-draggable"), o = i.options;
        i.snapElements = [], $(o.snap.constructor !== String ? o.snap.items || ":data(ui-draggable)" : o.snap).each(function () {
            var $t = $(this), $o = $t.offset();
            this !== i.element[0] && i.snapElements.push({item: this, width: $t.outerWidth(), height: $t.outerHeight(), top: $o.top, left: $o.left})
        })
    }, drag: function (event, ui) {
        var ts, bs, ls, rs, l, r, t, b, i, first, inst = $(this).data("ui-draggable"), o = inst.options, d = o.snapTolerance, x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width, y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;
        for (i = inst.snapElements.length - 1; i >= 0; i--)l = inst.snapElements[i].left, r = l + inst.snapElements[i].width, t = inst.snapElements[i].top, b = t + inst.snapElements[i].height, l - d > x2 || x1 > r + d || t - d > y2 || y1 > b + d || !$.contains(inst.snapElements[i].item.ownerDocument, inst.snapElements[i].item) ? (inst.snapElements[i].snapping && inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), {snapItem: inst.snapElements[i].item})), inst.snapElements[i].snapping = !1) : ("inner" !== o.snapMode && (ts = Math.abs(t - y2) <= d, bs = Math.abs(b - y1) <= d, ls = Math.abs(l - x2) <= d, rs = Math.abs(r - x1) <= d, ts && (ui.position.top = inst._convertPositionTo("relative", {top: t - inst.helperProportions.height, left: 0}).top - inst.margins.top), bs && (ui.position.top = inst._convertPositionTo("relative", {top: b, left: 0}).top - inst.margins.top), ls && (ui.position.left = inst._convertPositionTo("relative", {top: 0, left: l - inst.helperProportions.width}).left - inst.margins.left), rs && (ui.position.left = inst._convertPositionTo("relative", {top: 0, left: r}).left - inst.margins.left)), first = ts || bs || ls || rs, "outer" !== o.snapMode && (ts = Math.abs(t - y1) <= d, bs = Math.abs(b - y2) <= d, ls = Math.abs(l - x1) <= d, rs = Math.abs(r - x2) <= d, ts && (ui.position.top = inst._convertPositionTo("relative", {top: t, left: 0}).top - inst.margins.top), bs && (ui.position.top = inst._convertPositionTo("relative", {top: b - inst.helperProportions.height, left: 0}).top - inst.margins.top), ls && (ui.position.left = inst._convertPositionTo("relative", {top: 0, left: l}).left - inst.margins.left), rs && (ui.position.left = inst._convertPositionTo("relative", {top: 0, left: r - inst.helperProportions.width}).left - inst.margins.left)), !inst.snapElements[i].snapping && (ts || bs || ls || rs || first) && inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), {snapItem: inst.snapElements[i].item})), inst.snapElements[i].snapping = ts || bs || ls || rs || first)
    }}), $.ui.plugin.add("draggable", "stack", {start: function () {
        var min, o = this.data("ui-draggable").options, group = $.makeArray($(o.stack)).sort(function (a, b) {
            return(parseInt($(a).css("zIndex"), 10) || 0) - (parseInt($(b).css("zIndex"), 10) || 0)
        });
        group.length && (min = parseInt($(group[0]).css("zIndex"), 10) || 0, $(group).each(function (i) {
            $(this).css("zIndex", min + i)
        }), this.css("zIndex", min + group.length))
    }}), $.ui.plugin.add("draggable", "zIndex", {start: function (event, ui) {
        var t = $(ui.helper), o = $(this).data("ui-draggable").options;
        t.css("zIndex") && (o._zIndex = t.css("zIndex")), t.css("zIndex", o.zIndex)
    }, stop: function (event, ui) {
        var o = $(this).data("ui-draggable").options;
        o._zIndex && $(ui.helper).css("zIndex", o._zIndex)
    }})
}(jQuery), function ($) {
    function isOverAxis(x, reference, size) {
        return x > reference && reference + size > x
    }

    $.widget("ui.droppable", {version: "1.10.3", widgetEventPrefix: "drop", options: {accept: "*", activeClass: !1, addClasses: !0, greedy: !1, hoverClass: !1, scope: "default", tolerance: "intersect", activate: null, deactivate: null, drop: null, out: null, over: null}, _create: function () {
        var o = this.options, accept = o.accept;
        this.isover = !1, this.isout = !0, this.accept = $.isFunction(accept) ? accept : function (d) {
            return d.is(accept)
        }, this.proportions = {width: this.element[0].offsetWidth, height: this.element[0].offsetHeight}, $.ui.ddmanager.droppables[o.scope] = $.ui.ddmanager.droppables[o.scope] || [], $.ui.ddmanager.droppables[o.scope].push(this), o.addClasses && this.element.addClass("ui-droppable")
    }, _destroy: function () {
        for (var i = 0, drop = $.ui.ddmanager.droppables[this.options.scope]; i < drop.length; i++)drop[i] === this && drop.splice(i, 1);
        this.element.removeClass("ui-droppable ui-droppable-disabled")
    }, _setOption: function (key, value) {
        "accept" === key && (this.accept = $.isFunction(value) ? value : function (d) {
            return d.is(value)
        }), $.Widget.prototype._setOption.apply(this, arguments)
    }, _activate: function (event) {
        var draggable = $.ui.ddmanager.current;
        this.options.activeClass && this.element.addClass(this.options.activeClass), draggable && this._trigger("activate", event, this.ui(draggable))
    }, _deactivate: function (event) {
        var draggable = $.ui.ddmanager.current;
        this.options.activeClass && this.element.removeClass(this.options.activeClass), draggable && this._trigger("deactivate", event, this.ui(draggable))
    }, _over: function (event) {
        var draggable = $.ui.ddmanager.current;
        draggable && (draggable.currentItem || draggable.element)[0] !== this.element[0] && this.accept.call(this.element[0], draggable.currentItem || draggable.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", event, this.ui(draggable)))
    }, _out: function (event) {
        var draggable = $.ui.ddmanager.current;
        draggable && (draggable.currentItem || draggable.element)[0] !== this.element[0] && this.accept.call(this.element[0], draggable.currentItem || draggable.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", event, this.ui(draggable)))
    }, _drop: function (event, custom) {
        var draggable = custom || $.ui.ddmanager.current, childrenIntersection = !1;
        return draggable && (draggable.currentItem || draggable.element)[0] !== this.element[0] ? (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function () {
            var inst = $.data(this, "ui-droppable");
            return inst.options.greedy && !inst.options.disabled && inst.options.scope === draggable.options.scope && inst.accept.call(inst.element[0], draggable.currentItem || draggable.element) && $.ui.intersect(draggable, $.extend(inst, {offset: inst.element.offset()}), inst.options.tolerance) ? (childrenIntersection = !0, !1) : void 0
        }), childrenIntersection ? !1 : this.accept.call(this.element[0], draggable.currentItem || draggable.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", event, this.ui(draggable)), this.element) : !1) : !1
    }, ui: function (c) {
        return{draggable: c.currentItem || c.element, helper: c.helper, position: c.position, offset: c.positionAbs}
    }}), $.ui.intersect = function (draggable, droppable, toleranceMode) {
        if (!droppable.offset)return!1;
        var draggableLeft, draggableTop, x1 = (draggable.positionAbs || draggable.position.absolute).left, x2 = x1 + draggable.helperProportions.width, y1 = (draggable.positionAbs || draggable.position.absolute).top, y2 = y1 + draggable.helperProportions.height, l = droppable.offset.left, r = l + droppable.proportions.width, t = droppable.offset.top, b = t + droppable.proportions.height;
        switch (toleranceMode) {
            case"fit":
                return x1 >= l && r >= x2 && y1 >= t && b >= y2;
            case"intersect":
                return l < x1 + draggable.helperProportions.width / 2 && x2 - draggable.helperProportions.width / 2 < r && t < y1 + draggable.helperProportions.height / 2 && y2 - draggable.helperProportions.height / 2 < b;
            case"pointer":
                return draggableLeft = (draggable.positionAbs || draggable.position.absolute).left + (draggable.clickOffset || draggable.offset.click).left, draggableTop = (draggable.positionAbs || draggable.position.absolute).top + (draggable.clickOffset || draggable.offset.click).top, isOverAxis(draggableTop, t, droppable.proportions.height) && isOverAxis(draggableLeft, l, droppable.proportions.width);
            case"touch":
                return(y1 >= t && b >= y1 || y2 >= t && b >= y2 || t > y1 && y2 > b) && (x1 >= l && r >= x1 || x2 >= l && r >= x2 || l > x1 && x2 > r);
            default:
                return!1
        }
    }, $.ui.ddmanager = {current: null, droppables: {"default": []}, prepareOffsets: function (t, event) {
        var i, j, m = $.ui.ddmanager.droppables[t.options.scope] || [], type = event ? event.type : null, list = (t.currentItem || t.element).find(":data(ui-droppable)").addBack();
        droppablesLoop:for (i = 0; i < m.length; i++)if (!(m[i].options.disabled || t && !m[i].accept.call(m[i].element[0], t.currentItem || t.element))) {
            for (j = 0; j < list.length; j++)if (list[j] === m[i].element[0]) {
                m[i].proportions.height = 0;
                continue droppablesLoop
            }
            m[i].visible = "none" !== m[i].element.css("display"), m[i].visible && ("mousedown" === type && m[i]._activate.call(m[i], event), m[i].offset = m[i].element.offset(), m[i].proportions = {width: m[i].element[0].offsetWidth, height: m[i].element[0].offsetHeight})
        }
    }, drop: function (draggable, event) {
        var dropped = !1;
        return $.each(($.ui.ddmanager.droppables[draggable.options.scope] || []).slice(), function () {
            this.options && (!this.options.disabled && this.visible && $.ui.intersect(draggable, this, this.options.tolerance) && (dropped = this._drop.call(this, event) || dropped), !this.options.disabled && this.visible && this.accept.call(this.element[0], draggable.currentItem || draggable.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, event)))
        }), dropped
    }, dragStart: function (draggable, event) {
        draggable.element.parentsUntil("body").bind("scroll.droppable", function () {
            draggable.options.refreshPositions || $.ui.ddmanager.prepareOffsets(draggable, event)
        })
    }, drag: function (draggable, event) {
        draggable.options.refreshPositions && $.ui.ddmanager.prepareOffsets(draggable, event), $.each($.ui.ddmanager.droppables[draggable.options.scope] || [], function () {
            if (!this.options.disabled && !this.greedyChild && this.visible) {
                var parentInstance, scope, parent, intersects = $.ui.intersect(draggable, this, this.options.tolerance), c = !intersects && this.isover ? "isout" : intersects && !this.isover ? "isover" : null;
                c && (this.options.greedy && (scope = this.options.scope, parent = this.element.parents(":data(ui-droppable)").filter(function () {
                    return $.data(this, "ui-droppable").options.scope === scope
                }), parent.length && (parentInstance = $.data(parent[0], "ui-droppable"), parentInstance.greedyChild = "isover" === c)), parentInstance && "isover" === c && (parentInstance.isover = !1, parentInstance.isout = !0, parentInstance._out.call(parentInstance, event)), this[c] = !0, this["isout" === c ? "isover" : "isout"] = !1, this["isover" === c ? "_over" : "_out"].call(this, event), parentInstance && "isout" === c && (parentInstance.isout = !1, parentInstance.isover = !0, parentInstance._over.call(parentInstance, event)))
            }
        })
    }, dragStop: function (draggable, event) {
        draggable.element.parentsUntil("body").unbind("scroll.droppable"), draggable.options.refreshPositions || $.ui.ddmanager.prepareOffsets(draggable, event)
    }}
}(jQuery), function ($) {
    function isOverAxis(x, reference, size) {
        return x > reference && reference + size > x
    }

    function isFloating(item) {
        return/left|right/.test(item.css("float")) || /inline|table-cell/.test(item.css("display"))
    }

    $.widget("ui.sortable", $.ui.mouse, {version: "1.10.3", widgetEventPrefix: "sort", ready: !1, options: {appendTo: "parent", axis: !1, connectWith: !1, containment: !1, cursor: "auto", cursorAt: !1, dropOnEmpty: !0, forcePlaceholderSize: !1, forceHelperSize: !1, grid: !1, handle: !1, helper: "original", items: "> *", opacity: !1, placeholder: !1, revert: !1, scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, scope: "default", tolerance: "intersect", zIndex: 1e3, activate: null, beforeStop: null, change: null, deactivate: null, out: null, over: null, receive: null, remove: null, sort: null, start: null, stop: null, update: null}, _create: function () {
        var o = this.options;
        this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? "x" === o.axis || isFloating(this.items[0].item) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
    }, _destroy: function () {
        this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
        for (var i = this.items.length - 1; i >= 0; i--)this.items[i].item.removeData(this.widgetName + "-item");
        return this
    }, _setOption: function (key, value) {
        "disabled" === key ? (this.options[key] = value, this.widget().toggleClass("ui-sortable-disabled", !!value)) : $.Widget.prototype._setOption.apply(this, arguments)
    }, _mouseCapture: function (event, overrideHandle) {
        var currentItem = null, validHandle = !1, that = this;
        return this.reverting ? !1 : this.options.disabled || "static" === this.options.type ? !1 : (this._refreshItems(event), $(event.target).parents().each(function () {
            return $.data(this, that.widgetName + "-item") === that ? (currentItem = $(this), !1) : void 0
        }), $.data(event.target, that.widgetName + "-item") === that && (currentItem = $(event.target)), currentItem ? !this.options.handle || overrideHandle || ($(this.options.handle, currentItem).find("*").addBack().each(function () {
            this === event.target && (validHandle = !0)
        }), validHandle) ? (this.currentItem = currentItem, this._removeCurrentsFromItems(), !0) : !1 : !1)
    }, _mouseStart: function (event, overrideHandle, noActivation) {
        var i, body, o = this.options;
        if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(event), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left}, $.extend(this.offset, {click: {left: event.pageX - this.offset.left, top: event.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()}), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(event), this.originalPageX = event.pageX, this.originalPageY = event.pageY, o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt), this.domPosition = {prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0]}, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), o.containment && this._setContainment(), o.cursor && "auto" !== o.cursor && (body = this.document.find("body"), this.storedCursor = body.css("cursor"), body.css("cursor", o.cursor), this.storedStylesheet = $("<style>*{ cursor: " + o.cursor + " !important; }</style>").appendTo(body)), o.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", o.opacity)), o.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", o.zIndex)), this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", event, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !noActivation)for (i = this.containers.length - 1; i >= 0; i--)this.containers[i]._trigger("activate", event, this._uiHash(this));
        return $.ui.ddmanager && ($.ui.ddmanager.current = this), $.ui.ddmanager && !o.dropBehaviour && $.ui.ddmanager.prepareOffsets(this, event), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(event), !0
    }, _mouseDrag: function (event) {
        var i, item, itemElement, intersection, o = this.options, scrolled = !1;
        for (this.position = this._generatePosition(event), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - event.pageY < o.scrollSensitivity ? this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed : event.pageY - this.overflowOffset.top < o.scrollSensitivity && (this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - event.pageX < o.scrollSensitivity ? this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed : event.pageX - this.overflowOffset.left < o.scrollSensitivity && (this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed)) : (event.pageY - $(document).scrollTop() < o.scrollSensitivity ? scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed) : $(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity && (scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed)), event.pageX - $(document).scrollLeft() < o.scrollSensitivity ? scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed) : $(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity && (scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed))), scrolled !== !1 && $.ui.ddmanager && !o.dropBehaviour && $.ui.ddmanager.prepareOffsets(this, event)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), i = this.items.length - 1; i >= 0; i--)if (item = this.items[i], itemElement = item.item[0], intersection = this._intersectsWithPointer(item), intersection && item.instance === this.currentContainer && itemElement !== this.currentItem[0] && this.placeholder[1 === intersection ? "next" : "prev"]()[0] !== itemElement && !$.contains(this.placeholder[0], itemElement) && ("semi-dynamic" === this.options.type ? !$.contains(this.element[0], itemElement) : !0)) {
            if (this.direction = 1 === intersection ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(item))break;
            this._rearrange(event, item), this._trigger("change", event, this._uiHash());
            break
        }
        return this._contactContainers(event), $.ui.ddmanager && $.ui.ddmanager.drag(this, event), this._trigger("sort", event, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
    }, _mouseStop: function (event, noPropagation) {
        if (event) {
            if ($.ui.ddmanager && !this.options.dropBehaviour && $.ui.ddmanager.drop(this, event), this.options.revert) {
                var that = this, cur = this.placeholder.offset(), axis = this.options.axis, animation = {};
                axis && "x" !== axis || (animation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft)), axis && "y" !== axis || (animation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)), this.reverting = !0, $(this.helper).animate(animation, parseInt(this.options.revert, 10) || 500, function () {
                    that._clear(event)
                })
            } else this._clear(event, noPropagation);
            return!1
        }
    }, cancel: function () {
        if (this.dragging) {
            this._mouseUp({target: null}), "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
            for (var i = this.containers.length - 1; i >= 0; i--)this.containers[i]._trigger("deactivate", null, this._uiHash(this)), this.containers[i].containerCache.over && (this.containers[i]._trigger("out", null, this._uiHash(this)), this.containers[i].containerCache.over = 0)
        }
        return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), $.extend(this, {helper: null, dragging: !1, reverting: !1, _noFinalSort: null}), this.domPosition.prev ? $(this.domPosition.prev).after(this.currentItem) : $(this.domPosition.parent).prepend(this.currentItem)), this
    }, serialize: function (o) {
        var items = this._getItemsAsjQuery(o && o.connected), str = [];
        return o = o || {}, $(items).each(function () {
            var res = ($(o.item || this).attr(o.attribute || "id") || "").match(o.expression || /(.+)[\-=_](.+)/);
            res && str.push((o.key || res[1] + "[]") + "=" + (o.key && o.expression ? res[1] : res[2]))
        }), !str.length && o.key && str.push(o.key + "="), str.join("&")
    }, toArray: function (o) {
        var items = this._getItemsAsjQuery(o && o.connected), ret = [];
        return o = o || {}, items.each(function () {
            ret.push($(o.item || this).attr(o.attribute || "id") || "")
        }), ret
    }, _intersectsWith: function (item) {
        var x1 = this.positionAbs.left, x2 = x1 + this.helperProportions.width, y1 = this.positionAbs.top, y2 = y1 + this.helperProportions.height, l = item.left, r = l + item.width, t = item.top, b = t + item.height, dyClick = this.offset.click.top, dxClick = this.offset.click.left, isOverElementHeight = "x" === this.options.axis || y1 + dyClick > t && b > y1 + dyClick, isOverElementWidth = "y" === this.options.axis || x1 + dxClick > l && r > x1 + dxClick, isOverElement = isOverElementHeight && isOverElementWidth;
        return"pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > item[this.floating ? "width" : "height"] ? isOverElement : l < x1 + this.helperProportions.width / 2 && x2 - this.helperProportions.width / 2 < r && t < y1 + this.helperProportions.height / 2 && y2 - this.helperProportions.height / 2 < b
    }, _intersectsWithPointer: function (item) {
        var isOverElementHeight = "x" === this.options.axis || isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height), isOverElementWidth = "y" === this.options.axis || isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width), isOverElement = isOverElementHeight && isOverElementWidth, verticalDirection = this._getDragVerticalDirection(), horizontalDirection = this._getDragHorizontalDirection();
        return isOverElement ? this.floating ? horizontalDirection && "right" === horizontalDirection || "down" === verticalDirection ? 2 : 1 : verticalDirection && ("down" === verticalDirection ? 2 : 1) : !1
    }, _intersectsWithSides: function (item) {
        var isOverBottomHalf = isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + item.height / 2, item.height), isOverRightHalf = isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + item.width / 2, item.width), verticalDirection = this._getDragVerticalDirection(), horizontalDirection = this._getDragHorizontalDirection();
        return this.floating && horizontalDirection ? "right" === horizontalDirection && isOverRightHalf || "left" === horizontalDirection && !isOverRightHalf : verticalDirection && ("down" === verticalDirection && isOverBottomHalf || "up" === verticalDirection && !isOverBottomHalf)
    }, _getDragVerticalDirection: function () {
        var delta = this.positionAbs.top - this.lastPositionAbs.top;
        return 0 !== delta && (delta > 0 ? "down" : "up")
    }, _getDragHorizontalDirection: function () {
        var delta = this.positionAbs.left - this.lastPositionAbs.left;
        return 0 !== delta && (delta > 0 ? "right" : "left")
    }, refresh: function (event) {
        return this._refreshItems(event), this.refreshPositions(), this
    }, _connectWith: function () {
        var options = this.options;
        return options.connectWith.constructor === String ? [options.connectWith] : options.connectWith
    }, _getItemsAsjQuery: function (connected) {
        var i, j, cur, inst, items = [], queries = [], connectWith = this._connectWith();
        if (connectWith && connected)for (i = connectWith.length - 1; i >= 0; i--)for (cur = $(connectWith[i]), j = cur.length - 1; j >= 0; j--)inst = $.data(cur[j], this.widgetFullName), inst && inst !== this && !inst.options.disabled && queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), inst]);
        for (queries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options: this.options, item: this.currentItem}) : $(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), i = queries.length - 1; i >= 0; i--)queries[i][0].each(function () {
            items.push(this)
        });
        return $(items)
    }, _removeCurrentsFromItems: function () {
        var list = this.currentItem.find(":data(" + this.widgetName + "-item)");
        this.items = $.grep(this.items, function (item) {
            for (var j = 0; j < list.length; j++)if (list[j] === item.item[0])return!1;
            return!0
        })
    }, _refreshItems: function (event) {
        this.items = [], this.containers = [this];
        var i, j, cur, inst, targetData, _queries, item, queriesLength, items = this.items, queries = [
            [$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, {item: this.currentItem}) : $(this.options.items, this.element), this]
        ], connectWith = this._connectWith();
        if (connectWith && this.ready)for (i = connectWith.length - 1; i >= 0; i--)for (cur = $(connectWith[i]), j = cur.length - 1; j >= 0; j--)inst = $.data(cur[j], this.widgetFullName), inst && inst !== this && !inst.options.disabled && (queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, {item: this.currentItem}) : $(inst.options.items, inst.element), inst]), this.containers.push(inst));
        for (i = queries.length - 1; i >= 0; i--)for (targetData = queries[i][1], _queries = queries[i][0], j = 0, queriesLength = _queries.length; queriesLength > j; j++)item = $(_queries[j]), item.data(this.widgetName + "-item", targetData), items.push({item: item, instance: targetData, width: 0, height: 0, left: 0, top: 0})
    }, refreshPositions: function (fast) {
        this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
        var i, item, t, p;
        for (i = this.items.length - 1; i >= 0; i--)item = this.items[i], item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0] || (t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item, fast || (item.width = t.outerWidth(), item.height = t.outerHeight()), p = t.offset(), item.left = p.left, item.top = p.top);
        if (this.options.custom && this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this); else for (i = this.containers.length - 1; i >= 0; i--)p = this.containers[i].element.offset(), this.containers[i].containerCache.left = p.left, this.containers[i].containerCache.top = p.top, this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
        return this
    }, _createPlaceholder: function (that) {
        that = that || this;
        var className, o = that.options;
        o.placeholder && o.placeholder.constructor !== String || (className = o.placeholder, o.placeholder = {element: function () {
            var nodeName = that.currentItem[0].nodeName.toLowerCase(), element = $("<" + nodeName + ">", that.document[0]).addClass(className || that.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
            return"tr" === nodeName ? that.currentItem.children().each(function () {
                $("<td>&#160;</td>", that.document[0]).attr("colspan", $(this).attr("colspan") || 1).appendTo(element)
            }) : "img" === nodeName && element.attr("src", that.currentItem.attr("src")), className || element.css("visibility", "hidden"), element
        }, update: function (container, p) {
            (!className || o.forcePlaceholderSize) && (p.height() || p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css("paddingTop") || 0, 10) - parseInt(that.currentItem.css("paddingBottom") || 0, 10)), p.width() || p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css("paddingLeft") || 0, 10) - parseInt(that.currentItem.css("paddingRight") || 0, 10)))
        }}), that.placeholder = $(o.placeholder.element.call(that.element, that.currentItem)), that.currentItem.after(that.placeholder), o.placeholder.update(that, that.placeholder)
    }, _contactContainers: function (event) {
        var i, j, dist, itemWithLeastDistance, posProperty, sizeProperty, base, cur, nearBottom, floating, innermostContainer = null, innermostIndex = null;
        for (i = this.containers.length - 1; i >= 0; i--)if (!$.contains(this.currentItem[0], this.containers[i].element[0]))if (this._intersectsWith(this.containers[i].containerCache)) {
            if (innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0]))continue;
            innermostContainer = this.containers[i], innermostIndex = i
        } else this.containers[i].containerCache.over && (this.containers[i]._trigger("out", event, this._uiHash(this)), this.containers[i].containerCache.over = 0);
        if (innermostContainer)if (1 === this.containers.length)this.containers[innermostIndex].containerCache.over || (this.containers[innermostIndex]._trigger("over", event, this._uiHash(this)), this.containers[innermostIndex].containerCache.over = 1); else {
            for (dist = 1e4, itemWithLeastDistance = null, floating = innermostContainer.floating || isFloating(this.currentItem), posProperty = floating ? "left" : "top", sizeProperty = floating ? "width" : "height", base = this.positionAbs[posProperty] + this.offset.click[posProperty], j = this.items.length - 1; j >= 0; j--)$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0]) && this.items[j].item[0] !== this.currentItem[0] && (!floating || isOverAxis(this.positionAbs.top + this.offset.click.top, this.items[j].top, this.items[j].height)) && (cur = this.items[j].item.offset()[posProperty], nearBottom = !1, Math.abs(cur - base) > Math.abs(cur + this.items[j][sizeProperty] - base) && (nearBottom = !0, cur += this.items[j][sizeProperty]), Math.abs(cur - base) < dist && (dist = Math.abs(cur - base), itemWithLeastDistance = this.items[j], this.direction = nearBottom ? "up" : "down"));
            if (!itemWithLeastDistance && !this.options.dropOnEmpty)return;
            if (this.currentContainer === this.containers[innermostIndex])return;
            itemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, !0) : this._rearrange(event, null, this.containers[innermostIndex].element, !0), this._trigger("change", event, this._uiHash()), this.containers[innermostIndex]._trigger("change", event, this._uiHash(this)), this.currentContainer = this.containers[innermostIndex], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[innermostIndex]._trigger("over", event, this._uiHash(this)), this.containers[innermostIndex].containerCache.over = 1
        }
    }, _createHelper: function (event) {
        var o = this.options, helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : "clone" === o.helper ? this.currentItem.clone() : this.currentItem;
        return helper.parents("body").length || $("parent" !== o.appendTo ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]), helper[0] === this.currentItem[0] && (this._storedCSS = {width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left")}), (!helper[0].style.width || o.forceHelperSize) && helper.width(this.currentItem.width()), (!helper[0].style.height || o.forceHelperSize) && helper.height(this.currentItem.height()), helper
    }, _adjustOffsetFromHelper: function (obj) {
        "string" == typeof obj && (obj = obj.split(" ")), $.isArray(obj) && (obj = {left: +obj[0], top: +obj[1] || 0}), "left"in obj && (this.offset.click.left = obj.left + this.margins.left), "right"in obj && (this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left), "top"in obj && (this.offset.click.top = obj.top + this.margins.top), "bottom"in obj && (this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top)
    }, _getParentOffset: function () {
        this.offsetParent = this.helper.offsetParent();
        var po = this.offsetParent.offset();
        return"absolute" === this.cssPosition && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) && (po.left += this.scrollParent.scrollLeft(), po.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && $.ui.ie) && (po = {top: 0, left: 0}), {top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
        if ("relative" === this.cssPosition) {
            var p = this.currentItem.position();
            return{top: p.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: p.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
        }
        return{top: 0, left: 0}
    }, _cacheMargins: function () {
        this.margins = {left: parseInt(this.currentItem.css("marginLeft"), 10) || 0, top: parseInt(this.currentItem.css("marginTop"), 10) || 0}
    }, _cacheHelperProportions: function () {
        this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
    }, _setContainment: function () {
        var ce, co, over, o = this.options;
        "parent" === o.containment && (o.containment = this.helper[0].parentNode), ("document" === o.containment || "window" === o.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, $("document" === o.containment ? document : window).width() - this.helperProportions.width - this.margins.left, ($("document" === o.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(o.containment) || (ce = $(o.containment)[0], co = $(o.containment).offset(), over = "hidden" !== $(ce).css("overflow"), this.containment = [co.left + (parseInt($(ce).css("borderLeftWidth"), 10) || 0) + (parseInt($(ce).css("paddingLeft"), 10) || 0) - this.margins.left, co.top + (parseInt($(ce).css("borderTopWidth"), 10) || 0) + (parseInt($(ce).css("paddingTop"), 10) || 0) - this.margins.top, co.left + (over ? Math.max(ce.scrollWidth, ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"), 10) || 0) - (parseInt($(ce).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, co.top + (over ? Math.max(ce.scrollHeight, ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"), 10) || 0) - (parseInt($(ce).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
    }, _convertPositionTo: function (d, pos) {
        pos || (pos = this.position);
        var mod = "absolute" === d ? 1 : -1, scroll = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, scrollIsRootNode = /(html|body)/i.test(scroll[0].tagName);
        return{top: pos.top + this.offset.relative.top * mod + this.offset.parent.top * mod - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : scrollIsRootNode ? 0 : scroll.scrollTop()) * mod, left: pos.left + this.offset.relative.left * mod + this.offset.parent.left * mod - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft()) * mod}
    }, _generatePosition: function (event) {
        var top, left, o = this.options, pageX = event.pageX, pageY = event.pageY, scroll = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, scrollIsRootNode = /(html|body)/i.test(scroll[0].tagName);
        return"relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (event.pageX - this.offset.click.left < this.containment[0] && (pageX = this.containment[0] + this.offset.click.left), event.pageY - this.offset.click.top < this.containment[1] && (pageY = this.containment[1] + this.offset.click.top), event.pageX - this.offset.click.left > this.containment[2] && (pageX = this.containment[2] + this.offset.click.left), event.pageY - this.offset.click.top > this.containment[3] && (pageY = this.containment[3] + this.offset.click.top)), o.grid && (top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1], pageY = this.containment ? top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3] ? top : top - this.offset.click.top >= this.containment[1] ? top - o.grid[1] : top + o.grid[1] : top, left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0], pageX = this.containment ? left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2] ? left : left - this.offset.click.left >= this.containment[0] ? left - o.grid[0] : left + o.grid[0] : left)), {top: pageY - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : scrollIsRootNode ? 0 : scroll.scrollTop()), left: pageX - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft())}
    }, _rearrange: function (event, i, a, hardRefresh) {
        a ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? i.item[0] : i.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
        var counter = this.counter;
        this._delay(function () {
            counter === this.counter && this.refreshPositions(!hardRefresh)
        })
    }, _clear: function (event, noPropagation) {
        this.reverting = !1;
        var i, delayedTriggers = [];
        if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
            for (i in this._storedCSS)("auto" === this._storedCSS[i] || "static" === this._storedCSS[i]) && (this._storedCSS[i] = "");
            this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
        } else this.currentItem.show();
        for (this.fromOutside && !noPropagation && delayedTriggers.push(function (event) {
            this._trigger("receive", event, this._uiHash(this.fromOutside))
        }), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || noPropagation || delayedTriggers.push(function (event) {
            this._trigger("update", event, this._uiHash())
        }), this !== this.currentContainer && (noPropagation || (delayedTriggers.push(function (event) {
            this._trigger("remove", event, this._uiHash())
        }), delayedTriggers.push(function (c) {
            return function (event) {
                c._trigger("receive", event, this._uiHash(this))
            }
        }.call(this, this.currentContainer)), delayedTriggers.push(function (c) {
            return function (event) {
                c._trigger("update", event, this._uiHash(this))
            }
        }.call(this, this.currentContainer)))), i = this.containers.length - 1; i >= 0; i--)noPropagation || delayedTriggers.push(function (c) {
            return function (event) {
                c._trigger("deactivate", event, this._uiHash(this))
            }
        }.call(this, this.containers[i])), this.containers[i].containerCache.over && (delayedTriggers.push(function (c) {
            return function (event) {
                c._trigger("out", event, this._uiHash(this))
            }
        }.call(this, this.containers[i])), this.containers[i].containerCache.over = 0);
        if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
            if (!noPropagation) {
                for (this._trigger("beforeStop", event, this._uiHash()), i = 0; i < delayedTriggers.length; i++)delayedTriggers[i].call(this, event);
                this._trigger("stop", event, this._uiHash())
            }
            return this.fromOutside = !1, !1
        }
        if (noPropagation || this._trigger("beforeStop", event, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null, !noPropagation) {
            for (i = 0; i < delayedTriggers.length; i++)delayedTriggers[i].call(this, event);
            this._trigger("stop", event, this._uiHash())
        }
        return this.fromOutside = !1, !0
    }, _trigger: function () {
        $.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
    }, _uiHash: function (_inst) {
        var inst = _inst || this;
        return{helper: inst.helper, placeholder: inst.placeholder || $([]), position: inst.position, originalPosition: inst.originalPosition, offset: inst.positionAbs, item: inst.currentItem, sender: _inst ? _inst.element : null}
    }})
}(jQuery), function ($) {
    var numPages = 5;
    $.widget("ui.slider", $.ui.mouse, {version: "1.10.3", widgetEventPrefix: "slide", options: {animate: !1, distance: 0, max: 100, min: 0, orientation: "horizontal", range: !1, step: 1, value: 0, values: null, change: null, slide: null, start: null, stop: null}, _create: function () {
        this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget ui-widget-content ui-corner-all"), this._refresh(), this._setOption("disabled", this.options.disabled), this._animateOff = !1
    }, _refresh: function () {
        this._createRange(), this._createHandles(), this._setupEvents(), this._refreshValue()
    }, _createHandles: function () {
        var i, handleCount, options = this.options, existingHandles = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"), handle = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>", handles = [];
        for (handleCount = options.values && options.values.length || 1, existingHandles.length > handleCount && (existingHandles.slice(handleCount).remove(), existingHandles = existingHandles.slice(0, handleCount)), i = existingHandles.length; handleCount > i; i++)handles.push(handle);
        this.handles = existingHandles.add($(handles.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.each(function (i) {
            $(this).data("ui-slider-handle-index", i)
        })
    }, _createRange: function () {
        var options = this.options, classes = "";
        options.range ? (options.range === !0 && (options.values ? options.values.length && 2 !== options.values.length ? options.values = [options.values[0], options.values[0]] : $.isArray(options.values) && (options.values = options.values.slice(0)) : options.values = [this._valueMin(), this._valueMin()]), this.range && this.range.length ? this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left: "", bottom: ""}) : (this.range = $("<div></div>").appendTo(this.element), classes = "ui-slider-range ui-widget-header ui-corner-all"), this.range.addClass(classes + ("min" === options.range || "max" === options.range ? " ui-slider-range-" + options.range : ""))) : this.range = $([])
    }, _setupEvents: function () {
        var elements = this.handles.add(this.range).filter("a");
        this._off(elements), this._on(elements, this._handleEvents), this._hoverable(elements), this._focusable(elements)
    }, _destroy: function () {
        this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
    }, _mouseCapture: function (event) {
        var position, normValue, distance, closestHandle, index, allowed, offset, mouseOverHandle, that = this, o = this.options;
        return o.disabled ? !1 : (this.elementSize = {width: this.element.outerWidth(), height: this.element.outerHeight()}, this.elementOffset = this.element.offset(), position = {x: event.pageX, y: event.pageY}, normValue = this._normValueFromMouse(position), distance = this._valueMax() - this._valueMin() + 1, this.handles.each(function (i) {
            var thisDistance = Math.abs(normValue - that.values(i));
            (distance > thisDistance || distance === thisDistance && (i === that._lastChangedValue || that.values(i) === o.min)) && (distance = thisDistance, closestHandle = $(this), index = i)
        }), allowed = this._start(event, index), allowed === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = index, closestHandle.addClass("ui-state-active").focus(), offset = closestHandle.offset(), mouseOverHandle = !$(event.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = mouseOverHandle ? {left: 0, top: 0} : {left: event.pageX - offset.left - closestHandle.width() / 2, top: event.pageY - offset.top - closestHandle.height() / 2 - (parseInt(closestHandle.css("borderTopWidth"), 10) || 0) - (parseInt(closestHandle.css("borderBottomWidth"), 10) || 0) + (parseInt(closestHandle.css("marginTop"), 10) || 0)}, this.handles.hasClass("ui-state-hover") || this._slide(event, index, normValue), this._animateOff = !0, !0))
    }, _mouseStart: function () {
        return!0
    }, _mouseDrag: function (event) {
        var position = {x: event.pageX, y: event.pageY}, normValue = this._normValueFromMouse(position);
        return this._slide(event, this._handleIndex, normValue), !1
    }, _mouseStop: function (event) {
        return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(event, this._handleIndex), this._change(event, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
    }, _detectOrientation: function () {
        this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal"
    }, _normValueFromMouse: function (position) {
        var pixelTotal, pixelMouse, percentMouse, valueTotal, valueMouse;
        return"horizontal" === this.orientation ? (pixelTotal = this.elementSize.width, pixelMouse = position.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (pixelTotal = this.elementSize.height, pixelMouse = position.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), percentMouse = pixelMouse / pixelTotal, percentMouse > 1 && (percentMouse = 1), 0 > percentMouse && (percentMouse = 0), "vertical" === this.orientation && (percentMouse = 1 - percentMouse), valueTotal = this._valueMax() - this._valueMin(), valueMouse = this._valueMin() + percentMouse * valueTotal, this._trimAlignValue(valueMouse)
    }, _start: function (event, index) {
        var uiHash = {handle: this.handles[index], value: this.value()};
        return this.options.values && this.options.values.length && (uiHash.value = this.values(index), uiHash.values = this.values()), this._trigger("start", event, uiHash)
    }, _slide: function (event, index, newVal) {
        var otherVal, newValues, allowed;
        this.options.values && this.options.values.length ? (otherVal = this.values(index ? 0 : 1), 2 === this.options.values.length && this.options.range === !0 && (0 === index && newVal > otherVal || 1 === index && otherVal > newVal) && (newVal = otherVal), newVal !== this.values(index) && (newValues = this.values(), newValues[index] = newVal, allowed = this._trigger("slide", event, {handle: this.handles[index], value: newVal, values: newValues}), otherVal = this.values(index ? 0 : 1), allowed !== !1 && this.values(index, newVal, !0))) : newVal !== this.value() && (allowed = this._trigger("slide", event, {handle: this.handles[index], value: newVal}), allowed !== !1 && this.value(newVal))
    }, _stop: function (event, index) {
        var uiHash = {handle: this.handles[index], value: this.value()};
        this.options.values && this.options.values.length && (uiHash.value = this.values(index), uiHash.values = this.values()), this._trigger("stop", event, uiHash)
    }, _change: function (event, index) {
        if (!this._keySliding && !this._mouseSliding) {
            var uiHash = {handle: this.handles[index], value: this.value()};
            this.options.values && this.options.values.length && (uiHash.value = this.values(index), uiHash.values = this.values()), this._lastChangedValue = index, this._trigger("change", event, uiHash)
        }
    }, value: function (newValue) {
        return arguments.length ? (this.options.value = this._trimAlignValue(newValue), this._refreshValue(), this._change(null, 0), void 0) : this._value()
    }, values: function (index, newValue) {
        var vals, newValues, i;
        if (arguments.length > 1)return this.options.values[index] = this._trimAlignValue(newValue), this._refreshValue(), this._change(null, index), void 0;
        if (!arguments.length)return this._values();
        if (!$.isArray(arguments[0]))return this.options.values && this.options.values.length ? this._values(index) : this.value();
        for (vals = this.options.values, newValues = arguments[0], i = 0; i < vals.length; i += 1)vals[i] = this._trimAlignValue(newValues[i]), this._change(null, i);
        this._refreshValue()
    }, _setOption: function (key, value) {
        var i, valsLength = 0;
        switch ("range" === key && this.options.range === !0 && ("min" === value ? (this.options.value = this._values(0), this.options.values = null) : "max" === value && (this.options.value = this._values(this.options.values.length - 1), this.options.values = null)), $.isArray(this.options.values) && (valsLength = this.options.values.length), $.Widget.prototype._setOption.apply(this, arguments), key) {
            case"orientation":
                this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
                break;
            case"value":
                this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
                break;
            case"values":
                for (this._animateOff = !0, this._refreshValue(), i = 0; valsLength > i; i += 1)this._change(null, i);
                this._animateOff = !1;
                break;
            case"min":
            case"max":
                this._animateOff = !0, this._refreshValue(), this._animateOff = !1;
                break;
            case"range":
                this._animateOff = !0, this._refresh(), this._animateOff = !1
        }
    }, _value: function () {
        var val = this.options.value;
        return val = this._trimAlignValue(val)
    }, _values: function (index) {
        var val, vals, i;
        if (arguments.length)return val = this.options.values[index], val = this._trimAlignValue(val);
        if (this.options.values && this.options.values.length) {
            for (vals = this.options.values.slice(), i = 0; i < vals.length; i += 1)vals[i] = this._trimAlignValue(vals[i]);
            return vals
        }
        return[]
    }, _trimAlignValue: function (val) {
        if (val <= this._valueMin())return this._valueMin();
        if (val >= this._valueMax())return this._valueMax();
        var step = this.options.step > 0 ? this.options.step : 1, valModStep = (val - this._valueMin()) % step, alignValue = val - valModStep;
        return 2 * Math.abs(valModStep) >= step && (alignValue += valModStep > 0 ? step : -step), parseFloat(alignValue.toFixed(5))
    }, _valueMin: function () {
        return this.options.min
    }, _valueMax: function () {
        return this.options.max
    }, _refreshValue: function () {
        var lastValPercent, valPercent, value, valueMin, valueMax, oRange = this.options.range, o = this.options, that = this, animate = this._animateOff ? !1 : o.animate, _set = {};
        this.options.values && this.options.values.length ? this.handles.each(function (i) {
            valPercent = 100 * ((that.values(i) - that._valueMin()) / (that._valueMax() - that._valueMin())), _set["horizontal" === that.orientation ? "left" : "bottom"] = valPercent + "%", $(this).stop(1, 1)[animate ? "animate" : "css"](_set, o.animate), that.options.range === !0 && ("horizontal" === that.orientation ? (0 === i && that.range.stop(1, 1)[animate ? "animate" : "css"]({left: valPercent + "%"}, o.animate), 1 === i && that.range[animate ? "animate" : "css"]({width: valPercent - lastValPercent + "%"}, {queue: !1, duration: o.animate})) : (0 === i && that.range.stop(1, 1)[animate ? "animate" : "css"]({bottom: valPercent + "%"}, o.animate), 1 === i && that.range[animate ? "animate" : "css"]({height: valPercent - lastValPercent + "%"}, {queue: !1, duration: o.animate}))), lastValPercent = valPercent
        }) : (value = this.value(), valueMin = this._valueMin(), valueMax = this._valueMax(), valPercent = valueMax !== valueMin ? 100 * ((value - valueMin) / (valueMax - valueMin)) : 0, _set["horizontal" === this.orientation ? "left" : "bottom"] = valPercent + "%", this.handle.stop(1, 1)[animate ? "animate" : "css"](_set, o.animate), "min" === oRange && "horizontal" === this.orientation && this.range.stop(1, 1)[animate ? "animate" : "css"]({width: valPercent + "%"}, o.animate), "max" === oRange && "horizontal" === this.orientation && this.range[animate ? "animate" : "css"]({width: 100 - valPercent + "%"}, {queue: !1, duration: o.animate}), "min" === oRange && "vertical" === this.orientation && this.range.stop(1, 1)[animate ? "animate" : "css"]({height: valPercent + "%"}, o.animate), "max" === oRange && "vertical" === this.orientation && this.range[animate ? "animate" : "css"]({height: 100 - valPercent + "%"}, {queue: !1, duration: o.animate}))
    }, _handleEvents: {keydown: function (event) {
        var allowed, curVal, newVal, step, index = $(event.target).data("ui-slider-handle-index");
        switch (event.keyCode) {
            case $.ui.keyCode.HOME:
            case $.ui.keyCode.END:
            case $.ui.keyCode.PAGE_UP:
            case $.ui.keyCode.PAGE_DOWN:
            case $.ui.keyCode.UP:
            case $.ui.keyCode.RIGHT:
            case $.ui.keyCode.DOWN:
            case $.ui.keyCode.LEFT:
                if (event.preventDefault(), !this._keySliding && (this._keySliding = !0, $(event.target).addClass("ui-state-active"), allowed = this._start(event, index), allowed === !1))return
        }
        switch (step = this.options.step, curVal = newVal = this.options.values && this.options.values.length ? this.values(index) : this.value(), event.keyCode) {
            case $.ui.keyCode.HOME:
                newVal = this._valueMin();
                break;
            case $.ui.keyCode.END:
                newVal = this._valueMax();
                break;
            case $.ui.keyCode.PAGE_UP:
                newVal = this._trimAlignValue(curVal + (this._valueMax() - this._valueMin()) / numPages);
                break;
            case $.ui.keyCode.PAGE_DOWN:
                newVal = this._trimAlignValue(curVal - (this._valueMax() - this._valueMin()) / numPages);
                break;
            case $.ui.keyCode.UP:
            case $.ui.keyCode.RIGHT:
                if (curVal === this._valueMax())return;
                newVal = this._trimAlignValue(curVal + step);
                break;
            case $.ui.keyCode.DOWN:
            case $.ui.keyCode.LEFT:
                if (curVal === this._valueMin())return;
                newVal = this._trimAlignValue(curVal - step)
        }
        this._slide(event, index, newVal)
    }, click: function (event) {
        event.preventDefault()
    }, keyup: function (event) {
        var index = $(event.target).data("ui-slider-handle-index");
        this._keySliding && (this._keySliding = !1, this._stop(event, index), this._change(event, index), $(event.target).removeClass("ui-state-active"))
    }}})
}(jQuery), function ($) {
    "undefined" == typeof $.fn.each2 && $.fn.extend({each2: function (c) {
        for (var j = $([0]), i = -1, l = this.length; ++i < l && (j.context = j[0] = this[i]) && c.call(j[0], i, j) !== !1;);
        return this
    }})
}(jQuery), function ($, undefined) {
    "use strict";
    function indexOf(value, array) {
        for (var i = 0, l = array.length; l > i; i += 1)if (equal(value, array[i]))return i;
        return-1
    }

    function measureScrollbar() {
        var $template = $(MEASURE_SCROLLBAR_TEMPLATE);
        $template.appendTo("body");
        var dim = {width: $template.width() - $template[0].clientWidth, height: $template.height() - $template[0].clientHeight};
        return $template.remove(), dim
    }

    function equal(a, b) {
        return a === b ? !0 : a === undefined || b === undefined ? !1 : null === a || null === b ? !1 : a.constructor === String ? a + "" == b + "" : b.constructor === String ? b + "" == a + "" : !1
    }

    function splitVal(string, separator) {
        var val, i, l;
        if (null === string || string.length < 1)return[];
        for (val = string.split(separator), i = 0, l = val.length; l > i; i += 1)val[i] = $.trim(val[i]);
        return val
    }

    function getSideBorderPadding(element) {
        return element.outerWidth(!1) - element.width()
    }

    function installKeyUpChangeEvent(element) {
        var key = "keyup-change-value";
        element.on("keydown", function () {
            $.data(element, key) === undefined && $.data(element, key, element.val())
        }), element.on("keyup", function () {
            var val = $.data(element, key);
            val !== undefined && element.val() !== val && ($.removeData(element, key), element.trigger("keyup-change"))
        })
    }

    function installFilteredMouseMove(element) {
        element.on("mousemove", function (e) {
            var lastpos = lastMousePosition;
            (lastpos === undefined || lastpos.x !== e.pageX || lastpos.y !== e.pageY) && $(e.target).trigger("mousemove-filtered", e)
        })
    }

    function debounce(quietMillis, fn, ctx) {
        ctx = ctx || undefined;
        var timeout;
        return function () {
            var args = arguments;
            window.clearTimeout(timeout), timeout = window.setTimeout(function () {
                fn.apply(ctx, args)
            }, quietMillis)
        }
    }

    function thunk(formula) {
        var value, evaluated = !1;
        return function () {
            return evaluated === !1 && (value = formula(), evaluated = !0), value
        }
    }

    function installDebouncedScroll(threshold, element) {
        var notify = debounce(threshold, function (e) {
            element.trigger("scroll-debounced", e)
        });
        element.on("scroll", function (e) {
            indexOf(e.target, element.get()) >= 0 && notify(e)
        })
    }

    function focus($el) {
        $el[0] !== document.activeElement && window.setTimeout(function () {
            var range, el = $el[0], pos = $el.val().length;
            $el.focus(), $el.is(":visible") && el === document.activeElement && (el.setSelectionRange ? el.setSelectionRange(pos, pos) : el.createTextRange && (range = el.createTextRange(), range.collapse(!1), range.select()))
        }, 0)
    }

    function getCursorInfo(el) {
        el = $(el)[0];
        var offset = 0, length = 0;
        if ("selectionStart"in el)offset = el.selectionStart, length = el.selectionEnd - offset; else if ("selection"in document) {
            el.focus();
            var sel = document.selection.createRange();
            length = document.selection.createRange().text.length, sel.moveStart("character", -el.value.length), offset = sel.text.length - length
        }
        return{offset: offset, length: length}
    }

    function killEvent(event) {
        event.preventDefault(), event.stopPropagation()
    }

    function killEventImmediately(event) {
        event.preventDefault(), event.stopImmediatePropagation()
    }

    function measureTextWidth(e) {
        if (!sizer) {
            var style = e[0].currentStyle || window.getComputedStyle(e[0], null);
            sizer = $(document.createElement("div")).css({position: "absolute", left: "-10000px", top: "-10000px", display: "none", fontSize: style.fontSize, fontFamily: style.fontFamily, fontStyle: style.fontStyle, fontWeight: style.fontWeight, letterSpacing: style.letterSpacing, textTransform: style.textTransform, whiteSpace: "nowrap"}), sizer.attr("class", "select2-sizer"), $("body").append(sizer)
        }
        return sizer.text(e.val()), sizer.width()
    }

    function syncCssClasses(dest, src, adapter) {
        var classes, adapted, replacements = [];
        classes = dest.attr("class"), classes && (classes = "" + classes, $(classes.split(" ")).each2(function () {
            0 === this.indexOf("select2-") && replacements.push(this)
        })), classes = src.attr("class"), classes && (classes = "" + classes, $(classes.split(" ")).each2(function () {
            0 !== this.indexOf("select2-") && (adapted = adapter(this), adapted && replacements.push(this))
        })), dest.attr("class", replacements.join(" "))
    }

    function markMatch(text, term, markup, escapeMarkup) {
        var match = text.toUpperCase().indexOf(term.toUpperCase()), tl = term.length;
        return 0 > match ? (markup.push(escapeMarkup(text)), void 0) : (markup.push(escapeMarkup(text.substring(0, match))), markup.push("<span class='select2-match'>"), markup.push(escapeMarkup(text.substring(match, match + tl))), markup.push("</span>"), markup.push(escapeMarkup(text.substring(match + tl, text.length))), void 0)
    }

    function defaultEscapeMarkup(markup) {
        var replace_map = {"\\": "&#92;", "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;", "/": "&#47;"};
        return String(markup).replace(/[&<>"'\/\\]/g, function (match) {
            return replace_map[match]
        })
    }

    function ajax(options) {
        var timeout, requestSequence = 0, handler = null, quietMillis = options.quietMillis || 100, ajaxUrl = options.url, self = this;
        return function (query) {
            window.clearTimeout(timeout), timeout = window.setTimeout(function () {
                requestSequence += 1;
                var requestNumber = requestSequence, data = options.data, url = ajaxUrl, transport = options.transport || $.fn.select2.ajaxDefaults.transport, deprecated = {type: options.type || "GET", cache: options.cache || !1, jsonpCallback: options.jsonpCallback || undefined, dataType: options.dataType || "json"}, params = $.extend({}, $.fn.select2.ajaxDefaults.params, deprecated);
                data = data ? data.call(self, query.term, query.page, query.context) : null, url = "function" == typeof url ? url.call(self, query.term, query.page, query.context) : url, handler && handler.abort(), options.params && ($.isFunction(options.params) ? $.extend(params, options.params.call(self)) : $.extend(params, options.params)), $.extend(params, {url: url, dataType: options.dataType, data: data, success: function (data) {
                    if (!(requestSequence > requestNumber)) {
                        var results = options.results(data, query.page);
                        query.callback(results)
                    }
                }}), handler = transport.call(self, params)
            }, quietMillis)
        }
    }

    function local(options) {
        var dataText, tmp, data = options, text = function (item) {
            return"" + item.text
        };
        $.isArray(data) && (tmp = data, data = {results: tmp}), $.isFunction(data) === !1 && (tmp = data, data = function () {
            return tmp
        });
        var dataItem = data();
        return dataItem.text && (text = dataItem.text, $.isFunction(text) || (dataText = dataItem.text, text = function (item) {
            return item[dataText]
        })), function (query) {
            var process, t = query.term, filtered = {results: []};
            return"" === t ? (query.callback(data()), void 0) : (process = function (datum, collection) {
                var group, attr;
                if (datum = datum[0], datum.children) {
                    group = {};
                    for (attr in datum)datum.hasOwnProperty(attr) && (group[attr] = datum[attr]);
                    group.children = [], $(datum.children).each2(function (i, childDatum) {
                        process(childDatum, group.children)
                    }), (group.children.length || query.matcher(t, text(group), datum)) && collection.push(group)
                } else query.matcher(t, text(datum), datum) && collection.push(datum)
            }, $(data().results).each2(function (i, datum) {
                process(datum, filtered.results)
            }), query.callback(filtered), void 0)
        }
    }

    function tags(data) {
        var isFunc = $.isFunction(data);
        return function (query) {
            var t = query.term, filtered = {results: []};
            $(isFunc ? data() : data).each(function () {
                var isObject = this.text !== undefined, text = isObject ? this.text : this;
                ("" === t || query.matcher(t, text)) && filtered.results.push(isObject ? this : {id: this, text: this})
            }), query.callback(filtered)
        }
    }

    function checkFormatter(formatter, formatterName) {
        if ($.isFunction(formatter))return!0;
        if (!formatter)return!1;
        throw new Error(formatterName + " must be a function or a falsy value")
    }

    function evaluate(val) {
        return $.isFunction(val) ? val() : val
    }

    function countResults(results) {
        var count = 0;
        return $.each(results, function (i, item) {
            item.children ? count += countResults(item.children) : count++
        }), count
    }

    function defaultTokenizer(input, selection, selectCallback, opts) {
        var token, index, i, l, separator, original = input, dupe = !1;
        if (!opts.createSearchChoice || !opts.tokenSeparators || opts.tokenSeparators.length < 1)return undefined;
        for (; ;) {
            for (index = -1, i = 0, l = opts.tokenSeparators.length; l > i && (separator = opts.tokenSeparators[i], index = input.indexOf(separator), !(index >= 0)); i++);
            if (0 > index)break;
            if (token = input.substring(0, index), input = input.substring(index + separator.length), token.length > 0 && (token = opts.createSearchChoice.call(this, token, selection), token !== undefined && null !== token && opts.id(token) !== undefined && null !== opts.id(token))) {
                for (dupe = !1, i = 0, l = selection.length; l > i; i++)if (equal(opts.id(token), opts.id(selection[i]))) {
                    dupe = !0;
                    break
                }
                dupe || selectCallback(token)
            }
        }
        return original !== input ? input : void 0
    }

    function clazz(SuperClass, methods) {
        var constructor = function () {
        };
        return constructor.prototype = new SuperClass, constructor.prototype.constructor = constructor, constructor.prototype.parent = SuperClass.prototype, constructor.prototype = $.extend(constructor.prototype, methods), constructor
    }

    if (window.Select2 === undefined) {
        var KEY, AbstractSelect2, SingleSelect2, MultiSelect2, nextUid, sizer, $document, scrollBarDimensions, lastMousePosition = {x: 0, y: 0}, KEY = {TAB: 9, ENTER: 13, ESC: 27, SPACE: 32, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, SHIFT: 16, CTRL: 17, ALT: 18, PAGE_UP: 33, PAGE_DOWN: 34, HOME: 36, END: 35, BACKSPACE: 8, DELETE: 46, isArrow: function (k) {
            switch (k = k.which ? k.which : k) {
                case KEY.LEFT:
                case KEY.RIGHT:
                case KEY.UP:
                case KEY.DOWN:
                    return!0
            }
            return!1
        }, isControl: function (e) {
            var k = e.which;
            switch (k) {
                case KEY.SHIFT:
                case KEY.CTRL:
                case KEY.ALT:
                    return!0
            }
            return e.metaKey ? !0 : !1
        }, isFunctionKey: function (k) {
            return k = k.which ? k.which : k, k >= 112 && 123 >= k
        }}, MEASURE_SCROLLBAR_TEMPLATE = "<div class='select2-measure-scrollbar'></div>";
        $document = $(document), nextUid = function () {
            var counter = 1;
            return function () {
                return counter++
            }
        }(), $document.on("mousemove", function (e) {
            lastMousePosition.x = e.pageX, lastMousePosition.y = e.pageY
        }), AbstractSelect2 = clazz(Object, {bind: function (func) {
            var self = this;
            return function () {
                func.apply(self, arguments)
            }
        }, init: function (opts) {
            var results, search, disabled, readonly, resultsSelector = ".select2-results";
            this.opts = opts = this.prepareOpts(opts), this.id = opts.id, opts.element.data("select2") !== undefined && null !== opts.element.data("select2") && opts.element.data("select2").destroy(), this.container = this.createContainer(), this.containerId = "s2id_" + (opts.element.attr("id") || "autogen" + nextUid()), this.containerSelector = "#" + this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g, "\\$1"), this.container.attr("id", this.containerId), this.body = thunk(function () {
                return opts.element.closest("body")
            }), syncCssClasses(this.container, this.opts.element, this.opts.adaptContainerCssClass), this.container.css(evaluate(opts.containerCss)), this.container.addClass(evaluate(opts.containerCssClass)), this.elementTabIndex = this.opts.element.attr("tabindex"), this.opts.element.data("select2", this).attr("tabindex", "-1").before(this.container), this.container.data("select2", this), this.dropdown = this.container.find(".select2-drop"), this.dropdown.addClass(evaluate(opts.dropdownCssClass)), this.dropdown.data("select2", this), this.results = results = this.container.find(resultsSelector), this.search = search = this.container.find("input.select2-input"), this.resultsPage = 0, this.context = null, this.initContainer(), installFilteredMouseMove(this.results), this.dropdown.on("mousemove-filtered touchstart touchmove touchend", resultsSelector, this.bind(this.highlightUnderEvent)), installDebouncedScroll(80, this.results), this.dropdown.on("scroll-debounced", resultsSelector, this.bind(this.loadMoreIfNeeded)), $(this.container).on("change", ".select2-input", function (e) {
                e.stopPropagation()
            }), $(this.dropdown).on("change", ".select2-input", function (e) {
                e.stopPropagation()
            }), $.fn.mousewheel && results.mousewheel(function (e, delta, deltaX, deltaY) {
                var top = results.scrollTop();
                deltaY > 0 && 0 >= top - deltaY ? (results.scrollTop(0), killEvent(e)) : 0 > deltaY && results.get(0).scrollHeight - results.scrollTop() + deltaY <= results.height() && (results.scrollTop(results.get(0).scrollHeight - results.height()), killEvent(e))
            }), installKeyUpChangeEvent(search), search.on("keyup-change input paste", this.bind(this.updateResults)), search.on("focus", function () {
                search.addClass("select2-focused")
            }), search.on("blur", function () {
                search.removeClass("select2-focused")
            }), this.dropdown.on("mouseup", resultsSelector, this.bind(function (e) {
                $(e.target).closest(".select2-result-selectable").length > 0 && (this.highlightUnderEvent(e), this.selectHighlighted(e))
            })), this.dropdown.on("click mouseup mousedown", function (e) {
                e.stopPropagation()
            }), $.isFunction(this.opts.initSelection) && (this.initSelection(), this.monitorSource()), null !== opts.maximumInputLength && this.search.attr("maxlength", opts.maximumInputLength);
            var disabled = opts.element.prop("disabled");
            disabled === undefined && (disabled = !1), this.enable(!disabled);
            var readonly = opts.element.prop("readonly");
            readonly === undefined && (readonly = !1), this.readonly(readonly), scrollBarDimensions = scrollBarDimensions || measureScrollbar(), this.autofocus = opts.element.prop("autofocus"), opts.element.prop("autofocus", !1), this.autofocus && this.focus()
        }, destroy: function () {
            var element = this.opts.element, select2 = element.data("select2");
            this.propertyObserver && (delete this.propertyObserver, this.propertyObserver = null), select2 !== undefined && (select2.container.remove(), select2.dropdown.remove(), element.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus", this.autofocus || !1), this.elementTabIndex ? element.attr({tabindex: this.elementTabIndex}) : element.removeAttr("tabindex"), element.show())
        }, optionToData: function (element) {
            return element.is("option") ? {id: element.prop("value"), text: element.text(), element: element.get(), css: element.attr("class"), disabled: element.prop("disabled"), locked: equal(element.attr("locked"), "locked") || equal(element.data("locked"), !0)} : element.is("optgroup") ? {text: element.attr("label"), children: [], element: element.get(), css: element.attr("class")} : void 0
        }, prepareOpts: function (opts) {
            var element, select, idKey, ajaxUrl, self = this;
            if (element = opts.element, "select" === element.get(0).tagName.toLowerCase() && (this.select = select = opts.element), select && $.each(["id", "multiple", "ajax", "query", "createSearchChoice", "initSelection", "data", "tags"], function () {
                if (this in opts)throw new Error("Option '" + this + "' is not allowed for Select2 when attached to a <select> element.")
            }), opts = $.extend({}, {populateResults: function (container, results, query) {
                var populate, id = this.opts.id;
                populate = function (results, container, depth) {
                    var i, l, result, selectable, disabled, compound, node, label, innerContainer, formatted;
                    for (results = opts.sortResults(results, container, query), i = 0, l = results.length; l > i; i += 1)result = results[i], disabled = result.disabled === !0, selectable = !disabled && id(result) !== undefined, compound = result.children && result.children.length > 0, node = $("<li></li>"), node.addClass("select2-results-dept-" + depth), node.addClass("select2-result"), node.addClass(selectable ? "select2-result-selectable" : "select2-result-unselectable"), disabled && node.addClass("select2-disabled"), compound && node.addClass("select2-result-with-children"), node.addClass(self.opts.formatResultCssClass(result)), label = $(document.createElement("div")), label.addClass("select2-result-label"), formatted = opts.formatResult(result, label, query, self.opts.escapeMarkup), formatted !== undefined && label.html(formatted), node.append(label), compound && (innerContainer = $("<ul></ul>"), innerContainer.addClass("select2-result-sub"), populate(result.children, innerContainer, depth + 1), node.append(innerContainer)), node.data("select2-data", result), container.append(node)
                }, populate(results, container, 0)
            }}, $.fn.select2.defaults, opts), "function" != typeof opts.id && (idKey = opts.id, opts.id = function (e) {
                return e[idKey]
            }), $.isArray(opts.element.data("select2Tags"))) {
                if ("tags"in opts)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 " + opts.element.attr("id");
                opts.tags = opts.element.data("select2Tags")
            }
            if (select ? (opts.query = this.bind(function (query) {
                var children, placeholderOption, process, data = {results: [], more: !1}, term = query.term;
                process = function (element, collection) {
                    var group;
                    element.is("option") ? query.matcher(term, element.text(), element) && collection.push(self.optionToData(element)) : element.is("optgroup") && (group = self.optionToData(element), element.children().each2(function (i, elm) {
                        process(elm, group.children)
                    }), group.children.length > 0 && collection.push(group))
                }, children = element.children(), this.getPlaceholder() !== undefined && children.length > 0 && (placeholderOption = this.getPlaceholderOption(), placeholderOption && (children = children.not(placeholderOption))), children.each2(function (i, elm) {
                    process(elm, data.results)
                }), query.callback(data)
            }), opts.id = function (e) {
                return e.id
            }, opts.formatResultCssClass = function (data) {
                return data.css
            }) : "query"in opts || ("ajax"in opts ? (ajaxUrl = opts.element.data("ajax-url"), ajaxUrl && ajaxUrl.length > 0 && (opts.ajax.url = ajaxUrl), opts.query = ajax.call(opts.element, opts.ajax)) : "data"in opts ? opts.query = local(opts.data) : "tags"in opts && (opts.query = tags(opts.tags), opts.createSearchChoice === undefined && (opts.createSearchChoice = function (term) {
                return{id: term, text: term}
            }), opts.initSelection === undefined && (opts.initSelection = function (element, callback) {
                var data = [];
                $(splitVal(element.val(), opts.separator)).each(function () {
                    var id = this, text = this, tags = opts.tags;
                    $.isFunction(tags) && (tags = tags()), $(tags).each(function () {
                        return equal(this.id, id) ? (text = this.text, !1) : void 0
                    }), data.push({id: id, text: text})
                }), callback(data)
            }))), "function" != typeof opts.query)throw"query function not defined for Select2 " + opts.element.attr("id");
            return opts
        }, monitorSource: function () {
            var sync, el = this.opts.element;
            el.on("change.select2", this.bind(function () {
                this.opts.element.data("select2-change-triggered") !== !0 && this.initSelection()
            })), sync = this.bind(function () {
                var readonly, disabled = el.prop("disabled");
                disabled === undefined && (disabled = !1), this.enable(!disabled);
                var readonly = el.prop("readonly");
                readonly === undefined && (readonly = !1), this.readonly(readonly), syncCssClasses(this.container, this.opts.element, this.opts.adaptContainerCssClass), this.container.addClass(evaluate(this.opts.containerCssClass)), syncCssClasses(this.dropdown, this.opts.element, this.opts.adaptDropdownCssClass), this.dropdown.addClass(evaluate(this.opts.dropdownCssClass))
            }), el.on("propertychange.select2 DOMAttrModified.select2", sync), this.mutationCallback === undefined && (this.mutationCallback = function (mutations) {
                mutations.forEach(sync)
            }), "undefined" != typeof WebKitMutationObserver && (this.propertyObserver && (delete this.propertyObserver, this.propertyObserver = null), this.propertyObserver = new WebKitMutationObserver(this.mutationCallback), this.propertyObserver.observe(el.get(0), {attributes: !0, subtree: !1}))
        }, triggerSelect: function (data) {
            var evt = $.Event("select2-selecting", {val: this.id(data), object: data});
            return this.opts.element.trigger(evt), !evt.isDefaultPrevented()
        }, triggerChange: function (details) {
            details = details || {}, details = $.extend({}, details, {type: "change", val: this.val()}), this.opts.element.data("select2-change-triggered", !0), this.opts.element.trigger(details), this.opts.element.data("select2-change-triggered", !1), this.opts.element.click(), this.opts.blurOnChange && this.opts.element.blur()
        }, isInterfaceEnabled: function () {
            return this.enabledInterface === !0
        }, enableInterface: function () {
            var enabled = this._enabled && !this._readonly, disabled = !enabled;
            return enabled === this.enabledInterface ? !1 : (this.container.toggleClass("select2-container-disabled", disabled), this.close(), this.enabledInterface = enabled, !0)
        }, enable: function (enabled) {
            return enabled === undefined && (enabled = !0), this._enabled === enabled ? !1 : (this._enabled = enabled, this.opts.element.prop("disabled", !enabled), this.enableInterface(), !0)
        }, readonly: function (enabled) {
            return enabled === undefined && (enabled = !1), this._readonly === enabled ? !1 : (this._readonly = enabled, this.opts.element.prop("readonly", enabled), this.enableInterface(), !0)
        }, opened: function () {
            return this.container.hasClass("select2-dropdown-open")
        }, positionDropdown: function () {
            var bodyOffset, above, css, resultsListNode, $dropdown = this.dropdown, offset = this.container.offset(), height = this.container.outerHeight(!1), width = this.container.outerWidth(!1), dropHeight = $dropdown.outerHeight(!1), viewPortRight = $(window).scrollLeft() + $(window).width(), viewportBottom = $(window).scrollTop() + $(window).height(), dropTop = offset.top + height, dropLeft = offset.left, enoughRoomBelow = viewportBottom >= dropTop + dropHeight, enoughRoomAbove = offset.top - dropHeight >= this.body().scrollTop(), dropWidth = $dropdown.outerWidth(!1), enoughRoomOnRight = viewPortRight >= dropLeft + dropWidth, aboveNow = $dropdown.hasClass("select2-drop-above");
            this.opts.dropdownAutoWidth ? (resultsListNode = $(".select2-results", $dropdown)[0], $dropdown.addClass("select2-drop-auto-width"), $dropdown.css("width", ""), dropWidth = $dropdown.outerWidth(!1) + (resultsListNode.scrollHeight === resultsListNode.clientHeight ? 0 : scrollBarDimensions.width), dropWidth > width ? width = dropWidth : dropWidth = width, enoughRoomOnRight = viewPortRight >= dropLeft + dropWidth) : this.container.removeClass("select2-drop-auto-width"), "static" !== this.body().css("position") && (bodyOffset = this.body().offset(), dropTop -= bodyOffset.top, dropLeft -= bodyOffset.left), aboveNow ? (above = !0, !enoughRoomAbove && enoughRoomBelow && (above = !1)) : (above = !1, !enoughRoomBelow && enoughRoomAbove && (above = !0)), enoughRoomOnRight || (dropLeft = offset.left + width - dropWidth), above ? (dropTop = offset.top - dropHeight, this.container.addClass("select2-drop-above"), $dropdown.addClass("select2-drop-above")) : (this.container.removeClass("select2-drop-above"), $dropdown.removeClass("select2-drop-above")), css = $.extend({top: dropTop, left: dropLeft, width: width}, evaluate(this.opts.dropdownCss)), $dropdown.css(css)
        }, shouldOpen: function () {
            var event;
            return this.opened() ? !1 : this._enabled === !1 || this._readonly === !0 ? !1 : (event = $.Event("select2-opening"), this.opts.element.trigger(event), !event.isDefaultPrevented())
        }, clearDropdownAlignmentPreference: function () {
            this.container.removeClass("select2-drop-above"), this.dropdown.removeClass("select2-drop-above")
        }, open: function () {
            return this.shouldOpen() ? (this.opening(), !0) : !1
        }, opening: function () {
            function _makeMaskCss() {
                return{width: Math.max(document.documentElement.scrollWidth, $(window).width()), height: Math.max(document.documentElement.scrollHeight, $(window).height())}
            }

            var mask, maskCss, cid = this.containerId, scroll = "scroll." + cid, resize = "resize." + cid, orient = "orientationchange." + cid;
            this.container.addClass("select2-dropdown-open").addClass("select2-container-active"), this.clearDropdownAlignmentPreference(), this.dropdown[0] !== this.body().children().last()[0] && this.dropdown.detach().appendTo(this.body()), mask = $("#select2-drop-mask"), 0 == mask.length && (mask = $(document.createElement("div")), mask.attr("id", "select2-drop-mask").attr("class", "select2-drop-mask"), mask.hide(), mask.appendTo(this.body()), mask.on("mousedown touchstart click", function (e) {
                var self, dropdown = $("#select2-drop");
                dropdown.length > 0 && (self = dropdown.data("select2"), self.opts.selectOnBlur && self.selectHighlighted({noFocus: !0}), self.close(), e.preventDefault(), e.stopPropagation())
            })), this.dropdown.prev()[0] !== mask[0] && this.dropdown.before(mask), $("#select2-drop").removeAttr("id"), this.dropdown.attr("id", "select2-drop"), maskCss = _makeMaskCss(), mask.css(maskCss).show(), this.dropdown.show(), this.positionDropdown(), this.dropdown.addClass("select2-drop-active");
            var that = this;
            this.container.parents().add(window).each(function () {
                $(this).on(resize + " " + scroll + " " + orient, function () {
                    var maskCss = _makeMaskCss();
                    $("#select2-drop-mask").css(maskCss), that.positionDropdown()
                })
            })
        }, close: function () {
            if (this.opened()) {
                var cid = this.containerId, scroll = "scroll." + cid, resize = "resize." + cid, orient = "orientationchange." + cid;
                this.container.parents().add(window).each(function () {
                    $(this).off(scroll).off(resize).off(orient)
                }), this.clearDropdownAlignmentPreference(), $("#select2-drop-mask").hide(), this.dropdown.removeAttr("id"), this.dropdown.hide(), this.container.removeClass("select2-dropdown-open"), this.results.empty(), this.clearSearch(), this.search.removeClass("select2-active"), this.opts.element.trigger($.Event("select2-close"))
            }
        }, externalSearch: function (term) {
            this.open(), this.search.val(term), this.updateResults(!1)
        }, clearSearch: function () {
        }, getMaximumSelectionSize: function () {
            return evaluate(this.opts.maximumSelectionSize)
        }, ensureHighlightVisible: function () {
            var children, index, child, hb, rb, y, more, results = this.results;
            if (index = this.highlight(), !(0 > index)) {
                if (0 == index)return results.scrollTop(0), void 0;
                children = this.findHighlightableChoices().find(".select2-result-label"), child = $(children[index]), hb = child.offset().top + child.outerHeight(!0), index === children.length - 1 && (more = results.find("li.select2-more-results"), more.length > 0 && (hb = more.offset().top + more.outerHeight(!0))), rb = results.offset().top + results.outerHeight(!0), hb > rb && results.scrollTop(results.scrollTop() + (hb - rb)), y = child.offset().top - results.offset().top, 0 > y && "none" != child.css("display") && results.scrollTop(results.scrollTop() + y)
            }
        }, findHighlightableChoices: function () {
            return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")
        }, moveHighlight: function (delta) {
            for (var choices = this.findHighlightableChoices(), index = this.highlight(); index > -1 && index < choices.length;) {
                index += delta;
                var choice = $(choices[index]);
                if (choice.hasClass("select2-result-selectable") && !choice.hasClass("select2-disabled") && !choice.hasClass("select2-selected")) {
                    this.highlight(index);
                    break
                }
            }
        }, highlight: function (index) {
            var choice, data, choices = this.findHighlightableChoices();
            return 0 === arguments.length ? indexOf(choices.filter(".select2-highlighted")[0], choices.get()) : (index >= choices.length && (index = choices.length - 1), 0 > index && (index = 0), this.results.find(".select2-highlighted").removeClass("select2-highlighted"), choice = $(choices[index]), choice.addClass("select2-highlighted"), this.ensureHighlightVisible(), data = choice.data("select2-data"), data && this.opts.element.trigger({type: "select2-highlight", val: this.id(data), choice: data}), void 0)
        }, countSelectableResults: function () {
            return this.findHighlightableChoices().length
        }, highlightUnderEvent: function (event) {
            var el = $(event.target).closest(".select2-result-selectable");
            if (el.length > 0 && !el.is(".select2-highlighted")) {
                var choices = this.findHighlightableChoices();
                this.highlight(choices.index(el))
            } else 0 == el.length && this.results.find(".select2-highlighted").removeClass("select2-highlighted")
        }, loadMoreIfNeeded: function () {
            var below, results = this.results, more = results.find("li.select2-more-results"), page = this.resultsPage + 1, self = this, term = this.search.val(), context = this.context;
            0 !== more.length && (below = more.offset().top - results.offset().top - results.height(), below <= this.opts.loadMorePadding && (more.addClass("select2-active"), this.opts.query({element: this.opts.element, term: term, page: page, context: context, matcher: this.opts.matcher, callback: this.bind(function (data) {
                self.opened() && (self.opts.populateResults.call(this, results, data.results, {term: term, page: page, context: context}), self.postprocessResults(data, !1, !1), data.more === !0 ? (more.detach().appendTo(results).text(self.opts.formatLoadMore(page + 1)), window.setTimeout(function () {
                    self.loadMoreIfNeeded()
                }, 10)) : more.remove(), self.positionDropdown(), self.resultsPage = page, self.context = data.context)
            })})))
        }, tokenize: function () {
        }, updateResults: function (initial) {
            function postRender() {
                search.removeClass("select2-active"), self.positionDropdown()
            }

            function render(html) {
                results.html(html), postRender()
            }

            var data, input, search = this.search, results = this.results, opts = this.opts, self = this, term = search.val(), lastTerm = $.data(this.container, "select2-last-term");
            if ((initial === !0 || !lastTerm || !equal(term, lastTerm)) && ($.data(this.container, "select2-last-term", term), initial === !0 || this.showSearchInput !== !1 && this.opened())) {
                var maxSelSize = this.getMaximumSelectionSize();
                if (maxSelSize >= 1 && (data = this.data(), $.isArray(data) && data.length >= maxSelSize && checkFormatter(opts.formatSelectionTooBig, "formatSelectionTooBig")))return render("<li class='select2-selection-limit'>" + opts.formatSelectionTooBig(maxSelSize) + "</li>"), void 0;
                if (search.val().length < opts.minimumInputLength)return checkFormatter(opts.formatInputTooShort, "formatInputTooShort") ? render("<li class='select2-no-results'>" + opts.formatInputTooShort(search.val(), opts.minimumInputLength) + "</li>") : render(""), initial && this.showSearch && this.showSearch(!0), void 0;
                if (opts.maximumInputLength && search.val().length > opts.maximumInputLength)return checkFormatter(opts.formatInputTooLong, "formatInputTooLong") ? render("<li class='select2-no-results'>" + opts.formatInputTooLong(search.val(), opts.maximumInputLength) + "</li>") : render(""), void 0;
                opts.formatSearching && 0 === this.findHighlightableChoices().length && render("<li class='select2-searching'>" + opts.formatSearching() + "</li>"), search.addClass("select2-active"), input = this.tokenize(), input != undefined && null != input && search.val(input), this.resultsPage = 1, opts.query({element: opts.element, term: search.val(), page: this.resultsPage, context: null, matcher: opts.matcher, callback: this.bind(function (data) {
                    var def;
                    return this.opened() ? (this.context = data.context === undefined ? null : data.context, this.opts.createSearchChoice && "" !== search.val() && (def = this.opts.createSearchChoice.call(self, search.val(), data.results), def !== undefined && null !== def && self.id(def) !== undefined && null !== self.id(def) && 0 === $(data.results).filter(function () {
                        return equal(self.id(this), self.id(def))
                    }).length && data.results.unshift(def)), 0 === data.results.length && checkFormatter(opts.formatNoMatches, "formatNoMatches") ? (render("<li class='select2-no-results'>" + opts.formatNoMatches(search.val()) + "</li>"), void 0) : (results.empty(), self.opts.populateResults.call(this, results, data.results, {term: search.val(), page: this.resultsPage, context: null}), data.more === !0 && checkFormatter(opts.formatLoadMore, "formatLoadMore") && (results.append("<li class='select2-more-results'>" + self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage)) + "</li>"), window.setTimeout(function () {
                        self.loadMoreIfNeeded()
                    }, 10)), this.postprocessResults(data, initial), postRender(), this.opts.element.trigger({type: "select2-loaded", items: data}), void 0)) : (this.search.removeClass("select2-active"), void 0)
                })})
            }
        }, cancel: function () {
            this.close()
        }, blur: function () {
            this.opts.selectOnBlur && this.selectHighlighted({noFocus: !0}), this.close(), this.container.removeClass("select2-container-active"), this.search[0] === document.activeElement && this.search.blur(), this.clearSearch(), this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")
        }, focusSearch: function () {
            focus(this.search)
        }, selectHighlighted: function (options) {
            var index = this.highlight(), highlighted = this.results.find(".select2-highlighted"), data = highlighted.closest(".select2-result").data("select2-data");
            data ? (this.highlight(index), this.onSelect(data, options)) : options && options.noFocus && this.close()
        }, getPlaceholder: function () {
            var placeholderOption;
            return this.opts.element.attr("placeholder") || this.opts.element.attr("data-placeholder") || this.opts.element.data("placeholder") || this.opts.placeholder || ((placeholderOption = this.getPlaceholderOption()) !== undefined ? placeholderOption.text() : undefined)
        }, getPlaceholderOption: function () {
            if (this.select) {
                var firstOption = this.select.children().first();
                if (this.opts.placeholderOption !== undefined)return"first" === this.opts.placeholderOption && firstOption || "function" == typeof this.opts.placeholderOption && this.opts.placeholderOption(this.select);
                if ("" === firstOption.text() && "" === firstOption.val())return firstOption
            }
        }, initContainerWidth: function () {
            function resolveContainerWidth() {
                var style, attrs, matches, i, l;
                if ("off" === this.opts.width)return null;
                if ("element" === this.opts.width)return 0 === this.opts.element.outerWidth(!1) ? "auto" : this.opts.element.outerWidth(!1) + "px";
                if ("copy" === this.opts.width || "resolve" === this.opts.width) {
                    if (style = this.opts.element.attr("style"), style !== undefined)for (attrs = style.split(";"), i = 0, l = attrs.length; l > i; i += 1)if (matches = attrs[i].replace(/\s/g, "").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i), null !== matches && matches.length >= 1)return matches[1];
                    return"resolve" === this.opts.width ? (style = this.opts.element.css("width"), style.indexOf("%") > 0 ? style : 0 === this.opts.element.outerWidth(!1) ? "auto" : this.opts.element.outerWidth(!1) + "px") : null
                }
                return $.isFunction(this.opts.width) ? this.opts.width() : this.opts.width
            }

            var width = resolveContainerWidth.call(this);
            null !== width && this.container.css("width", width)
        }}), SingleSelect2 = clazz(AbstractSelect2, {createContainer: function () {
            var container = $(document.createElement("div")).attr({"class": "select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>", "   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>", "   <span class='select2-arrow'><b></b></span>", "</a>", "<input class='select2-focusser select2-offscreen' type='text'/>", "<div class='select2-drop select2-display-none'>", "   <div class='select2-search'>", "       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>", "   </div>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join(""));
            return container
        }, enableInterface: function () {
            this.parent.enableInterface.apply(this, arguments) && this.focusser.prop("disabled", !this.isInterfaceEnabled())
        }, opening: function () {
            var el, range, len;
            this.opts.minimumResultsForSearch >= 0 && this.showSearch(!0), this.parent.opening.apply(this, arguments), this.showSearchInput !== !1 && this.search.val(this.focusser.val()), this.search.focus(), el = this.search.get(0), el.createTextRange ? (range = el.createTextRange(), range.collapse(!1), range.select()) : el.setSelectionRange && (len = this.search.val().length, el.setSelectionRange(len, len)), this.focusser.prop("disabled", !0).val(""), this.updateResults(!0), this.opts.element.trigger($.Event("select2-open"))
        }, close: function () {
            this.opened() && (this.parent.close.apply(this, arguments), this.focusser.removeAttr("disabled"), this.focusser.focus())
        }, focus: function () {
            this.opened() ? this.close() : (this.focusser.removeAttr("disabled"), this.focusser.focus())
        }, isFocused: function () {
            return this.container.hasClass("select2-container-active")
        }, cancel: function () {
            this.parent.cancel.apply(this, arguments), this.focusser.removeAttr("disabled"), this.focusser.focus()
        }, initContainer: function () {
            var selection, container = this.container, dropdown = this.dropdown;
            this.opts.minimumResultsForSearch < 0 ? this.showSearch(!1) : this.showSearch(!0), this.selection = selection = container.find(".select2-choice"), this.focusser = container.find(".select2-focusser"), this.focusser.attr("id", "s2id_autogen" + nextUid()), $("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.focusser.attr("id")), this.focusser.attr("tabindex", this.elementTabIndex), this.search.on("keydown", this.bind(function (e) {
                if (this.isInterfaceEnabled()) {
                    if (e.which === KEY.PAGE_UP || e.which === KEY.PAGE_DOWN)return killEvent(e), void 0;
                    switch (e.which) {
                        case KEY.UP:
                        case KEY.DOWN:
                            return this.moveHighlight(e.which === KEY.UP ? -1 : 1), killEvent(e), void 0;
                        case KEY.ENTER:
                            return this.selectHighlighted(), killEvent(e), void 0;
                        case KEY.TAB:
                            return this.selectHighlighted({noFocus: !0}), void 0;
                        case KEY.ESC:
                            return this.cancel(e), killEvent(e), void 0
                    }
                }
            })), this.search.on("blur", this.bind(function () {
                document.activeElement === this.body().get(0) && window.setTimeout(this.bind(function () {
                    this.search.focus()
                }), 0)
            })), this.focusser.on("keydown", this.bind(function (e) {
                if (this.isInterfaceEnabled() && e.which !== KEY.TAB && !KEY.isControl(e) && !KEY.isFunctionKey(e) && e.which !== KEY.ESC) {
                    if (this.opts.openOnEnter === !1 && e.which === KEY.ENTER)return killEvent(e), void 0;
                    if (e.which == KEY.DOWN || e.which == KEY.UP || e.which == KEY.ENTER && this.opts.openOnEnter) {
                        if (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey)return;
                        return this.open(), killEvent(e), void 0
                    }
                    return e.which == KEY.DELETE || e.which == KEY.BACKSPACE ? (this.opts.allowClear && this.clear(), killEvent(e), void 0) : void 0
                }
            })), installKeyUpChangeEvent(this.focusser), this.focusser.on("keyup-change input", this.bind(function (e) {
                if (this.opts.minimumResultsForSearch >= 0) {
                    if (e.stopPropagation(), this.opened())return;
                    this.open()
                }
            })), selection.on("mousedown", "abbr", this.bind(function (e) {
                this.isInterfaceEnabled() && (this.clear(), killEventImmediately(e), this.close(), this.selection.focus())
            })), selection.on("mousedown", this.bind(function (e) {
                this.container.hasClass("select2-container-active") || this.opts.element.trigger($.Event("select2-focus")), this.opened() ? this.close() : this.isInterfaceEnabled() && this.open(), killEvent(e)
            })), dropdown.on("mousedown", this.bind(function () {
                this.search.focus()
            })), selection.on("focus", this.bind(function (e) {
                killEvent(e)
            })), this.focusser.on("focus", this.bind(function () {
                this.container.hasClass("select2-container-active") || this.opts.element.trigger($.Event("select2-focus")), this.container.addClass("select2-container-active")
            })).on("blur", this.bind(function () {
                this.opened() || (this.container.removeClass("select2-container-active"), this.opts.element.trigger($.Event("select2-blur")))
            })), this.search.on("focus", this.bind(function () {
                this.container.hasClass("select2-container-active") || this.opts.element.trigger($.Event("select2-focus")), this.container.addClass("select2-container-active")
            })), this.initContainerWidth(), this.opts.element.addClass("select2-offscreen"), this.setPlaceholder()
        }, clear: function (triggerChange) {
            var data = this.selection.data("select2-data");
            if (data) {
                var placeholderOption = this.getPlaceholderOption();
                this.opts.element.val(placeholderOption ? placeholderOption.val() : ""), this.selection.find(".select2-chosen").empty(), this.selection.removeData("select2-data"), this.setPlaceholder(), triggerChange !== !1 && (this.opts.element.trigger({type: "select2-removed", val: this.id(data), choice: data}), this.triggerChange({removed: data}))
            }
        }, initSelection: function () {
            if (this.isPlaceholderOptionSelected())this.updateSelection([]), this.close(), this.setPlaceholder(); else {
                var self = this;
                this.opts.initSelection.call(null, this.opts.element, function (selected) {
                    selected !== undefined && null !== selected && (self.updateSelection(selected), self.close(), self.setPlaceholder())
                })
            }
        }, isPlaceholderOptionSelected: function () {
            var placeholderOption;
            return(placeholderOption = this.getPlaceholderOption()) !== undefined && placeholderOption.is(":selected") || "" === this.opts.element.val() || this.opts.element.val() === undefined || null === this.opts.element.val()
        }, prepareOpts: function () {
            var opts = this.parent.prepareOpts.apply(this, arguments), self = this;
            return"select" === opts.element.get(0).tagName.toLowerCase() ? opts.initSelection = function (element, callback) {
                var selected = element.find(":selected");
                callback(self.optionToData(selected))
            } : "data"in opts && (opts.initSelection = opts.initSelection || function (element, callback) {
                var id = element.val(), match = null;
                opts.query({matcher: function (term, text, el) {
                    var is_match = equal(id, opts.id(el));
                    return is_match && (match = el), is_match
                }, callback: $.isFunction(callback) ? function () {
                    callback(match)
                } : $.noop})
            }), opts
        }, getPlaceholder: function () {
            return this.select && this.getPlaceholderOption() === undefined ? undefined : this.parent.getPlaceholder.apply(this, arguments)
        }, setPlaceholder: function () {
            var placeholder = this.getPlaceholder();
            if (this.isPlaceholderOptionSelected() && placeholder !== undefined) {
                if (this.select && this.getPlaceholderOption() === undefined)return;
                this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(placeholder)), this.selection.addClass("select2-default"), this.container.removeClass("select2-allowclear")
            }
        }, postprocessResults: function (data, initial, noHighlightUpdate) {
            var selected = 0, self = this;
            if (this.findHighlightableChoices().each2(function (i, elm) {
                return equal(self.id(elm.data("select2-data")), self.opts.element.val()) ? (selected = i, !1) : void 0
            }), noHighlightUpdate !== !1 && (initial === !0 && selected >= 0 ? this.highlight(selected) : this.highlight(0)), initial === !0) {
                var min = this.opts.minimumResultsForSearch;
                min >= 0 && this.showSearch(countResults(data.results) >= min)
            }
        }, showSearch: function (showSearchInput) {
            this.showSearchInput !== showSearchInput && (this.showSearchInput = showSearchInput, this.dropdown.find(".select2-search").toggleClass("select2-search-hidden", !showSearchInput), this.dropdown.find(".select2-search").toggleClass("select2-offscreen", !showSearchInput), $(this.dropdown, this.container).toggleClass("select2-with-searchbox", showSearchInput))
        }, onSelect: function (data, options) {
            if (this.triggerSelect(data)) {
                var old = this.opts.element.val(), oldData = this.data();
                this.opts.element.val(this.id(data)), this.updateSelection(data), this.opts.element.trigger({type: "select2-selected", val: this.id(data), choice: data}), this.close(), options && options.noFocus || this.selection.focus(), equal(old, this.id(data)) || this.triggerChange({added: data, removed: oldData})
            }
        }, updateSelection: function (data) {
            var formatted, cssClass, container = this.selection.find(".select2-chosen");
            this.selection.data("select2-data", data), container.empty(), formatted = this.opts.formatSelection(data, container, this.opts.escapeMarkup), formatted !== undefined && container.append(formatted), cssClass = this.opts.formatSelectionCssClass(data, container), cssClass !== undefined && container.addClass(cssClass), this.selection.removeClass("select2-default"), this.opts.allowClear && this.getPlaceholder() !== undefined && this.container.addClass("select2-allowclear")
        }, val: function () {
            var val, triggerChange = !1, data = null, self = this, oldData = this.data();
            if (0 === arguments.length)return this.opts.element.val();
            if (val = arguments[0], arguments.length > 1 && (triggerChange = arguments[1]), this.select)this.select.val(val).find(":selected").each2(function (i, elm) {
                return data = self.optionToData(elm), !1
            }), this.updateSelection(data), this.setPlaceholder(), triggerChange && this.triggerChange({added: data, removed: oldData}); else {
                if (!val && 0 !== val)return this.clear(triggerChange), void 0;
                if (this.opts.initSelection === undefined)throw new Error("cannot call val() if initSelection() is not defined");
                this.opts.element.val(val), this.opts.initSelection(this.opts.element, function (data) {
                    self.opts.element.val(data ? self.id(data) : ""), self.updateSelection(data), self.setPlaceholder(), triggerChange && self.triggerChange({added: data, removed: oldData})
                })
            }
        }, clearSearch: function () {
            this.search.val(""), this.focusser.val("")
        }, data: function (value, triggerChange) {
            var data;
            return 0 === arguments.length ? (data = this.selection.data("select2-data"), data == undefined && (data = null), data) : (value && "" !== value ? (data = this.data(), this.opts.element.val(value ? this.id(value) : ""), this.updateSelection(value), triggerChange && this.triggerChange({added: value, removed: data})) : this.clear(triggerChange), void 0)
        }}), MultiSelect2 = clazz(AbstractSelect2, {createContainer: function () {
            var container = $(document.createElement("div")).attr({"class": "select2-container select2-container-multi"}).html(["<ul class='select2-choices'>", "  <li class='select2-search-field'>", "    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>", "  </li>", "</ul>", "<div class='select2-drop select2-drop-multi select2-display-none'>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join(""));
            return container
        }, prepareOpts: function () {
            var opts = this.parent.prepareOpts.apply(this, arguments), self = this;
            return"select" === opts.element.get(0).tagName.toLowerCase() ? opts.initSelection = function (element, callback) {
                var data = [];
                element.find(":selected").each2(function (i, elm) {
                    data.push(self.optionToData(elm))
                }), callback(data)
            } : "data"in opts && (opts.initSelection = opts.initSelection || function (element, callback) {
                var ids = splitVal(element.val(), opts.separator), matches = [];
                opts.query({matcher: function (term, text, el) {
                    var is_match = $.grep(ids,function (id) {
                        return equal(id, opts.id(el))
                    }).length;
                    return is_match && matches.push(el), is_match
                }, callback: $.isFunction(callback) ? function () {
                    for (var ordered = [], i = 0; i < ids.length; i++)for (var id = ids[i], j = 0; j < matches.length; j++) {
                        var match = matches[j];
                        if (equal(id, opts.id(match))) {
                            ordered.push(match), matches.splice(j, 1);
                            break
                        }
                    }
                    callback(ordered)
                } : $.noop})
            }), opts
        }, selectChoice: function (choice) {
            var selected = this.container.find(".select2-search-choice-focus");
            selected.length && choice && choice[0] == selected[0] || (selected.length && this.opts.element.trigger("choice-deselected", selected), selected.removeClass("select2-search-choice-focus"), choice && choice.length && (this.close(), choice.addClass("select2-search-choice-focus"), this.opts.element.trigger("choice-selected", choice)))
        }, initContainer: function () {
            var selection, selector = ".select2-choices";
            this.searchContainer = this.container.find(".select2-search-field"), this.selection = selection = this.container.find(selector);
            var _this = this;
            this.selection.on("mousedown", ".select2-search-choice", function () {
                _this.search[0].focus(), _this.selectChoice($(this))
            }), this.search.attr("id", "s2id_autogen" + nextUid()), $("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.search.attr("id")), this.search.on("input paste", this.bind(function () {
                this.isInterfaceEnabled() && (this.opened() || this.open())
            })), this.search.attr("tabindex", this.elementTabIndex), this.keydowns = 0, this.search.on("keydown", this.bind(function (e) {
                if (this.isInterfaceEnabled()) {
                    ++this.keydowns;
                    var selected = selection.find(".select2-search-choice-focus"), prev = selected.prev(".select2-search-choice:not(.select2-locked)"), next = selected.next(".select2-search-choice:not(.select2-locked)"), pos = getCursorInfo(this.search);
                    if (selected.length && (e.which == KEY.LEFT || e.which == KEY.RIGHT || e.which == KEY.BACKSPACE || e.which == KEY.DELETE || e.which == KEY.ENTER)) {
                        var selectedChoice = selected;
                        return e.which == KEY.LEFT && prev.length ? selectedChoice = prev : e.which == KEY.RIGHT ? selectedChoice = next.length ? next : null : e.which === KEY.BACKSPACE ? (this.unselect(selected.first()), this.search.width(10), selectedChoice = prev.length ? prev : next) : e.which == KEY.DELETE ? (this.unselect(selected.first()), this.search.width(10), selectedChoice = next.length ? next : null) : e.which == KEY.ENTER && (selectedChoice = null), this.selectChoice(selectedChoice), killEvent(e), selectedChoice && selectedChoice.length || this.open(), void 0
                    }
                    if ((e.which === KEY.BACKSPACE && 1 == this.keydowns || e.which == KEY.LEFT) && 0 == pos.offset && !pos.length)return this.selectChoice(selection.find(".select2-search-choice:not(.select2-locked)").last()), killEvent(e), void 0;
                    if (this.selectChoice(null), this.opened())switch (e.which) {
                        case KEY.UP:
                        case KEY.DOWN:
                            return this.moveHighlight(e.which === KEY.UP ? -1 : 1), killEvent(e), void 0;
                        case KEY.ENTER:
                            return this.selectHighlighted(), killEvent(e), void 0;
                        case KEY.TAB:
                            return this.selectHighlighted({noFocus: !0}), this.close(), void 0;
                        case KEY.ESC:
                            return this.cancel(e), killEvent(e), void 0
                    }
                    if (e.which !== KEY.TAB && !KEY.isControl(e) && !KEY.isFunctionKey(e) && e.which !== KEY.BACKSPACE && e.which !== KEY.ESC) {
                        if (e.which === KEY.ENTER) {
                            if (this.opts.openOnEnter === !1)return;
                            if (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey)return
                        }
                        this.open(), (e.which === KEY.PAGE_UP || e.which === KEY.PAGE_DOWN) && killEvent(e), e.which === KEY.ENTER && killEvent(e)
                    }
                }
            })), this.search.on("keyup", this.bind(function () {
                this.keydowns = 0, this.resizeSearch()
            })), this.search.on("blur", this.bind(function (e) {
                this.container.removeClass("select2-container-active"), this.search.removeClass("select2-focused"), this.selectChoice(null), this.opened() || this.clearSearch(), e.stopImmediatePropagation(), this.opts.element.trigger($.Event("select2-blur"))
            })), this.container.on("click", selector, this.bind(function (e) {
                this.isInterfaceEnabled() && ($(e.target).closest(".select2-search-choice").length > 0 || (this.selectChoice(null), this.clearPlaceholder(), this.container.hasClass("select2-container-active") || this.opts.element.trigger($.Event("select2-focus")), this.open(), this.focusSearch(), e.preventDefault()))
            })), this.container.on("focus", selector, this.bind(function () {
                this.isInterfaceEnabled() && (this.container.hasClass("select2-container-active") || this.opts.element.trigger($.Event("select2-focus")), this.container.addClass("select2-container-active"), this.dropdown.addClass("select2-drop-active"), this.clearPlaceholder())
            })), this.initContainerWidth(), this.opts.element.addClass("select2-offscreen"), this.clearSearch()
        }, enableInterface: function () {
            this.parent.enableInterface.apply(this, arguments) && this.search.prop("disabled", !this.isInterfaceEnabled())
        }, initSelection: function () {
            if ("" === this.opts.element.val() && "" === this.opts.element.text() && (this.updateSelection([]), this.close(), this.clearSearch()), this.select || "" !== this.opts.element.val()) {
                var self = this;
                this.opts.initSelection.call(null, this.opts.element, function (data) {
                    data !== undefined && null !== data && (self.updateSelection(data), self.close(), self.clearSearch())
                })
            }
        }, clearSearch: function () {
            var placeholder = this.getPlaceholder(), maxWidth = this.getMaxSearchWidth();
            placeholder !== undefined && 0 === this.getVal().length && this.search.hasClass("select2-focused") === !1 ? (this.search.val(placeholder).addClass("select2-default"), this.search.width(maxWidth > 0 ? maxWidth : this.container.css("width"))) : this.search.val("").width(10)
        }, clearPlaceholder: function () {
            this.search.hasClass("select2-default") && this.search.val("").removeClass("select2-default")
        }, opening: function () {
            this.clearPlaceholder(), this.resizeSearch(), this.parent.opening.apply(this, arguments), this.focusSearch(), this.updateResults(!0), this.search.focus(), this.opts.element.trigger($.Event("select2-open"))
        }, close: function () {
            this.opened() && this.parent.close.apply(this, arguments)
        }, focus: function () {
            this.close(), this.search.focus()
        }, isFocused: function () {
            return this.search.hasClass("select2-focused")
        }, updateSelection: function (data) {
            var ids = [], filtered = [], self = this;
            $(data).each(function () {
                indexOf(self.id(this), ids) < 0 && (ids.push(self.id(this)), filtered.push(this))
            }), data = filtered, this.selection.find(".select2-search-choice").remove(), $(data).each(function () {
                self.addSelectedChoice(this)
            }), self.postprocessResults()
        }, tokenize: function () {
            var input = this.search.val();
            input = this.opts.tokenizer.call(this, input, this.data(), this.bind(this.onSelect), this.opts), null != input && input != undefined && (this.search.val(input), input.length > 0 && this.open())
        }, onSelect: function (data, options) {
            this.triggerSelect(data) && (this.addSelectedChoice(data), this.opts.element.trigger({type: "selected", val: this.id(data), choice: data}), (this.select || !this.opts.closeOnSelect) && this.postprocessResults(), this.opts.closeOnSelect ? (this.close(), this.search.width(10)) : this.countSelectableResults() > 0 ? (this.search.width(10), this.resizeSearch(), this.getMaximumSelectionSize() > 0 && this.val().length >= this.getMaximumSelectionSize() && this.updateResults(!0), this.positionDropdown()) : (this.close(), this.search.width(10)), this.triggerChange({added: data}), options && options.noFocus || this.focusSearch())
        }, cancel: function () {
            this.close(), this.focusSearch()
        }, addSelectedChoice: function (data) {
            var formatted, cssClass, enableChoice = !data.locked, enabledItem = $("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"), disabledItem = $("<li class='select2-search-choice select2-locked'><div></div></li>"), choice = enableChoice ? enabledItem : disabledItem, id = this.id(data), val = this.getVal();
            formatted = this.opts.formatSelection(data, choice.find("div"), this.opts.escapeMarkup), formatted != undefined && choice.find("div").replaceWith("<div>" + formatted + "</div>"), cssClass = this.opts.formatSelectionCssClass(data, choice.find("div")), cssClass != undefined && choice.addClass(cssClass), enableChoice && choice.find(".select2-search-choice-close").on("mousedown", killEvent).on("click dblclick", this.bind(function (e) {
                this.isInterfaceEnabled() && ($(e.target).closest(".select2-search-choice").fadeOut("fast", this.bind(function () {
                    this.unselect($(e.target)), this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"), this.close(), this.focusSearch()
                })).dequeue(), killEvent(e))
            })).on("focus", this.bind(function () {
                this.isInterfaceEnabled() && (this.container.addClass("select2-container-active"), this.dropdown.addClass("select2-drop-active"))
            })), choice.data("select2-data", data), choice.insertBefore(this.searchContainer), val.push(id), this.setVal(val)
        }, unselect: function (selected) {
            var data, index, val = this.getVal();
            if (selected = selected.closest(".select2-search-choice"), 0 === selected.length)throw"Invalid argument: " + selected + ". Must be .select2-search-choice";
            data = selected.data("select2-data"), data && (index = indexOf(this.id(data), val), index >= 0 && (val.splice(index, 1), this.setVal(val), this.select && this.postprocessResults()), selected.remove(), this.opts.element.trigger({type: "removed", val: this.id(data), choice: data}), this.triggerChange({removed: data}))
        }, postprocessResults: function (data, initial, noHighlightUpdate) {
            var val = this.getVal(), choices = this.results.find(".select2-result"), compound = this.results.find(".select2-result-with-children"), self = this;
            choices.each2(function (i, choice) {
                var id = self.id(choice.data("select2-data"));
                indexOf(id, val) >= 0 && (choice.addClass("select2-selected"), choice.find(".select2-result-selectable").addClass("select2-selected"))
            }), compound.each2(function (i, choice) {
                choice.is(".select2-result-selectable") || 0 !== choice.find(".select2-result-selectable:not(.select2-selected)").length || choice.addClass("select2-selected")
            }), -1 == this.highlight() && noHighlightUpdate !== !1 && self.highlight(0), !this.opts.createSearchChoice && !choices.filter(".select2-result:not(.select2-selected)").length > 0 && (!data || data && !data.more && 0 === this.results.find(".select2-no-results").length) && checkFormatter(self.opts.formatNoMatches, "formatNoMatches") && this.results.append("<li class='select2-no-results'>" + self.opts.formatNoMatches(self.search.val()) + "</li>")
        }, getMaxSearchWidth: function () {
            return this.selection.width() - getSideBorderPadding(this.search)
        }, resizeSearch: function () {
            var minimumWidth, left, maxWidth, containerLeft, searchWidth, sideBorderPadding = getSideBorderPadding(this.search);
            minimumWidth = measureTextWidth(this.search) + 10, left = this.search.offset().left, maxWidth = this.selection.width(), containerLeft = this.selection.offset().left, searchWidth = maxWidth - (left - containerLeft) - sideBorderPadding, minimumWidth > searchWidth && (searchWidth = maxWidth - sideBorderPadding), 40 > searchWidth && (searchWidth = maxWidth - sideBorderPadding), 0 >= searchWidth && (searchWidth = minimumWidth), this.search.width(searchWidth)
        }, getVal: function () {
            var val;
            return this.select ? (val = this.select.val(), null === val ? [] : val) : (val = this.opts.element.val(), splitVal(val, this.opts.separator))
        }, setVal: function (val) {
            var unique;
            this.select ? this.select.val(val) : (unique = [], $(val).each(function () {
                indexOf(this, unique) < 0 && unique.push(this)
            }), this.opts.element.val(0 === unique.length ? "" : unique.join(this.opts.separator)))
        }, buildChangeDetails: function (old, current) {
            for (var current = current.slice(0), old = old.slice(0), i = 0; i < current.length; i++)for (var j = 0; j < old.length; j++)equal(this.opts.id(current[i]), this.opts.id(old[j])) && (current.splice(i, 1), i--, old.splice(j, 1), j--);
            return{added: current, removed: old}
        }, val: function (val, triggerChange) {
            var oldData, self = this;
            if (0 === arguments.length)return this.getVal();
            if (oldData = this.data(), oldData.length || (oldData = []), !val && 0 !== val)return this.opts.element.val(""), this.updateSelection([]), this.clearSearch(), triggerChange && this.triggerChange({added: this.data(), removed: oldData}), void 0;
            if (this.setVal(val), this.select)this.opts.initSelection(this.select, this.bind(this.updateSelection)), triggerChange && this.triggerChange(this.buildChangeDetails(oldData, this.data())); else {
                if (this.opts.initSelection === undefined)throw new Error("val() cannot be called if initSelection() is not defined");
                this.opts.initSelection(this.opts.element, function (data) {
                    var ids = $.map(data, self.id);
                    self.setVal(ids), self.updateSelection(data), self.clearSearch(), triggerChange && self.triggerChange(this.buildChangeDetails(oldData, this.data()))
                })
            }
            this.clearSearch()
        }, onSortStart: function () {
            if (this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");
            this.search.width(0), this.searchContainer.hide()
        }, onSortEnd: function () {
            var val = [], self = this;
            this.searchContainer.show(), this.searchContainer.appendTo(this.searchContainer.parent()), this.resizeSearch(), this.selection.find(".select2-search-choice").each(function () {
                val.push(self.opts.id($(this).data("select2-data")))
            }), this.setVal(val), this.triggerChange()
        }, data: function (values, triggerChange) {
            var ids, old, self = this;
            return 0 === arguments.length ? this.selection.find(".select2-search-choice").map(function () {
                return $(this).data("select2-data")
            }).get() : (old = this.data(), values || (values = []), ids = $.map(values, function (e) {
                return self.opts.id(e)
            }), this.setVal(ids), this.updateSelection(values), this.clearSearch(), triggerChange && this.triggerChange(this.buildChangeDetails(old, this.data())), void 0)
        }}), $.fn.select2 = function () {
            var opts, select2, method, value, multiple, args = Array.prototype.slice.call(arguments, 0), allowedMethods = ["val", "destroy", "opened", "open", "close", "focus", "isFocused", "container", "dropdown", "onSortStart", "onSortEnd", "enable", "readonly", "positionDropdown", "data", "search"], valueMethods = ["val", "opened", "isFocused", "container", "data"], methodsMap = {search: "externalSearch"};
            return this.each(function () {
                if (0 === args.length || "object" == typeof args[0])opts = 0 === args.length ? {} : $.extend({}, args[0]), opts.element = $(this), "select" === opts.element.get(0).tagName.toLowerCase() ? multiple = opts.element.prop("multiple") : (multiple = opts.multiple || !1, "tags"in opts && (opts.multiple = multiple = !0)), select2 = multiple ? new MultiSelect2 : new SingleSelect2, select2.init(opts); else {
                    if ("string" != typeof args[0])throw"Invalid arguments to select2 plugin: " + args;
                    if (indexOf(args[0], allowedMethods) < 0)throw"Unknown method: " + args[0];
                    if (value = undefined, select2 = $(this).data("select2"), select2 === undefined)return;
                    if (method = args[0], "container" === method ? value = select2.container : "dropdown" === method ? value = select2.dropdown : (methodsMap[method] && (method = methodsMap[method]), value = select2[method].apply(select2, args.slice(1))), indexOf(args[0], valueMethods) >= 0)return!1
                }
            }), value === undefined ? this : value
        }, $.fn.select2.defaults = {width: "copy", loadMorePadding: 0, closeOnSelect: !0, openOnEnter: !0, containerCss: {}, dropdownCss: {}, containerCssClass: "", dropdownCssClass: "", formatResult: function (result, container, query, escapeMarkup) {
            var markup = [];
            return markMatch(result.text, query.term, markup, escapeMarkup), markup.join("")
        }, formatSelection: function (data, container, escapeMarkup) {
            return data ? escapeMarkup(data.text) : undefined
        }, sortResults: function (results) {
            return results
        }, formatResultCssClass: function () {
            return undefined
        }, formatSelectionCssClass: function () {
            return undefined
        }, formatNoMatches: function () {
            return"No matches found"
        }, formatInputTooShort: function (input, min) {
            var n = min - input.length;
            return"Please enter " + n + " more character" + (1 == n ? "" : "s")
        }, formatInputTooLong: function (input, max) {
            var n = input.length - max;
            return"Please delete " + n + " character" + (1 == n ? "" : "s")
        }, formatSelectionTooBig: function (limit) {
            return"You can only select " + limit + " item" + (1 == limit ? "" : "s")
        }, formatLoadMore: function () {
            return"Loading more results..."
        }, formatSearching: function () {
            return"Searching..."
        }, minimumResultsForSearch: 0, minimumInputLength: 0, maximumInputLength: null, maximumSelectionSize: 0, id: function (e) {
            return e.id
        }, matcher: function (term, text) {
            return("" + text).toUpperCase().indexOf(("" + term).toUpperCase()) >= 0
        }, separator: ",", tokenSeparators: [], tokenizer: defaultTokenizer, escapeMarkup: defaultEscapeMarkup, blurOnChange: !1, selectOnBlur: !1, adaptContainerCssClass: function (c) {
            return c
        }, adaptDropdownCssClass: function () {
            return null
        }}, $.fn.select2.ajaxDefaults = {transport: $.ajax, params: {type: "GET", cache: !1, dataType: "json"}}, window.Select2 = {query: {ajax: ajax, local: local, tags: tags}, util: {debounce: debounce, markMatch: markMatch, escapeMarkup: defaultEscapeMarkup}, "class": {"abstract": AbstractSelect2, single: SingleSelect2, multi: MultiSelect2}}
    }
}(jQuery), d3 = function () {
    function d3_number(x) {
        return null != x && !isNaN(x)
    }

    function d3_zipLength(d) {
        return d.length
    }

    function d3_range_integerScale(x) {
        for (var k = 1; x * k % 1;)k *= 10;
        return k
    }

    function d3_class(ctor, properties) {
        try {
            for (var key in properties)Object.defineProperty(ctor.prototype, key, {value: properties[key], enumerable: !1})
        } catch (e) {
            ctor.prototype = properties
        }
    }

    function d3_Map() {
    }

    function d3_Set() {
    }

    function d3_rebind(target, source, method) {
        return function () {
            var value = method.apply(source, arguments);
            return value === source ? target : value
        }
    }

    function d3_dispatch() {
    }

    function d3_dispatch_event(dispatch) {
        function event() {
            for (var l, z = listeners, i = -1, n = z.length; ++i < n;)(l = z[i].on) && l.apply(this, arguments);
            return dispatch
        }

        var listeners = [], listenerByName = new d3_Map;
        return event.on = function (name, listener) {
            var i, l = listenerByName.get(name);
            return arguments.length < 2 ? l && l.on : (l && (l.on = null, listeners = listeners.slice(0, i = listeners.indexOf(l)).concat(listeners.slice(i + 1)), listenerByName.remove(name)), listener && listeners.push(listenerByName.set(name, {on: listener})), dispatch)
        }, event
    }

    function d3_eventCancel() {
        d3.event.stopPropagation(), d3.event.preventDefault()
    }

    function d3_eventSource() {
        for (var s, e = d3.event; s = e.sourceEvent;)e = s;
        return e
    }

    function d3_eventSuppress(target, type) {
        function off() {
            target.on(type, null)
        }

        target.on(type, function () {
            d3_eventCancel(), off()
        }, !0), setTimeout(off, 0)
    }

    function d3_eventDispatch(target) {
        for (var dispatch = new d3_dispatch, i = 0, n = arguments.length; ++i < n;)dispatch[arguments[i]] = d3_dispatch_event(dispatch);
        return dispatch.of = function (thiz, argumentz) {
            return function (e1) {
                try {
                    var e0 = e1.sourceEvent = d3.event;
                    e1.target = target, d3.event = e1, dispatch[e1.type].apply(thiz, argumentz)
                } finally {
                    d3.event = e0
                }
            }
        }, dispatch
    }

    function d3_mousePoint(container, e) {
        var svg = container.ownerSVGElement || container;
        if (svg.createSVGPoint) {
            var point = svg.createSVGPoint();
            if (0 > d3_mouse_bug44083 && (d3_window.scrollX || d3_window.scrollY)) {
                svg = d3.select("body").append("svg").style({position: "absolute", top: 0, left: 0, margin: 0, padding: 0, border: "none"}, "important");
                var ctm = svg[0][0].getScreenCTM();
                d3_mouse_bug44083 = !(ctm.f || ctm.e), svg.remove()
            }
            return d3_mouse_bug44083 ? (point.x = e.pageX, point.y = e.pageY) : (point.x = e.clientX, point.y = e.clientY), point = point.matrixTransform(container.getScreenCTM().inverse()), [point.x, point.y]
        }
        var rect = container.getBoundingClientRect();
        return[e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop]
    }

    function d3_arrayCopy(pseudoarray) {
        for (var i = -1, n = pseudoarray.length, array = []; ++i < n;)array.push(pseudoarray[i]);
        return array
    }

    function d3_arraySlice(pseudoarray) {
        return Array.prototype.slice.call(pseudoarray)
    }

    function d3_vendorSymbol(object, name) {
        if (name in object)return name;
        name = name.charAt(0).toUpperCase() + name.substring(1);
        for (var i = 0, n = d3_vendorPrefixes.length; n > i; ++i) {
            var prefixName = d3_vendorPrefixes[i] + name;
            if (prefixName in object)return prefixName
        }
    }

    function d3_selection(groups) {
        return d3_arraySubclass(groups, d3_selectionPrototype), groups
    }

    function d3_selection_selector(selector) {
        return function () {
            return d3_select(selector, this)
        }
    }

    function d3_selection_selectorAll(selector) {
        return function () {
            return d3_selectAll(selector, this)
        }
    }

    function d3_selection_attr(name, value) {
        function attrNull() {
            this.removeAttribute(name)
        }

        function attrNullNS() {
            this.removeAttributeNS(name.space, name.local)
        }

        function attrConstant() {
            this.setAttribute(name, value)
        }

        function attrConstantNS() {
            this.setAttributeNS(name.space, name.local, value)
        }

        function attrFunction() {
            var x = value.apply(this, arguments);
            null == x ? this.removeAttribute(name) : this.setAttribute(name, x)
        }

        function attrFunctionNS() {
            var x = value.apply(this, arguments);
            null == x ? this.removeAttributeNS(name.space, name.local) : this.setAttributeNS(name.space, name.local, x)
        }

        return name = d3.ns.qualify(name), null == value ? name.local ? attrNullNS : attrNull : "function" == typeof value ? name.local ? attrFunctionNS : attrFunction : name.local ? attrConstantNS : attrConstant
    }

    function d3_collapse(s) {
        return s.trim().replace(/\s+/g, " ")
    }

    function d3_selection_classedRe(name) {
        return new RegExp("(?:^|\\s+)" + d3.requote(name) + "(?:\\s+|$)", "g")
    }

    function d3_selection_classed(name, value) {
        function classedConstant() {
            for (var i = -1; ++i < n;)name[i](this, value)
        }

        function classedFunction() {
            for (var i = -1, x = value.apply(this, arguments); ++i < n;)name[i](this, x)
        }

        name = name.trim().split(/\s+/).map(d3_selection_classedName);
        var n = name.length;
        return"function" == typeof value ? classedFunction : classedConstant
    }

    function d3_selection_classedName(name) {
        var re = d3_selection_classedRe(name);
        return function (node, value) {
            if (c = node.classList)return value ? c.add(name) : c.remove(name);
            var c = node.getAttribute("class") || "";
            value ? (re.lastIndex = 0, re.test(c) || node.setAttribute("class", d3_collapse(c + " " + name))) : node.setAttribute("class", d3_collapse(c.replace(re, " ")))
        }
    }

    function d3_selection_style(name, value, priority) {
        function styleNull() {
            this.style.removeProperty(name)
        }

        function styleConstant() {
            this.style.setProperty(name, value, priority)
        }

        function styleFunction() {
            var x = value.apply(this, arguments);
            null == x ? this.style.removeProperty(name) : this.style.setProperty(name, x, priority)
        }

        return null == value ? styleNull : "function" == typeof value ? styleFunction : styleConstant
    }

    function d3_selection_property(name, value) {
        function propertyNull() {
            delete this[name]
        }

        function propertyConstant() {
            this[name] = value
        }

        function propertyFunction() {
            var x = value.apply(this, arguments);
            null == x ? delete this[name] : this[name] = x
        }

        return null == value ? propertyNull : "function" == typeof value ? propertyFunction : propertyConstant
    }

    function d3_selection_dataNode(data) {
        return{__data__: data}
    }

    function d3_selection_filter(selector) {
        return function () {
            return d3_selectMatches(this, selector)
        }
    }

    function d3_selection_sortComparator(comparator) {
        return arguments.length || (comparator = d3.ascending), function (a, b) {
            return!a - !b || comparator(a.__data__, b.__data__)
        }
    }

    function d3_noop() {
    }

    function d3_selection_on(type, listener, capture) {
        function onRemove() {
            var l = this[name];
            l && (this.removeEventListener(type, l, l.$), delete this[name])
        }

        function onAdd() {
            var l = wrap(listener, d3_array(arguments));
            onRemove.call(this), this.addEventListener(type, this[name] = l, l.$ = capture), l._ = listener
        }

        function removeAll() {
            var match, re = new RegExp("^__on([^.]+)" + d3.requote(type) + "$");
            for (var name in this)if (match = name.match(re)) {
                var l = this[name];
                this.removeEventListener(match[1], l, l.$), delete this[name]
            }
        }

        var name = "__on" + type, i = type.indexOf("."), wrap = d3_selection_onListener;
        i > 0 && (type = type.substring(0, i));
        var filter = d3_selection_onFilters.get(type);
        return filter && (type = filter, wrap = d3_selection_onFilter), i ? listener ? onAdd : onRemove : listener ? d3_noop : removeAll
    }

    function d3_selection_onListener(listener, argumentz) {
        return function (e) {
            var o = d3.event;
            d3.event = e, argumentz[0] = this.__data__;
            try {
                listener.apply(this, argumentz)
            } finally {
                d3.event = o
            }
        }
    }

    function d3_selection_onFilter(listener, argumentz) {
        var l = d3_selection_onListener(listener, argumentz);
        return function (e) {
            var target = this, related = e.relatedTarget;
            related && (related === target || 8 & related.compareDocumentPosition(target)) || l.call(target, e)
        }
    }

    function d3_selection_each(groups, callback) {
        for (var j = 0, m = groups.length; m > j; j++)for (var node, group = groups[j], i = 0, n = group.length; n > i; i++)(node = group[i]) && callback(node, i, j);
        return groups
    }

    function d3_selection_enter(selection) {
        return d3_arraySubclass(selection, d3_selection_enterPrototype), selection
    }

    function d3_Color() {
    }

    function d3_hsl(h, s, l) {
        return new d3_Hsl(h, s, l)
    }

    function d3_Hsl(h, s, l) {
        this.h = h, this.s = s, this.l = l
    }

    function d3_hsl_rgb(h, s, l) {
        function v(h) {
            return h > 360 ? h -= 360 : 0 > h && (h += 360), 60 > h ? m1 + (m2 - m1) * h / 60 : 180 > h ? m2 : 240 > h ? m1 + (m2 - m1) * (240 - h) / 60 : m1
        }

        function vv(h) {
            return Math.round(255 * v(h))
        }

        var m1, m2;
        return h = isNaN(h) ? 0 : (h %= 360) < 0 ? h + 360 : h, s = isNaN(s) ? 0 : 0 > s ? 0 : s > 1 ? 1 : s, l = 0 > l ? 0 : l > 1 ? 1 : l, m2 = .5 >= l ? l * (1 + s) : l + s - l * s, m1 = 2 * l - m2, d3_rgb(vv(h + 120), vv(h), vv(h - 120))
    }

    function d3_sgn(x) {
        return x > 0 ? 1 : 0 > x ? -1 : 0
    }

    function d3_acos(x) {
        return x > 1 ? 0 : -1 > x ? π : Math.acos(x)
    }

    function d3_asin(x) {
        return x > 1 ? π / 2 : -1 > x ? -π / 2 : Math.asin(x)
    }

    function d3_sinh(x) {
        return(Math.exp(x) - Math.exp(-x)) / 2
    }

    function d3_cosh(x) {
        return(Math.exp(x) + Math.exp(-x)) / 2
    }

    function d3_haversin(x) {
        return(x = Math.sin(x / 2)) * x
    }

    function d3_hcl(h, c, l) {
        return new d3_Hcl(h, c, l)
    }

    function d3_Hcl(h, c, l) {
        this.h = h, this.c = c, this.l = l
    }

    function d3_hcl_lab(h, c, l) {
        return isNaN(h) && (h = 0), isNaN(c) && (c = 0), d3_lab(l, Math.cos(h *= d3_radians) * c, Math.sin(h) * c)
    }

    function d3_lab(l, a, b) {
        return new d3_Lab(l, a, b)
    }

    function d3_Lab(l, a, b) {
        this.l = l, this.a = a, this.b = b
    }

    function d3_lab_rgb(l, a, b) {
        var y = (l + 16) / 116, x = y + a / 500, z = y - b / 200;
        return x = d3_lab_xyz(x) * d3_lab_X, y = d3_lab_xyz(y) * d3_lab_Y, z = d3_lab_xyz(z) * d3_lab_Z, d3_rgb(d3_xyz_rgb(3.2404542 * x - 1.5371385 * y - .4985314 * z), d3_xyz_rgb(-.969266 * x + 1.8760108 * y + .041556 * z), d3_xyz_rgb(.0556434 * x - .2040259 * y + 1.0572252 * z))
    }

    function d3_lab_hcl(l, a, b) {
        return l > 0 ? d3_hcl(Math.atan2(b, a) * d3_degrees, Math.sqrt(a * a + b * b), l) : d3_hcl(0 / 0, 0 / 0, l)
    }

    function d3_lab_xyz(x) {
        return x > .206893034 ? x * x * x : (x - 4 / 29) / 7.787037
    }

    function d3_xyz_lab(x) {
        return x > .008856 ? Math.pow(x, 1 / 3) : 7.787037 * x + 4 / 29
    }

    function d3_xyz_rgb(r) {
        return Math.round(255 * (.00304 >= r ? 12.92 * r : 1.055 * Math.pow(r, 1 / 2.4) - .055))
    }

    function d3_rgb(r, g, b) {
        return new d3_Rgb(r, g, b)
    }

    function d3_Rgb(r, g, b) {
        this.r = r, this.g = g, this.b = b
    }

    function d3_rgb_hex(v) {
        return 16 > v ? "0" + Math.max(0, v).toString(16) : Math.min(255, v).toString(16)
    }

    function d3_rgb_parse(format, rgb, hsl) {
        var m1, m2, name, r = 0, g = 0, b = 0;
        if (m1 = /([a-z]+)\((.*)\)/i.exec(format))switch (m2 = m1[2].split(","), m1[1]) {
            case"hsl":
                return hsl(parseFloat(m2[0]), parseFloat(m2[1]) / 100, parseFloat(m2[2]) / 100);
            case"rgb":
                return rgb(d3_rgb_parseNumber(m2[0]), d3_rgb_parseNumber(m2[1]), d3_rgb_parseNumber(m2[2]))
        }
        return(name = d3_rgb_names.get(format)) ? rgb(name.r, name.g, name.b) : (null != format && "#" === format.charAt(0) && (4 === format.length ? (r = format.charAt(1), r += r, g = format.charAt(2), g += g, b = format.charAt(3), b += b) : 7 === format.length && (r = format.substring(1, 3), g = format.substring(3, 5), b = format.substring(5, 7)), r = parseInt(r, 16), g = parseInt(g, 16), b = parseInt(b, 16)), rgb(r, g, b))
    }

    function d3_rgb_hsl(r, g, b) {
        var h, s, min = Math.min(r /= 255, g /= 255, b /= 255), max = Math.max(r, g, b), d = max - min, l = (max + min) / 2;
        return d ? (s = .5 > l ? d / (max + min) : d / (2 - max - min), h = r == max ? (g - b) / d + (b > g ? 6 : 0) : g == max ? (b - r) / d + 2 : (r - g) / d + 4, h *= 60) : (h = 0 / 0, s = l > 0 && 1 > l ? 0 : h), d3_hsl(h, s, l)
    }

    function d3_rgb_lab(r, g, b) {
        r = d3_rgb_xyz(r), g = d3_rgb_xyz(g), b = d3_rgb_xyz(b);
        var x = d3_xyz_lab((.4124564 * r + .3575761 * g + .1804375 * b) / d3_lab_X), y = d3_xyz_lab((.2126729 * r + .7151522 * g + .072175 * b) / d3_lab_Y), z = d3_xyz_lab((.0193339 * r + .119192 * g + .9503041 * b) / d3_lab_Z);
        return d3_lab(116 * y - 16, 500 * (x - y), 200 * (y - z))
    }

    function d3_rgb_xyz(r) {
        return(r /= 255) <= .04045 ? r / 12.92 : Math.pow((r + .055) / 1.055, 2.4)
    }

    function d3_rgb_parseNumber(c) {
        var f = parseFloat(c);
        return"%" === c.charAt(c.length - 1) ? Math.round(2.55 * f) : f
    }

    function d3_functor(v) {
        return"function" == typeof v ? v : function () {
            return v
        }
    }

    function d3_identity(d) {
        return d
    }

    function d3_xhrType(response) {
        return function (url, mimeType, callback) {
            return 2 === arguments.length && "function" == typeof mimeType && (callback = mimeType, mimeType = null), d3_xhr(url, mimeType, response, callback)
        }
    }

    function d3_xhr(url, mimeType, response, callback) {
        function respond() {
            var result, status = request.status;
            if (!status && request.responseText || status >= 200 && 300 > status || 304 === status) {
                try {
                    result = response.call(xhr, request)
                } catch (e) {
                    return dispatch.error.call(xhr, e), void 0
                }
                dispatch.load.call(xhr, result)
            } else dispatch.error.call(xhr, request)
        }

        var xhr = {}, dispatch = d3.dispatch("progress", "load", "error"), headers = {}, request = new XMLHttpRequest, responseType = null;
        return!d3_window.XDomainRequest || "withCredentials"in request || !/^(http(s)?:)?\/\//.test(url) || (request = new XDomainRequest), "onload"in request ? request.onload = request.onerror = respond : request.onreadystatechange = function () {
            request.readyState > 3 && respond()
        }, request.onprogress = function (event) {
            var o = d3.event;
            d3.event = event;
            try {
                dispatch.progress.call(xhr, request)
            } finally {
                d3.event = o
            }
        }, xhr.header = function (name, value) {
            return name = (name + "").toLowerCase(), arguments.length < 2 ? headers[name] : (null == value ? delete headers[name] : headers[name] = value + "", xhr)
        }, xhr.mimeType = function (value) {
            return arguments.length ? (mimeType = null == value ? null : value + "", xhr) : mimeType
        }, xhr.responseType = function (value) {
            return arguments.length ? (responseType = value, xhr) : responseType
        }, xhr.response = function (value) {
            return response = value, xhr
        }, ["get", "post"].forEach(function (method) {
            xhr[method] = function () {
                return xhr.send.apply(xhr, [method].concat(d3_array(arguments)))
            }
        }), xhr.send = function (method, data, callback) {
            if (2 === arguments.length && "function" == typeof data && (callback = data, data = null), request.open(method, url, !0), null == mimeType || "accept"in headers || (headers.accept = mimeType + ",*/*"), request.setRequestHeader)for (var name in headers)request.setRequestHeader(name, headers[name]);
            return null != mimeType && request.overrideMimeType && request.overrideMimeType(mimeType), null != responseType && (request.responseType = responseType), null != callback && xhr.on("error", callback).on("load", function (request) {
                callback(null, request)
            }), request.send(null == data ? null : data), xhr
        }, xhr.abort = function () {
            return request.abort(), xhr
        }, d3.rebind(xhr, dispatch, "on"), null == callback ? xhr : xhr.get(d3_xhr_fixCallback(callback))
    }

    function d3_xhr_fixCallback(callback) {
        return 1 === callback.length ? function (error, request) {
            callback(null == error ? request : null)
        } : callback
    }

    function d3_timer_step() {
        var now = d3_timer_mark(), delay = d3_timer_sweep() - now;
        delay > 24 ? (isFinite(delay) && (clearTimeout(d3_timer_timeout), d3_timer_timeout = setTimeout(d3_timer_step, delay)), d3_timer_interval = 0) : (d3_timer_interval = 1, d3_timer_frame(d3_timer_step))
    }

    function d3_timer_mark() {
        for (var now = Date.now(), timer = d3_timer_queueHead; timer;)now >= timer.time && (timer.flush = timer.callback(now - timer.time)), timer = timer.next;
        return now
    }

    function d3_timer_sweep() {
        for (var t0, t1 = d3_timer_queueHead, time = 1 / 0; t1;)t1.flush ? t1 = t0 ? t0.next = t1.next : d3_timer_queueHead = t1.next : (t1.time < time && (time = t1.time), t1 = (t0 = t1).next);
        return d3_timer_queueTail = t0, time
    }

    function d3_formatPrefix(d, i) {
        var k = Math.pow(10, 3 * Math.abs(8 - i));
        return{scale: i > 8 ? function (d) {
            return d / k
        } : function (d) {
            return d * k
        }, symbol: d}
    }

    function d3_format_precision(x, p) {
        return p - (x ? Math.ceil(Math.log(x) / Math.LN10) : 1)
    }

    function d3_format_typeDefault(x) {
        return x + ""
    }

    function d3_adder() {
    }

    function d3_adderSum(a, b, o) {
        var x = o.s = a + b, bv = x - a, av = x - bv;
        o.t = a - av + (b - bv)
    }

    function d3_geo_streamGeometry(geometry, listener) {
        geometry && d3_geo_streamGeometryType.hasOwnProperty(geometry.type) && d3_geo_streamGeometryType[geometry.type](geometry, listener)
    }

    function d3_geo_streamLine(coordinates, listener, closed) {
        var coordinate, i = -1, n = coordinates.length - closed;
        for (listener.lineStart(); ++i < n;)coordinate = coordinates[i], listener.point(coordinate[0], coordinate[1]);
        listener.lineEnd()
    }

    function d3_geo_streamPolygon(coordinates, listener) {
        var i = -1, n = coordinates.length;
        for (listener.polygonStart(); ++i < n;)d3_geo_streamLine(coordinates[i], listener, 1);
        listener.polygonEnd()
    }

    function d3_geo_areaRingStart() {
        function nextPoint(λ, φ) {
            λ *= d3_radians, φ = φ * d3_radians / 2 + π / 4;
            var dλ = λ - λ0, cosφ = Math.cos(φ), sinφ = Math.sin(φ), k = sinφ0 * sinφ, u = cosφ0 * cosφ + k * Math.cos(dλ), v = k * Math.sin(dλ);
            d3_geo_areaRingSum.add(Math.atan2(v, u)), λ0 = λ, cosφ0 = cosφ, sinφ0 = sinφ
        }

        var λ00, φ00, λ0, cosφ0, sinφ0;
        d3_geo_area.point = function (λ, φ) {
            d3_geo_area.point = nextPoint, λ0 = (λ00 = λ) * d3_radians, cosφ0 = Math.cos(φ = (φ00 = φ) * d3_radians / 2 + π / 4), sinφ0 = Math.sin(φ)
        }, d3_geo_area.lineEnd = function () {
            nextPoint(λ00, φ00)
        }
    }

    function d3_geo_cartesian(spherical) {
        var λ = spherical[0], φ = spherical[1], cosφ = Math.cos(φ);
        return[cosφ * Math.cos(λ), cosφ * Math.sin(λ), Math.sin(φ)]
    }

    function d3_geo_cartesianDot(a, b) {
        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]
    }

    function d3_geo_cartesianCross(a, b) {
        return[a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]]
    }

    function d3_geo_cartesianAdd(a, b) {
        a[0] += b[0], a[1] += b[1], a[2] += b[2]
    }

    function d3_geo_cartesianScale(vector, k) {
        return[vector[0] * k, vector[1] * k, vector[2] * k]
    }

    function d3_geo_cartesianNormalize(d) {
        var l = Math.sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);
        d[0] /= l, d[1] /= l, d[2] /= l
    }

    function d3_geo_spherical(cartesian) {
        return[Math.atan2(cartesian[1], cartesian[0]), d3_asin(cartesian[2])]
    }

    function d3_geo_sphericalEqual(a, b) {
        return Math.abs(a[0] - b[0]) < ε && Math.abs(a[1] - b[1]) < ε
    }

    function d3_geo_centroidPoint(λ, φ) {
        λ *= d3_radians;
        var cosφ = Math.cos(φ *= d3_radians);
        d3_geo_centroidPointXYZ(cosφ * Math.cos(λ), cosφ * Math.sin(λ), Math.sin(φ))
    }

    function d3_geo_centroidPointXYZ(x, y, z) {
        ++d3_geo_centroidW0, d3_geo_centroidX0 += (x - d3_geo_centroidX0) / d3_geo_centroidW0, d3_geo_centroidY0 += (y - d3_geo_centroidY0) / d3_geo_centroidW0, d3_geo_centroidZ0 += (z - d3_geo_centroidZ0) / d3_geo_centroidW0
    }

    function d3_geo_centroidLineStart() {
        function nextPoint(λ, φ) {
            λ *= d3_radians;
            var cosφ = Math.cos(φ *= d3_radians), x = cosφ * Math.cos(λ), y = cosφ * Math.sin(λ), z = Math.sin(φ), w = Math.atan2(Math.sqrt((w = y0 * z - z0 * y) * w + (w = z0 * x - x0 * z) * w + (w = x0 * y - y0 * x) * w), x0 * x + y0 * y + z0 * z);
            d3_geo_centroidW1 += w, d3_geo_centroidX1 += w * (x0 + (x0 = x)), d3_geo_centroidY1 += w * (y0 + (y0 = y)), d3_geo_centroidZ1 += w * (z0 + (z0 = z)), d3_geo_centroidPointXYZ(x0, y0, z0)
        }

        var x0, y0, z0;
        d3_geo_centroid.point = function (λ, φ) {
            λ *= d3_radians;
            var cosφ = Math.cos(φ *= d3_radians);
            x0 = cosφ * Math.cos(λ), y0 = cosφ * Math.sin(λ), z0 = Math.sin(φ), d3_geo_centroid.point = nextPoint, d3_geo_centroidPointXYZ(x0, y0, z0)
        }
    }

    function d3_geo_centroidLineEnd() {
        d3_geo_centroid.point = d3_geo_centroidPoint
    }

    function d3_geo_centroidRingStart() {
        function nextPoint(λ, φ) {
            λ *= d3_radians;
            var cosφ = Math.cos(φ *= d3_radians), x = cosφ * Math.cos(λ), y = cosφ * Math.sin(λ), z = Math.sin(φ), cx = y0 * z - z0 * y, cy = z0 * x - x0 * z, cz = x0 * y - y0 * x, m = Math.sqrt(cx * cx + cy * cy + cz * cz), u = x0 * x + y0 * y + z0 * z, v = m && -d3_acos(u) / m, w = Math.atan2(m, u);
            d3_geo_centroidX2 += v * cx, d3_geo_centroidY2 += v * cy, d3_geo_centroidZ2 += v * cz, d3_geo_centroidW1 += w, d3_geo_centroidX1 += w * (x0 + (x0 = x)), d3_geo_centroidY1 += w * (y0 + (y0 = y)), d3_geo_centroidZ1 += w * (z0 + (z0 = z)), d3_geo_centroidPointXYZ(x0, y0, z0)
        }

        var λ00, φ00, x0, y0, z0;
        d3_geo_centroid.point = function (λ, φ) {
            λ00 = λ, φ00 = φ, d3_geo_centroid.point = nextPoint, λ *= d3_radians;
            var cosφ = Math.cos(φ *= d3_radians);
            x0 = cosφ * Math.cos(λ), y0 = cosφ * Math.sin(λ), z0 = Math.sin(φ), d3_geo_centroidPointXYZ(x0, y0, z0)
        }, d3_geo_centroid.lineEnd = function () {
            nextPoint(λ00, φ00), d3_geo_centroid.lineEnd = d3_geo_centroidLineEnd, d3_geo_centroid.point = d3_geo_centroidPoint
        }
    }

    function d3_true() {
        return!0
    }

    function d3_geo_clipPolygon(segments, compare, inside, interpolate, listener) {
        var subject = [], clip = [];
        if (segments.forEach(function (segment) {
            if (!((n = segment.length - 1) <= 0)) {
                var n, p0 = segment[0], p1 = segment[n];
                if (d3_geo_sphericalEqual(p0, p1)) {
                    listener.lineStart();
                    for (var i = 0; n > i; ++i)listener.point((p0 = segment[i])[0], p0[1]);
                    return listener.lineEnd(), void 0
                }
                var a = {point: p0, points: segment, other: null, visited: !1, entry: !0, subject: !0}, b = {point: p0, points: [p0], other: a, visited: !1, entry: !1, subject: !1};
                a.other = b, subject.push(a), clip.push(b), a = {point: p1, points: [p1], other: null, visited: !1, entry: !1, subject: !0}, b = {point: p1, points: [p1], other: a, visited: !1, entry: !0, subject: !1}, a.other = b, subject.push(a), clip.push(b)
            }
        }), clip.sort(compare), d3_geo_clipPolygonLinkCircular(subject), d3_geo_clipPolygonLinkCircular(clip), subject.length) {
            if (inside)for (var i = 1, e = !inside(clip[0].point), n = clip.length; n > i; ++i)clip[i].entry = e = !e;
            for (var current, points, point, start = subject[0]; ;) {
                for (current = start; current.visited;)if ((current = current.next) === start)return;
                points = current.points, listener.lineStart();
                do {
                    if (current.visited = current.other.visited = !0, current.entry) {
                        if (current.subject)for (var i = 0; i < points.length; i++)listener.point((point = points[i])[0], point[1]); else interpolate(current.point, current.next.point, 1, listener);
                        current = current.next
                    } else {
                        if (current.subject) {
                            points = current.prev.points;
                            for (var i = points.length; --i >= 0;)listener.point((point = points[i])[0], point[1])
                        } else interpolate(current.point, current.prev.point, -1, listener);
                        current = current.prev
                    }
                    current = current.other, points = current.points
                } while (!current.visited);
                listener.lineEnd()
            }
        }
    }

    function d3_geo_clipPolygonLinkCircular(array) {
        if (n = array.length) {
            for (var n, b, i = 0, a = array[0]; ++i < n;)a.next = b = array[i], b.prev = a, a = b;
            a.next = b = array[0], b.prev = a
        }
    }

    function d3_geo_clip(pointVisible, clipLine, interpolate, polygonContains) {
        return function (listener) {
            function point(λ, φ) {
                pointVisible(λ, φ) && listener.point(λ, φ)
            }

            function pointLine(λ, φ) {
                line.point(λ, φ)
            }

            function lineStart() {
                clip.point = pointLine, line.lineStart()
            }

            function lineEnd() {
                clip.point = point, line.lineEnd()
            }

            function pointRing(λ, φ) {
                ringListener.point(λ, φ), ring.push([λ, φ])
            }

            function ringStart() {
                ringListener.lineStart(), ring = []
            }

            function ringEnd() {
                pointRing(ring[0][0], ring[0][1]), ringListener.lineEnd();
                var segment, clean = ringListener.clean(), ringSegments = buffer.buffer(), n = ringSegments.length;
                if (ring.pop(), polygon.push(ring), ring = null, n) {
                    if (1 & clean) {
                        segment = ringSegments[0];
                        var point, n = segment.length - 1, i = -1;
                        for (listener.lineStart(); ++i < n;)listener.point((point = segment[i])[0], point[1]);
                        return listener.lineEnd(), void 0
                    }
                    n > 1 && 2 & clean && ringSegments.push(ringSegments.pop().concat(ringSegments.shift())), segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))
                }
            }

            var segments, polygon, ring, line = clipLine(listener), clip = {point: point, lineStart: lineStart, lineEnd: lineEnd, polygonStart: function () {
                clip.point = pointRing, clip.lineStart = ringStart, clip.lineEnd = ringEnd, segments = [], polygon = [], listener.polygonStart()
            }, polygonEnd: function () {
                clip.point = point, clip.lineStart = lineStart, clip.lineEnd = lineEnd, segments = d3.merge(segments), segments.length ? d3_geo_clipPolygon(segments, d3_geo_clipSort, null, interpolate, listener) : polygonContains(polygon) && (listener.lineStart(), interpolate(null, null, 1, listener), listener.lineEnd()), listener.polygonEnd(), segments = polygon = null
            }, sphere: function () {
                listener.polygonStart(), listener.lineStart(), interpolate(null, null, 1, listener), listener.lineEnd(), listener.polygonEnd()
            }}, buffer = d3_geo_clipBufferListener(), ringListener = clipLine(buffer);
            return clip
        }
    }

    function d3_geo_clipSegmentLength1(segment) {
        return segment.length > 1
    }

    function d3_geo_clipBufferListener() {
        var line, lines = [];
        return{lineStart: function () {
            lines.push(line = [])
        }, point: function (λ, φ) {
            line.push([λ, φ])
        }, lineEnd: d3_noop, buffer: function () {
            var buffer = lines;
            return lines = [], line = null, buffer
        }, rejoin: function () {
            lines.length > 1 && lines.push(lines.pop().concat(lines.shift()))
        }}
    }

    function d3_geo_clipSort(a, b) {
        return((a = a.point)[0] < 0 ? a[1] - π / 2 - ε : π / 2 - a[1]) - ((b = b.point)[0] < 0 ? b[1] - π / 2 - ε : π / 2 - b[1])
    }

    function d3_geo_pointInPolygon(point, polygon) {
        var meridian = point[0], parallel = point[1], meridianNormal = [Math.sin(meridian), -Math.cos(meridian), 0], polarAngle = 0, polar = !1, southPole = !1, winding = 0;
        d3_geo_areaRingSum.reset();
        for (var i = 0, n = polygon.length; n > i; ++i) {
            var ring = polygon[i], m = ring.length;
            if (m) {
                for (var point0 = ring[0], λ0 = point0[0], φ0 = point0[1] / 2 + π / 4, sinφ0 = Math.sin(φ0), cosφ0 = Math.cos(φ0), j = 1; ;) {
                    j === m && (j = 0), point = ring[j];
                    var λ = point[0], φ = point[1] / 2 + π / 4, sinφ = Math.sin(φ), cosφ = Math.cos(φ), dλ = λ - λ0, antimeridian = Math.abs(dλ) > π, k = sinφ0 * sinφ;
                    if (d3_geo_areaRingSum.add(Math.atan2(k * Math.sin(dλ), cosφ0 * cosφ + k * Math.cos(dλ))), Math.abs(φ) < ε && (southPole = !0), polarAngle += antimeridian ? dλ + (dλ >= 0 ? 2 : -2) * π : dλ, antimeridian ^ λ0 >= meridian ^ λ >= meridian) {
                        var arc = d3_geo_cartesianCross(d3_geo_cartesian(point0), d3_geo_cartesian(point));
                        d3_geo_cartesianNormalize(arc);
                        var intersection = d3_geo_cartesianCross(meridianNormal, arc);
                        d3_geo_cartesianNormalize(intersection);
                        var φarc = (antimeridian ^ dλ >= 0 ? -1 : 1) * d3_asin(intersection[2]);
                        parallel > φarc && (winding += antimeridian ^ dλ >= 0 ? 1 : -1)
                    }
                    if (!j++)break;
                    λ0 = λ, sinφ0 = sinφ, cosφ0 = cosφ, point0 = point
                }
                Math.abs(polarAngle) > ε && (polar = !0)
            }
        }
        return(!southPole && !polar && 0 > d3_geo_areaRingSum || -ε > polarAngle) ^ 1 & winding
    }

    function d3_geo_clipAntimeridianLine(listener) {
        var clean, λ0 = 0 / 0, φ0 = 0 / 0, sλ0 = 0 / 0;
        return{lineStart: function () {
            listener.lineStart(), clean = 1
        }, point: function (λ1, φ1) {
            var sλ1 = λ1 > 0 ? π : -π, dλ = Math.abs(λ1 - λ0);
            Math.abs(dλ - π) < ε ? (listener.point(λ0, φ0 = (φ0 + φ1) / 2 > 0 ? π / 2 : -π / 2), listener.point(sλ0, φ0), listener.lineEnd(), listener.lineStart(), listener.point(sλ1, φ0), listener.point(λ1, φ0), clean = 0) : sλ0 !== sλ1 && dλ >= π && (Math.abs(λ0 - sλ0) < ε && (λ0 -= sλ0 * ε), Math.abs(λ1 - sλ1) < ε && (λ1 -= sλ1 * ε), φ0 = d3_geo_clipAntimeridianIntersect(λ0, φ0, λ1, φ1), listener.point(sλ0, φ0), listener.lineEnd(), listener.lineStart(), listener.point(sλ1, φ0), clean = 0), listener.point(λ0 = λ1, φ0 = φ1), sλ0 = sλ1
        }, lineEnd: function () {
            listener.lineEnd(), λ0 = φ0 = 0 / 0
        }, clean: function () {
            return 2 - clean
        }}
    }

    function d3_geo_clipAntimeridianIntersect(λ0, φ0, λ1, φ1) {
        var cosφ0, cosφ1, sinλ0_λ1 = Math.sin(λ0 - λ1);
        return Math.abs(sinλ0_λ1) > ε ? Math.atan((Math.sin(φ0) * (cosφ1 = Math.cos(φ1)) * Math.sin(λ1) - Math.sin(φ1) * (cosφ0 = Math.cos(φ0)) * Math.sin(λ0)) / (cosφ0 * cosφ1 * sinλ0_λ1)) : (φ0 + φ1) / 2
    }

    function d3_geo_clipAntimeridianInterpolate(from, to, direction, listener) {
        var φ;
        if (null == from)φ = direction * π / 2, listener.point(-π, φ), listener.point(0, φ), listener.point(π, φ), listener.point(π, 0), listener.point(π, -φ), listener.point(0, -φ), listener.point(-π, -φ), listener.point(-π, 0), listener.point(-π, φ); else if (Math.abs(from[0] - to[0]) > ε) {
            var s = (from[0] < to[0] ? 1 : -1) * π;
            φ = direction * s / 2, listener.point(-s, φ), listener.point(0, φ), listener.point(s, φ)
        } else listener.point(to[0], to[1])
    }

    function d3_geo_clipAntimeridianPolygonContains(polygon) {
        return d3_geo_pointInPolygon(d3_geo_clipAntimeridianPoint, polygon)
    }

    function d3_geo_clipCircle(radius) {
        function visible(λ, φ) {
            return Math.cos(λ) * Math.cos(φ) > cr
        }

        function clipLine(listener) {
            var point0, c0, v0, v00, clean;
            return{lineStart: function () {
                v00 = v0 = !1, clean = 1
            }, point: function (λ, φ) {
                var point2, point1 = [λ, φ], v = visible(λ, φ), c = smallRadius ? v ? 0 : code(λ, φ) : v ? code(λ + (0 > λ ? π : -π), φ) : 0;
                if (!point0 && (v00 = v0 = v) && listener.lineStart(), v !== v0 && (point2 = intersect(point0, point1), (d3_geo_sphericalEqual(point0, point2) || d3_geo_sphericalEqual(point1, point2)) && (point1[0] += ε, point1[1] += ε, v = visible(point1[0], point1[1]))), v !== v0)clean = 0, v ? (listener.lineStart(), point2 = intersect(point1, point0), listener.point(point2[0], point2[1])) : (point2 = intersect(point0, point1), listener.point(point2[0], point2[1]), listener.lineEnd()), point0 = point2; else if (notHemisphere && point0 && smallRadius ^ v) {
                    var t;
                    c & c0 || !(t = intersect(point1, point0, !0)) || (clean = 0, smallRadius ? (listener.lineStart(), listener.point(t[0][0], t[0][1]), listener.point(t[1][0], t[1][1]), listener.lineEnd()) : (listener.point(t[1][0], t[1][1]), listener.lineEnd(), listener.lineStart(), listener.point(t[0][0], t[0][1])))
                }
                !v || point0 && d3_geo_sphericalEqual(point0, point1) || listener.point(point1[0], point1[1]), point0 = point1, v0 = v, c0 = c
            }, lineEnd: function () {
                v0 && listener.lineEnd(), point0 = null
            }, clean: function () {
                return clean | (v00 && v0) << 1
            }}
        }

        function intersect(a, b, two) {
            var pa = d3_geo_cartesian(a), pb = d3_geo_cartesian(b), n1 = [1, 0, 0], n2 = d3_geo_cartesianCross(pa, pb), n2n2 = d3_geo_cartesianDot(n2, n2), n1n2 = n2[0], determinant = n2n2 - n1n2 * n1n2;
            if (!determinant)return!two && a;
            var c1 = cr * n2n2 / determinant, c2 = -cr * n1n2 / determinant, n1xn2 = d3_geo_cartesianCross(n1, n2), A = d3_geo_cartesianScale(n1, c1), B = d3_geo_cartesianScale(n2, c2);
            d3_geo_cartesianAdd(A, B);
            var u = n1xn2, w = d3_geo_cartesianDot(A, u), uu = d3_geo_cartesianDot(u, u), t2 = w * w - uu * (d3_geo_cartesianDot(A, A) - 1);
            if (!(0 > t2)) {
                var t = Math.sqrt(t2), q = d3_geo_cartesianScale(u, (-w - t) / uu);
                if (d3_geo_cartesianAdd(q, A), q = d3_geo_spherical(q), !two)return q;
                var z, λ0 = a[0], λ1 = b[0], φ0 = a[1], φ1 = b[1];
                λ0 > λ1 && (z = λ0, λ0 = λ1, λ1 = z);
                var δλ = λ1 - λ0, polar = Math.abs(δλ - π) < ε, meridian = polar || ε > δλ;
                if (!polar && φ0 > φ1 && (z = φ0, φ0 = φ1, φ1 = z), meridian ? polar ? φ0 + φ1 > 0 ^ q[1] < (Math.abs(q[0] - λ0) < ε ? φ0 : φ1) : φ0 <= q[1] && q[1] <= φ1 : δλ > π ^ (λ0 <= q[0] && q[0] <= λ1)) {
                    var q1 = d3_geo_cartesianScale(u, (-w + t) / uu);
                    return d3_geo_cartesianAdd(q1, A), [q, d3_geo_spherical(q1)]
                }
            }
        }

        function code(λ, φ) {
            var r = smallRadius ? radius : π - radius, code = 0;
            return-r > λ ? code |= 1 : λ > r && (code |= 2), -r > φ ? code |= 4 : φ > r && (code |= 8), code
        }

        function polygonContains(polygon) {
            return d3_geo_pointInPolygon(point, polygon)
        }

        var cr = Math.cos(radius), smallRadius = cr > 0, point = [radius, 0], notHemisphere = Math.abs(cr) > ε, interpolate = d3_geo_circleInterpolate(radius, 6 * d3_radians);
        return d3_geo_clip(visible, clipLine, interpolate, polygonContains)
    }

    function d3_geo_clipView(x0, y0, x1, y1) {
        function corner(p, direction) {
            return Math.abs(p[0] - x0) < ε ? direction > 0 ? 0 : 3 : Math.abs(p[0] - x1) < ε ? direction > 0 ? 2 : 1 : Math.abs(p[1] - y0) < ε ? direction > 0 ? 1 : 0 : direction > 0 ? 3 : 2
        }

        function compare(a, b) {
            return comparePoints(a.point, b.point)
        }

        function comparePoints(a, b) {
            var ca = corner(a, 1), cb = corner(b, 1);
            return ca !== cb ? ca - cb : 0 === ca ? b[1] - a[1] : 1 === ca ? a[0] - b[0] : 2 === ca ? a[1] - b[1] : b[0] - a[0]
        }

        function clipLine(a, b) {
            var dx = b[0] - a[0], dy = b[1] - a[1], t = [0, 1];
            return Math.abs(dx) < ε && Math.abs(dy) < ε ? x0 <= a[0] && a[0] <= x1 && y0 <= a[1] && a[1] <= y1 : d3_geo_clipViewT(x0 - a[0], dx, t) && d3_geo_clipViewT(a[0] - x1, -dx, t) && d3_geo_clipViewT(y0 - a[1], dy, t) && d3_geo_clipViewT(a[1] - y1, -dy, t) ? (t[1] < 1 && (b[0] = a[0] + t[1] * dx, b[1] = a[1] + t[1] * dy), t[0] > 0 && (a[0] += t[0] * dx, a[1] += t[0] * dy), !0) : !1
        }

        return function (listener) {
            function inside(point) {
                var a = corner(point, -1), i = insidePolygon([0 === a || 3 === a ? x0 : x1, a > 1 ? y1 : y0]);
                return i
            }

            function insidePolygon(p) {
                for (var wn = 0, n = polygon.length, y = p[1], i = 0; n > i; ++i)for (var b, j = 1, v = polygon[i], m = v.length, a = v[0]; m > j; ++j)b = v[j], a[1] <= y ? b[1] > y && isLeft(a, b, p) > 0 && ++wn : b[1] <= y && isLeft(a, b, p) < 0 && --wn, a = b;
                return 0 !== wn
            }

            function isLeft(a, b, c) {
                return(b[0] - a[0]) * (c[1] - a[1]) - (c[0] - a[0]) * (b[1] - a[1])
            }

            function interpolate(from, to, direction, listener) {
                var a = 0, a1 = 0;
                if (null == from || (a = corner(from, direction)) !== (a1 = corner(to, direction)) || comparePoints(from, to) < 0 ^ direction > 0) {
                    do listener.point(0 === a || 3 === a ? x0 : x1, a > 1 ? y1 : y0); while ((a = (a + direction + 4) % 4) !== a1)
                } else listener.point(to[0], to[1])
            }

            function visible(x, y) {
                return x >= x0 && x1 >= x && y >= y0 && y1 >= y
            }

            function point(x, y) {
                visible(x, y) && listener.point(x, y)
            }

            function lineStart() {
                clip.point = linePoint, polygon && polygon.push(ring = []), first = !0, v_ = !1, x_ = y_ = 0 / 0
            }

            function lineEnd() {
                segments && (linePoint(x__, y__), v__ && v_ && bufferListener.rejoin(), segments.push(bufferListener.buffer())), clip.point = point, v_ && listener.lineEnd()
            }

            function linePoint(x, y) {
                x = Math.max(-d3_geo_clipViewMAX, Math.min(d3_geo_clipViewMAX, x)), y = Math.max(-d3_geo_clipViewMAX, Math.min(d3_geo_clipViewMAX, y));
                var v = visible(x, y);
                if (polygon && ring.push([x, y]), first)x__ = x, y__ = y, v__ = v, first = !1, v && (listener.lineStart(), listener.point(x, y)); else if (v && v_)listener.point(x, y); else {
                    var a = [x_, y_], b = [x, y];
                    clipLine(a, b) ? (v_ || (listener.lineStart(), listener.point(a[0], a[1])), listener.point(b[0], b[1]), v || listener.lineEnd()) : v && (listener.lineStart(), listener.point(x, y))
                }
                x_ = x, y_ = y, v_ = v
            }

            var segments, polygon, ring, x__, y__, v__, x_, y_, v_, first, listener_ = listener, bufferListener = d3_geo_clipBufferListener(), clip = {point: point, lineStart: lineStart, lineEnd: lineEnd, polygonStart: function () {
                listener = bufferListener, segments = [], polygon = []
            }, polygonEnd: function () {
                listener = listener_, (segments = d3.merge(segments)).length ? (listener.polygonStart(), d3_geo_clipPolygon(segments, compare, inside, interpolate, listener), listener.polygonEnd()) : insidePolygon([x0, y0]) && (listener.polygonStart(), listener.lineStart(), interpolate(null, null, 1, listener), listener.lineEnd(), listener.polygonEnd()), segments = polygon = ring = null
            }};
            return clip
        }
    }

    function d3_geo_clipViewT(num, denominator, t) {
        if (Math.abs(denominator) < ε)return 0 >= num;
        var u = num / denominator;
        if (denominator > 0) {
            if (u > t[1])return!1;
            u > t[0] && (t[0] = u)
        } else {
            if (u < t[0])return!1;
            u < t[1] && (t[1] = u)
        }
        return!0
    }

    function d3_geo_compose(a, b) {
        function compose(x, y) {
            return x = a(x, y), b(x[0], x[1])
        }

        return a.invert && b.invert && (compose.invert = function (x, y) {
            return x = b.invert(x, y), x && a.invert(x[0], x[1])
        }), compose
    }

    function d3_geo_conic(projectAt) {
        var φ0 = 0, φ1 = π / 3, m = d3_geo_projectionMutator(projectAt), p = m(φ0, φ1);
        return p.parallels = function (_) {
            return arguments.length ? m(φ0 = _[0] * π / 180, φ1 = _[1] * π / 180) : [180 * (φ0 / π), 180 * (φ1 / π)]
        }, p
    }

    function d3_geo_conicEqualArea(φ0, φ1) {
        function forward(λ, φ) {
            var ρ = Math.sqrt(C - 2 * n * Math.sin(φ)) / n;
            return[ρ * Math.sin(λ *= n), ρ0 - ρ * Math.cos(λ)]
        }

        var sinφ0 = Math.sin(φ0), n = (sinφ0 + Math.sin(φ1)) / 2, C = 1 + sinφ0 * (2 * n - sinφ0), ρ0 = Math.sqrt(C) / n;
        return forward.invert = function (x, y) {
            var ρ0_y = ρ0 - y;
            return[Math.atan2(x, ρ0_y) / n, d3_asin((C - (x * x + ρ0_y * ρ0_y) * n * n) / (2 * n))]
        }, forward
    }

    function d3_geo_pathAreaRingStart() {
        function nextPoint(x, y) {
            d3_geo_pathAreaPolygon += y0 * x - x0 * y, x0 = x, y0 = y
        }

        var x00, y00, x0, y0;
        d3_geo_pathArea.point = function (x, y) {
            d3_geo_pathArea.point = nextPoint, x00 = x0 = x, y00 = y0 = y
        }, d3_geo_pathArea.lineEnd = function () {
            nextPoint(x00, y00)
        }
    }

    function d3_geo_pathBoundsPoint(x, y) {
        d3_geo_pathBoundsX0 > x && (d3_geo_pathBoundsX0 = x), x > d3_geo_pathBoundsX1 && (d3_geo_pathBoundsX1 = x), d3_geo_pathBoundsY0 > y && (d3_geo_pathBoundsY0 = y), y > d3_geo_pathBoundsY1 && (d3_geo_pathBoundsY1 = y)
    }

    function d3_geo_pathBuffer() {
        function point(x, y) {
            buffer.push("M", x, ",", y, pointCircle)
        }

        function pointLineStart(x, y) {
            buffer.push("M", x, ",", y), stream.point = pointLine
        }

        function pointLine(x, y) {
            buffer.push("L", x, ",", y)
        }

        function lineEnd() {
            stream.point = point
        }

        function lineEndPolygon() {
            buffer.push("Z")
        }

        var pointCircle = d3_geo_pathBufferCircle(4.5), buffer = [], stream = {point: point, lineStart: function () {
            stream.point = pointLineStart
        }, lineEnd: lineEnd, polygonStart: function () {
            stream.lineEnd = lineEndPolygon
        }, polygonEnd: function () {
            stream.lineEnd = lineEnd, stream.point = point
        }, pointRadius: function (_) {
            return pointCircle = d3_geo_pathBufferCircle(_), stream
        }, result: function () {
            if (buffer.length) {
                var result = buffer.join("");
                return buffer = [], result
            }
        }};
        return stream
    }

    function d3_geo_pathBufferCircle(radius) {
        return"m0," + radius + "a" + radius + "," + radius + " 0 1,1 0," + -2 * radius + "a" + radius + "," + radius + " 0 1,1 0," + 2 * radius + "z"
    }

    function d3_geo_pathCentroidPoint(x, y) {
        d3_geo_centroidX0 += x, d3_geo_centroidY0 += y, ++d3_geo_centroidZ0
    }

    function d3_geo_pathCentroidLineStart() {
        function nextPoint(x, y) {
            var dx = x - x0, dy = y - y0, z = Math.sqrt(dx * dx + dy * dy);
            d3_geo_centroidX1 += z * (x0 + x) / 2, d3_geo_centroidY1 += z * (y0 + y) / 2, d3_geo_centroidZ1 += z, d3_geo_pathCentroidPoint(x0 = x, y0 = y)
        }

        var x0, y0;
        d3_geo_pathCentroid.point = function (x, y) {
            d3_geo_pathCentroid.point = nextPoint, d3_geo_pathCentroidPoint(x0 = x, y0 = y)
        }
    }

    function d3_geo_pathCentroidLineEnd() {
        d3_geo_pathCentroid.point = d3_geo_pathCentroidPoint
    }

    function d3_geo_pathCentroidRingStart() {
        function nextPoint(x, y) {
            var dx = x - x0, dy = y - y0, z = Math.sqrt(dx * dx + dy * dy);
            d3_geo_centroidX1 += z * (x0 + x) / 2, d3_geo_centroidY1 += z * (y0 + y) / 2, d3_geo_centroidZ1 += z, z = y0 * x - x0 * y, d3_geo_centroidX2 += z * (x0 + x), d3_geo_centroidY2 += z * (y0 + y), d3_geo_centroidZ2 += 3 * z, d3_geo_pathCentroidPoint(x0 = x, y0 = y)
        }

        var x00, y00, x0, y0;
        d3_geo_pathCentroid.point = function (x, y) {
            d3_geo_pathCentroid.point = nextPoint, d3_geo_pathCentroidPoint(x00 = x0 = x, y00 = y0 = y)
        }, d3_geo_pathCentroid.lineEnd = function () {
            nextPoint(x00, y00)
        }
    }

    function d3_geo_pathContext(context) {
        function point(x, y) {
            context.moveTo(x, y), context.arc(x, y, pointRadius, 0, 2 * π)
        }

        function pointLineStart(x, y) {
            context.moveTo(x, y), stream.point = pointLine
        }

        function pointLine(x, y) {
            context.lineTo(x, y)
        }

        function lineEnd() {
            stream.point = point
        }

        function lineEndPolygon() {
            context.closePath()
        }

        var pointRadius = 4.5, stream = {point: point, lineStart: function () {
            stream.point = pointLineStart
        }, lineEnd: lineEnd, polygonStart: function () {
            stream.lineEnd = lineEndPolygon
        }, polygonEnd: function () {
            stream.lineEnd = lineEnd, stream.point = point
        }, pointRadius: function (_) {
            return pointRadius = _, stream
        }, result: d3_noop};
        return stream
    }

    function d3_geo_resample(project) {
        function resample(stream) {
            function point(x, y) {
                x = project(x, y), stream.point(x[0], x[1])
            }

            function lineStart() {
                x0 = 0 / 0, resample.point = linePoint, stream.lineStart()
            }

            function linePoint(λ, φ) {
                var c = d3_geo_cartesian([λ, φ]), p = project(λ, φ), buffer = [];
                resampleLineTo(x0, y0, λ0, a0, b0, c0, x0 = p[0], y0 = p[1], λ0 = λ, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, buffer), streamLine(buffer, stream), stream.point(x0, y0)
            }

            function lineEnd() {
                resample.point = point, stream.lineEnd()
            }

            function ringStart() {
                lineStart(), resample.point = ringPoint, resample.lineEnd = ringEnd
            }

            function ringPoint(λ, φ) {
                linePoint(λ00 = λ, φ00 = φ), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0, resample.point = linePoint
            }

            function ringEnd() {
                var buffer = [];
                resampleLineTo(x0, y0, λ0, a0, b0, c0, x00, y00, λ00, a00, b00, c00, maxDepth, buffer), streamLine(buffer, stream), resample.lineEnd = lineEnd, lineEnd()
            }

            function streamLine(line, stream) {
                for (var point, i = 0, n = line.length; n > i; ++i)stream.point((point = line[i])[0], point[1])
            }

            var λ00, φ00, x00, y00, a00, b00, c00, λ0, x0, y0, a0, b0, c0, resample = {point: point, lineStart: lineStart, lineEnd: lineEnd, polygonStart: function () {
                stream.polygonStart(), resample.lineStart = ringStart
            }, polygonEnd: function () {
                stream.polygonEnd(), resample.lineStart = lineStart
            }};
            return resample
        }

        function resampleLineTo(x0, y0, λ0, a0, b0, c0, x1, y1, λ1, a1, b1, c1, depth, buffer) {
            var dx = x1 - x0, dy = y1 - y0, d2 = dx * dx + dy * dy;
            if (d2 > 4 * δ2 && depth--) {
                var a = a0 + a1, b = b0 + b1, c = c0 + c1, m = Math.sqrt(a * a + b * b + c * c), φ2 = Math.asin(c /= m), λ2 = Math.abs(Math.abs(c) - 1) < ε ? (λ0 + λ1) / 2 : Math.atan2(b, a), p = project(λ2, φ2), x2 = p[0], y2 = p[1], dx2 = x2 - x0, dy2 = y2 - y0, dz = dy * dx2 - dx * dy2, tooFar = !1;
                if (dz * dz / d2 > δ2 || Math.abs((dx * dx2 + dy * dy2) / d2 - .5) > .3 || (tooFar = dx2 * dx2 + dy2 * dy2 > 256 * δ2)) {
                    var s0 = resampleLineTo(x0, y0, λ0, a0, b0, c0, x2, y2, λ2, a /= m, b /= m, c, depth, buffer);
                    buffer.push(p);
                    var s1 = resampleLineTo(x2, y2, λ2, a, b, c, x1, y1, λ1, a1, b1, c1, depth, buffer);
                    return!tooFar || s0 || s1 || (buffer.pop(), !1)
                }
            }
        }

        var δ2 = .5, maxDepth = 16;
        return resample.precision = function (_) {
            return arguments.length ? (maxDepth = (δ2 = _ * _) > 0 && 16, resample) : Math.sqrt(δ2)
        }, resample
    }

    function d3_geo_pathProjectStream(project) {
        var resample = d3_geo_resample(function (λ, φ) {
            return project([λ * d3_degrees, φ * d3_degrees])
        });
        return function (stream) {
            return stream = resample(stream), {point: function (λ, φ) {
                stream.point(λ * d3_radians, φ * d3_radians)
            }, sphere: function () {
                stream.sphere()
            }, lineStart: function () {
                stream.lineStart()
            }, lineEnd: function () {
                stream.lineEnd()
            }, polygonStart: function () {
                stream.polygonStart()
            }, polygonEnd: function () {
                stream.polygonEnd()
            }}
        }
    }

    function d3_geo_projection(project) {
        return d3_geo_projectionMutator(function () {
            return project
        })()
    }

    function d3_geo_projectionMutator(projectAt) {
        function projection(point) {
            return point = projectRotate(point[0] * d3_radians, point[1] * d3_radians), [point[0] * k + δx, δy - point[1] * k]
        }

        function invert(point) {
            return point = projectRotate.invert((point[0] - δx) / k, (δy - point[1]) / k), point && [point[0] * d3_degrees, point[1] * d3_degrees]
        }

        function reset() {
            projectRotate = d3_geo_compose(rotate = d3_geo_rotation(δλ, δφ, δγ), project);
            var center = project(λ, φ);
            return δx = x - center[0] * k, δy = y + center[1] * k, invalidate()
        }

        function invalidate() {
            return stream && (stream.valid = !1, stream = null), projection
        }

        var project, rotate, projectRotate, δx, δy, stream, projectResample = d3_geo_resample(function (x, y) {
            return x = project(x, y), [x[0] * k + δx, δy - x[1] * k]
        }), k = 150, x = 480, y = 250, λ = 0, φ = 0, δλ = 0, δφ = 0, δγ = 0, preclip = d3_geo_clipAntimeridian, postclip = d3_identity, clipAngle = null, clipExtent = null;
        return projection.stream = function (output) {
            return stream && (stream.valid = !1), stream = d3_geo_projectionRadiansRotate(rotate, preclip(projectResample(postclip(output)))), stream.valid = !0, stream
        }, projection.clipAngle = function (_) {
            return arguments.length ? (preclip = null == _ ? (clipAngle = _, d3_geo_clipAntimeridian) : d3_geo_clipCircle((clipAngle = +_) * d3_radians), invalidate()) : clipAngle
        }, projection.clipExtent = function (_) {
            return arguments.length ? (clipExtent = _, postclip = null == _ ? d3_identity : d3_geo_clipView(_[0][0], _[0][1], _[1][0], _[1][1]), invalidate()) : clipExtent
        }, projection.scale = function (_) {
            return arguments.length ? (k = +_, reset()) : k
        }, projection.translate = function (_) {
            return arguments.length ? (x = +_[0], y = +_[1], reset()) : [x, y]
        }, projection.center = function (_) {
            return arguments.length ? (λ = _[0] % 360 * d3_radians, φ = _[1] % 360 * d3_radians, reset()) : [λ * d3_degrees, φ * d3_degrees]
        }, projection.rotate = function (_) {
            return arguments.length ? (δλ = _[0] % 360 * d3_radians, δφ = _[1] % 360 * d3_radians, δγ = _.length > 2 ? _[2] % 360 * d3_radians : 0, reset()) : [δλ * d3_degrees, δφ * d3_degrees, δγ * d3_degrees]
        }, d3.rebind(projection, projectResample, "precision"), function () {
            return project = projectAt.apply(this, arguments), projection.invert = project.invert && invert, reset()
        }
    }

    function d3_geo_projectionRadiansRotate(rotate, stream) {
        return{point: function (x, y) {
            y = rotate(x * d3_radians, y * d3_radians), x = y[0], stream.point(x > π ? x - 2 * π : -π > x ? x + 2 * π : x, y[1])
        }, sphere: function () {
            stream.sphere()
        }, lineStart: function () {
            stream.lineStart()
        }, lineEnd: function () {
            stream.lineEnd()
        }, polygonStart: function () {
            stream.polygonStart()
        }, polygonEnd: function () {
            stream.polygonEnd()
        }}
    }

    function d3_geo_equirectangular(λ, φ) {
        return[λ, φ]
    }

    function d3_geo_rotation(δλ, δφ, δγ) {
        return δλ ? δφ || δγ ? d3_geo_compose(d3_geo_rotationλ(δλ), d3_geo_rotationφγ(δφ, δγ)) : d3_geo_rotationλ(δλ) : δφ || δγ ? d3_geo_rotationφγ(δφ, δγ) : d3_geo_equirectangular
    }

    function d3_geo_forwardRotationλ(δλ) {
        return function (λ, φ) {
            return λ += δλ, [λ > π ? λ - 2 * π : -π > λ ? λ + 2 * π : λ, φ]
        }
    }

    function d3_geo_rotationλ(δλ) {
        var rotation = d3_geo_forwardRotationλ(δλ);
        return rotation.invert = d3_geo_forwardRotationλ(-δλ), rotation
    }

    function d3_geo_rotationφγ(δφ, δγ) {
        function rotation(λ, φ) {
            var cosφ = Math.cos(φ), x = Math.cos(λ) * cosφ, y = Math.sin(λ) * cosφ, z = Math.sin(φ), k = z * cosδφ + x * sinδφ;
            return[Math.atan2(y * cosδγ - k * sinδγ, x * cosδφ - z * sinδφ), d3_asin(k * cosδγ + y * sinδγ)]
        }

        var cosδφ = Math.cos(δφ), sinδφ = Math.sin(δφ), cosδγ = Math.cos(δγ), sinδγ = Math.sin(δγ);
        return rotation.invert = function (λ, φ) {
            var cosφ = Math.cos(φ), x = Math.cos(λ) * cosφ, y = Math.sin(λ) * cosφ, z = Math.sin(φ), k = z * cosδγ - y * sinδγ;
            return[Math.atan2(y * cosδγ + z * sinδγ, x * cosδφ + k * sinδφ), d3_asin(k * cosδφ - x * sinδφ)]
        }, rotation
    }

    function d3_geo_circleInterpolate(radius, precision) {
        var cr = Math.cos(radius), sr = Math.sin(radius);
        return function (from, to, direction, listener) {
            null != from ? (from = d3_geo_circleAngle(cr, from), to = d3_geo_circleAngle(cr, to), (direction > 0 ? to > from : from > to) && (from += 2 * direction * π)) : (from = radius + 2 * direction * π, to = radius);
            for (var point, step = direction * precision, t = from; direction > 0 ? t > to : to > t; t -= step)listener.point((point = d3_geo_spherical([cr, -sr * Math.cos(t), -sr * Math.sin(t)]))[0], point[1])
        }
    }

    function d3_geo_circleAngle(cr, point) {
        var a = d3_geo_cartesian(point);
        a[0] -= cr, d3_geo_cartesianNormalize(a);
        var angle = d3_acos(-a[1]);
        return((-a[2] < 0 ? -angle : angle) + 2 * Math.PI - ε) % (2 * Math.PI)
    }

    function d3_geo_graticuleX(y0, y1, dy) {
        var y = d3.range(y0, y1 - ε, dy).concat(y1);
        return function (x) {
            return y.map(function (y) {
                return[x, y]
            })
        }
    }

    function d3_geo_graticuleY(x0, x1, dx) {
        var x = d3.range(x0, x1 - ε, dx).concat(x1);
        return function (y) {
            return x.map(function (x) {
                return[x, y]
            })
        }
    }

    function d3_source(d) {
        return d.source
    }

    function d3_target(d) {
        return d.target
    }

    function d3_geo_interpolate(x0, y0, x1, y1) {
        var cy0 = Math.cos(y0), sy0 = Math.sin(y0), cy1 = Math.cos(y1), sy1 = Math.sin(y1), kx0 = cy0 * Math.cos(x0), ky0 = cy0 * Math.sin(x0), kx1 = cy1 * Math.cos(x1), ky1 = cy1 * Math.sin(x1), d = 2 * Math.asin(Math.sqrt(d3_haversin(y1 - y0) + cy0 * cy1 * d3_haversin(x1 - x0))), k = 1 / Math.sin(d), interpolate = d ? function (t) {
            var B = Math.sin(t *= d) * k, A = Math.sin(d - t) * k, x = A * kx0 + B * kx1, y = A * ky0 + B * ky1, z = A * sy0 + B * sy1;
            return[Math.atan2(y, x) * d3_degrees, Math.atan2(z, Math.sqrt(x * x + y * y)) * d3_degrees]
        } : function () {
            return[x0 * d3_degrees, y0 * d3_degrees]
        };
        return interpolate.distance = d, interpolate
    }

    function d3_geo_lengthLineStart() {
        function nextPoint(λ, φ) {
            var sinφ = Math.sin(φ *= d3_radians), cosφ = Math.cos(φ), t = Math.abs((λ *= d3_radians) - λ0), cosΔλ = Math.cos(t);
            d3_geo_lengthSum += Math.atan2(Math.sqrt((t = cosφ * Math.sin(t)) * t + (t = cosφ0 * sinφ - sinφ0 * cosφ * cosΔλ) * t), sinφ0 * sinφ + cosφ0 * cosφ * cosΔλ), λ0 = λ, sinφ0 = sinφ, cosφ0 = cosφ
        }

        var λ0, sinφ0, cosφ0;
        d3_geo_length.point = function (λ, φ) {
            λ0 = λ * d3_radians, sinφ0 = Math.sin(φ *= d3_radians), cosφ0 = Math.cos(φ), d3_geo_length.point = nextPoint
        }, d3_geo_length.lineEnd = function () {
            d3_geo_length.point = d3_geo_length.lineEnd = d3_noop
        }
    }

    function d3_geo_azimuthal(scale, angle) {
        function azimuthal(λ, φ) {
            var cosλ = Math.cos(λ), cosφ = Math.cos(φ), k = scale(cosλ * cosφ);
            return[k * cosφ * Math.sin(λ), k * Math.sin(φ)]
        }

        return azimuthal.invert = function (x, y) {
            var ρ = Math.sqrt(x * x + y * y), c = angle(ρ), sinc = Math.sin(c), cosc = Math.cos(c);
            return[Math.atan2(x * sinc, ρ * cosc), Math.asin(ρ && y * sinc / ρ)]
        }, azimuthal
    }

    function d3_geo_conicConformal(φ0, φ1) {
        function forward(λ, φ) {
            var ρ = Math.abs(Math.abs(φ) - π / 2) < ε ? 0 : F / Math.pow(t(φ), n);
            return[ρ * Math.sin(n * λ), F - ρ * Math.cos(n * λ)]
        }

        var cosφ0 = Math.cos(φ0), t = function (φ) {
            return Math.tan(π / 4 + φ / 2)
        }, n = φ0 === φ1 ? Math.sin(φ0) : Math.log(cosφ0 / Math.cos(φ1)) / Math.log(t(φ1) / t(φ0)), F = cosφ0 * Math.pow(t(φ0), n) / n;
        return n ? (forward.invert = function (x, y) {
            var ρ0_y = F - y, ρ = d3_sgn(n) * Math.sqrt(x * x + ρ0_y * ρ0_y);
            return[Math.atan2(x, ρ0_y) / n, 2 * Math.atan(Math.pow(F / ρ, 1 / n)) - π / 2]
        }, forward) : d3_geo_mercator
    }

    function d3_geo_conicEquidistant(φ0, φ1) {
        function forward(λ, φ) {
            var ρ = G - φ;
            return[ρ * Math.sin(n * λ), G - ρ * Math.cos(n * λ)]
        }

        var cosφ0 = Math.cos(φ0), n = φ0 === φ1 ? Math.sin(φ0) : (cosφ0 - Math.cos(φ1)) / (φ1 - φ0), G = cosφ0 / n + φ0;
        return Math.abs(n) < ε ? d3_geo_equirectangular : (forward.invert = function (x, y) {
            var ρ0_y = G - y;
            return[Math.atan2(x, ρ0_y) / n, G - d3_sgn(n) * Math.sqrt(x * x + ρ0_y * ρ0_y)]
        }, forward)
    }

    function d3_geo_mercator(λ, φ) {
        return[λ, Math.log(Math.tan(π / 4 + φ / 2))]
    }

    function d3_geo_mercatorProjection(project) {
        var clipAuto, m = d3_geo_projection(project), scale = m.scale, translate = m.translate, clipExtent = m.clipExtent;
        return m.scale = function () {
            var v = scale.apply(m, arguments);
            return v === m ? clipAuto ? m.clipExtent(null) : m : v
        }, m.translate = function () {
            var v = translate.apply(m, arguments);
            return v === m ? clipAuto ? m.clipExtent(null) : m : v
        }, m.clipExtent = function (_) {
            var v = clipExtent.apply(m, arguments);
            if (v === m) {
                if (clipAuto = null == _) {
                    var k = π * scale(), t = translate();
                    clipExtent([
                        [t[0] - k, t[1] - k],
                        [t[0] + k, t[1] + k]
                    ])
                }
            } else clipAuto && (v = null);
            return v
        }, m.clipExtent(null)
    }

    function d3_geo_transverseMercator(λ, φ) {
        var B = Math.cos(φ) * Math.sin(λ);
        return[Math.log((1 + B) / (1 - B)) / 2, Math.atan2(Math.tan(φ), Math.cos(λ))]
    }

    function d3_svg_line(projection) {
        function line(data) {
            function segment() {
                segments.push("M", interpolate(projection(points), tension))
            }

            for (var d, segments = [], points = [], i = -1, n = data.length, fx = d3_functor(x), fy = d3_functor(y); ++i < n;)defined.call(this, d = data[i], i) ? points.push([+fx.call(this, d, i), +fy.call(this, d, i)]) : points.length && (segment(), points = []);
            return points.length && segment(), segments.length ? segments.join("") : null
        }

        var x = d3_svg_lineX, y = d3_svg_lineY, defined = d3_true, interpolate = d3_svg_lineLinear, interpolateKey = interpolate.key, tension = .7;
        return line.x = function (_) {
            return arguments.length ? (x = _, line) : x
        }, line.y = function (_) {
            return arguments.length ? (y = _, line) : y
        }, line.defined = function (_) {
            return arguments.length ? (defined = _, line) : defined
        }, line.interpolate = function (_) {
            return arguments.length ? (interpolateKey = "function" == typeof _ ? interpolate = _ : (interpolate = d3_svg_lineInterpolators.get(_) || d3_svg_lineLinear).key, line) : interpolateKey
        }, line.tension = function (_) {
            return arguments.length ? (tension = _, line) : tension
        }, line
    }

    function d3_svg_lineX(d) {
        return d[0]
    }

    function d3_svg_lineY(d) {
        return d[1]
    }

    function d3_svg_lineLinear(points) {
        return points.join("L")
    }

    function d3_svg_lineLinearClosed(points) {
        return d3_svg_lineLinear(points) + "Z"
    }

    function d3_svg_lineStep(points) {
        for (var i = 0, n = points.length, p = points[0], path = [p[0], ",", p[1]]; ++i < n;)path.push("H", (p[0] + (p = points[i])[0]) / 2, "V", p[1]);
        return n > 1 && path.push("H", p[0]), path.join("")
    }

    function d3_svg_lineStepBefore(points) {
        for (var i = 0, n = points.length, p = points[0], path = [p[0], ",", p[1]]; ++i < n;)path.push("V", (p = points[i])[1], "H", p[0]);
        return path.join("")
    }

    function d3_svg_lineStepAfter(points) {
        for (var i = 0, n = points.length, p = points[0], path = [p[0], ",", p[1]]; ++i < n;)path.push("H", (p = points[i])[0], "V", p[1]);
        return path.join("")
    }

    function d3_svg_lineCardinalOpen(points, tension) {
        return points.length < 4 ? d3_svg_lineLinear(points) : points[1] + d3_svg_lineHermite(points.slice(1, points.length - 1), d3_svg_lineCardinalTangents(points, tension))
    }

    function d3_svg_lineCardinalClosed(points, tension) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite((points.push(points[0]), points), d3_svg_lineCardinalTangents([points[points.length - 2]].concat(points, [points[1]]), tension))
    }

    function d3_svg_lineCardinal(points, tension) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite(points, d3_svg_lineCardinalTangents(points, tension))
    }

    function d3_svg_lineHermite(points, tangents) {
        if (tangents.length < 1 || points.length != tangents.length && points.length != tangents.length + 2)return d3_svg_lineLinear(points);
        var quad = points.length != tangents.length, path = "", p0 = points[0], p = points[1], t0 = tangents[0], t = t0, pi = 1;
        if (quad && (path += "Q" + (p[0] - 2 * t0[0] / 3) + "," + (p[1] - 2 * t0[1] / 3) + "," + p[0] + "," + p[1], p0 = points[1], pi = 2), tangents.length > 1) {
            t = tangents[1], p = points[pi], pi++, path += "C" + (p0[0] + t0[0]) + "," + (p0[1] + t0[1]) + "," + (p[0] - t[0]) + "," + (p[1] - t[1]) + "," + p[0] + "," + p[1];
            for (var i = 2; i < tangents.length; i++, pi++)p = points[pi], t = tangents[i], path += "S" + (p[0] - t[0]) + "," + (p[1] - t[1]) + "," + p[0] + "," + p[1]
        }
        if (quad) {
            var lp = points[pi];
            path += "Q" + (p[0] + 2 * t[0] / 3) + "," + (p[1] + 2 * t[1] / 3) + "," + lp[0] + "," + lp[1]
        }
        return path
    }

    function d3_svg_lineCardinalTangents(points, tension) {
        for (var p0, tangents = [], a = (1 - tension) / 2, p1 = points[0], p2 = points[1], i = 1, n = points.length; ++i < n;)p0 = p1, p1 = p2, p2 = points[i], tangents.push([a * (p2[0] - p0[0]), a * (p2[1] - p0[1])]);
        return tangents
    }

    function d3_svg_lineBasis(points) {
        if (points.length < 3)return d3_svg_lineLinear(points);
        var i = 1, n = points.length, pi = points[0], x0 = pi[0], y0 = pi[1], px = [x0, x0, x0, (pi = points[1])[0]], py = [y0, y0, y0, pi[1]], path = [x0, ",", y0];
        for (d3_svg_lineBasisBezier(path, px, py); ++i < n;)pi = points[i], px.shift(), px.push(pi[0]), py.shift(), py.push(pi[1]), d3_svg_lineBasisBezier(path, px, py);
        for (i = -1; ++i < 2;)px.shift(), px.push(pi[0]), py.shift(), py.push(pi[1]), d3_svg_lineBasisBezier(path, px, py);
        return path.join("")
    }

    function d3_svg_lineBasisOpen(points) {
        if (points.length < 4)return d3_svg_lineLinear(points);
        for (var pi, path = [], i = -1, n = points.length, px = [0], py = [0]; ++i < 3;)pi = points[i], px.push(pi[0]), py.push(pi[1]);
        for (path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3, px) + "," + d3_svg_lineDot4(d3_svg_lineBasisBezier3, py)), --i; ++i < n;)pi = points[i], px.shift(), px.push(pi[0]), py.shift(), py.push(pi[1]), d3_svg_lineBasisBezier(path, px, py);
        return path.join("")
    }

    function d3_svg_lineBasisClosed(points) {
        for (var path, pi, i = -1, n = points.length, m = n + 4, px = [], py = []; ++i < 4;)pi = points[i % n], px.push(pi[0]), py.push(pi[1]);
        for (path = [d3_svg_lineDot4(d3_svg_lineBasisBezier3, px), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, py)], --i; ++i < m;)pi = points[i % n], px.shift(), px.push(pi[0]), py.shift(), py.push(pi[1]), d3_svg_lineBasisBezier(path, px, py);
        return path.join("")
    }

    function d3_svg_lineBundle(points, tension) {
        var n = points.length - 1;
        if (n)for (var p, t, x0 = points[0][0], y0 = points[0][1], dx = points[n][0] - x0, dy = points[n][1] - y0, i = -1; ++i <= n;)p = points[i], t = i / n, p[0] = tension * p[0] + (1 - tension) * (x0 + t * dx), p[1] = tension * p[1] + (1 - tension) * (y0 + t * dy);
        return d3_svg_lineBasis(points)
    }

    function d3_svg_lineDot4(a, b) {
        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3]
    }

    function d3_svg_lineBasisBezier(path, x, y) {
        path.push("C", d3_svg_lineDot4(d3_svg_lineBasisBezier1, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier1, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier2, y), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, x), ",", d3_svg_lineDot4(d3_svg_lineBasisBezier3, y))
    }

    function d3_svg_lineSlope(p0, p1) {
        return(p1[1] - p0[1]) / (p1[0] - p0[0])
    }

    function d3_svg_lineFiniteDifferences(points) {
        for (var i = 0, j = points.length - 1, m = [], p0 = points[0], p1 = points[1], d = m[0] = d3_svg_lineSlope(p0, p1); ++i < j;)m[i] = (d + (d = d3_svg_lineSlope(p0 = p1, p1 = points[i + 1]))) / 2;
        return m[i] = d, m
    }

    function d3_svg_lineMonotoneTangents(points) {
        for (var d, a, b, s, tangents = [], m = d3_svg_lineFiniteDifferences(points), i = -1, j = points.length - 1; ++i < j;)d = d3_svg_lineSlope(points[i], points[i + 1]), Math.abs(d) < 1e-6 ? m[i] = m[i + 1] = 0 : (a = m[i] / d, b = m[i + 1] / d, s = a * a + b * b, s > 9 && (s = 3 * d / Math.sqrt(s), m[i] = s * a, m[i + 1] = s * b));
        for (i = -1; ++i <= j;)s = (points[Math.min(j, i + 1)][0] - points[Math.max(0, i - 1)][0]) / (6 * (1 + m[i] * m[i])), tangents.push([s || 0, m[i] * s || 0]);
        return tangents
    }

    function d3_svg_lineMonotone(points) {
        return points.length < 3 ? d3_svg_lineLinear(points) : points[0] + d3_svg_lineHermite(points, d3_svg_lineMonotoneTangents(points))
    }

    function d3_geom_hullCCW(i1, i2, i3, v) {
        var t, a, b, c, d, e, f;
        return t = v[i1], a = t[0], b = t[1], t = v[i2], c = t[0], d = t[1], t = v[i3], e = t[0], f = t[1], (f - b) * (c - a) - (d - b) * (e - a) > 0
    }

    function d3_geom_polygonInside(p, a, b) {
        return(b[0] - a[0]) * (p[1] - a[1]) < (b[1] - a[1]) * (p[0] - a[0])
    }

    function d3_geom_polygonIntersect(c, d, a, b) {
        var x1 = c[0], x3 = a[0], x21 = d[0] - x1, x43 = b[0] - x3, y1 = c[1], y3 = a[1], y21 = d[1] - y1, y43 = b[1] - y3, ua = (x43 * (y1 - y3) - y43 * (x1 - x3)) / (y43 * x21 - x43 * y21);
        return[x1 + ua * x21, y1 + ua * y21]
    }

    function d3_geom_voronoiTessellate(points, callback) {
        var Sites = {list: points.map(function (v, i) {
            return{index: i, x: v[0], y: v[1]}
        }).sort(function (a, b) {
            return a.y < b.y ? -1 : a.y > b.y ? 1 : a.x < b.x ? -1 : a.x > b.x ? 1 : 0
        }), bottomSite: null}, EdgeList = {list: [], leftEnd: null, rightEnd: null, init: function () {
            EdgeList.leftEnd = EdgeList.createHalfEdge(null, "l"), EdgeList.rightEnd = EdgeList.createHalfEdge(null, "l"), EdgeList.leftEnd.r = EdgeList.rightEnd, EdgeList.rightEnd.l = EdgeList.leftEnd, EdgeList.list.unshift(EdgeList.leftEnd, EdgeList.rightEnd)
        }, createHalfEdge: function (edge, side) {
            return{edge: edge, side: side, vertex: null, l: null, r: null}
        }, insert: function (lb, he) {
            he.l = lb, he.r = lb.r, lb.r.l = he, lb.r = he
        }, leftBound: function (p) {
            var he = EdgeList.leftEnd;
            do he = he.r; while (he != EdgeList.rightEnd && Geom.rightOf(he, p));
            return he = he.l
        }, del: function (he) {
            he.l.r = he.r, he.r.l = he.l, he.edge = null
        }, right: function (he) {
            return he.r
        }, left: function (he) {
            return he.l
        }, leftRegion: function (he) {
            return null == he.edge ? Sites.bottomSite : he.edge.region[he.side]
        }, rightRegion: function (he) {
            return null == he.edge ? Sites.bottomSite : he.edge.region[d3_geom_voronoiOpposite[he.side]]
        }}, Geom = {bisect: function (s1, s2) {
            var newEdge = {region: {l: s1, r: s2}, ep: {l: null, r: null}}, dx = s2.x - s1.x, dy = s2.y - s1.y, adx = dx > 0 ? dx : -dx, ady = dy > 0 ? dy : -dy;
            return newEdge.c = s1.x * dx + s1.y * dy + .5 * (dx * dx + dy * dy), adx > ady ? (newEdge.a = 1, newEdge.b = dy / dx, newEdge.c /= dx) : (newEdge.b = 1, newEdge.a = dx / dy, newEdge.c /= dy), newEdge
        }, intersect: function (el1, el2) {
            var e1 = el1.edge, e2 = el2.edge;
            if (!e1 || !e2 || e1.region.r == e2.region.r)return null;
            var d = e1.a * e2.b - e1.b * e2.a;
            if (Math.abs(d) < 1e-10)return null;
            var el, e, xint = (e1.c * e2.b - e2.c * e1.b) / d, yint = (e2.c * e1.a - e1.c * e2.a) / d, e1r = e1.region.r, e2r = e2.region.r;
            e1r.y < e2r.y || e1r.y == e2r.y && e1r.x < e2r.x ? (el = el1, e = e1) : (el = el2, e = e2);
            var rightOfSite = xint >= e.region.r.x;
            return rightOfSite && "l" === el.side || !rightOfSite && "r" === el.side ? null : {x: xint, y: yint}
        }, rightOf: function (he, p) {
            var e = he.edge, topsite = e.region.r, rightOfSite = p.x > topsite.x;
            if (rightOfSite && "l" === he.side)return 1;
            if (!rightOfSite && "r" === he.side)return 0;
            if (1 === e.a) {
                var dyp = p.y - topsite.y, dxp = p.x - topsite.x, fast = 0, above = 0;
                if (!rightOfSite && e.b < 0 || rightOfSite && e.b >= 0 ? above = fast = dyp >= e.b * dxp : (above = p.x + p.y * e.b > e.c, e.b < 0 && (above = !above), above || (fast = 1)), !fast) {
                    var dxs = topsite.x - e.region.l.x;
                    above = e.b * (dxp * dxp - dyp * dyp) < dxs * dyp * (1 + 2 * dxp / dxs + e.b * e.b), e.b < 0 && (above = !above)
                }
            } else {
                var yl = e.c - e.a * p.x, t1 = p.y - yl, t2 = p.x - topsite.x, t3 = yl - topsite.y;
                above = t1 * t1 > t2 * t2 + t3 * t3
            }
            return"l" === he.side ? above : !above
        }, endPoint: function (edge, side, site) {
            edge.ep[side] = site, edge.ep[d3_geom_voronoiOpposite[side]] && callback(edge)
        }, distance: function (s, t) {
            var dx = s.x - t.x, dy = s.y - t.y;
            return Math.sqrt(dx * dx + dy * dy)
        }}, EventQueue = {list: [], insert: function (he, site, offset) {
            he.vertex = site, he.ystar = site.y + offset;
            for (var i = 0, list = EventQueue.list, l = list.length; l > i; i++) {
                var next = list[i];
                if (!(he.ystar > next.ystar || he.ystar == next.ystar && site.x > next.vertex.x))break
            }
            list.splice(i, 0, he)
        }, del: function (he) {
            for (var i = 0, ls = EventQueue.list, l = ls.length; l > i && ls[i] != he; ++i);
            ls.splice(i, 1)
        }, empty: function () {
            return 0 === EventQueue.list.length
        }, nextEvent: function (he) {
            for (var i = 0, ls = EventQueue.list, l = ls.length; l > i; ++i)if (ls[i] == he)return ls[i + 1];
            return null
        }, min: function () {
            var elem = EventQueue.list[0];
            return{x: elem.vertex.x, y: elem.ystar}
        }, extractMin: function () {
            return EventQueue.list.shift()
        }};
        EdgeList.init(), Sites.bottomSite = Sites.list.shift();
        for (var newIntStar, lbnd, rbnd, llbnd, rrbnd, bisector, bot, top, temp, p, v, e, pm, newSite = Sites.list.shift(); ;)if (EventQueue.empty() || (newIntStar = EventQueue.min()), newSite && (EventQueue.empty() || newSite.y < newIntStar.y || newSite.y == newIntStar.y && newSite.x < newIntStar.x))lbnd = EdgeList.leftBound(newSite), rbnd = EdgeList.right(lbnd), bot = EdgeList.rightRegion(lbnd), e = Geom.bisect(bot, newSite), bisector = EdgeList.createHalfEdge(e, "l"), EdgeList.insert(lbnd, bisector), p = Geom.intersect(lbnd, bisector), p && (EventQueue.del(lbnd), EventQueue.insert(lbnd, p, Geom.distance(p, newSite))), lbnd = bisector, bisector = EdgeList.createHalfEdge(e, "r"), EdgeList.insert(lbnd, bisector), p = Geom.intersect(bisector, rbnd), p && EventQueue.insert(bisector, p, Geom.distance(p, newSite)), newSite = Sites.list.shift(); else {
            if (EventQueue.empty())break;
            lbnd = EventQueue.extractMin(), llbnd = EdgeList.left(lbnd), rbnd = EdgeList.right(lbnd), rrbnd = EdgeList.right(rbnd), bot = EdgeList.leftRegion(lbnd), top = EdgeList.rightRegion(rbnd), v = lbnd.vertex, Geom.endPoint(lbnd.edge, lbnd.side, v), Geom.endPoint(rbnd.edge, rbnd.side, v), EdgeList.del(lbnd), EventQueue.del(rbnd), EdgeList.del(rbnd), pm = "l", bot.y > top.y && (temp = bot, bot = top, top = temp, pm = "r"), e = Geom.bisect(bot, top), bisector = EdgeList.createHalfEdge(e, pm), EdgeList.insert(llbnd, bisector), Geom.endPoint(e, d3_geom_voronoiOpposite[pm], v), p = Geom.intersect(llbnd, bisector), p && (EventQueue.del(llbnd), EventQueue.insert(llbnd, p, Geom.distance(p, bot))), p = Geom.intersect(bisector, rrbnd), p && EventQueue.insert(bisector, p, Geom.distance(p, bot))
        }
        for (lbnd = EdgeList.right(EdgeList.leftEnd); lbnd != EdgeList.rightEnd; lbnd = EdgeList.right(lbnd))callback(lbnd.edge)
    }

    function d3_geom_quadtreeCompatX(d) {
        return d.x
    }

    function d3_geom_quadtreeCompatY(d) {
        return d.y
    }

    function d3_geom_quadtreeNode() {
        return{leaf: !0, nodes: [], point: null, x: null, y: null}
    }

    function d3_geom_quadtreeVisit(f, node, x1, y1, x2, y2) {
        if (!f(node, x1, y1, x2, y2)) {
            var sx = .5 * (x1 + x2), sy = .5 * (y1 + y2), children = node.nodes;
            children[0] && d3_geom_quadtreeVisit(f, children[0], x1, y1, sx, sy), children[1] && d3_geom_quadtreeVisit(f, children[1], sx, y1, x2, sy), children[2] && d3_geom_quadtreeVisit(f, children[2], x1, sy, sx, y2), children[3] && d3_geom_quadtreeVisit(f, children[3], sx, sy, x2, y2)
        }
    }

    function d3_interpolateRgb(a, b) {
        a = d3.rgb(a), b = d3.rgb(b);
        var ar = a.r, ag = a.g, ab = a.b, br = b.r - ar, bg = b.g - ag, bb = b.b - ab;
        return function (t) {
            return"#" + d3_rgb_hex(Math.round(ar + br * t)) + d3_rgb_hex(Math.round(ag + bg * t)) + d3_rgb_hex(Math.round(ab + bb * t))
        }
    }

    function d3_transform(m) {
        var r0 = [m.a, m.b], r1 = [m.c, m.d], kx = d3_transformNormalize(r0), kz = d3_transformDot(r0, r1), ky = d3_transformNormalize(d3_transformCombine(r1, r0, -kz)) || 0;
        r0[0] * r1[1] < r1[0] * r0[1] && (r0[0] *= -1, r0[1] *= -1, kx *= -1, kz *= -1), this.rotate = (kx ? Math.atan2(r0[1], r0[0]) : Math.atan2(-r1[0], r1[1])) * d3_degrees, this.translate = [m.e, m.f], this.scale = [kx, ky], this.skew = ky ? Math.atan2(kz, ky) * d3_degrees : 0
    }

    function d3_transformDot(a, b) {
        return a[0] * b[0] + a[1] * b[1]
    }

    function d3_transformNormalize(a) {
        var k = Math.sqrt(d3_transformDot(a, a));
        return k && (a[0] /= k, a[1] /= k), k
    }

    function d3_transformCombine(a, b, k) {
        return a[0] += k * b[0], a[1] += k * b[1], a
    }

    function d3_interpolateNumber(a, b) {
        return b -= a = +a, function (t) {
            return a + b * t
        }
    }

    function d3_interpolateTransform(a, b) {
        var n, s = [], q = [], A = d3.transform(a), B = d3.transform(b), ta = A.translate, tb = B.translate, ra = A.rotate, rb = B.rotate, wa = A.skew, wb = B.skew, ka = A.scale, kb = B.scale;
        return ta[0] != tb[0] || ta[1] != tb[1] ? (s.push("translate(", null, ",", null, ")"), q.push({i: 1, x: d3_interpolateNumber(ta[0], tb[0])}, {i: 3, x: d3_interpolateNumber(ta[1], tb[1])})) : tb[0] || tb[1] ? s.push("translate(" + tb + ")") : s.push(""), ra != rb ? (ra - rb > 180 ? rb += 360 : rb - ra > 180 && (ra += 360), q.push({i: s.push(s.pop() + "rotate(", null, ")") - 2, x: d3_interpolateNumber(ra, rb)})) : rb && s.push(s.pop() + "rotate(" + rb + ")"), wa != wb ? q.push({i: s.push(s.pop() + "skewX(", null, ")") - 2, x: d3_interpolateNumber(wa, wb)}) : wb && s.push(s.pop() + "skewX(" + wb + ")"), ka[0] != kb[0] || ka[1] != kb[1] ? (n = s.push(s.pop() + "scale(", null, ",", null, ")"), q.push({i: n - 4, x: d3_interpolateNumber(ka[0], kb[0])}, {i: n - 2, x: d3_interpolateNumber(ka[1], kb[1])})) : (1 != kb[0] || 1 != kb[1]) && s.push(s.pop() + "scale(" + kb + ")"), n = q.length, function (t) {
            for (var o, i = -1; ++i < n;)s[(o = q[i]).i] = o.x(t);
            return s.join("")
        }
    }

    function d3_interpolateObject(a, b) {
        var k, i = {}, c = {};
        for (k in a)k in b ? i[k] = d3_interpolateByName(k)(a[k], b[k]) : c[k] = a[k];
        for (k in b)k in a || (c[k] = b[k]);
        return function (t) {
            for (k in i)c[k] = i[k](t);
            return c
        }
    }

    function d3_interpolateString(a, b) {
        var m, i, j, n, o, s0 = 0, s1 = 0, s = [], q = [];
        for (a += "", b += "", d3_interpolate_number.lastIndex = 0, i = 0; m = d3_interpolate_number.exec(b); ++i)m.index && s.push(b.substring(s0, s1 = m.index)), q.push({i: s.length, x: m[0]}), s.push(null), s0 = d3_interpolate_number.lastIndex;
        for (s0 < b.length && s.push(b.substring(s0)), i = 0, n = q.length; (m = d3_interpolate_number.exec(a)) && n > i; ++i)if (o = q[i], o.x == m[0]) {
            if (o.i)if (null == s[o.i + 1])for (s[o.i - 1] += o.x, s.splice(o.i, 1), j = i + 1; n > j; ++j)q[j].i--; else for (s[o.i - 1] += o.x + s[o.i + 1], s.splice(o.i, 2), j = i + 1; n > j; ++j)q[j].i -= 2; else if (null == s[o.i + 1])s[o.i] = o.x; else for (s[o.i] = o.x + s[o.i + 1], s.splice(o.i + 1, 1), j = i + 1; n > j; ++j)q[j].i--;
            q.splice(i, 1), n--, i--
        } else o.x = d3_interpolateNumber(parseFloat(m[0]), parseFloat(o.x));
        for (; n > i;)o = q.pop(), null == s[o.i + 1] ? s[o.i] = o.x : (s[o.i] = o.x + s[o.i + 1], s.splice(o.i + 1, 1)), n--;
        return 1 === s.length ? null == s[0] ? (o = q[0].x, function (t) {
            return o(t) + ""
        }) : function () {
            return b
        } : function (t) {
            for (i = 0; n > i; ++i)s[(o = q[i]).i] = o.x(t);
            return s.join("")
        }
    }

    function d3_interpolate(a, b) {
        for (var f, i = d3.interpolators.length; --i >= 0 && !(f = d3.interpolators[i](a, b)););
        return f
    }

    function d3_interpolateByName(name) {
        return"transform" == name ? d3_interpolateTransform : d3_interpolate
    }

    function d3_interpolateArray(a, b) {
        var i, x = [], c = [], na = a.length, nb = b.length, n0 = Math.min(a.length, b.length);
        for (i = 0; n0 > i; ++i)x.push(d3_interpolate(a[i], b[i]));
        for (; na > i; ++i)c[i] = a[i];
        for (; nb > i; ++i)c[i] = b[i];
        return function (t) {
            for (i = 0; n0 > i; ++i)c[i] = x[i](t);
            return c
        }
    }

    function d3_ease_clamp(f) {
        return function (t) {
            return 0 >= t ? 0 : t >= 1 ? 1 : f(t)
        }
    }

    function d3_ease_reverse(f) {
        return function (t) {
            return 1 - f(1 - t)
        }
    }

    function d3_ease_reflect(f) {
        return function (t) {
            return.5 * (.5 > t ? f(2 * t) : 2 - f(2 - 2 * t))
        }
    }

    function d3_ease_quad(t) {
        return t * t
    }

    function d3_ease_cubic(t) {
        return t * t * t
    }

    function d3_ease_cubicInOut(t) {
        if (0 >= t)return 0;
        if (t >= 1)return 1;
        var t2 = t * t, t3 = t2 * t;
        return 4 * (.5 > t ? t3 : 3 * (t - t2) + t3 - .75)
    }

    function d3_ease_poly(e) {
        return function (t) {
            return Math.pow(t, e)
        }
    }

    function d3_ease_sin(t) {
        return 1 - Math.cos(t * π / 2)
    }

    function d3_ease_exp(t) {
        return Math.pow(2, 10 * (t - 1))
    }

    function d3_ease_circle(t) {
        return 1 - Math.sqrt(1 - t * t)
    }

    function d3_ease_elastic(a, p) {
        var s;
        return arguments.length < 2 && (p = .45), arguments.length ? s = p / (2 * π) * Math.asin(1 / a) : (a = 1, s = p / 4), function (t) {
            return 1 + a * Math.pow(2, 10 * -t) * Math.sin(2 * (t - s) * π / p)
        }
    }

    function d3_ease_back(s) {
        return s || (s = 1.70158), function (t) {
            return t * t * ((s + 1) * t - s)
        }
    }

    function d3_ease_bounce(t) {
        return 1 / 2.75 > t ? 7.5625 * t * t : 2 / 2.75 > t ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : 2.5 / 2.75 > t ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375
    }

    function d3_interpolateHcl(a, b) {
        a = d3.hcl(a), b = d3.hcl(b);
        var ah = a.h, ac = a.c, al = a.l, bh = b.h - ah, bc = b.c - ac, bl = b.l - al;
        return isNaN(bc) && (bc = 0, ac = isNaN(ac) ? b.c : ac), isNaN(bh) ? (bh = 0, ah = isNaN(ah) ? b.h : ah) : bh > 180 ? bh -= 360 : -180 > bh && (bh += 360), function (t) {
            return d3_hcl_lab(ah + bh * t, ac + bc * t, al + bl * t) + ""
        }
    }

    function d3_interpolateHsl(a, b) {
        a = d3.hsl(a), b = d3.hsl(b);
        var ah = a.h, as = a.s, al = a.l, bh = b.h - ah, bs = b.s - as, bl = b.l - al;
        return isNaN(bs) && (bs = 0, as = isNaN(as) ? b.s : as), isNaN(bh) ? (bh = 0, ah = isNaN(ah) ? b.h : ah) : bh > 180 ? bh -= 360 : -180 > bh && (bh += 360), function (t) {
            return d3_hsl_rgb(ah + bh * t, as + bs * t, al + bl * t) + ""
        }
    }

    function d3_interpolateLab(a, b) {
        a = d3.lab(a), b = d3.lab(b);
        var al = a.l, aa = a.a, ab = a.b, bl = b.l - al, ba = b.a - aa, bb = b.b - ab;
        return function (t) {
            return d3_lab_rgb(al + bl * t, aa + ba * t, ab + bb * t) + ""
        }
    }

    function d3_interpolateRound(a, b) {
        return b -= a, function (t) {
            return Math.round(a + b * t)
        }
    }

    function d3_uninterpolateNumber(a, b) {
        return b = b - (a = +a) ? 1 / (b - a) : 0, function (x) {
            return(x - a) * b
        }
    }

    function d3_uninterpolateClamp(a, b) {
        return b = b - (a = +a) ? 1 / (b - a) : 0, function (x) {
            return Math.max(0, Math.min(1, (x - a) * b))
        }
    }

    function d3_layout_bundlePath(link) {
        for (var start = link.source, end = link.target, lca = d3_layout_bundleLeastCommonAncestor(start, end), points = [start]; start !== lca;)start = start.parent, points.push(start);
        for (var k = points.length; end !== lca;)points.splice(k, 0, end), end = end.parent;
        return points
    }

    function d3_layout_bundleAncestors(node) {
        for (var ancestors = [], parent = node.parent; null != parent;)ancestors.push(node), node = parent, parent = parent.parent;
        return ancestors.push(node), ancestors
    }

    function d3_layout_bundleLeastCommonAncestor(a, b) {
        if (a === b)return a;
        for (var aNodes = d3_layout_bundleAncestors(a), bNodes = d3_layout_bundleAncestors(b), aNode = aNodes.pop(), bNode = bNodes.pop(), sharedNode = null; aNode === bNode;)sharedNode = aNode, aNode = aNodes.pop(), bNode = bNodes.pop();
        return sharedNode
    }

    function d3_layout_forceDragstart(d) {
        d.fixed |= 2
    }

    function d3_layout_forceDragend(d) {
        d.fixed &= -7
    }

    function d3_layout_forceMouseover(d) {
        d.fixed |= 4, d.px = d.x, d.py = d.y
    }

    function d3_layout_forceMouseout(d) {
        d.fixed &= -5
    }

    function d3_layout_forceAccumulate(quad, alpha, charges) {
        var cx = 0, cy = 0;
        if (quad.charge = 0, !quad.leaf)for (var c, nodes = quad.nodes, n = nodes.length, i = -1; ++i < n;)c = nodes[i], null != c && (d3_layout_forceAccumulate(c, alpha, charges), quad.charge += c.charge, cx += c.charge * c.cx, cy += c.charge * c.cy);
        if (quad.point) {
            quad.leaf || (quad.point.x += Math.random() - .5, quad.point.y += Math.random() - .5);
            var k = alpha * charges[quad.point.index];
            quad.charge += quad.pointCharge = k, cx += k * quad.point.x, cy += k * quad.point.y
        }
        quad.cx = cx / quad.charge, quad.cy = cy / quad.charge
    }

    function d3_layout_hierarchyRebind(object, hierarchy) {
        return d3.rebind(object, hierarchy, "sort", "children", "value"), object.nodes = object, object.links = d3_layout_hierarchyLinks, object
    }

    function d3_layout_hierarchyChildren(d) {
        return d.children
    }

    function d3_layout_hierarchyValue(d) {
        return d.value
    }

    function d3_layout_hierarchySort(a, b) {
        return b.value - a.value
    }

    function d3_layout_hierarchyLinks(nodes) {
        return d3.merge(nodes.map(function (parent) {
            return(parent.children || []).map(function (child) {
                return{source: parent, target: child}
            })
        }))
    }

    function d3_layout_stackX(d) {
        return d.x
    }

    function d3_layout_stackY(d) {
        return d.y
    }

    function d3_layout_stackOut(d, y0, y) {
        d.y0 = y0, d.y = y
    }

    function d3_layout_stackOrderDefault(data) {
        return d3.range(data.length)
    }

    function d3_layout_stackOffsetZero(data) {
        for (var j = -1, m = data[0].length, y0 = []; ++j < m;)y0[j] = 0;
        return y0
    }

    function d3_layout_stackMaxIndex(array) {
        for (var k, i = 1, j = 0, v = array[0][1], n = array.length; n > i; ++i)(k = array[i][1]) > v && (j = i, v = k);
        return j
    }

    function d3_layout_stackReduceSum(d) {
        return d.reduce(d3_layout_stackSum, 0)
    }

    function d3_layout_stackSum(p, d) {
        return p + d[1]
    }

    function d3_layout_histogramBinSturges(range, values) {
        return d3_layout_histogramBinFixed(range, Math.ceil(Math.log(values.length) / Math.LN2 + 1))
    }

    function d3_layout_histogramBinFixed(range, n) {
        for (var x = -1, b = +range[0], m = (range[1] - b) / n, f = []; ++x <= n;)f[x] = m * x + b;
        return f
    }

    function d3_layout_histogramRange(values) {
        return[d3.min(values), d3.max(values)]
    }

    function d3_layout_treeSeparation(a, b) {
        return a.parent == b.parent ? 1 : 2
    }

    function d3_layout_treeLeft(node) {
        var children = node.children;
        return children && children.length ? children[0] : node._tree.thread
    }

    function d3_layout_treeRight(node) {
        var n, children = node.children;
        return children && (n = children.length) ? children[n - 1] : node._tree.thread
    }

    function d3_layout_treeSearch(node, compare) {
        var children = node.children;
        if (children && (n = children.length))for (var child, n, i = -1; ++i < n;)compare(child = d3_layout_treeSearch(children[i], compare), node) > 0 && (node = child);
        return node
    }

    function d3_layout_treeRightmost(a, b) {
        return a.x - b.x
    }

    function d3_layout_treeLeftmost(a, b) {
        return b.x - a.x
    }

    function d3_layout_treeDeepest(a, b) {
        return a.depth - b.depth
    }

    function d3_layout_treeVisitAfter(node, callback) {
        function visit(node, previousSibling) {
            var children = node.children;
            if (children && (n = children.length))for (var child, n, previousChild = null, i = -1; ++i < n;)child = children[i], visit(child, previousChild), previousChild = child;
            callback(node, previousSibling)
        }

        visit(node, null)
    }

    function d3_layout_treeShift(node) {
        for (var child, shift = 0, change = 0, children = node.children, i = children.length; --i >= 0;)child = children[i]._tree, child.prelim += shift, child.mod += shift, shift += child.shift + (change += child.change)
    }

    function d3_layout_treeMove(ancestor, node, shift) {
        ancestor = ancestor._tree, node = node._tree;
        var change = shift / (node.number - ancestor.number);
        ancestor.change += change, node.change -= change, node.shift += shift, node.prelim += shift, node.mod += shift
    }

    function d3_layout_treeAncestor(vim, node, ancestor) {
        return vim._tree.ancestor.parent == node.parent ? vim._tree.ancestor : ancestor
    }

    function d3_layout_packSort(a, b) {
        return a.value - b.value
    }

    function d3_layout_packInsert(a, b) {
        var c = a._pack_next;
        a._pack_next = b, b._pack_prev = a, b._pack_next = c, c._pack_prev = b
    }

    function d3_layout_packSplice(a, b) {
        a._pack_next = b, b._pack_prev = a
    }

    function d3_layout_packIntersects(a, b) {
        var dx = b.x - a.x, dy = b.y - a.y, dr = a.r + b.r;
        return.999 * dr * dr > dx * dx + dy * dy
    }

    function d3_layout_packSiblings(node) {
        function bound(node) {
            xMin = Math.min(node.x - node.r, xMin), xMax = Math.max(node.x + node.r, xMax), yMin = Math.min(node.y - node.r, yMin), yMax = Math.max(node.y + node.r, yMax)
        }

        if ((nodes = node.children) && (n = nodes.length)) {
            var nodes, a, b, c, i, j, k, n, xMin = 1 / 0, xMax = -1 / 0, yMin = 1 / 0, yMax = -1 / 0;
            if (nodes.forEach(d3_layout_packLink), a = nodes[0], a.x = -a.r, a.y = 0, bound(a), n > 1 && (b = nodes[1], b.x = b.r, b.y = 0, bound(b), n > 2))for (c = nodes[2], d3_layout_packPlace(a, b, c), bound(c), d3_layout_packInsert(a, c), a._pack_prev = c, d3_layout_packInsert(c, b), b = a._pack_next, i = 3; n > i; i++) {
                d3_layout_packPlace(a, b, c = nodes[i]);
                var isect = 0, s1 = 1, s2 = 1;
                for (j = b._pack_next; j !== b; j = j._pack_next, s1++)if (d3_layout_packIntersects(j, c)) {
                    isect = 1;
                    break
                }
                if (1 == isect)for (k = a._pack_prev; k !== j._pack_prev && !d3_layout_packIntersects(k, c); k = k._pack_prev, s2++);
                isect ? (s2 > s1 || s1 == s2 && b.r < a.r ? d3_layout_packSplice(a, b = j) : d3_layout_packSplice(a = k, b), i--) : (d3_layout_packInsert(a, c), b = c, bound(c))
            }
            var cx = (xMin + xMax) / 2, cy = (yMin + yMax) / 2, cr = 0;
            for (i = 0; n > i; i++)c = nodes[i], c.x -= cx, c.y -= cy, cr = Math.max(cr, c.r + Math.sqrt(c.x * c.x + c.y * c.y));
            node.r = cr, nodes.forEach(d3_layout_packUnlink)
        }
    }

    function d3_layout_packLink(node) {
        node._pack_next = node._pack_prev = node
    }

    function d3_layout_packUnlink(node) {
        delete node._pack_next, delete node._pack_prev
    }

    function d3_layout_packTransform(node, x, y, k) {
        var children = node.children;
        if (node.x = x += k * node.x, node.y = y += k * node.y, node.r *= k, children)for (var i = -1, n = children.length; ++i < n;)d3_layout_packTransform(children[i], x, y, k)
    }

    function d3_layout_packPlace(a, b, c) {
        var db = a.r + c.r, dx = b.x - a.x, dy = b.y - a.y;
        if (db && (dx || dy)) {
            var da = b.r + c.r, dc = dx * dx + dy * dy;
            da *= da, db *= db;
            var x = .5 + (db - da) / (2 * dc), y = Math.sqrt(Math.max(0, 2 * da * (db + dc) - (db -= dc) * db - da * da)) / (2 * dc);
            c.x = a.x + x * dx + y * dy, c.y = a.y + x * dy - y * dx
        } else c.x = a.x + db, c.y = a.y
    }

    function d3_layout_clusterY(children) {
        return 1 + d3.max(children, function (child) {
            return child.y
        })
    }

    function d3_layout_clusterX(children) {
        return children.reduce(function (x, child) {
            return x + child.x
        }, 0) / children.length
    }

    function d3_layout_clusterLeft(node) {
        var children = node.children;
        return children && children.length ? d3_layout_clusterLeft(children[0]) : node
    }

    function d3_layout_clusterRight(node) {
        var n, children = node.children;
        return children && (n = children.length) ? d3_layout_clusterRight(children[n - 1]) : node
    }

    function d3_layout_treemapPadNull(node) {
        return{x: node.x, y: node.y, dx: node.dx, dy: node.dy}
    }

    function d3_layout_treemapPad(node, padding) {
        var x = node.x + padding[3], y = node.y + padding[0], dx = node.dx - padding[1] - padding[3], dy = node.dy - padding[0] - padding[2];
        return 0 > dx && (x += dx / 2, dx = 0), 0 > dy && (y += dy / 2, dy = 0), {x: x, y: y, dx: dx, dy: dy}
    }

    function d3_scaleExtent(domain) {
        var start = domain[0], stop = domain[domain.length - 1];
        return stop > start ? [start, stop] : [stop, start]
    }

    function d3_scaleRange(scale) {
        return scale.rangeExtent ? scale.rangeExtent() : d3_scaleExtent(scale.range())
    }

    function d3_scale_bilinear(domain, range, uninterpolate, interpolate) {
        var u = uninterpolate(domain[0], domain[1]), i = interpolate(range[0], range[1]);
        return function (x) {
            return i(u(x))
        }
    }

    function d3_scale_nice(domain, nice) {
        var dx, i0 = 0, i1 = domain.length - 1, x0 = domain[i0], x1 = domain[i1];
        return x0 > x1 && (dx = i0, i0 = i1, i1 = dx, dx = x0, x0 = x1, x1 = dx), domain[i0] = nice.floor(x0), domain[i1] = nice.ceil(x1), domain
    }

    function d3_scale_niceStep(step) {
        return step ? {floor: function (x) {
            return Math.floor(x / step) * step
        }, ceil: function (x) {
            return Math.ceil(x / step) * step
        }} : d3_scale_niceIdentity
    }

    function d3_scale_polylinear(domain, range, uninterpolate, interpolate) {
        var u = [], i = [], j = 0, k = Math.min(domain.length, range.length) - 1;
        for (domain[k] < domain[0] && (domain = domain.slice().reverse(), range = range.slice().reverse()); ++j <= k;)u.push(uninterpolate(domain[j - 1], domain[j])), i.push(interpolate(range[j - 1], range[j]));
        return function (x) {
            var j = d3.bisect(domain, x, 1, k) - 1;
            return i[j](u[j](x))
        }
    }

    function d3_scale_linear(domain, range, interpolate, clamp) {
        function rescale() {
            var linear = Math.min(domain.length, range.length) > 2 ? d3_scale_polylinear : d3_scale_bilinear, uninterpolate = clamp ? d3_uninterpolateClamp : d3_uninterpolateNumber;
            return output = linear(domain, range, uninterpolate, interpolate), input = linear(range, domain, uninterpolate, d3_interpolate), scale
        }

        function scale(x) {
            return output(x)
        }

        var output, input;
        return scale.invert = function (y) {
            return input(y)
        }, scale.domain = function (x) {
            return arguments.length ? (domain = x.map(Number), rescale()) : domain
        }, scale.range = function (x) {
            return arguments.length ? (range = x, rescale()) : range
        }, scale.rangeRound = function (x) {
            return scale.range(x).interpolate(d3_interpolateRound)
        }, scale.clamp = function (x) {
            return arguments.length ? (clamp = x, rescale()) : clamp
        }, scale.interpolate = function (x) {
            return arguments.length ? (interpolate = x, rescale()) : interpolate
        }, scale.ticks = function (m) {
            return d3_scale_linearTicks(domain, m)
        }, scale.tickFormat = function (m, format) {
            return d3_scale_linearTickFormat(domain, m, format)
        }, scale.nice = function (m) {
            return d3_scale_linearNice(domain, m), rescale()
        }, scale.copy = function () {
            return d3_scale_linear(domain, range, interpolate, clamp)
        }, rescale()
    }

    function d3_scale_linearRebind(scale, linear) {
        return d3.rebind(scale, linear, "range", "rangeRound", "interpolate", "clamp")
    }

    function d3_scale_linearNice(domain, m) {
        return d3_scale_nice(domain, d3_scale_niceStep(m ? d3_scale_linearTickRange(domain, m)[2] : d3_scale_linearNiceStep(domain)))
    }

    function d3_scale_linearNiceStep(domain) {
        var extent = d3_scaleExtent(domain), span = extent[1] - extent[0];
        return Math.pow(10, Math.round(Math.log(span) / Math.LN10) - 1)
    }

    function d3_scale_linearTickRange(domain, m) {
        var extent = d3_scaleExtent(domain), span = extent[1] - extent[0], step = Math.pow(10, Math.floor(Math.log(span / m) / Math.LN10)), err = m / span * step;
        return.15 >= err ? step *= 10 : .35 >= err ? step *= 5 : .75 >= err && (step *= 2), extent[0] = Math.ceil(extent[0] / step) * step, extent[1] = Math.floor(extent[1] / step) * step + .5 * step, extent[2] = step, extent
    }

    function d3_scale_linearTicks(domain, m) {
        return d3.range.apply(d3, d3_scale_linearTickRange(domain, m))
    }

    function d3_scale_linearTickFormat(domain, m, format) {
        var precision = -Math.floor(Math.log(d3_scale_linearTickRange(domain, m)[2]) / Math.LN10 + .01);
        return d3.format(format ? format.replace(d3_format_re, function (a, b, c, d, e, f, g, h, i, j) {
            return[b, c, d, e, f, g, h, i || "." + (precision - 2 * ("%" === j)), j].join("")
        }) : ",." + precision + "f")
    }

    function d3_scale_log(linear, base, log, pow, domain) {
        function scale(x) {
            return linear(log(x))
        }

        return scale.invert = function (x) {
            return pow(linear.invert(x))
        }, scale.domain = function (x) {
            return arguments.length ? (x[0] < 0 ? (log = d3_scale_logn, pow = d3_scale_pown) : (log = d3_scale_logp, pow = d3_scale_powp), linear.domain((domain = x.map(Number)).map(log)), scale) : domain
        }, scale.base = function (_) {
            return arguments.length ? (base = +_, scale) : base
        }, scale.nice = function () {
            function floor(x) {
                return Math.pow(base, Math.floor(Math.log(x) / Math.log(base)))
            }

            function ceil(x) {
                return Math.pow(base, Math.ceil(Math.log(x) / Math.log(base)))
            }

            return linear.domain(d3_scale_nice(domain, log === d3_scale_logp ? {floor: floor, ceil: ceil} : {floor: function (x) {
                return-ceil(-x)
            }, ceil: function (x) {
                return-floor(-x)
            }}).map(log)), scale
        }, scale.ticks = function () {
            var extent = d3_scaleExtent(linear.domain()), ticks = [];
            if (extent.every(isFinite)) {
                var b = Math.log(base), i = Math.floor(extent[0] / b), j = Math.ceil(extent[1] / b), u = pow(extent[0]), v = pow(extent[1]), n = base % 1 ? 2 : base;
                if (log === d3_scale_logn)for (ticks.push(-Math.pow(base, -i)); i++ < j;)for (var k = n - 1; k > 0; k--)ticks.push(-Math.pow(base, -i) * k); else {
                    for (; j > i; i++)for (var k = 1; n > k; k++)ticks.push(Math.pow(base, i) * k);
                    ticks.push(Math.pow(base, i))
                }
                for (i = 0; ticks[i] < u; i++);
                for (j = ticks.length; ticks[j - 1] > v; j--);
                ticks = ticks.slice(i, j)
            }
            return ticks
        }, scale.tickFormat = function (n, format) {
            if (!arguments.length)return d3_scale_logFormat;
            arguments.length < 2 ? format = d3_scale_logFormat : "function" != typeof format && (format = d3.format(format));
            var e, b = Math.log(base), k = Math.max(.1, n / scale.ticks().length), f = log === d3_scale_logn ? (e = -1e-12, Math.floor) : (e = 1e-12, Math.ceil);
            return function (d) {
                return d / pow(b * f(log(d) / b + e)) <= k ? format(d) : ""
            }
        }, scale.copy = function () {
            return d3_scale_log(linear.copy(), base, log, pow, domain)
        }, d3_scale_linearRebind(scale, linear)
    }

    function d3_scale_logp(x) {
        return Math.log(0 > x ? 0 : x)
    }

    function d3_scale_powp(x) {
        return Math.exp(x)
    }

    function d3_scale_logn(x) {
        return-Math.log(x > 0 ? 0 : -x)
    }

    function d3_scale_pown(x) {
        return-Math.exp(-x)
    }

    function d3_scale_pow(linear, exponent, domain) {
        function scale(x) {
            return linear(powp(x))
        }

        var powp = d3_scale_powPow(exponent), powb = d3_scale_powPow(1 / exponent);
        return scale.invert = function (x) {
            return powb(linear.invert(x))
        }, scale.domain = function (x) {
            return arguments.length ? (linear.domain((domain = x.map(Number)).map(powp)), scale) : domain
        }, scale.ticks = function (m) {
            return d3_scale_linearTicks(domain, m)
        }, scale.tickFormat = function (m, format) {
            return d3_scale_linearTickFormat(domain, m, format)
        }, scale.nice = function (m) {
            return scale.domain(d3_scale_linearNice(domain, m))
        }, scale.exponent = function (x) {
            return arguments.length ? (powp = d3_scale_powPow(exponent = x), powb = d3_scale_powPow(1 / exponent), linear.domain(domain.map(powp)), scale) : exponent
        }, scale.copy = function () {
            return d3_scale_pow(linear.copy(), exponent, domain)
        }, d3_scale_linearRebind(scale, linear)
    }

    function d3_scale_powPow(e) {
        return function (x) {
            return 0 > x ? -Math.pow(-x, e) : Math.pow(x, e)
        }
    }

    function d3_scale_ordinal(domain, ranger) {
        function scale(x) {
            return range[((index.get(x) || index.set(x, domain.push(x))) - 1) % range.length]
        }

        function steps(start, step) {
            return d3.range(domain.length).map(function (i) {
                return start + step * i
            })
        }

        var index, range, rangeBand;
        return scale.domain = function (x) {
            if (!arguments.length)return domain;
            domain = [], index = new d3_Map;
            for (var xi, i = -1, n = x.length; ++i < n;)index.has(xi = x[i]) || index.set(xi, domain.push(xi));
            return scale[ranger.t].apply(scale, ranger.a)
        }, scale.range = function (x) {
            return arguments.length ? (range = x, rangeBand = 0, ranger = {t: "range", a: arguments}, scale) : range
        }, scale.rangePoints = function (x, padding) {
            arguments.length < 2 && (padding = 0);
            var start = x[0], stop = x[1], step = (stop - start) / (Math.max(1, domain.length - 1) + padding);
            return range = steps(domain.length < 2 ? (start + stop) / 2 : start + step * padding / 2, step), rangeBand = 0, ranger = {t: "rangePoints", a: arguments}, scale
        }, scale.rangeBands = function (x, padding, outerPadding) {
            arguments.length < 2 && (padding = 0), arguments.length < 3 && (outerPadding = padding);
            var reverse = x[1] < x[0], start = x[reverse - 0], stop = x[1 - reverse], step = (stop - start) / (domain.length - padding + 2 * outerPadding);
            return range = steps(start + step * outerPadding, step), reverse && range.reverse(), rangeBand = step * (1 - padding), ranger = {t: "rangeBands", a: arguments}, scale
        }, scale.rangeRoundBands = function (x, padding, outerPadding) {
            arguments.length < 2 && (padding = 0), arguments.length < 3 && (outerPadding = padding);
            var reverse = x[1] < x[0], start = x[reverse - 0], stop = x[1 - reverse], step = Math.floor((stop - start) / (domain.length - padding + 2 * outerPadding)), error = stop - start - (domain.length - padding) * step;
            return range = steps(start + Math.round(error / 2), step), reverse && range.reverse(), rangeBand = Math.round(step * (1 - padding)), ranger = {t: "rangeRoundBands", a: arguments}, scale
        }, scale.rangeBand = function () {
            return rangeBand
        }, scale.rangeExtent = function () {
            return d3_scaleExtent(ranger.a[0])
        }, scale.copy = function () {
            return d3_scale_ordinal(domain, ranger)
        }, scale.domain(domain)
    }

    function d3_scale_quantile(domain, range) {
        function rescale() {
            var k = 0, q = range.length;
            for (thresholds = []; ++k < q;)thresholds[k - 1] = d3.quantile(domain, k / q);
            return scale
        }

        function scale(x) {
            return isNaN(x = +x) ? 0 / 0 : range[d3.bisect(thresholds, x)]
        }

        var thresholds;
        return scale.domain = function (x) {
            return arguments.length ? (domain = x.filter(function (d) {
                return!isNaN(d)
            }).sort(d3.ascending), rescale()) : domain
        }, scale.range = function (x) {
            return arguments.length ? (range = x, rescale()) : range
        }, scale.quantiles = function () {
            return thresholds
        }, scale.copy = function () {
            return d3_scale_quantile(domain, range)
        }, rescale()
    }

    function d3_scale_quantize(x0, x1, range) {
        function scale(x) {
            return range[Math.max(0, Math.min(i, Math.floor(kx * (x - x0))))]
        }

        function rescale() {
            return kx = range.length / (x1 - x0), i = range.length - 1, scale
        }

        var kx, i;
        return scale.domain = function (x) {
            return arguments.length ? (x0 = +x[0], x1 = +x[x.length - 1], rescale()) : [x0, x1]
        }, scale.range = function (x) {
            return arguments.length ? (range = x, rescale()) : range
        }, scale.copy = function () {
            return d3_scale_quantize(x0, x1, range)
        }, scale.invertExtent = function (y) {
            return y = range.indexOf(y), y = 0 > y ? 0 / 0 : y / kx + x0, [y, y + 1 / kx]
        }, rescale()
    }

    function d3_scale_threshold(domain, range) {
        function scale(x) {
            return range[d3.bisect(domain, x)]
        }

        return scale.domain = function (_) {
            return arguments.length ? (domain = _, scale) : domain
        }, scale.range = function (_) {
            return arguments.length ? (range = _, scale) : range
        }, scale.invertExtent = function (y) {
            return y = range.indexOf(y), [domain[y - 1], domain[y]]
        }, scale.copy = function () {
            return d3_scale_threshold(domain, range)
        }, scale
    }

    function d3_scale_identity(domain) {
        function identity(x) {
            return+x
        }

        return identity.invert = identity, identity.domain = identity.range = function (x) {
            return arguments.length ? (domain = x.map(identity), identity) : domain
        }, identity.ticks = function (m) {
            return d3_scale_linearTicks(domain, m)
        }, identity.tickFormat = function (m, format) {
            return d3_scale_linearTickFormat(domain, m, format)
        }, identity.copy = function () {
            return d3_scale_identity(domain)
        }, identity
    }

    function d3_svg_arcInnerRadius(d) {
        return d.innerRadius
    }

    function d3_svg_arcOuterRadius(d) {
        return d.outerRadius
    }

    function d3_svg_arcStartAngle(d) {
        return d.startAngle
    }

    function d3_svg_arcEndAngle(d) {
        return d.endAngle
    }

    function d3_svg_lineRadial(points) {
        for (var point, r, a, i = -1, n = points.length; ++i < n;)point = points[i], r = point[0], a = point[1] + d3_svg_arcOffset, point[0] = r * Math.cos(a), point[1] = r * Math.sin(a);
        return points
    }

    function d3_svg_area(projection) {
        function area(data) {
            function segment() {
                segments.push("M", interpolate(projection(points1), tension), L, interpolateReverse(projection(points0.reverse()), tension), "Z")
            }

            for (var d, x, y, segments = [], points0 = [], points1 = [], i = -1, n = data.length, fx0 = d3_functor(x0), fy0 = d3_functor(y0), fx1 = x0 === x1 ? function () {
                return x
            } : d3_functor(x1), fy1 = y0 === y1 ? function () {
                return y
            } : d3_functor(y1); ++i < n;)defined.call(this, d = data[i], i) ? (points0.push([x = +fx0.call(this, d, i), y = +fy0.call(this, d, i)]), points1.push([+fx1.call(this, d, i), +fy1.call(this, d, i)])) : points0.length && (segment(), points0 = [], points1 = []);
            return points0.length && segment(), segments.length ? segments.join("") : null
        }

        var x0 = d3_svg_lineX, x1 = d3_svg_lineX, y0 = 0, y1 = d3_svg_lineY, defined = d3_true, interpolate = d3_svg_lineLinear, interpolateKey = interpolate.key, interpolateReverse = interpolate, L = "L", tension = .7;
        return area.x = function (_) {
            return arguments.length ? (x0 = x1 = _, area) : x1
        }, area.x0 = function (_) {
            return arguments.length ? (x0 = _, area) : x0
        }, area.x1 = function (_) {
            return arguments.length ? (x1 = _, area) : x1
        }, area.y = function (_) {
            return arguments.length ? (y0 = y1 = _, area) : y1
        }, area.y0 = function (_) {
            return arguments.length ? (y0 = _, area) : y0
        }, area.y1 = function (_) {
            return arguments.length ? (y1 = _, area) : y1
        }, area.defined = function (_) {
            return arguments.length ? (defined = _, area) : defined
        }, area.interpolate = function (_) {
            return arguments.length ? (interpolateKey = "function" == typeof _ ? interpolate = _ : (interpolate = d3_svg_lineInterpolators.get(_) || d3_svg_lineLinear).key, interpolateReverse = interpolate.reverse || interpolate, L = interpolate.closed ? "M" : "L", area) : interpolateKey
        }, area.tension = function (_) {
            return arguments.length ? (tension = _, area) : tension
        }, area
    }

    function d3_svg_chordRadius(d) {
        return d.radius
    }

    function d3_svg_diagonalProjection(d) {
        return[d.x, d.y]
    }

    function d3_svg_diagonalRadialProjection(projection) {
        return function () {
            var d = projection.apply(this, arguments), r = d[0], a = d[1] + d3_svg_arcOffset;
            return[r * Math.cos(a), r * Math.sin(a)]
        }
    }

    function d3_svg_symbolSize() {
        return 64
    }

    function d3_svg_symbolType() {
        return"circle"
    }

    function d3_svg_symbolCircle(size) {
        var r = Math.sqrt(size / π);
        return"M0," + r + "A" + r + "," + r + " 0 1,1 0," + -r + "A" + r + "," + r + " 0 1,1 0," + r + "Z"
    }

    function d3_transition(groups, id) {
        return d3_arraySubclass(groups, d3_transitionPrototype), groups.id = id, groups
    }

    function d3_transition_tween(groups, name, value, tween) {
        var id = groups.id;
        return d3_selection_each(groups, "function" == typeof value ? function (node, i, j) {
            node.__transition__[id].tween.set(name, tween(value.call(node, node.__data__, i, j)))
        } : (value = tween(value), function (node) {
            node.__transition__[id].tween.set(name, value)
        }))
    }

    function d3_transition_text(b) {
        return null == b && (b = ""), function () {
            this.textContent = b
        }
    }

    function d3_transitionNode(node, i, id, inherit) {
        var lock = node.__transition__ || (node.__transition__ = {active: 0, count: 0}), transition = lock[id];
        if (!transition) {
            var time = inherit.time;
            return transition = lock[id] = {tween: new d3_Map, event: d3.dispatch("start", "end"), time: time, ease: inherit.ease, delay: inherit.delay, duration: inherit.duration}, ++lock.count, d3.timer(function (elapsed) {
                function start(elapsed) {
                    return lock.active > id ? stop() : (lock.active = id, event.start.call(node, d, i), transition.tween.forEach(function (key, value) {
                        (value = value.call(node, d, i)) && tweened.push(value)
                    }), tick(elapsed) || d3.timer(tick, 0, time), 1)
                }

                function tick(elapsed) {
                    if (lock.active !== id)return stop();
                    for (var t = (elapsed - delay) / duration, e = ease(t), n = tweened.length; n > 0;)tweened[--n].call(node, e);
                    return t >= 1 ? (stop(), event.end.call(node, d, i), 1) : void 0
                }

                function stop() {
                    return--lock.count ? delete lock[id] : delete node.__transition__, 1
                }

                var d = node.__data__, ease = transition.ease, event = transition.event, delay = transition.delay, duration = transition.duration, tweened = [];
                return elapsed >= delay ? start(elapsed) : d3.timer(start, delay, time), 1
            }, 0, time), transition
        }
    }

    function d3_svg_axisX(selection, x) {
        selection.attr("transform", function (d) {
            return"translate(" + x(d) + ",0)"
        })
    }

    function d3_svg_axisY(selection, y) {
        selection.attr("transform", function (d) {
            return"translate(0," + y(d) + ")"
        })
    }

    function d3_svg_axisSubdivide(scale, ticks, m) {
        if (subticks = [], m && ticks.length > 1) {
            for (var subticks, j, v, extent = d3_scaleExtent(scale.domain()), i = -1, n = ticks.length, d = (ticks[1] - ticks[0]) / ++m; ++i < n;)for (j = m; --j > 0;)(v = +ticks[i] - j * d) >= extent[0] && subticks.push(v);
            for (--i, j = 0; ++j < m && (v = +ticks[i] + j * d) < extent[1];)subticks.push(v)
        }
        return subticks
    }

    function d3_time_utc() {
        this._ = new Date(arguments.length > 1 ? Date.UTC.apply(this, arguments) : arguments[0])
    }

    function d3_time_interval(local, step, number) {
        function round(date) {
            var d0 = local(date), d1 = offset(d0, 1);
            return d1 - date > date - d0 ? d0 : d1
        }

        function ceil(date) {
            return step(date = local(new d3_time(date - 1)), 1), date
        }

        function offset(date, k) {
            return step(date = new d3_time(+date), k), date
        }

        function range(t0, t1, dt) {
            var time = ceil(t0), times = [];
            if (dt > 1)for (; t1 > time;)number(time) % dt || times.push(new Date(+time)), step(time, 1); else for (; t1 > time;)times.push(new Date(+time)), step(time, 1);
            return times
        }

        function range_utc(t0, t1, dt) {
            try {
                d3_time = d3_time_utc;
                var utc = new d3_time_utc;
                return utc._ = t0, range(utc, t1, dt)
            } finally {
                d3_time = Date
            }
        }

        local.floor = local, local.round = round, local.ceil = ceil, local.offset = offset, local.range = range;
        var utc = local.utc = d3_time_interval_utc(local);
        return utc.floor = utc, utc.round = d3_time_interval_utc(round), utc.ceil = d3_time_interval_utc(ceil), utc.offset = d3_time_interval_utc(offset), utc.range = range_utc, local
    }

    function d3_time_interval_utc(method) {
        return function (date, k) {
            try {
                d3_time = d3_time_utc;
                var utc = new d3_time_utc;
                return utc._ = date, method(utc, k)._
            } finally {
                d3_time = Date
            }
        }
    }

    function d3_time_parse(date, template, string, j) {
        for (var c, p, i = 0, n = template.length, m = string.length; n > i;) {
            if (j >= m)return-1;
            if (c = template.charCodeAt(i++), 37 === c) {
                if (p = d3_time_parsers[template.charAt(i++)], !p || (j = p(date, string, j)) < 0)return-1
            } else if (c != string.charCodeAt(j++))return-1
        }
        return j
    }

    function d3_time_formatRe(names) {
        return new RegExp("^(?:" + names.map(d3.requote).join("|") + ")", "i")
    }

    function d3_time_formatLookup(names) {
        for (var map = new d3_Map, i = -1, n = names.length; ++i < n;)map.set(names[i].toLowerCase(), i);
        return map
    }

    function d3_time_formatPad(value, fill, width) {
        var sign = 0 > value ? "-" : "", string = (sign ? -value : value) + "", length = string.length;
        return sign + (width > length ? new Array(width - length + 1).join(fill) + string : string)
    }

    function d3_time_parseWeekdayAbbrev(date, string, i) {
        d3_time_dayAbbrevRe.lastIndex = 0;
        var n = d3_time_dayAbbrevRe.exec(string.substring(i));
        return n ? (date.w = d3_time_dayAbbrevLookup.get(n[0].toLowerCase()), i + n[0].length) : -1
    }

    function d3_time_parseWeekday(date, string, i) {
        d3_time_dayRe.lastIndex = 0;
        var n = d3_time_dayRe.exec(string.substring(i));
        return n ? (date.w = d3_time_dayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1
    }

    function d3_time_parseWeekdayNumber(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 1));
        return n ? (date.w = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseWeekNumberSunday(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i));
        return n ? (date.U = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseWeekNumberMonday(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i));
        return n ? (date.W = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseMonthAbbrev(date, string, i) {
        d3_time_monthAbbrevRe.lastIndex = 0;
        var n = d3_time_monthAbbrevRe.exec(string.substring(i));
        return n ? (date.m = d3_time_monthAbbrevLookup.get(n[0].toLowerCase()), i + n[0].length) : -1
    }

    function d3_time_parseMonth(date, string, i) {
        d3_time_monthRe.lastIndex = 0;
        var n = d3_time_monthRe.exec(string.substring(i));
        return n ? (date.m = d3_time_monthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1
    }

    function d3_time_parseLocaleFull(date, string, i) {
        return d3_time_parse(date, d3_time_formats.c.toString(), string, i)
    }

    function d3_time_parseLocaleDate(date, string, i) {
        return d3_time_parse(date, d3_time_formats.x.toString(), string, i)
    }

    function d3_time_parseLocaleTime(date, string, i) {
        return d3_time_parse(date, d3_time_formats.X.toString(), string, i)
    }

    function d3_time_parseFullYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 4));
        return n ? (date.y = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.y = d3_time_expandYear(+n[0]), i + n[0].length) : -1
    }

    function d3_time_expandYear(d) {
        return d + (d > 68 ? 1900 : 2e3)
    }

    function d3_time_parseMonthNumber(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.m = n[0] - 1, i + n[0].length) : -1
    }

    function d3_time_parseDay(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.d = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseDayOfYear(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 3));
        return n ? (date.j = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseHour24(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.H = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseMinutes(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.M = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseSeconds(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 2));
        return n ? (date.S = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseMilliseconds(date, string, i) {
        d3_time_numberRe.lastIndex = 0;
        var n = d3_time_numberRe.exec(string.substring(i, i + 3));
        return n ? (date.L = +n[0], i + n[0].length) : -1
    }

    function d3_time_parseAmPm(date, string, i) {
        var n = d3_time_amPmLookup.get(string.substring(i, i += 2).toLowerCase());
        return null == n ? -1 : (date.p = n, i)
    }

    function d3_time_zone(d) {
        var z = d.getTimezoneOffset(), zs = z > 0 ? "-" : "+", zh = ~~(Math.abs(z) / 60), zm = Math.abs(z) % 60;
        return zs + d3_time_formatPad(zh, "0", 2) + d3_time_formatPad(zm, "0", 2)
    }

    function d3_time_parseLiteralPercent(date, string, i) {
        d3_time_percentRe.lastIndex = 0;
        var n = d3_time_percentRe.exec(string.substring(i, i + 1));
        return n ? i + n[0].length : -1
    }

    function d3_time_formatIsoNative(date) {
        return date.toISOString()
    }

    function d3_time_scale(linear, methods, format) {
        function scale(x) {
            return linear(x)
        }

        return scale.invert = function (x) {
            return d3_time_scaleDate(linear.invert(x))
        }, scale.domain = function (x) {
            return arguments.length ? (linear.domain(x), scale) : linear.domain().map(d3_time_scaleDate)
        }, scale.nice = function (m) {
            return scale.domain(d3_scale_nice(scale.domain(), m))
        }, scale.ticks = function (m, k) {
            var extent = d3_scaleExtent(scale.domain());
            if ("function" != typeof m) {
                var span = extent[1] - extent[0], target = span / m, i = d3.bisect(d3_time_scaleSteps, target);
                if (i == d3_time_scaleSteps.length)return methods.year(extent, m);
                if (!i)return linear.ticks(m).map(d3_time_scaleDate);
                Math.log(target / d3_time_scaleSteps[i - 1]) < Math.log(d3_time_scaleSteps[i] / target) && --i, m = methods[i], k = m[1], m = m[0].range
            }
            return m(extent[0], new Date(+extent[1] + 1), k)
        }, scale.tickFormat = function () {
            return format
        }, scale.copy = function () {
            return d3_time_scale(linear.copy(), methods, format)
        }, d3_scale_linearRebind(scale, linear)
    }

    function d3_time_scaleDate(t) {
        return new Date(t)
    }

    function d3_time_scaleFormat(formats) {
        return function (date) {
            for (var i = formats.length - 1, f = formats[i]; !f[1](date);)f = formats[--i];
            return f[0](date)
        }
    }

    function d3_time_scaleSetYear(y) {
        var d = new Date(y, 0, 1);
        return d.setFullYear(y), d
    }

    function d3_time_scaleGetYear(d) {
        var y = d.getFullYear(), d0 = d3_time_scaleSetYear(y), d1 = d3_time_scaleSetYear(y + 1);
        return y + (d - d0) / (d1 - d0)
    }

    function d3_time_scaleUTCSetYear(y) {
        var d = new Date(Date.UTC(y, 0, 1));
        return d.setUTCFullYear(y), d
    }

    function d3_time_scaleUTCGetYear(d) {
        var y = d.getUTCFullYear(), d0 = d3_time_scaleUTCSetYear(y), d1 = d3_time_scaleUTCSetYear(y + 1);
        return y + (d - d0) / (d1 - d0)
    }

    function d3_json(request) {
        return JSON.parse(request.responseText)
    }

    function d3_html(request) {
        var range = d3_document.createRange();
        return range.selectNode(d3_document.body), range.createContextualFragment(request.responseText)
    }

    var d3 = {version: "3.2.0"};
    Date.now || (Date.now = function () {
        return+new Date
    });
    var d3_document = document, d3_documentElement = d3_document.documentElement, d3_window = window;
    try {
        d3_document.createElement("div").style.setProperty("opacity", 0, "")
    } catch (error) {
        var d3_style_prototype = d3_window.CSSStyleDeclaration.prototype, d3_style_setProperty = d3_style_prototype.setProperty;
        d3_style_prototype.setProperty = function (name, value, priority) {
            d3_style_setProperty.call(this, name, value + "", priority)
        }
    }
    d3.ascending = function (a, b) {
        return b > a ? -1 : a > b ? 1 : a >= b ? 0 : 0 / 0
    }, d3.descending = function (a, b) {
        return a > b ? -1 : b > a ? 1 : b >= a ? 0 : 0 / 0
    }, d3.min = function (array, f) {
        var a, b, i = -1, n = array.length;
        if (1 === arguments.length) {
            for (; ++i < n && (null == (a = array[i]) || a != a);)a = void 0;
            for (; ++i < n;)null != (b = array[i]) && a > b && (a = b)
        } else {
            for (; ++i < n && (null == (a = f.call(array, array[i], i)) || a != a);)a = void 0;
            for (; ++i < n;)null != (b = f.call(array, array[i], i)) && a > b && (a = b)
        }
        return a
    }, d3.max = function (array, f) {
        var a, b, i = -1, n = array.length;
        if (1 === arguments.length) {
            for (; ++i < n && (null == (a = array[i]) || a != a);)a = void 0;
            for (; ++i < n;)null != (b = array[i]) && b > a && (a = b)
        } else {
            for (; ++i < n && (null == (a = f.call(array, array[i], i)) || a != a);)a = void 0;
            for (; ++i < n;)null != (b = f.call(array, array[i], i)) && b > a && (a = b)
        }
        return a
    }, d3.extent = function (array, f) {
        var a, b, c, i = -1, n = array.length;
        if (1 === arguments.length) {
            for (; ++i < n && (null == (a = c = array[i]) || a != a);)a = c = void 0;
            for (; ++i < n;)null != (b = array[i]) && (a > b && (a = b), b > c && (c = b))
        } else {
            for (; ++i < n && (null == (a = c = f.call(array, array[i], i)) || a != a);)a = void 0;
            for (; ++i < n;)null != (b = f.call(array, array[i], i)) && (a > b && (a = b), b > c && (c = b))
        }
        return[a, c]
    }, d3.sum = function (array, f) {
        var a, s = 0, n = array.length, i = -1;
        if (1 === arguments.length)for (; ++i < n;)isNaN(a = +array[i]) || (s += a); else for (; ++i < n;)isNaN(a = +f.call(array, array[i], i)) || (s += a);
        return s
    }, d3.mean = function (array, f) {
        var a, n = array.length, m = 0, i = -1, j = 0;
        if (1 === arguments.length)for (; ++i < n;)d3_number(a = array[i]) && (m += (a - m) / ++j); else for (; ++i < n;)d3_number(a = f.call(array, array[i], i)) && (m += (a - m) / ++j);
        return j ? m : void 0
    }, d3.quantile = function (values, p) {
        var H = (values.length - 1) * p + 1, h = Math.floor(H), v = +values[h - 1], e = H - h;
        return e ? v + e * (values[h] - v) : v
    }, d3.median = function (array, f) {
        return arguments.length > 1 && (array = array.map(f)), array = array.filter(d3_number), array.length ? d3.quantile(array.sort(d3.ascending), .5) : void 0
    }, d3.bisector = function (f) {
        return{left: function (a, x, lo, hi) {
            for (arguments.length < 3 && (lo = 0), arguments.length < 4 && (hi = a.length); hi > lo;) {
                var mid = lo + hi >>> 1;
                f.call(a, a[mid], mid) < x ? lo = mid + 1 : hi = mid
            }
            return lo
        }, right: function (a, x, lo, hi) {
            for (arguments.length < 3 && (lo = 0), arguments.length < 4 && (hi = a.length); hi > lo;) {
                var mid = lo + hi >>> 1;
                x < f.call(a, a[mid], mid) ? hi = mid : lo = mid + 1
            }
            return lo
        }}
    };
    var d3_bisector = d3.bisector(function (d) {
        return d
    });
    d3.bisectLeft = d3_bisector.left, d3.bisect = d3.bisectRight = d3_bisector.right, d3.shuffle = function (array) {
        for (var t, i, m = array.length; m;)i = 0 | Math.random() * m--, t = array[m], array[m] = array[i], array[i] = t;
        return array
    }, d3.permute = function (array, indexes) {
        for (var permutes = [], i = -1, n = indexes.length; ++i < n;)permutes[i] = array[indexes[i]];
        return permutes
    }, d3.zip = function () {
        if (!(n = arguments.length))return[];
        for (var i = -1, m = d3.min(arguments, d3_zipLength), zips = new Array(m); ++i < m;)for (var n, j = -1, zip = zips[i] = new Array(n); ++j < n;)zip[j] = arguments[j][i];
        return zips
    }, d3.transpose = function (matrix) {
        return d3.zip.apply(d3, matrix)
    }, d3.keys = function (map) {
        var keys = [];
        for (var key in map)keys.push(key);
        return keys
    }, d3.values = function (map) {
        var values = [];
        for (var key in map)values.push(map[key]);
        return values
    }, d3.entries = function (map) {
        var entries = [];
        for (var key in map)entries.push({key: key, value: map[key]});
        return entries
    }, d3.merge = function (arrays) {
        return Array.prototype.concat.apply([], arrays)
    }, d3.range = function (start, stop, step) {
        if (arguments.length < 3 && (step = 1, arguments.length < 2 && (stop = start, start = 0)), 1 / 0 === (stop - start) / step)throw new Error("infinite range");
        var j, range = [], k = d3_range_integerScale(Math.abs(step)), i = -1;
        if (start *= k, stop *= k, step *= k, 0 > step)for (; (j = start + step * ++i) > stop;)range.push(j / k); else for (; (j = start + step * ++i) < stop;)range.push(j / k);
        return range
    }, d3.map = function (object) {
        var map = new d3_Map;
        for (var key in object)map.set(key, object[key]);
        return map
    }, d3_class(d3_Map, {has: function (key) {
        return d3_map_prefix + key in this
    }, get: function (key) {
        return this[d3_map_prefix + key]
    }, set: function (key, value) {
        return this[d3_map_prefix + key] = value
    }, remove: function (key) {
        return key = d3_map_prefix + key, key in this && delete this[key]
    }, keys: function () {
        var keys = [];
        return this.forEach(function (key) {
            keys.push(key)
        }), keys
    }, values: function () {
        var values = [];
        return this.forEach(function (key, value) {
            values.push(value)
        }), values
    }, entries: function () {
        var entries = [];
        return this.forEach(function (key, value) {
            entries.push({key: key, value: value})
        }), entries
    }, forEach: function (f) {
        for (var key in this)key.charCodeAt(0) === d3_map_prefixCode && f.call(this, key.substring(1), this[key])
    }});
    var d3_map_prefix = "\x00", d3_map_prefixCode = d3_map_prefix.charCodeAt(0);
    d3.nest = function () {
        function map(mapType, array, depth) {
            if (depth >= keys.length)return rollup ? rollup.call(nest, array) : sortValues ? array.sort(sortValues) : array;
            for (var keyValue, object, setter, values, i = -1, n = array.length, key = keys[depth++], valuesByKey = new d3_Map; ++i < n;)(values = valuesByKey.get(keyValue = key(object = array[i]))) ? values.push(object) : valuesByKey.set(keyValue, [object]);
            return mapType ? (object = mapType(), setter = function (keyValue, values) {
                object.set(keyValue, map(mapType, values, depth))
            }) : (object = {}, setter = function (keyValue, values) {
                object[keyValue] = map(mapType, values, depth)
            }), valuesByKey.forEach(setter), object
        }

        function entries(map, depth) {
            if (depth >= keys.length)return map;
            var array = [], sortKey = sortKeys[depth++];
            return map.forEach(function (key, keyMap) {
                array.push({key: key, values: entries(keyMap, depth)})
            }), sortKey ? array.sort(function (a, b) {
                return sortKey(a.key, b.key)
            }) : array
        }

        var sortValues, rollup, nest = {}, keys = [], sortKeys = [];
        return nest.map = function (array, mapType) {
            return map(mapType, array, 0)
        }, nest.entries = function (array) {
            return entries(map(d3.map, array, 0), 0)
        }, nest.key = function (d) {
            return keys.push(d), nest
        }, nest.sortKeys = function (order) {
            return sortKeys[keys.length - 1] = order, nest
        }, nest.sortValues = function (order) {
            return sortValues = order, nest
        }, nest.rollup = function (f) {
            return rollup = f, nest
        }, nest
    }, d3.set = function (array) {
        var set = new d3_Set;
        if (array)for (var i = 0; i < array.length; i++)set.add(array[i]);
        return set
    }, d3_class(d3_Set, {has: function (value) {
        return d3_map_prefix + value in this
    }, add: function (value) {
        return this[d3_map_prefix + value] = !0, value
    }, remove: function (value) {
        return value = d3_map_prefix + value, value in this && delete this[value]
    }, values: function () {
        var values = [];
        return this.forEach(function (value) {
            values.push(value)
        }), values
    }, forEach: function (f) {
        for (var value in this)value.charCodeAt(0) === d3_map_prefixCode && f.call(this, value.substring(1))
    }}), d3.behavior = {}, d3.rebind = function (target, source) {
        for (var method, i = 1, n = arguments.length; ++i < n;)target[method = arguments[i]] = d3_rebind(target, source, source[method]);
        return target
    }, d3.dispatch = function () {
        for (var dispatch = new d3_dispatch, i = -1, n = arguments.length; ++i < n;)dispatch[arguments[i]] = d3_dispatch_event(dispatch);
        return dispatch
    }, d3_dispatch.prototype.on = function (type, listener) {
        var i = type.indexOf("."), name = "";
        if (i >= 0 && (name = type.substring(i + 1), type = type.substring(0, i)), type)return arguments.length < 2 ? this[type].on(name) : this[type].on(name, listener);
        if (2 === arguments.length) {
            if (null == listener)for (type in this)this.hasOwnProperty(type) && this[type].on(name, null);
            return this
        }
    }, d3.event = null, d3.mouse = function (container) {
        return d3_mousePoint(container, d3_eventSource())
    };
    var d3_mouse_bug44083 = /WebKit/.test(d3_window.navigator.userAgent) ? -1 : 0, d3_array = d3_arraySlice;
    try {
        d3_array(d3_documentElement.childNodes)[0].nodeType
    } catch (e) {
        d3_array = d3_arrayCopy
    }
    var d3_arraySubclass = [].__proto__ ? function (array, prototype) {
        array.__proto__ = prototype
    } : function (array, prototype) {
        for (var property in prototype)array[property] = prototype[property]
    };
    d3.touches = function (container, touches) {
        return arguments.length < 2 && (touches = d3_eventSource().touches), touches ? d3_array(touches).map(function (touch) {
            var point = d3_mousePoint(container, touch);
            return point.identifier = touch.identifier, point
        }) : []
    };
    var d3_vendorPrefixes = ["webkit", "ms", "moz", "Moz", "o", "O"], d3_event_userSelectProperty = d3_vendorSymbol(d3_documentElement.style, "userSelect"), d3_event_userSelectSuppress = d3_event_userSelectProperty ? function () {
        var style = d3_documentElement.style, select = style[d3_event_userSelectProperty];
        return style[d3_event_userSelectProperty] = "none", function () {
            style[d3_event_userSelectProperty] = select
        }
    } : function (type) {
        var w = d3.select(d3_window).on("selectstart." + type, d3_eventCancel);
        return function () {
            w.on("selectstart." + type, null)
        }
    };
    d3.behavior.drag = function () {
        function drag() {
            this.on("mousedown.drag", mousedown).on("touchstart.drag", mousedown)
        }

        function mousedown() {
            function point() {
                var p = target.parentNode;
                return null != touchId ? d3.touches(p).filter(function (p) {
                    return p.identifier === touchId
                })[0] : d3.mouse(p)
            }

            function dragmove() {
                if (!target.parentNode)return dragend();
                var p = point(), dx = p[0] - origin_[0], dy = p[1] - origin_[1];
                moved |= dx | dy, origin_ = p, d3_eventCancel(), event_({type: "drag", x: p[0] + offset[0], y: p[1] + offset[1], dx: dx, dy: dy})
            }

            function dragend() {
                event_({type: "dragend"}), moved && (d3_eventCancel(), d3.event.target === eventTarget && d3_eventSuppress(w, "click")), w.on(null != touchId ? "touchmove.drag-" + touchId : "mousemove.drag", null).on(null != touchId ? "touchend.drag-" + touchId : "mouseup.drag", null), selectEnable()
            }

            var offset, target = this, event_ = event.of(target, arguments), eventTarget = d3.event.target, touchId = d3.event.touches ? d3.event.changedTouches[0].identifier : null, origin_ = point(), moved = 0, selectEnable = d3_event_userSelectSuppress(null != touchId ? "drag-" + touchId : "drag"), w = d3.select(d3_window).on(null != touchId ? "touchmove.drag-" + touchId : "mousemove.drag", dragmove).on(null != touchId ? "touchend.drag-" + touchId : "mouseup.drag", dragend, !0);
            origin ? (offset = origin.apply(target, arguments), offset = [offset.x - origin_[0], offset.y - origin_[1]]) : offset = [0, 0], event_({type: "dragstart"})
        }

        var event = d3_eventDispatch(drag, "drag", "dragstart", "dragend"), origin = null;
        return drag.origin = function (x) {
            return arguments.length ? (origin = x, drag) : origin
        }, d3.rebind(drag, event, "on")
    };
    var d3_select = function (s, n) {
        return n.querySelector(s)
    }, d3_selectAll = function (s, n) {
        return n.querySelectorAll(s)
    }, d3_selectMatcher = d3_documentElement[d3_vendorSymbol(d3_documentElement, "matchesSelector")], d3_selectMatches = function (n, s) {
        return d3_selectMatcher.call(n, s)
    };
    "function" == typeof Sizzle && (d3_select = function (s, n) {
        return Sizzle(s, n)[0] || null
    }, d3_selectAll = function (s, n) {
        return Sizzle.uniqueSort(Sizzle(s, n))
    }, d3_selectMatches = Sizzle.matchesSelector), d3.selection = function () {
        return d3_selectionRoot
    };
    var d3_selectionPrototype = d3.selection.prototype = [];
    d3_selectionPrototype.select = function (selector) {
        var subgroup, subnode, group, node, subgroups = [];
        "function" != typeof selector && (selector = d3_selection_selector(selector));
        for (var j = -1, m = this.length; ++j < m;) {
            subgroups.push(subgroup = []), subgroup.parentNode = (group = this[j]).parentNode;
            for (var i = -1, n = group.length; ++i < n;)(node = group[i]) ? (subgroup.push(subnode = selector.call(node, node.__data__, i)), subnode && "__data__"in node && (subnode.__data__ = node.__data__)) : subgroup.push(null)
        }
        return d3_selection(subgroups)
    }, d3_selectionPrototype.selectAll = function (selector) {
        var subgroup, node, subgroups = [];
        "function" != typeof selector && (selector = d3_selection_selectorAll(selector));
        for (var j = -1, m = this.length; ++j < m;)for (var group = this[j], i = -1, n = group.length; ++i < n;)(node = group[i]) && (subgroups.push(subgroup = d3_array(selector.call(node, node.__data__, i))), subgroup.parentNode = node);
        return d3_selection(subgroups)
    };
    var d3_nsPrefix = {svg: "http://www.w3.org/2000/svg", xhtml: "http://www.w3.org/1999/xhtml", xlink: "http://www.w3.org/1999/xlink", xml: "http://www.w3.org/XML/1998/namespace", xmlns: "http://www.w3.org/2000/xmlns/"};
    d3.ns = {prefix: d3_nsPrefix, qualify: function (name) {
        var i = name.indexOf(":"), prefix = name;
        return i >= 0 && (prefix = name.substring(0, i), name = name.substring(i + 1)), d3_nsPrefix.hasOwnProperty(prefix) ? {space: d3_nsPrefix[prefix], local: name} : name
    }}, d3_selectionPrototype.attr = function (name, value) {
        if (arguments.length < 2) {
            if ("string" == typeof name) {
                var node = this.node();
                return name = d3.ns.qualify(name), name.local ? node.getAttributeNS(name.space, name.local) : node.getAttribute(name)
            }
            for (value in name)this.each(d3_selection_attr(value, name[value]));
            return this
        }
        return this.each(d3_selection_attr(name, value))
    }, d3.requote = function (s) {
        return s.replace(d3_requote_re, "\\$&")
    };
    var d3_requote_re = /[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;
    d3_selectionPrototype.classed = function (name, value) {
        if (arguments.length < 2) {
            if ("string" == typeof name) {
                var node = this.node(), n = (name = name.trim().split(/^|\s+/g)).length, i = -1;
                if (value = node.classList) {
                    for (; ++i < n;)if (!value.contains(name[i]))return!1
                } else for (value = node.getAttribute("class"); ++i < n;)if (!d3_selection_classedRe(name[i]).test(value))return!1;
                return!0
            }
            for (value in name)this.each(d3_selection_classed(value, name[value]));
            return this
        }
        return this.each(d3_selection_classed(name, value))
    }, d3_selectionPrototype.style = function (name, value, priority) {
        var n = arguments.length;
        if (3 > n) {
            if ("string" != typeof name) {
                2 > n && (value = "");
                for (priority in name)this.each(d3_selection_style(priority, name[priority], value));
                return this
            }
            if (2 > n)return d3_window.getComputedStyle(this.node(), null).getPropertyValue(name);
            priority = ""
        }
        return this.each(d3_selection_style(name, value, priority))
    }, d3_selectionPrototype.property = function (name, value) {
        if (arguments.length < 2) {
            if ("string" == typeof name)return this.node()[name];
            for (value in name)this.each(d3_selection_property(value, name[value]));
            return this
        }
        return this.each(d3_selection_property(name, value))
    }, d3_selectionPrototype.text = function (value) {
        return arguments.length ? this.each("function" == typeof value ? function () {
            var v = value.apply(this, arguments);
            this.textContent = null == v ? "" : v
        } : null == value ? function () {
            this.textContent = ""
        } : function () {
            this.textContent = value
        }) : this.node().textContent
    }, d3_selectionPrototype.html = function (value) {
        return arguments.length ? this.each("function" == typeof value ? function () {
            var v = value.apply(this, arguments);
            this.innerHTML = null == v ? "" : v
        } : null == value ? function () {
            this.innerHTML = ""
        } : function () {
            this.innerHTML = value
        }) : this.node().innerHTML
    }, d3_selectionPrototype.append = function (name) {
        function append() {
            return this.appendChild(d3_document.createElementNS(this.namespaceURI, name))
        }

        function appendNS() {
            return this.appendChild(d3_document.createElementNS(name.space, name.local))
        }

        return name = d3.ns.qualify(name), this.select(name.local ? appendNS : append)
    }, d3_selectionPrototype.insert = function (name, before) {
        function insert(d, i) {
            return this.insertBefore(d3_document.createElementNS(this.namespaceURI, name), before.call(this, d, i))
        }

        function insertNS(d, i) {
            return this.insertBefore(d3_document.createElementNS(name.space, name.local), before.call(this, d, i))
        }

        return name = d3.ns.qualify(name), "function" != typeof before && (before = d3_selection_selector(before)), this.select(name.local ? insertNS : insert)
    }, d3_selectionPrototype.remove = function () {
        return this.each(function () {
            var parent = this.parentNode;
            parent && parent.removeChild(this)
        })
    }, d3_selectionPrototype.data = function (value, key) {
        function bind(group, groupData) {
            var i, node, nodeData, n = group.length, m = groupData.length, n0 = Math.min(n, m), updateNodes = new Array(m), enterNodes = new Array(m), exitNodes = new Array(n);
            if (key) {
                var keyValue, nodeByKeyValue = new d3_Map, dataByKeyValue = new d3_Map, keyValues = [];
                for (i = -1; ++i < n;)keyValue = key.call(node = group[i], node.__data__, i), nodeByKeyValue.has(keyValue) ? exitNodes[i] = node : nodeByKeyValue.set(keyValue, node), keyValues.push(keyValue);
                for (i = -1; ++i < m;)keyValue = key.call(groupData, nodeData = groupData[i], i), (node = nodeByKeyValue.get(keyValue)) ? (updateNodes[i] = node, node.__data__ = nodeData) : dataByKeyValue.has(keyValue) || (enterNodes[i] = d3_selection_dataNode(nodeData)), dataByKeyValue.set(keyValue, nodeData), nodeByKeyValue.remove(keyValue);
                for (i = -1; ++i < n;)nodeByKeyValue.has(keyValues[i]) && (exitNodes[i] = group[i])
            } else {
                for (i = -1; ++i < n0;)node = group[i], nodeData = groupData[i], node ? (node.__data__ = nodeData, updateNodes[i] = node) : enterNodes[i] = d3_selection_dataNode(nodeData);
                for (; m > i; ++i)enterNodes[i] = d3_selection_dataNode(groupData[i]);
                for (; n > i; ++i)exitNodes[i] = group[i]
            }
            enterNodes.update = updateNodes, enterNodes.parentNode = updateNodes.parentNode = exitNodes.parentNode = group.parentNode, enter.push(enterNodes), update.push(updateNodes), exit.push(exitNodes)
        }

        var group, node, i = -1, n = this.length;
        if (!arguments.length) {
            for (value = new Array(n = (group = this[0]).length); ++i < n;)(node = group[i]) && (value[i] = node.__data__);
            return value
        }
        var enter = d3_selection_enter([]), update = d3_selection([]), exit = d3_selection([]);
        if ("function" == typeof value)for (; ++i < n;)bind(group = this[i], value.call(group, group.parentNode.__data__, i)); else for (; ++i < n;)bind(group = this[i], value);
        return update.enter = function () {
            return enter
        }, update.exit = function () {
            return exit
        }, update
    }, d3_selectionPrototype.datum = function (value) {
        return arguments.length ? this.property("__data__", value) : this.property("__data__")
    }, d3_selectionPrototype.filter = function (filter) {
        var subgroup, group, node, subgroups = [];
        "function" != typeof filter && (filter = d3_selection_filter(filter));
        for (var j = 0, m = this.length; m > j; j++) {
            subgroups.push(subgroup = []), subgroup.parentNode = (group = this[j]).parentNode;
            for (var i = 0, n = group.length; n > i; i++)(node = group[i]) && filter.call(node, node.__data__, i) && subgroup.push(node)
        }
        return d3_selection(subgroups)
    }, d3_selectionPrototype.order = function () {
        for (var j = -1, m = this.length; ++j < m;)for (var node, group = this[j], i = group.length - 1, next = group[i]; --i >= 0;)(node = group[i]) && (next && next !== node.nextSibling && next.parentNode.insertBefore(node, next), next = node);
        return this
    }, d3_selectionPrototype.sort = function (comparator) {
        comparator = d3_selection_sortComparator.apply(this, arguments);
        for (var j = -1, m = this.length; ++j < m;)this[j].sort(comparator);
        return this.order()
    }, d3_selectionPrototype.on = function (type, listener, capture) {
        var n = arguments.length;
        if (3 > n) {
            if ("string" != typeof type) {
                2 > n && (listener = !1);
                for (capture in type)this.each(d3_selection_on(capture, type[capture], listener));
                return this
            }
            if (2 > n)return(n = this.node()["__on" + type]) && n._;
            capture = !1
        }
        return this.each(d3_selection_on(type, listener, capture))
    };
    var d3_selection_onFilters = d3.map({mouseenter: "mouseover", mouseleave: "mouseout"});
    d3_selection_onFilters.forEach(function (k) {
        "on" + k in d3_document && d3_selection_onFilters.remove(k)
    }), d3_selectionPrototype.each = function (callback) {
        return d3_selection_each(this, function (node, i, j) {
            callback.call(node, node.__data__, i, j)
        })
    }, d3_selectionPrototype.call = function (callback) {
        var args = d3_array(arguments);
        return callback.apply(args[0] = this, args), this
    }, d3_selectionPrototype.empty = function () {
        return!this.node()
    }, d3_selectionPrototype.node = function () {
        for (var j = 0, m = this.length; m > j; j++)for (var group = this[j], i = 0, n = group.length; n > i; i++) {
            var node = group[i];
            if (node)return node
        }
        return null
    }, d3_selectionPrototype.size = function () {
        var n = 0;
        return this.each(function () {
            ++n
        }), n
    };
    var d3_selection_enterPrototype = [];
    d3.selection.enter = d3_selection_enter, d3.selection.enter.prototype = d3_selection_enterPrototype, d3_selection_enterPrototype.append = d3_selectionPrototype.append, d3_selection_enterPrototype.insert = d3_selectionPrototype.insert, d3_selection_enterPrototype.empty = d3_selectionPrototype.empty, d3_selection_enterPrototype.node = d3_selectionPrototype.node, d3_selection_enterPrototype.call = d3_selectionPrototype.call, d3_selection_enterPrototype.size = d3_selectionPrototype.size, d3_selection_enterPrototype.select = function (selector) {
        for (var subgroup, subnode, upgroup, group, node, subgroups = [], j = -1, m = this.length; ++j < m;) {
            upgroup = (group = this[j]).update, subgroups.push(subgroup = []), subgroup.parentNode = group.parentNode;
            for (var i = -1, n = group.length; ++i < n;)(node = group[i]) ? (subgroup.push(upgroup[i] = subnode = selector.call(group.parentNode, node.__data__, i)), subnode.__data__ = node.__data__) : subgroup.push(null)
        }
        return d3_selection(subgroups)
    }, d3_selectionPrototype.transition = function () {
        var subgroup, node, id = d3_transitionInheritId || ++d3_transitionId, subgroups = [], transition = Object.create(d3_transitionInherit);
        transition.time = Date.now();
        for (var j = -1, m = this.length; ++j < m;) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = -1, n = group.length; ++i < n;)(node = group[i]) && d3_transitionNode(node, i, id, transition), subgroup.push(node)
        }
        return d3_transition(subgroups, id)
    }, d3.select = function (node) {
        var group = ["string" == typeof node ? d3_select(node, d3_document) : node];
        return group.parentNode = d3_documentElement, d3_selection([group])
    }, d3.selectAll = function (nodes) {
        var group = d3_array("string" == typeof nodes ? d3_selectAll(nodes, d3_document) : nodes);
        return group.parentNode = d3_documentElement, d3_selection([group])
    };
    var d3_selectionRoot = d3.select(d3_documentElement);
    d3.behavior.zoom = function () {
        function zoom() {
            this.on("mousedown.zoom", mousedown).on("mousemove.zoom", mousemove).on(d3_behavior_zoomWheel + ".zoom", mousewheel).on("dblclick.zoom", dblclick).on("touchstart.zoom", touchstart).on("touchmove.zoom", touchmove).on("touchend.zoom", touchstart)
        }

        function location(p) {
            return[(p[0] - translate[0]) / scale, (p[1] - translate[1]) / scale]
        }

        function point(l) {
            return[l[0] * scale + translate[0], l[1] * scale + translate[1]]
        }

        function scaleTo(s) {
            scale = Math.max(scaleExtent[0], Math.min(scaleExtent[1], s))
        }

        function translateTo(p, l) {
            l = point(l), translate[0] += p[0] - l[0], translate[1] += p[1] - l[1]
        }

        function rescale() {
            x1 && x1.domain(x0.range().map(function (x) {
                return(x - translate[0]) / scale
            }).map(x0.invert)), y1 && y1.domain(y0.range().map(function (y) {
                return(y - translate[1]) / scale
            }).map(y0.invert))
        }

        function dispatch(event) {
            rescale(), d3.event.preventDefault(), event({type: "zoom", scale: scale, translate: translate})
        }

        function mousedown() {
            function mousemove() {
                moved = 1, translateTo(d3.mouse(target), l), dispatch(event_)
            }

            function mouseup() {
                moved && d3_eventCancel(), w.on("mousemove.zoom", null).on("mouseup.zoom", null), selectEnable(), moved && d3.event.target === eventTarget && d3_eventSuppress(w, "click.zoom")
            }

            var target = this, event_ = event.of(target, arguments), eventTarget = d3.event.target, moved = 0, w = d3.select(d3_window).on("mousemove.zoom", mousemove).on("mouseup.zoom", mouseup), l = location(d3.mouse(target)), selectEnable = d3_event_userSelectSuppress("zoom")
        }

        function mousewheel() {
            translate0 || (translate0 = location(d3.mouse(this))), scaleTo(Math.pow(2, .002 * d3_behavior_zoomDelta()) * scale), translateTo(d3.mouse(this), translate0), dispatch(event.of(this, arguments))
        }

        function mousemove() {
            translate0 = null
        }

        function dblclick() {
            var p = d3.mouse(this), l = location(p), k = Math.log(scale) / Math.LN2;
            scaleTo(Math.pow(2, d3.event.shiftKey ? Math.ceil(k) - 1 : Math.floor(k) + 1)), translateTo(p, l), dispatch(event.of(this, arguments))
        }

        function touchstart() {
            var touches = d3.touches(this), now = Date.now();
            if (scale0 = scale, translate0 = {}, touches.forEach(function (t) {
                translate0[t.identifier] = location(t)
            }), 1 === touches.length) {
                if (500 > now - touchtime) {
                    var p = touches[0], l = location(touches[0]);
                    scaleTo(2 * scale), translateTo(p, l), dispatch(event.of(this, arguments))
                }
                touchtime = now
            }
        }

        function touchmove() {
            var touches = d3.touches(this), p0 = touches[0], l0 = translate0[p0.identifier];
            if (p1 = touches[1]) {
                var p1, l1 = translate0[p1.identifier];
                p0 = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2], l0 = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2], scaleTo(d3.event.scale * scale0)
            }
            translateTo(p0, l0), touchtime = null, dispatch(event.of(this, arguments))
        }

        var translate0, scale0, x0, x1, y0, y1, touchtime, translate = [0, 0], scale = 1, scaleExtent = d3_behavior_zoomInfinity, event = d3_eventDispatch(zoom, "zoom");
        return zoom.translate = function (x) {
            return arguments.length ? (translate = x.map(Number), rescale(), zoom) : translate
        }, zoom.scale = function (x) {
            return arguments.length ? (scale = +x, rescale(), zoom) : scale
        }, zoom.scaleExtent = function (x) {
            return arguments.length ? (scaleExtent = null == x ? d3_behavior_zoomInfinity : x.map(Number), zoom) : scaleExtent
        }, zoom.x = function (z) {
            return arguments.length ? (x1 = z, x0 = z.copy(), translate = [0, 0], scale = 1, zoom) : x1
        }, zoom.y = function (z) {
            return arguments.length ? (y1 = z, y0 = z.copy(), translate = [0, 0], scale = 1, zoom) : y1
        }, d3.rebind(zoom, event, "on")
    };
    var d3_behavior_zoomDelta, d3_behavior_zoomInfinity = [0, 1 / 0], d3_behavior_zoomWheel = "onwheel"in d3_document ? (d3_behavior_zoomDelta = function () {
        return-d3.event.deltaY * (d3.event.deltaMode ? 120 : 1)
    }, "wheel") : "onmousewheel"in d3_document ? (d3_behavior_zoomDelta = function () {
        return d3.event.wheelDelta
    }, "mousewheel") : (d3_behavior_zoomDelta = function () {
        return-d3.event.detail
    }, "MozMousePixelScroll");
    d3_Color.prototype.toString = function () {
        return this.rgb() + ""
    }, d3.hsl = function (h, s, l) {
        return 1 === arguments.length ? h instanceof d3_Hsl ? d3_hsl(h.h, h.s, h.l) : d3_rgb_parse("" + h, d3_rgb_hsl, d3_hsl) : d3_hsl(+h, +s, +l)
    };
    var d3_hslPrototype = d3_Hsl.prototype = new d3_Color;
    d3_hslPrototype.brighter = function (k) {
        return k = Math.pow(.7, arguments.length ? k : 1), d3_hsl(this.h, this.s, this.l / k)
    }, d3_hslPrototype.darker = function (k) {
        return k = Math.pow(.7, arguments.length ? k : 1), d3_hsl(this.h, this.s, k * this.l)
    }, d3_hslPrototype.rgb = function () {
        return d3_hsl_rgb(this.h, this.s, this.l)
    };
    var π = Math.PI, ε = 1e-6, ε2 = ε * ε, d3_radians = π / 180, d3_degrees = 180 / π;
    d3.hcl = function (h, c, l) {
        return 1 === arguments.length ? h instanceof d3_Hcl ? d3_hcl(h.h, h.c, h.l) : h instanceof d3_Lab ? d3_lab_hcl(h.l, h.a, h.b) : d3_lab_hcl((h = d3_rgb_lab((h = d3.rgb(h)).r, h.g, h.b)).l, h.a, h.b) : d3_hcl(+h, +c, +l)
    };
    var d3_hclPrototype = d3_Hcl.prototype = new d3_Color;
    d3_hclPrototype.brighter = function (k) {
        return d3_hcl(this.h, this.c, Math.min(100, this.l + d3_lab_K * (arguments.length ? k : 1)))
    }, d3_hclPrototype.darker = function (k) {
        return d3_hcl(this.h, this.c, Math.max(0, this.l - d3_lab_K * (arguments.length ? k : 1)))
    }, d3_hclPrototype.rgb = function () {
        return d3_hcl_lab(this.h, this.c, this.l).rgb()
    }, d3.lab = function (l, a, b) {
        return 1 === arguments.length ? l instanceof d3_Lab ? d3_lab(l.l, l.a, l.b) : l instanceof d3_Hcl ? d3_hcl_lab(l.l, l.c, l.h) : d3_rgb_lab((l = d3.rgb(l)).r, l.g, l.b) : d3_lab(+l, +a, +b)
    };
    var d3_lab_K = 18, d3_lab_X = .95047, d3_lab_Y = 1, d3_lab_Z = 1.08883, d3_labPrototype = d3_Lab.prototype = new d3_Color;
    d3_labPrototype.brighter = function (k) {
        return d3_lab(Math.min(100, this.l + d3_lab_K * (arguments.length ? k : 1)), this.a, this.b)
    }, d3_labPrototype.darker = function (k) {
        return d3_lab(Math.max(0, this.l - d3_lab_K * (arguments.length ? k : 1)), this.a, this.b)
    }, d3_labPrototype.rgb = function () {
        return d3_lab_rgb(this.l, this.a, this.b)
    }, d3.rgb = function (r, g, b) {
        return 1 === arguments.length ? r instanceof d3_Rgb ? d3_rgb(r.r, r.g, r.b) : d3_rgb_parse("" + r, d3_rgb, d3_hsl_rgb) : d3_rgb(~~r, ~~g, ~~b)
    };
    var d3_rgbPrototype = d3_Rgb.prototype = new d3_Color;
    d3_rgbPrototype.brighter = function (k) {
        k = Math.pow(.7, arguments.length ? k : 1);
        var r = this.r, g = this.g, b = this.b, i = 30;
        return r || g || b ? (r && i > r && (r = i), g && i > g && (g = i), b && i > b && (b = i), d3_rgb(Math.min(255, Math.floor(r / k)), Math.min(255, Math.floor(g / k)), Math.min(255, Math.floor(b / k)))) : d3_rgb(i, i, i)
    }, d3_rgbPrototype.darker = function (k) {
        return k = Math.pow(.7, arguments.length ? k : 1), d3_rgb(Math.floor(k * this.r), Math.floor(k * this.g), Math.floor(k * this.b))
    }, d3_rgbPrototype.hsl = function () {
        return d3_rgb_hsl(this.r, this.g, this.b)
    }, d3_rgbPrototype.toString = function () {
        return"#" + d3_rgb_hex(this.r) + d3_rgb_hex(this.g) + d3_rgb_hex(this.b)
    };
    var d3_rgb_names = d3.map({aliceblue: "#f0f8ff", antiquewhite: "#faebd7", aqua: "#00ffff", aquamarine: "#7fffd4", azure: "#f0ffff", beige: "#f5f5dc", bisque: "#ffe4c4", black: "#000000", blanchedalmond: "#ffebcd", blue: "#0000ff", blueviolet: "#8a2be2", brown: "#a52a2a", burlywood: "#deb887", cadetblue: "#5f9ea0", chartreuse: "#7fff00", chocolate: "#d2691e", coral: "#ff7f50", cornflowerblue: "#6495ed", cornsilk: "#fff8dc", crimson: "#dc143c", cyan: "#00ffff", darkblue: "#00008b", darkcyan: "#008b8b", darkgoldenrod: "#b8860b", darkgray: "#a9a9a9", darkgreen: "#006400", darkgrey: "#a9a9a9", darkkhaki: "#bdb76b", darkmagenta: "#8b008b", darkolivegreen: "#556b2f", darkorange: "#ff8c00", darkorchid: "#9932cc", darkred: "#8b0000", darksalmon: "#e9967a", darkseagreen: "#8fbc8f", darkslateblue: "#483d8b", darkslategray: "#2f4f4f", darkslategrey: "#2f4f4f", darkturquoise: "#00ced1", darkviolet: "#9400d3", deeppink: "#ff1493", deepskyblue: "#00bfff", dimgray: "#696969", dimgrey: "#696969", dodgerblue: "#1e90ff", firebrick: "#b22222", floralwhite: "#fffaf0", forestgreen: "#228b22", fuchsia: "#ff00ff", gainsboro: "#dcdcdc", ghostwhite: "#f8f8ff", gold: "#ffd700", goldenrod: "#daa520", gray: "#808080", green: "#008000", greenyellow: "#adff2f", grey: "#808080", honeydew: "#f0fff0", hotpink: "#ff69b4", indianred: "#cd5c5c", indigo: "#4b0082", ivory: "#fffff0", khaki: "#f0e68c", lavender: "#e6e6fa", lavenderblush: "#fff0f5", lawngreen: "#7cfc00", lemonchiffon: "#fffacd", lightblue: "#add8e6", lightcoral: "#f08080", lightcyan: "#e0ffff", lightgoldenrodyellow: "#fafad2", lightgray: "#d3d3d3", lightgreen: "#90ee90", lightgrey: "#d3d3d3", lightpink: "#ffb6c1", lightsalmon: "#ffa07a", lightseagreen: "#20b2aa", lightskyblue: "#87cefa", lightslategray: "#778899", lightslategrey: "#778899", lightsteelblue: "#b0c4de", lightyellow: "#ffffe0", lime: "#00ff00", limegreen: "#32cd32", linen: "#faf0e6", magenta: "#ff00ff", maroon: "#800000", mediumaquamarine: "#66cdaa", mediumblue: "#0000cd", mediumorchid: "#ba55d3", mediumpurple: "#9370db", mediumseagreen: "#3cb371", mediumslateblue: "#7b68ee", mediumspringgreen: "#00fa9a", mediumturquoise: "#48d1cc", mediumvioletred: "#c71585", midnightblue: "#191970", mintcream: "#f5fffa", mistyrose: "#ffe4e1", moccasin: "#ffe4b5", navajowhite: "#ffdead", navy: "#000080", oldlace: "#fdf5e6", olive: "#808000", olivedrab: "#6b8e23", orange: "#ffa500", orangered: "#ff4500", orchid: "#da70d6", palegoldenrod: "#eee8aa", palegreen: "#98fb98", paleturquoise: "#afeeee", palevioletred: "#db7093", papayawhip: "#ffefd5", peachpuff: "#ffdab9", peru: "#cd853f", pink: "#ffc0cb", plum: "#dda0dd", powderblue: "#b0e0e6", purple: "#800080", red: "#ff0000", rosybrown: "#bc8f8f", royalblue: "#4169e1", saddlebrown: "#8b4513", salmon: "#fa8072", sandybrown: "#f4a460", seagreen: "#2e8b57", seashell: "#fff5ee", sienna: "#a0522d", silver: "#c0c0c0", skyblue: "#87ceeb", slateblue: "#6a5acd", slategray: "#708090", slategrey: "#708090", snow: "#fffafa", springgreen: "#00ff7f", steelblue: "#4682b4", tan: "#d2b48c", teal: "#008080", thistle: "#d8bfd8", tomato: "#ff6347", turquoise: "#40e0d0", violet: "#ee82ee", wheat: "#f5deb3", white: "#ffffff", whitesmoke: "#f5f5f5", yellow: "#ffff00", yellowgreen: "#9acd32"});
    d3_rgb_names.forEach(function (key, value) {
        d3_rgb_names.set(key, d3_rgb_parse(value, d3_rgb, d3_hsl_rgb))
    }), d3.functor = d3_functor, d3.xhr = d3_xhrType(d3_identity), d3.dsv = function (delimiter, mimeType) {
        function dsv(url, row, callback) {
            arguments.length < 3 && (callback = row, row = null);
            var xhr = d3.xhr(url, mimeType, callback);
            return xhr.row = function (_) {
                return arguments.length ? xhr.response(null == (row = _) ? response : typedResponse(_)) : row
            }, xhr.row(row)
        }

        function response(request) {
            return dsv.parse(request.responseText)
        }

        function typedResponse(f) {
            return function (request) {
                return dsv.parse(request.responseText, f)
            }
        }

        function formatRow(row) {
            return row.map(formatValue).join(delimiter)
        }

        function formatValue(text) {
            return reFormat.test(text) ? '"' + text.replace(/\"/g, '""') + '"' : text
        }

        var reFormat = new RegExp('["' + delimiter + "\n]"), delimiterCode = delimiter.charCodeAt(0);
        return dsv.parse = function (text, f) {
            var o;
            return dsv.parseRows(text, function (row, i) {
                if (o)return o(row, i - 1);
                var a = new Function("d", "return {" + row.map(function (name, i) {
                    return JSON.stringify(name) + ": d[" + i + "]"
                }).join(",") + "}");
                o = f ? function (row, i) {
                    return f(a(row), i)
                } : a
            })
        }, dsv.parseRows = function (text, f) {
            function token() {
                if (I >= N)return EOF;
                if (eol)return eol = !1, EOL;
                var j = I;
                if (34 === text.charCodeAt(j)) {
                    for (var i = j; i++ < N;)if (34 === text.charCodeAt(i)) {
                        if (34 !== text.charCodeAt(i + 1))break;
                        ++i
                    }
                    I = i + 2;
                    var c = text.charCodeAt(i + 1);
                    return 13 === c ? (eol = !0, 10 === text.charCodeAt(i + 2) && ++I) : 10 === c && (eol = !0), text.substring(j + 1, i).replace(/""/g, '"')
                }
                for (; N > I;) {
                    var c = text.charCodeAt(I++), k = 1;
                    if (10 === c)eol = !0; else if (13 === c)eol = !0, 10 === text.charCodeAt(I) && (++I, ++k); else if (c !== delimiterCode)continue;
                    return text.substring(j, I - k)
                }
                return text.substring(j)
            }

            for (var t, eol, EOL = {}, EOF = {}, rows = [], N = text.length, I = 0, n = 0; (t = token()) !== EOF;) {
                for (var a = []; t !== EOL && t !== EOF;)a.push(t), t = token();
                (!f || (a = f(a, n++))) && rows.push(a)
            }
            return rows
        }, dsv.format = function (rows) {
            if (Array.isArray(rows[0]))return dsv.formatRows(rows);
            var fieldSet = new d3_Set, fields = [];
            return rows.forEach(function (row) {
                for (var field in row)fieldSet.has(field) || fields.push(fieldSet.add(field))
            }), [fields.map(formatValue).join(delimiter)].concat(rows.map(function (row) {
                return fields.map(function (field) {
                    return formatValue(row[field])
                }).join(delimiter)
            })).join("\n")
        }, dsv.formatRows = function (rows) {
            return rows.map(formatRow).join("\n")
        }, dsv
    }, d3.csv = d3.dsv(",", "text/csv"), d3.tsv = d3.dsv("	", "text/tab-separated-values");
    var d3_timer_queueHead, d3_timer_queueTail, d3_timer_interval, d3_timer_timeout;
    d3.timer = function (callback, delay, then) {
        if (arguments.length < 3) {
            if (arguments.length < 2)delay = 0; else if (!isFinite(delay))return;
            then = Date.now()
        }
        var time = then + delay, timer = {callback: callback, time: time, next: null};
        d3_timer_queueTail ? d3_timer_queueTail.next = timer : d3_timer_queueHead = timer, d3_timer_queueTail = timer, d3_timer_interval || (d3_timer_timeout = clearTimeout(d3_timer_timeout), d3_timer_interval = 1, d3_timer_frame(d3_timer_step))
    }, d3.timer.flush = function () {
        d3_timer_mark(), d3_timer_sweep()
    };
    var d3_timer_frame = d3_window[d3_vendorSymbol(d3_window, "requestAnimationFrame")] || function (callback) {
        setTimeout(callback, 17)
    }, d3_format_decimalPoint = ".", d3_format_thousandsSeparator = ",", d3_format_grouping = [3, 3], d3_formatPrefixes = ["y", "z", "a", "f", "p", "n", "µ", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y"].map(d3_formatPrefix);
    d3.formatPrefix = function (value, precision) {
        var i = 0;
        return value && (0 > value && (value *= -1), precision && (value = d3.round(value, d3_format_precision(value, precision))), i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10), i = Math.max(-24, Math.min(24, 3 * Math.floor((0 >= i ? i + 1 : i - 1) / 3)))), d3_formatPrefixes[8 + i / 3]
    }, d3.round = function (x, n) {
        return n ? Math.round(x * (n = Math.pow(10, n))) / n : Math.round(x)
    }, d3.format = function (specifier) {
        var match = d3_format_re.exec(specifier), fill = match[1] || " ", align = match[2] || ">", sign = match[3] || "", basePrefix = match[4] || "", zfill = match[5], width = +match[6], comma = match[7], precision = match[8], type = match[9], scale = 1, suffix = "", integer = !1;
        switch (precision && (precision = +precision.substring(1)), (zfill || "0" === fill && "=" === align) && (zfill = fill = "0", align = "=", comma && (width -= Math.floor((width - 1) / 4))), type) {
            case"n":
                comma = !0, type = "g";
                break;
            case"%":
                scale = 100, suffix = "%", type = "f";
                break;
            case"p":
                scale = 100, suffix = "%", type = "r";
                break;
            case"b":
            case"o":
            case"x":
            case"X":
                basePrefix && (basePrefix = "0" + type.toLowerCase());
            case"c":
            case"d":
                integer = !0, precision = 0;
                break;
            case"s":
                scale = -1, type = "r"
        }
        "#" === basePrefix && (basePrefix = ""), "r" != type || precision || (type = "g"), null != precision && ("g" == type ? precision = Math.max(1, Math.min(21, precision)) : ("e" == type || "f" == type) && (precision = Math.max(0, Math.min(20, precision)))), type = d3_format_types.get(type) || d3_format_typeDefault;
        var zcomma = zfill && comma;
        return function (value) {
            if (integer && value % 1)return"";
            var negative = 0 > value || 0 === value && 0 > 1 / value ? (value = -value, "-") : sign;
            if (0 > scale) {
                var prefix = d3.formatPrefix(value, precision);
                value = prefix.scale(value), suffix = prefix.symbol
            } else value *= scale;
            value = type(value, precision), !zfill && comma && (value = d3_format_group(value));
            var length = basePrefix.length + value.length + (zcomma ? 0 : negative.length), padding = width > length ? new Array(length = width - length + 1).join(fill) : "";
            return zcomma && (value = d3_format_group(padding + value)), d3_format_decimalPoint && value.replace(".", d3_format_decimalPoint), negative += basePrefix, ("<" === align ? negative + value + padding : ">" === align ? padding + negative + value : "^" === align ? padding.substring(0, length >>= 1) + negative + value + padding.substring(length) : negative + (zcomma ? value : padding + value)) + suffix
        }
    };
    var d3_format_re = /(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i, d3_format_types = d3.map({b: function (x) {
        return x.toString(2)
    }, c: function (x) {
        return String.fromCharCode(x)
    }, o: function (x) {
        return x.toString(8)
    }, x: function (x) {
        return x.toString(16)
    }, X: function (x) {
        return x.toString(16).toUpperCase()
    }, g: function (x, p) {
        return x.toPrecision(p)
    }, e: function (x, p) {
        return x.toExponential(p)
    }, f: function (x, p) {
        return x.toFixed(p)
    }, r: function (x, p) {
        return(x = d3.round(x, d3_format_precision(x, p))).toFixed(Math.max(0, Math.min(20, d3_format_precision(x * (1 + 1e-15), p))))
    }}), d3_format_group = d3_identity;
    if (d3_format_grouping) {
        var d3_format_groupingLength = d3_format_grouping.length;
        d3_format_group = function (value) {
            for (var i = value.lastIndexOf("."), f = i >= 0 ? "." + value.substring(i + 1) : (i = value.length, ""), t = [], j = 0, g = d3_format_grouping[0]; i > 0 && g > 0;)t.push(value.substring(i -= g, i + g)), g = d3_format_grouping[j = (j + 1) % d3_format_groupingLength];
            return t.reverse().join(d3_format_thousandsSeparator || "") + f
        }
    }
    d3.geo = {}, d3_adder.prototype = {s: 0, t: 0, add: function (y) {
        d3_adderSum(y, this.t, d3_adderTemp), d3_adderSum(d3_adderTemp.s, this.s, this), this.s ? this.t += d3_adderTemp.t : this.s = d3_adderTemp.t
    }, reset: function () {
        this.s = this.t = 0
    }, valueOf: function () {
        return this.s
    }};
    var d3_adderTemp = new d3_adder;
    d3.geo.stream = function (object, listener) {
        object && d3_geo_streamObjectType.hasOwnProperty(object.type) ? d3_geo_streamObjectType[object.type](object, listener) : d3_geo_streamGeometry(object, listener)
    };
    var d3_geo_streamObjectType = {Feature: function (feature, listener) {
        d3_geo_streamGeometry(feature.geometry, listener)
    }, FeatureCollection: function (object, listener) {
        for (var features = object.features, i = -1, n = features.length; ++i < n;)d3_geo_streamGeometry(features[i].geometry, listener)
    }}, d3_geo_streamGeometryType = {Sphere: function (object, listener) {
        listener.sphere()
    }, Point: function (object, listener) {
        var coordinate = object.coordinates;
        listener.point(coordinate[0], coordinate[1])
    }, MultiPoint: function (object, listener) {
        for (var coordinate, coordinates = object.coordinates, i = -1, n = coordinates.length; ++i < n;)coordinate = coordinates[i], listener.point(coordinate[0], coordinate[1])
    }, LineString: function (object, listener) {
        d3_geo_streamLine(object.coordinates, listener, 0)
    }, MultiLineString: function (object, listener) {
        for (var coordinates = object.coordinates, i = -1, n = coordinates.length; ++i < n;)d3_geo_streamLine(coordinates[i], listener, 0)
    }, Polygon: function (object, listener) {
        d3_geo_streamPolygon(object.coordinates, listener)
    }, MultiPolygon: function (object, listener) {
        for (var coordinates = object.coordinates, i = -1, n = coordinates.length; ++i < n;)d3_geo_streamPolygon(coordinates[i], listener)
    }, GeometryCollection: function (object, listener) {
        for (var geometries = object.geometries, i = -1, n = geometries.length; ++i < n;)d3_geo_streamGeometry(geometries[i], listener)
    }};
    d3.geo.area = function (object) {
        return d3_geo_areaSum = 0, d3.geo.stream(object, d3_geo_area), d3_geo_areaSum
    };
    var d3_geo_areaSum, d3_geo_areaRingSum = new d3_adder, d3_geo_area = {sphere: function () {
        d3_geo_areaSum += 4 * π
    }, point: d3_noop, lineStart: d3_noop, lineEnd: d3_noop, polygonStart: function () {
        d3_geo_areaRingSum.reset(), d3_geo_area.lineStart = d3_geo_areaRingStart
    }, polygonEnd: function () {
        var area = 2 * d3_geo_areaRingSum;
        d3_geo_areaSum += 0 > area ? 4 * π + area : area, d3_geo_area.lineStart = d3_geo_area.lineEnd = d3_geo_area.point = d3_noop
    }};
    d3.geo.bounds = function () {
        function point(λ, φ) {
            ranges.push(range = [λ0 = λ, λ1 = λ]), φ0 > φ && (φ0 = φ), φ > φ1 && (φ1 = φ)
        }

        function linePoint(λ, φ) {
            var p = d3_geo_cartesian([λ * d3_radians, φ * d3_radians]);
            if (p0) {
                var normal = d3_geo_cartesianCross(p0, p), equatorial = [normal[1], -normal[0], 0], inflection = d3_geo_cartesianCross(equatorial, normal);
                d3_geo_cartesianNormalize(inflection), inflection = d3_geo_spherical(inflection);
                var dλ = λ - λ_, s = dλ > 0 ? 1 : -1, λi = inflection[0] * d3_degrees * s, antimeridian = Math.abs(dλ) > 180;
                if (antimeridian ^ (λi > s * λ_ && s * λ > λi)) {
                    var φi = inflection[1] * d3_degrees;
                    φi > φ1 && (φ1 = φi)
                } else if (λi = (λi + 360) % 360 - 180, antimeridian ^ (λi > s * λ_ && s * λ > λi)) {
                    var φi = -inflection[1] * d3_degrees;
                    φ0 > φi && (φ0 = φi)
                } else φ0 > φ && (φ0 = φ), φ > φ1 && (φ1 = φ);
                antimeridian ? λ_ > λ ? angle(λ0, λ) > angle(λ0, λ1) && (λ1 = λ) : angle(λ, λ1) > angle(λ0, λ1) && (λ0 = λ) : λ1 >= λ0 ? (λ0 > λ && (λ0 = λ), λ > λ1 && (λ1 = λ)) : λ > λ_ ? angle(λ0, λ) > angle(λ0, λ1) && (λ1 = λ) : angle(λ, λ1) > angle(λ0, λ1) && (λ0 = λ)
            } else point(λ, φ);
            p0 = p, λ_ = λ
        }

        function lineStart() {
            bound.point = linePoint
        }

        function lineEnd() {
            range[0] = λ0, range[1] = λ1, bound.point = point, p0 = null
        }

        function ringPoint(λ, φ) {
            if (p0) {
                var dλ = λ - λ_;
                dλSum += Math.abs(dλ) > 180 ? dλ + (dλ > 0 ? 360 : -360) : dλ
            } else λ__ = λ, φ__ = φ;
            d3_geo_area.point(λ, φ), linePoint(λ, φ)
        }

        function ringStart() {
            d3_geo_area.lineStart()
        }

        function ringEnd() {
            ringPoint(λ__, φ__), d3_geo_area.lineEnd(), Math.abs(dλSum) > ε && (λ0 = -(λ1 = 180)), range[0] = λ0, range[1] = λ1, p0 = null
        }

        function angle(λ0, λ1) {
            return(λ1 -= λ0) < 0 ? λ1 + 360 : λ1
        }

        function compareRanges(a, b) {
            return a[0] - b[0]
        }

        function withinRange(x, range) {
            return range[0] <= range[1] ? range[0] <= x && x <= range[1] : x < range[0] || range[1] < x
        }

        var λ0, φ0, λ1, φ1, λ_, λ__, φ__, p0, dλSum, ranges, range, bound = {point: point, lineStart: lineStart, lineEnd: lineEnd, polygonStart: function () {
            bound.point = ringPoint, bound.lineStart = ringStart, bound.lineEnd = ringEnd, dλSum = 0, d3_geo_area.polygonStart()
        }, polygonEnd: function () {
            d3_geo_area.polygonEnd(), bound.point = point, bound.lineStart = lineStart, bound.lineEnd = lineEnd, 0 > d3_geo_areaRingSum ? (λ0 = -(λ1 = 180), φ0 = -(φ1 = 90)) : dλSum > ε ? φ1 = 90 : -ε > dλSum && (φ0 = -90), range[0] = λ0, range[1] = λ1
        }};
        return function (feature) {
            φ1 = λ1 = -(λ0 = φ0 = 1 / 0), ranges = [], d3.geo.stream(feature, bound);
            var n = ranges.length;
            if (n) {
                ranges.sort(compareRanges);
                for (var b, i = 1, a = ranges[0], merged = [a]; n > i; ++i)b = ranges[i], withinRange(b[0], a) || withinRange(b[1], a) ? (angle(a[0], b[1]) > angle(a[0], a[1]) && (a[1] = b[1]), angle(b[0], a[1]) > angle(a[0], a[1]) && (a[0] = b[0])) : merged.push(a = b);
                for (var dλ, b, best = -1 / 0, n = merged.length - 1, i = 0, a = merged[n]; n >= i; a = b, ++i)b = merged[i], (dλ = angle(a[1], b[0])) > best && (best = dλ, λ0 = b[0], λ1 = a[1])
            }
            return ranges = range = null, 1 / 0 === λ0 || 1 / 0 === φ0 ? [
                [0 / 0, 0 / 0],
                [0 / 0, 0 / 0]
            ] : [
                [λ0, φ0],
                [λ1, φ1]
            ]
        }
    }(), d3.geo.centroid = function (object) {
        d3_geo_centroidW0 = d3_geo_centroidW1 = d3_geo_centroidX0 = d3_geo_centroidY0 = d3_geo_centroidZ0 = d3_geo_centroidX1 = d3_geo_centroidY1 = d3_geo_centroidZ1 = d3_geo_centroidX2 = d3_geo_centroidY2 = d3_geo_centroidZ2 = 0, d3.geo.stream(object, d3_geo_centroid);
        var x = d3_geo_centroidX2, y = d3_geo_centroidY2, z = d3_geo_centroidZ2, m = x * x + y * y + z * z;
        return ε2 > m && (x = d3_geo_centroidX1, y = d3_geo_centroidY1, z = d3_geo_centroidZ1, ε > d3_geo_centroidW1 && (x = d3_geo_centroidX0, y = d3_geo_centroidY0, z = d3_geo_centroidZ0), m = x * x + y * y + z * z, ε2 > m) ? [0 / 0, 0 / 0] : [Math.atan2(y, x) * d3_degrees, d3_asin(z / Math.sqrt(m)) * d3_degrees]
    };
    var d3_geo_centroidW0, d3_geo_centroidW1, d3_geo_centroidX0, d3_geo_centroidY0, d3_geo_centroidZ0, d3_geo_centroidX1, d3_geo_centroidY1, d3_geo_centroidZ1, d3_geo_centroidX2, d3_geo_centroidY2, d3_geo_centroidZ2, d3_geo_centroid = {sphere: d3_noop, point: d3_geo_centroidPoint, lineStart: d3_geo_centroidLineStart, lineEnd: d3_geo_centroidLineEnd, polygonStart: function () {
        d3_geo_centroid.lineStart = d3_geo_centroidRingStart
    }, polygonEnd: function () {
        d3_geo_centroid.lineStart = d3_geo_centroidLineStart
    }}, d3_geo_clipAntimeridian = d3_geo_clip(d3_true, d3_geo_clipAntimeridianLine, d3_geo_clipAntimeridianInterpolate, d3_geo_clipAntimeridianPolygonContains), d3_geo_clipAntimeridianPoint = [-π, 0], d3_geo_clipViewMAX = 1e9;
    (d3.geo.conicEqualArea = function () {
        return d3_geo_conic(d3_geo_conicEqualArea)
    }).raw = d3_geo_conicEqualArea, d3.geo.albers = function () {
        return d3.geo.conicEqualArea().rotate([96, 0]).center([-.6, 38.7]).parallels([29.5, 45.5]).scale(1070)
    }, d3.geo.albersUsa = function () {
        function albersUsa(coordinates) {
            var x = coordinates[0], y = coordinates[1];
            return point = null, lower48Point(x, y), point || (alaskaPoint(x, y), point) || hawaiiPoint(x, y), point
        }

        var point, lower48Point, alaskaPoint, hawaiiPoint, lower48 = d3.geo.albers(), alaska = d3.geo.conicEqualArea().rotate([154, 0]).center([-2, 58.5]).parallels([55, 65]), hawaii = d3.geo.conicEqualArea().rotate([157, 0]).center([-3, 19.9]).parallels([8, 18]), pointStream = {point: function (x, y) {
            point = [x, y]
        }};
        return albersUsa.invert = function (coordinates) {
            var k = lower48.scale(), t = lower48.translate(), x = (coordinates[0] - t[0]) / k, y = (coordinates[1] - t[1]) / k;
            return(y >= .12 && .234 > y && x >= -.425 && -.214 > x ? alaska : y >= .166 && .234 > y && x >= -.214 && -.115 > x ? hawaii : lower48).invert(coordinates)
        }, albersUsa.stream = function (stream) {
            var lower48Stream = lower48.stream(stream), alaskaStream = alaska.stream(stream), hawaiiStream = hawaii.stream(stream);
            return{point: function (x, y) {
                lower48Stream.point(x, y), alaskaStream.point(x, y), hawaiiStream.point(x, y)
            }, sphere: function () {
                lower48Stream.sphere(), alaskaStream.sphere(), hawaiiStream.sphere()
            }, lineStart: function () {
                lower48Stream.lineStart(), alaskaStream.lineStart(), hawaiiStream.lineStart()
            }, lineEnd: function () {
                lower48Stream.lineEnd(), alaskaStream.lineEnd(), hawaiiStream.lineEnd()
            }, polygonStart: function () {
                lower48Stream.polygonStart(), alaskaStream.polygonStart(), hawaiiStream.polygonStart()
            }, polygonEnd: function () {
                lower48Stream.polygonEnd(), alaskaStream.polygonEnd(), hawaiiStream.polygonEnd()
            }}
        }, albersUsa.precision = function (_) {
            return arguments.length ? (lower48.precision(_), alaska.precision(_), hawaii.precision(_), albersUsa) : lower48.precision()
        }, albersUsa.scale = function (_) {
            return arguments.length ? (lower48.scale(_), alaska.scale(.35 * _), hawaii.scale(_), albersUsa.translate(lower48.translate())) : lower48.scale()
        }, albersUsa.translate = function (_) {
            if (!arguments.length)return lower48.translate();
            var k = lower48.scale(), x = +_[0], y = +_[1];
            return lower48Point = lower48.translate(_).clipExtent([
                [x - .455 * k, y - .238 * k],
                [x + .455 * k, y + .238 * k]
            ]).stream(pointStream).point, alaskaPoint = alaska.translate([x - .307 * k, y + .201 * k]).clipExtent([
                [x - .425 * k + ε, y + .12 * k + ε],
                [x - .214 * k - ε, y + .234 * k - ε]
            ]).stream(pointStream).point, hawaiiPoint = hawaii.translate([x - .205 * k, y + .212 * k]).clipExtent([
                [x - .214 * k + ε, y + .166 * k + ε],
                [x - .115 * k - ε, y + .234 * k - ε]
            ]).stream(pointStream).point, albersUsa
        }, albersUsa.scale(1070)
    };
    var d3_geo_pathAreaSum, d3_geo_pathAreaPolygon, d3_geo_pathBoundsX0, d3_geo_pathBoundsY0, d3_geo_pathBoundsX1, d3_geo_pathBoundsY1, d3_geo_pathArea = {point: d3_noop, lineStart: d3_noop, lineEnd: d3_noop, polygonStart: function () {
        d3_geo_pathAreaPolygon = 0, d3_geo_pathArea.lineStart = d3_geo_pathAreaRingStart
    }, polygonEnd: function () {
        d3_geo_pathArea.lineStart = d3_geo_pathArea.lineEnd = d3_geo_pathArea.point = d3_noop, d3_geo_pathAreaSum += Math.abs(d3_geo_pathAreaPolygon / 2)
    }}, d3_geo_pathBounds = {point: d3_geo_pathBoundsPoint, lineStart: d3_noop, lineEnd: d3_noop, polygonStart: d3_noop, polygonEnd: d3_noop}, d3_geo_pathCentroid = {point: d3_geo_pathCentroidPoint, lineStart: d3_geo_pathCentroidLineStart, lineEnd: d3_geo_pathCentroidLineEnd, polygonStart: function () {
        d3_geo_pathCentroid.lineStart = d3_geo_pathCentroidRingStart
    }, polygonEnd: function () {
        d3_geo_pathCentroid.point = d3_geo_pathCentroidPoint, d3_geo_pathCentroid.lineStart = d3_geo_pathCentroidLineStart, d3_geo_pathCentroid.lineEnd = d3_geo_pathCentroidLineEnd
    }};
    d3.geo.path = function () {
        function path(object) {
            return object && ("function" == typeof pointRadius && contextStream.pointRadius(+pointRadius.apply(this, arguments)), cacheStream && cacheStream.valid || (cacheStream = projectStream(contextStream)), d3.geo.stream(object, cacheStream)), contextStream.result()
        }

        function reset() {
            return cacheStream = null, path
        }

        var projection, context, projectStream, contextStream, cacheStream, pointRadius = 4.5;
        return path.area = function (object) {
            return d3_geo_pathAreaSum = 0, d3.geo.stream(object, projectStream(d3_geo_pathArea)), d3_geo_pathAreaSum
        }, path.centroid = function (object) {
            return d3_geo_centroidX0 = d3_geo_centroidY0 = d3_geo_centroidZ0 = d3_geo_centroidX1 = d3_geo_centroidY1 = d3_geo_centroidZ1 = d3_geo_centroidX2 = d3_geo_centroidY2 = d3_geo_centroidZ2 = 0, d3.geo.stream(object, projectStream(d3_geo_pathCentroid)), d3_geo_centroidZ2 ? [d3_geo_centroidX2 / d3_geo_centroidZ2, d3_geo_centroidY2 / d3_geo_centroidZ2] : d3_geo_centroidZ1 ? [d3_geo_centroidX1 / d3_geo_centroidZ1, d3_geo_centroidY1 / d3_geo_centroidZ1] : d3_geo_centroidZ0 ? [d3_geo_centroidX0 / d3_geo_centroidZ0, d3_geo_centroidY0 / d3_geo_centroidZ0] : [0 / 0, 0 / 0]
        }, path.bounds = function (object) {
            return d3_geo_pathBoundsX1 = d3_geo_pathBoundsY1 = -(d3_geo_pathBoundsX0 = d3_geo_pathBoundsY0 = 1 / 0), d3.geo.stream(object, projectStream(d3_geo_pathBounds)), [
                [d3_geo_pathBoundsX0, d3_geo_pathBoundsY0],
                [d3_geo_pathBoundsX1, d3_geo_pathBoundsY1]
            ]
        }, path.projection = function (_) {
            return arguments.length ? (projectStream = (projection = _) ? _.stream || d3_geo_pathProjectStream(_) : d3_identity, reset()) : projection
        }, path.context = function (_) {
            return arguments.length ? (contextStream = null == (context = _) ? new d3_geo_pathBuffer : new d3_geo_pathContext(_), "function" != typeof pointRadius && contextStream.pointRadius(pointRadius), reset()) : context
        }, path.pointRadius = function (_) {
            return arguments.length ? (pointRadius = "function" == typeof _ ? _ : (contextStream.pointRadius(+_), +_), path) : pointRadius
        }, path.projection(d3.geo.albersUsa()).context(null)
    }, d3.geo.projection = d3_geo_projection, d3.geo.projectionMutator = d3_geo_projectionMutator, (d3.geo.equirectangular = function () {
        return d3_geo_projection(d3_geo_equirectangular)
    }).raw = d3_geo_equirectangular.invert = d3_geo_equirectangular, d3.geo.rotation = function (rotate) {
        function forward(coordinates) {
            return coordinates = rotate(coordinates[0] * d3_radians, coordinates[1] * d3_radians), coordinates[0] *= d3_degrees, coordinates[1] *= d3_degrees, coordinates
        }

        return rotate = d3_geo_rotation(rotate[0] % 360 * d3_radians, rotate[1] * d3_radians, rotate.length > 2 ? rotate[2] * d3_radians : 0), forward.invert = function (coordinates) {
            return coordinates = rotate.invert(coordinates[0] * d3_radians, coordinates[1] * d3_radians), coordinates[0] *= d3_degrees, coordinates[1] *= d3_degrees, coordinates
        }, forward
    }, d3.geo.circle = function () {
        function circle() {
            var center = "function" == typeof origin ? origin.apply(this, arguments) : origin, rotate = d3_geo_rotation(-center[0] * d3_radians, -center[1] * d3_radians, 0).invert, ring = [];
            return interpolate(null, null, 1, {point: function (x, y) {
                ring.push(x = rotate(x, y)), x[0] *= d3_degrees, x[1] *= d3_degrees
            }}), {type: "Polygon", coordinates: [ring]}
        }

        var angle, interpolate, origin = [0, 0], precision = 6;
        return circle.origin = function (x) {
            return arguments.length ? (origin = x, circle) : origin
        }, circle.angle = function (x) {
            return arguments.length ? (interpolate = d3_geo_circleInterpolate((angle = +x) * d3_radians, precision * d3_radians), circle) : angle
        }, circle.precision = function (_) {
            return arguments.length ? (interpolate = d3_geo_circleInterpolate(angle * d3_radians, (precision = +_) * d3_radians), circle) : precision
        }, circle.angle(90)
    }, d3.geo.distance = function (a, b) {
        var t, Δλ = (b[0] - a[0]) * d3_radians, φ0 = a[1] * d3_radians, φ1 = b[1] * d3_radians, sinΔλ = Math.sin(Δλ), cosΔλ = Math.cos(Δλ), sinφ0 = Math.sin(φ0), cosφ0 = Math.cos(φ0), sinφ1 = Math.sin(φ1), cosφ1 = Math.cos(φ1);
        return Math.atan2(Math.sqrt((t = cosφ1 * sinΔλ) * t + (t = cosφ0 * sinφ1 - sinφ0 * cosφ1 * cosΔλ) * t), sinφ0 * sinφ1 + cosφ0 * cosφ1 * cosΔλ)
    }, d3.geo.graticule = function () {
        function graticule() {
            return{type: "MultiLineString", coordinates: lines()}
        }

        function lines() {
            return d3.range(Math.ceil(X0 / DX) * DX, X1, DX).map(X).concat(d3.range(Math.ceil(Y0 / DY) * DY, Y1, DY).map(Y)).concat(d3.range(Math.ceil(x0 / dx) * dx, x1, dx).filter(function (x) {
                return Math.abs(x % DX) > ε
            }).map(x)).concat(d3.range(Math.ceil(y0 / dy) * dy, y1, dy).filter(function (y) {
                return Math.abs(y % DY) > ε
            }).map(y))
        }

        var x1, x0, X1, X0, y1, y0, Y1, Y0, x, y, X, Y, dx = 10, dy = dx, DX = 90, DY = 360, precision = 2.5;
        return graticule.lines = function () {
            return lines().map(function (coordinates) {
                return{type: "LineString", coordinates: coordinates}
            })
        }, graticule.outline = function () {
            return{type: "Polygon", coordinates: [X(X0).concat(Y(Y1).slice(1), X(X1).reverse().slice(1), Y(Y0).reverse().slice(1))]}
        }, graticule.extent = function (_) {
            return arguments.length ? graticule.majorExtent(_).minorExtent(_) : graticule.minorExtent()
        }, graticule.majorExtent = function (_) {
            return arguments.length ? (X0 = +_[0][0], X1 = +_[1][0], Y0 = +_[0][1], Y1 = +_[1][1], X0 > X1 && (_ = X0, X0 = X1, X1 = _), Y0 > Y1 && (_ = Y0, Y0 = Y1, Y1 = _), graticule.precision(precision)) : [
                [X0, Y0],
                [X1, Y1]
            ]
        }, graticule.minorExtent = function (_) {
            return arguments.length ? (x0 = +_[0][0], x1 = +_[1][0], y0 = +_[0][1], y1 = +_[1][1], x0 > x1 && (_ = x0, x0 = x1, x1 = _), y0 > y1 && (_ = y0, y0 = y1, y1 = _), graticule.precision(precision)) : [
                [x0, y0],
                [x1, y1]
            ]
        }, graticule.step = function (_) {
            return arguments.length ? graticule.majorStep(_).minorStep(_) : graticule.minorStep()
        }, graticule.majorStep = function (_) {
            return arguments.length ? (DX = +_[0], DY = +_[1], graticule) : [DX, DY]
        }, graticule.minorStep = function (_) {
            return arguments.length ? (dx = +_[0], dy = +_[1], graticule) : [dx, dy]
        }, graticule.precision = function (_) {
            return arguments.length ? (precision = +_, x = d3_geo_graticuleX(y0, y1, 90), y = d3_geo_graticuleY(x0, x1, precision), X = d3_geo_graticuleX(Y0, Y1, 90), Y = d3_geo_graticuleY(X0, X1, precision), graticule) : precision
        }, graticule.majorExtent([
            [-180, -90 + ε],
            [180, 90 - ε]
        ]).minorExtent([
            [-180, -80 - ε],
            [180, 80 + ε]
        ])
    }, d3.geo.greatArc = function () {
        function greatArc() {
            return{type: "LineString", coordinates: [source_ || source.apply(this, arguments), target_ || target.apply(this, arguments)]}
        }

        var source_, target_, source = d3_source, target = d3_target;
        return greatArc.distance = function () {
            return d3.geo.distance(source_ || source.apply(this, arguments), target_ || target.apply(this, arguments))
        }, greatArc.source = function (_) {
            return arguments.length ? (source = _, source_ = "function" == typeof _ ? null : _, greatArc) : source
        }, greatArc.target = function (_) {
            return arguments.length ? (target = _, target_ = "function" == typeof _ ? null : _, greatArc) : target
        }, greatArc.precision = function () {
            return arguments.length ? greatArc : 0
        }, greatArc
    }, d3.geo.interpolate = function (source, target) {
        return d3_geo_interpolate(source[0] * d3_radians, source[1] * d3_radians, target[0] * d3_radians, target[1] * d3_radians)
    }, d3.geo.length = function (object) {
        return d3_geo_lengthSum = 0, d3.geo.stream(object, d3_geo_length), d3_geo_lengthSum
    };
    var d3_geo_lengthSum, d3_geo_length = {sphere: d3_noop, point: d3_noop, lineStart: d3_geo_lengthLineStart, lineEnd: d3_noop, polygonStart: d3_noop, polygonEnd: d3_noop}, d3_geo_azimuthalEqualArea = d3_geo_azimuthal(function (cosλcosφ) {
        return Math.sqrt(2 / (1 + cosλcosφ))
    }, function (ρ) {
        return 2 * Math.asin(ρ / 2)
    });
    (d3.geo.azimuthalEqualArea = function () {
        return d3_geo_projection(d3_geo_azimuthalEqualArea)
    }).raw = d3_geo_azimuthalEqualArea;
    var d3_geo_azimuthalEquidistant = d3_geo_azimuthal(function (cosλcosφ) {
        var c = Math.acos(cosλcosφ);
        return c && c / Math.sin(c)
    }, d3_identity);
    (d3.geo.azimuthalEquidistant = function () {
        return d3_geo_projection(d3_geo_azimuthalEquidistant)
    }).raw = d3_geo_azimuthalEquidistant, (d3.geo.conicConformal = function () {
        return d3_geo_conic(d3_geo_conicConformal)
    }).raw = d3_geo_conicConformal, (d3.geo.conicEquidistant = function () {
        return d3_geo_conic(d3_geo_conicEquidistant)
    }).raw = d3_geo_conicEquidistant;
    var d3_geo_gnomonic = d3_geo_azimuthal(function (cosλcosφ) {
        return 1 / cosλcosφ
    }, Math.atan);
    (d3.geo.gnomonic = function () {
        return d3_geo_projection(d3_geo_gnomonic)
    }).raw = d3_geo_gnomonic, d3_geo_mercator.invert = function (x, y) {
        return[x, 2 * Math.atan(Math.exp(y)) - π / 2]
    }, (d3.geo.mercator = function () {
        return d3_geo_mercatorProjection(d3_geo_mercator)
    }).raw = d3_geo_mercator;
    var d3_geo_orthographic = d3_geo_azimuthal(function () {
        return 1
    }, Math.asin);
    (d3.geo.orthographic = function () {
        return d3_geo_projection(d3_geo_orthographic)
    }).raw = d3_geo_orthographic;
    var d3_geo_stereographic = d3_geo_azimuthal(function (cosλcosφ) {
        return 1 / (1 + cosλcosφ)
    }, function (ρ) {
        return 2 * Math.atan(ρ)
    });
    (d3.geo.stereographic = function () {
        return d3_geo_projection(d3_geo_stereographic)
    }).raw = d3_geo_stereographic, d3_geo_transverseMercator.invert = function (x, y) {
        return[Math.atan2(d3_sinh(x), Math.cos(y)), d3_asin(Math.sin(y) / d3_cosh(x))]
    }, (d3.geo.transverseMercator = function () {
        return d3_geo_mercatorProjection(d3_geo_transverseMercator)
    }).raw = d3_geo_transverseMercator, d3.geom = {}, d3.svg = {}, d3.svg.line = function () {
        return d3_svg_line(d3_identity)
    };
    var d3_svg_lineInterpolators = d3.map({linear: d3_svg_lineLinear, "linear-closed": d3_svg_lineLinearClosed, step: d3_svg_lineStep, "step-before": d3_svg_lineStepBefore, "step-after": d3_svg_lineStepAfter, basis: d3_svg_lineBasis, "basis-open": d3_svg_lineBasisOpen, "basis-closed": d3_svg_lineBasisClosed, bundle: d3_svg_lineBundle, cardinal: d3_svg_lineCardinal, "cardinal-open": d3_svg_lineCardinalOpen, "cardinal-closed": d3_svg_lineCardinalClosed, monotone: d3_svg_lineMonotone});
    d3_svg_lineInterpolators.forEach(function (key, value) {
        value.key = key, value.closed = /-closed$/.test(key)
    });
    var d3_svg_lineBasisBezier1 = [0, 2 / 3, 1 / 3, 0], d3_svg_lineBasisBezier2 = [0, 1 / 3, 2 / 3, 0], d3_svg_lineBasisBezier3 = [0, 1 / 6, 2 / 3, 1 / 6];
    d3.geom.hull = function (vertices) {
        function hull(data) {
            if (data.length < 3)return[];
            var vertices, d, i, j, x1, y1, x2, y2, u, v, a, sp, fx = d3_functor(x), fy = d3_functor(y), n = data.length, plen = n - 1, points = [], stack = [], h = 0;
            if (fx === d3_svg_lineX && y === d3_svg_lineY)vertices = data; else for (i = 0, vertices = []; n > i; ++i)vertices.push([+fx.call(this, d = data[i], i), +fy.call(this, d, i)]);
            for (i = 1; n > i; ++i)(vertices[i][1] < vertices[h][1] || vertices[i][1] == vertices[h][1] && vertices[i][0] < vertices[h][0]) && (h = i);
            for (i = 0; n > i; ++i)i !== h && (y1 = vertices[i][1] - vertices[h][1], x1 = vertices[i][0] - vertices[h][0], points.push({angle: Math.atan2(y1, x1), index: i}));
            for (points.sort(function (a, b) {
                return a.angle - b.angle
            }), a = points[0].angle, v = points[0].index, u = 0, i = 1; plen > i; ++i) {
                if (j = points[i].index, a == points[i].angle) {
                    if (x1 = vertices[v][0] - vertices[h][0], y1 = vertices[v][1] - vertices[h][1], x2 = vertices[j][0] - vertices[h][0], y2 = vertices[j][1] - vertices[h][1], x1 * x1 + y1 * y1 >= x2 * x2 + y2 * y2) {
                        points[i].index = -1;
                        continue
                    }
                    points[u].index = -1
                }
                a = points[i].angle, u = i, v = j
            }
            for (stack.push(h), i = 0, j = 0; 2 > i; ++j)points[j].index > -1 && (stack.push(points[j].index), i++);
            for (sp = stack.length; plen > j; ++j)if (!(points[j].index < 0)) {
                for (; !d3_geom_hullCCW(stack[sp - 2], stack[sp - 1], points[j].index, vertices);)--sp;
                stack[sp++] = points[j].index
            }
            var poly = [];
            for (i = sp - 1; i >= 0; --i)poly.push(data[stack[i]]);
            return poly
        }

        var x = d3_svg_lineX, y = d3_svg_lineY;
        return arguments.length ? hull(vertices) : (hull.x = function (_) {
            return arguments.length ? (x = _, hull) : x
        }, hull.y = function (_) {
            return arguments.length ? (y = _, hull) : y
        }, hull)
    }, d3.geom.polygon = function (coordinates) {
        return coordinates.area = function () {
            for (var i = 0, n = coordinates.length, area = coordinates[n - 1][1] * coordinates[0][0] - coordinates[n - 1][0] * coordinates[0][1]; ++i < n;)area += coordinates[i - 1][1] * coordinates[i][0] - coordinates[i - 1][0] * coordinates[i][1];
            return.5 * area
        }, coordinates.centroid = function (k) {
            var a, c, i = -1, n = coordinates.length, x = 0, y = 0, b = coordinates[n - 1];
            for (arguments.length || (k = -1 / (6 * coordinates.area())); ++i < n;)a = b, b = coordinates[i], c = a[0] * b[1] - b[0] * a[1], x += (a[0] + b[0]) * c, y += (a[1] + b[1]) * c;
            return[x * k, y * k]
        }, coordinates.clip = function (subject) {
            for (var input, j, m, b, c, d, i = -1, n = coordinates.length, a = coordinates[n - 1]; ++i < n;) {
                for (input = subject.slice(), subject.length = 0, b = coordinates[i], c = input[(m = input.length) - 1], j = -1; ++j < m;)d = input[j], d3_geom_polygonInside(d, a, b) ? (d3_geom_polygonInside(c, a, b) || subject.push(d3_geom_polygonIntersect(c, d, a, b)), subject.push(d)) : d3_geom_polygonInside(c, a, b) && subject.push(d3_geom_polygonIntersect(c, d, a, b)), c = d;
                a = b
            }
            return subject
        }, coordinates
    }, d3.geom.delaunay = function (vertices) {
        var edges = vertices.map(function () {
            return[]
        }), triangles = [];
        return d3_geom_voronoiTessellate(vertices, function (e) {
            edges[e.region.l.index].push(vertices[e.region.r.index])
        }), edges.forEach(function (edge, i) {
            var v = vertices[i], cx = v[0], cy = v[1];
            edge.forEach(function (v) {
                v.angle = Math.atan2(v[0] - cx, v[1] - cy)
            }), edge.sort(function (a, b) {
                return a.angle - b.angle
            });
            for (var j = 0, m = edge.length - 1; m > j; j++)triangles.push([v, edge[j], edge[j + 1]])
        }), triangles
    }, d3.geom.voronoi = function (points) {
        function voronoi(data) {
            var points, d, i, polygons = data.map(function () {
                return[]
            }), fx = d3_functor(x), fy = d3_functor(y), n = data.length, Z = 1e6;
            if (fx === d3_svg_lineX && fy === d3_svg_lineY)points = data; else for (points = new Array(n), i = 0; n > i; ++i)points[i] = [+fx.call(this, d = data[i], i), +fy.call(this, d, i)];
            if (d3_geom_voronoiTessellate(points, function (e) {
                var s1, s2, x1, x2, y1, y2;
                1 === e.a && e.b >= 0 ? (s1 = e.ep.r, s2 = e.ep.l) : (s1 = e.ep.l, s2 = e.ep.r), 1 === e.a ? (y1 = s1 ? s1.y : -Z, x1 = e.c - e.b * y1, y2 = s2 ? s2.y : Z, x2 = e.c - e.b * y2) : (x1 = s1 ? s1.x : -Z, y1 = e.c - e.a * x1, x2 = s2 ? s2.x : Z, y2 = e.c - e.a * x2);
                var v1 = [x1, y1], v2 = [x2, y2];
                polygons[e.region.l.index].push(v1, v2), polygons[e.region.r.index].push(v1, v2)
            }), polygons = polygons.map(function (polygon, i) {
                var cx = points[i][0], cy = points[i][1], angle = polygon.map(function (v) {
                    return Math.atan2(v[0] - cx, v[1] - cy)
                }), order = d3.range(polygon.length).sort(function (a, b) {
                    return angle[a] - angle[b]
                });
                return order.filter(function (d, i) {
                    return!i || angle[d] - angle[order[i - 1]] > ε
                }).map(function (d) {
                    return polygon[d]
                })
            }), polygons.forEach(function (polygon, i) {
                var n = polygon.length;
                if (!n)return polygon.push([-Z, -Z], [-Z, Z], [Z, Z], [Z, -Z]);
                if (!(n > 2)) {
                    var p0 = points[i], p1 = polygon[0], p2 = polygon[1], x0 = p0[0], y0 = p0[1], x1 = p1[0], y1 = p1[1], x2 = p2[0], y2 = p2[1], dx = Math.abs(x2 - x1), dy = y2 - y1;
                    if (Math.abs(dy) < ε) {
                        var y = y1 > y0 ? -Z : Z;
                        polygon.push([-Z, y], [Z, y])
                    } else if (ε > dx) {
                        var x = x1 > x0 ? -Z : Z;
                        polygon.push([x, -Z], [x, Z])
                    } else {
                        var y = (x1 - x0) * (y2 - y1) > (x2 - x1) * (y1 - y0) ? Z : -Z, z = Math.abs(dy) - dx;
                        Math.abs(z) < ε ? polygon.push([0 > dy ? y : -y, y]) : (z > 0 && (y *= -1), polygon.push([-Z, y], [Z, y]))
                    }
                }
            }), clipPolygon)for (i = 0; n > i; ++i)clipPolygon.clip(polygons[i]);
            for (i = 0; n > i; ++i)polygons[i].point = data[i];
            return polygons
        }

        var x = d3_svg_lineX, y = d3_svg_lineY, clipPolygon = null;
        return arguments.length ? voronoi(points) : (voronoi.x = function (_) {
            return arguments.length ? (x = _, voronoi) : x
        }, voronoi.y = function (_) {
            return arguments.length ? (y = _, voronoi) : y
        }, voronoi.clipExtent = function (_) {
            if (!arguments.length)return clipPolygon && [clipPolygon[0], clipPolygon[2]];
            if (null == _)clipPolygon = null; else {
                var x1 = +_[0][0], y1 = +_[0][1], x2 = +_[1][0], y2 = +_[1][1];
                clipPolygon = d3.geom.polygon([
                    [x1, y1],
                    [x1, y2],
                    [x2, y2],
                    [x2, y1]
                ])
            }
            return voronoi
        }, voronoi.size = function (_) {
            return arguments.length ? voronoi.clipExtent(_ && [
                [0, 0],
                _
            ]) : clipPolygon && clipPolygon[2]
        }, voronoi.links = function (data) {
            var points, d, i, graph = data.map(function () {
                return[]
            }), links = [], fx = d3_functor(x), fy = d3_functor(y), n = data.length;
            if (fx === d3_svg_lineX && fy === d3_svg_lineY)points = data; else for (points = new Array(n), i = 0; n > i; ++i)points[i] = [+fx.call(this, d = data[i], i), +fy.call(this, d, i)];
            return d3_geom_voronoiTessellate(points, function (e) {
                var l = e.region.l.index, r = e.region.r.index;
                graph[l][r] || (graph[l][r] = graph[r][l] = !0, links.push({source: data[l], target: data[r]}))
            }), links
        }, voronoi.triangles = function (data) {
            if (x === d3_svg_lineX && y === d3_svg_lineY)return d3.geom.delaunay(data);
            for (var d, points = new Array(n), fx = d3_functor(x), fy = d3_functor(y), i = -1, n = data.length; ++i < n;)(points[i] = [+fx.call(this, d = data[i], i), +fy.call(this, d, i)]).data = d;
            return d3.geom.delaunay(points).map(function (triangle) {
                return triangle.map(function (point) {
                    return point.data
                })
            })
        }, voronoi)
    };
    var d3_geom_voronoiOpposite = {l: "r", r: "l"};
    d3.geom.quadtree = function (points, x1, y1, x2, y2) {
        function quadtree(data) {
            function insert(n, d, x, y, x1, y1, x2, y2) {
                if (!isNaN(x) && !isNaN(y))if (n.leaf) {
                    var nx = n.x, ny = n.y;
                    if (null != nx)if (Math.abs(nx - x) + Math.abs(ny - y) < .01)insertChild(n, d, x, y, x1, y1, x2, y2); else {
                        var nPoint = n.point;
                        n.x = n.y = n.point = null, insertChild(n, nPoint, nx, ny, x1, y1, x2, y2), insertChild(n, d, x, y, x1, y1, x2, y2)
                    } else n.x = x, n.y = y, n.point = d
                } else insertChild(n, d, x, y, x1, y1, x2, y2)
            }

            function insertChild(n, d, x, y, x1, y1, x2, y2) {
                var sx = .5 * (x1 + x2), sy = .5 * (y1 + y2), right = x >= sx, bottom = y >= sy, i = (bottom << 1) + right;
                n.leaf = !1, n = n.nodes[i] || (n.nodes[i] = d3_geom_quadtreeNode()), right ? x1 = sx : x2 = sx, bottom ? y1 = sy : y2 = sy, insert(n, d, x, y, x1, y1, x2, y2)
            }

            var d, xs, ys, i, n, x1_, y1_, x2_, y2_, fx = d3_functor(x), fy = d3_functor(y);
            if (null != x1)x1_ = x1, y1_ = y1, x2_ = x2, y2_ = y2; else if (x2_ = y2_ = -(x1_ = y1_ = 1 / 0), xs = [], ys = [], n = data.length, compat)for (i = 0; n > i; ++i)d = data[i], d.x < x1_ && (x1_ = d.x), d.y < y1_ && (y1_ = d.y), d.x > x2_ && (x2_ = d.x), d.y > y2_ && (y2_ = d.y), xs.push(d.x), ys.push(d.y); else for (i = 0; n > i; ++i) {
                var x_ = +fx(d = data[i], i), y_ = +fy(d, i);
                x1_ > x_ && (x1_ = x_), y1_ > y_ && (y1_ = y_), x_ > x2_ && (x2_ = x_), y_ > y2_ && (y2_ = y_), xs.push(x_), ys.push(y_)
            }
            var dx = x2_ - x1_, dy = y2_ - y1_;
            dx > dy ? y2_ = y1_ + dx : x2_ = x1_ + dy;
            var root = d3_geom_quadtreeNode();
            if (root.add = function (d) {
                insert(root, d, +fx(d, ++i), +fy(d, i), x1_, y1_, x2_, y2_)
            }, root.visit = function (f) {
                d3_geom_quadtreeVisit(f, root, x1_, y1_, x2_, y2_)
            }, i = -1, null == x1) {
                for (; ++i < n;)insert(root, data[i], xs[i], ys[i], x1_, y1_, x2_, y2_);
                --i
            } else data.forEach(root.add);
            return xs = ys = data = d = null, root
        }

        var compat, x = d3_svg_lineX, y = d3_svg_lineY;
        return(compat = arguments.length) ? (x = d3_geom_quadtreeCompatX, y = d3_geom_quadtreeCompatY, 3 === compat && (y2 = y1, x2 = x1, y1 = x1 = 0), quadtree(points)) : (quadtree.x = function (_) {
            return arguments.length ? (x = _, quadtree) : x
        }, quadtree.y = function (_) {
            return arguments.length ? (y = _, quadtree) : y
        }, quadtree.extent = function (_) {
            return arguments.length ? (null == _ ? x1 = y1 = x2 = y2 = null : (x1 = +_[0][0], y1 = +_[0][1], x2 = +_[1][0], y2 = +_[1][1]), quadtree) : null == x1 ? null : [
                [x1, y1],
                [x2, y2]
            ]
        }, quadtree.size = function (_) {
            return arguments.length ? (null == _ ? x1 = y1 = x2 = y2 = null : (x1 = y1 = 0, x2 = +_[0], y2 = +_[1]), quadtree) : null == x1 ? null : [x2 - x1, y2 - y1]
        }, quadtree)
    }, d3.interpolateRgb = d3_interpolateRgb, d3.transform = function (string) {
        var g = d3_document.createElementNS(d3.ns.prefix.svg, "g");
        return(d3.transform = function (string) {
            if (null != string) {
                g.setAttribute("transform", string);
                var t = g.transform.baseVal.consolidate()
            }
            return new d3_transform(t ? t.matrix : d3_transformIdentity)
        })(string)
    }, d3_transform.prototype.toString = function () {
        return"translate(" + this.translate + ")rotate(" + this.rotate + ")skewX(" + this.skew + ")scale(" + this.scale + ")"
    };
    var d3_transformIdentity = {a: 1, b: 0, c: 0, d: 1, e: 0, f: 0};
    d3.interpolateNumber = d3_interpolateNumber, d3.interpolateTransform = d3_interpolateTransform, d3.interpolateObject = d3_interpolateObject, d3.interpolateString = d3_interpolateString;
    var d3_interpolate_number = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;
    d3.interpolate = d3_interpolate, d3.interpolators = [function (a, b) {
        var t = typeof b;
        return("string" === t ? d3_rgb_names.has(b) || /^(#|rgb\(|hsl\()/.test(b) ? d3_interpolateRgb : d3_interpolateString : b instanceof d3_Color ? d3_interpolateRgb : "object" === t ? Array.isArray(b) ? d3_interpolateArray : d3_interpolateObject : d3_interpolateNumber)(a, b)
    }], d3.interpolateArray = d3_interpolateArray;
    var d3_ease_default = function () {
        return d3_identity
    }, d3_ease = d3.map({linear: d3_ease_default, poly: d3_ease_poly, quad: function () {
        return d3_ease_quad
    }, cubic: function () {
        return d3_ease_cubic
    }, sin: function () {
        return d3_ease_sin
    }, exp: function () {
        return d3_ease_exp
    }, circle: function () {
        return d3_ease_circle
    }, elastic: d3_ease_elastic, back: d3_ease_back, bounce: function () {
        return d3_ease_bounce
    }}), d3_ease_mode = d3.map({"in": d3_identity, out: d3_ease_reverse, "in-out": d3_ease_reflect, "out-in": function (f) {
        return d3_ease_reflect(d3_ease_reverse(f))
    }});
    d3.ease = function (name) {
        var i = name.indexOf("-"), t = i >= 0 ? name.substring(0, i) : name, m = i >= 0 ? name.substring(i + 1) : "in";
        return t = d3_ease.get(t) || d3_ease_default, m = d3_ease_mode.get(m) || d3_identity, d3_ease_clamp(m(t.apply(null, Array.prototype.slice.call(arguments, 1))))
    }, d3.interpolateHcl = d3_interpolateHcl, d3.interpolateHsl = d3_interpolateHsl, d3.interpolateLab = d3_interpolateLab, d3.interpolateRound = d3_interpolateRound, d3.layout = {}, d3.layout.bundle = function () {
        return function (links) {
            for (var paths = [], i = -1, n = links.length; ++i < n;)paths.push(d3_layout_bundlePath(links[i]));
            return paths
        }
    }, d3.layout.chord = function () {
        function relayout() {
            var k, x, x0, i, j, subgroups = {}, groupSums = [], groupIndex = d3.range(n), subgroupIndex = [];
            for (chords = [], groups = [], k = 0, i = -1; ++i < n;) {
                for (x = 0, j = -1; ++j < n;)x += matrix[i][j];
                groupSums.push(x), subgroupIndex.push(d3.range(n)), k += x
            }
            for (sortGroups && groupIndex.sort(function (a, b) {
                return sortGroups(groupSums[a], groupSums[b])
            }), sortSubgroups && subgroupIndex.forEach(function (d, i) {
                d.sort(function (a, b) {
                    return sortSubgroups(matrix[i][a], matrix[i][b])
                })
            }), k = (2 * π - padding * n) / k, x = 0, i = -1; ++i < n;) {
                for (x0 = x, j = -1; ++j < n;) {
                    var di = groupIndex[i], dj = subgroupIndex[di][j], v = matrix[di][dj], a0 = x, a1 = x += v * k;
                    subgroups[di + "-" + dj] = {index: di, subindex: dj, startAngle: a0, endAngle: a1, value: v}
                }
                groups[di] = {index: di, startAngle: x0, endAngle: x, value: (x - x0) / k}, x += padding
            }
            for (i = -1; ++i < n;)for (j = i - 1; ++j < n;) {
                var source = subgroups[i + "-" + j], target = subgroups[j + "-" + i];
                (source.value || target.value) && chords.push(source.value < target.value ? {source: target, target: source} : {source: source, target: target})
            }
            sortChords && resort()
        }

        function resort() {
            chords.sort(function (a, b) {
                return sortChords((a.source.value + a.target.value) / 2, (b.source.value + b.target.value) / 2)
            })
        }

        var chords, groups, matrix, n, sortGroups, sortSubgroups, sortChords, chord = {}, padding = 0;
        return chord.matrix = function (x) {
            return arguments.length ? (n = (matrix = x) && matrix.length, chords = groups = null, chord) : matrix
        }, chord.padding = function (x) {
            return arguments.length ? (padding = x, chords = groups = null, chord) : padding
        }, chord.sortGroups = function (x) {
            return arguments.length ? (sortGroups = x, chords = groups = null, chord) : sortGroups
        }, chord.sortSubgroups = function (x) {
            return arguments.length ? (sortSubgroups = x, chords = null, chord) : sortSubgroups
        }, chord.sortChords = function (x) {
            return arguments.length ? (sortChords = x, chords && resort(), chord) : sortChords
        }, chord.chords = function () {
            return chords || relayout(), chords
        }, chord.groups = function () {
            return groups || relayout(), groups
        }, chord
    }, d3.layout.force = function () {
        function repulse(node) {
            return function (quad, x1, _, x2) {
                if (quad.point !== node) {
                    var dx = quad.cx - node.x, dy = quad.cy - node.y, dn = 1 / Math.sqrt(dx * dx + dy * dy);
                    if (theta > (x2 - x1) * dn) {
                        var k = quad.charge * dn * dn;
                        return node.px -= dx * k, node.py -= dy * k, !0
                    }
                    if (quad.point && isFinite(dn)) {
                        var k = quad.pointCharge * dn * dn;
                        node.px -= dx * k, node.py -= dy * k
                    }
                }
                return!quad.charge
            }
        }

        function dragmove(d) {
            d.px = d3.event.x, d.py = d3.event.y, force.resume()
        }

        var drag, alpha, distances, strengths, charges, force = {}, event = d3.dispatch("start", "tick", "end"), size = [1, 1], friction = .9, linkDistance = d3_layout_forceLinkDistance, linkStrength = d3_layout_forceLinkStrength, charge = -30, gravity = .1, theta = .8, nodes = [], links = [];
        return force.tick = function () {
            if ((alpha *= .99) < .005)return event.end({type: "end", alpha: alpha = 0}), !0;
            var q, i, o, s, t, l, k, x, y, n = nodes.length, m = links.length;
            for (i = 0; m > i; ++i)o = links[i], s = o.source, t = o.target, x = t.x - s.x, y = t.y - s.y, (l = x * x + y * y) && (l = alpha * strengths[i] * ((l = Math.sqrt(l)) - distances[i]) / l, x *= l, y *= l, t.x -= x * (k = s.weight / (t.weight + s.weight)), t.y -= y * k, s.x += x * (k = 1 - k), s.y += y * k);
            if ((k = alpha * gravity) && (x = size[0] / 2, y = size[1] / 2, i = -1, k))for (; ++i < n;)o = nodes[i], o.x += (x - o.x) * k, o.y += (y - o.y) * k;
            if (charge)for (d3_layout_forceAccumulate(q = d3.geom.quadtree(nodes), alpha, charges), i = -1; ++i < n;)(o = nodes[i]).fixed || q.visit(repulse(o));
            for (i = -1; ++i < n;)o = nodes[i], o.fixed ? (o.x = o.px, o.y = o.py) : (o.x -= (o.px - (o.px = o.x)) * friction, o.y -= (o.py - (o.py = o.y)) * friction);
            event.tick({type: "tick", alpha: alpha})
        }, force.nodes = function (x) {
            return arguments.length ? (nodes = x, force) : nodes
        }, force.links = function (x) {
            return arguments.length ? (links = x, force) : links
        }, force.size = function (x) {
            return arguments.length ? (size = x, force) : size
        }, force.linkDistance = function (x) {
            return arguments.length ? (linkDistance = "function" == typeof x ? x : +x, force) : linkDistance
        }, force.distance = force.linkDistance, force.linkStrength = function (x) {
            return arguments.length ? (linkStrength = "function" == typeof x ? x : +x, force) : linkStrength
        }, force.friction = function (x) {
            return arguments.length ? (friction = +x, force) : friction
        }, force.charge = function (x) {
            return arguments.length ? (charge = "function" == typeof x ? x : +x, force) : charge
        }, force.gravity = function (x) {
            return arguments.length ? (gravity = +x, force) : gravity
        }, force.theta = function (x) {
            return arguments.length ? (theta = +x, force) : theta
        }, force.alpha = function (x) {
            return arguments.length ? (x = +x, alpha ? alpha = x > 0 ? x : 0 : x > 0 && (event.start({type: "start", alpha: alpha = x}), d3.timer(force.tick)), force) : alpha
        }, force.start = function () {
            function position(dimension, size) {
                for (var x, neighbors = neighbor(i), j = -1, m = neighbors.length; ++j < m;)if (!isNaN(x = neighbors[j][dimension]))return x;
                return Math.random() * size
            }

            function neighbor() {
                if (!neighbors) {
                    for (neighbors = [], j = 0; n > j; ++j)neighbors[j] = [];
                    for (j = 0; m > j; ++j) {
                        var o = links[j];
                        neighbors[o.source.index].push(o.target), neighbors[o.target.index].push(o.source)
                    }
                }
                return neighbors[i]
            }

            var i, j, neighbors, o, n = nodes.length, m = links.length, w = size[0], h = size[1];
            for (i = 0; n > i; ++i)(o = nodes[i]).index = i, o.weight = 0;
            for (i = 0; m > i; ++i)o = links[i], "number" == typeof o.source && (o.source = nodes[o.source]), "number" == typeof o.target && (o.target = nodes[o.target]), ++o.source.weight, ++o.target.weight;
            for (i = 0; n > i; ++i)o = nodes[i], isNaN(o.x) && (o.x = position("x", w)), isNaN(o.y) && (o.y = position("y", h)), isNaN(o.px) && (o.px = o.x), isNaN(o.py) && (o.py = o.y);
            if (distances = [], "function" == typeof linkDistance)for (i = 0; m > i; ++i)distances[i] = +linkDistance.call(this, links[i], i); else for (i = 0; m > i; ++i)distances[i] = linkDistance;
            if (strengths = [], "function" == typeof linkStrength)for (i = 0; m > i; ++i)strengths[i] = +linkStrength.call(this, links[i], i); else for (i = 0; m > i; ++i)strengths[i] = linkStrength;
            if (charges = [], "function" == typeof charge)for (i = 0; n > i; ++i)charges[i] = +charge.call(this, nodes[i], i); else for (i = 0; n > i; ++i)charges[i] = charge;
            return force.resume()
        }, force.resume = function () {
            return force.alpha(.1)
        }, force.stop = function () {
            return force.alpha(0)
        }, force.drag = function () {
            return drag || (drag = d3.behavior.drag().origin(d3_identity).on("dragstart.force", d3_layout_forceDragstart).on("drag.force", dragmove).on("dragend.force", d3_layout_forceDragend)), arguments.length ? (this.on("mouseover.force", d3_layout_forceMouseover).on("mouseout.force", d3_layout_forceMouseout).call(drag), void 0) : drag
        }, d3.rebind(force, event, "on")
    };
    var d3_layout_forceLinkDistance = 20, d3_layout_forceLinkStrength = 1;
    d3.layout.hierarchy = function () {
        function recurse(node, depth, nodes) {
            var childs = children.call(hierarchy, node, depth);
            if (node.depth = depth, nodes.push(node), childs && (n = childs.length)) {
                for (var n, d, i = -1, c = node.children = [], v = 0, j = depth + 1; ++i < n;)d = recurse(childs[i], j, nodes), d.parent = node, c.push(d), v += d.value;
                sort && c.sort(sort), value && (node.value = v)
            } else value && (node.value = +value.call(hierarchy, node, depth) || 0);
            return node
        }

        function revalue(node, depth) {
            var children = node.children, v = 0;
            if (children && (n = children.length))for (var n, i = -1, j = depth + 1; ++i < n;)v += revalue(children[i], j); else value && (v = +value.call(hierarchy, node, depth) || 0);
            return value && (node.value = v), v
        }

        function hierarchy(d) {
            var nodes = [];
            return recurse(d, 0, nodes), nodes
        }

        var sort = d3_layout_hierarchySort, children = d3_layout_hierarchyChildren, value = d3_layout_hierarchyValue;
        return hierarchy.sort = function (x) {
            return arguments.length ? (sort = x, hierarchy) : sort
        }, hierarchy.children = function (x) {
            return arguments.length ? (children = x, hierarchy) : children
        }, hierarchy.value = function (x) {
            return arguments.length ? (value = x, hierarchy) : value
        }, hierarchy.revalue = function (root) {
            return revalue(root, 0), root
        }, hierarchy
    }, d3.layout.partition = function () {
        function position(node, x, dx, dy) {
            var children = node.children;
            if (node.x = x, node.y = node.depth * dy, node.dx = dx, node.dy = dy, children && (n = children.length)) {
                var n, c, d, i = -1;
                for (dx = node.value ? dx / node.value : 0; ++i < n;)position(c = children[i], x, d = c.value * dx, dy), x += d
            }
        }

        function depth(node) {
            var children = node.children, d = 0;
            if (children && (n = children.length))for (var n, i = -1; ++i < n;)d = Math.max(d, depth(children[i]));
            return 1 + d
        }

        function partition(d, i) {
            var nodes = hierarchy.call(this, d, i);
            return position(nodes[0], 0, size[0], size[1] / depth(nodes[0])), nodes
        }

        var hierarchy = d3.layout.hierarchy(), size = [1, 1];
        return partition.size = function (x) {
            return arguments.length ? (size = x, partition) : size
        }, d3_layout_hierarchyRebind(partition, hierarchy)
    }, d3.layout.pie = function () {
        function pie(data) {
            var values = data.map(function (d, i) {
                return+value.call(pie, d, i)
            }), a = +("function" == typeof startAngle ? startAngle.apply(this, arguments) : startAngle), k = (("function" == typeof endAngle ? endAngle.apply(this, arguments) : endAngle) - a) / d3.sum(values), index = d3.range(data.length);
            null != sort && index.sort(sort === d3_layout_pieSortByValue ? function (i, j) {
                return values[j] - values[i]
            } : function (i, j) {
                return sort(data[i], data[j])
            });
            var arcs = [];
            return index.forEach(function (i) {
                var d;
                arcs[i] = {data: data[i], value: d = values[i], startAngle: a, endAngle: a += d * k}
            }), arcs
        }

        var value = Number, sort = d3_layout_pieSortByValue, startAngle = 0, endAngle = 2 * π;
        return pie.value = function (x) {
            return arguments.length ? (value = x, pie) : value
        }, pie.sort = function (x) {
            return arguments.length ? (sort = x, pie) : sort
        }, pie.startAngle = function (x) {
            return arguments.length ? (startAngle = x, pie) : startAngle
        }, pie.endAngle = function (x) {
            return arguments.length ? (endAngle = x, pie) : endAngle
        }, pie
    };
    var d3_layout_pieSortByValue = {};
    d3.layout.stack = function () {
        function stack(data, index) {
            var series = data.map(function (d, i) {
                return values.call(stack, d, i)
            }), points = series.map(function (d) {
                return d.map(function (v, i) {
                    return[x.call(stack, v, i), y.call(stack, v, i)]
                })
            }), orders = order.call(stack, points, index);
            series = d3.permute(series, orders), points = d3.permute(points, orders);
            var i, j, o, offsets = offset.call(stack, points, index), n = series.length, m = series[0].length;
            for (j = 0; m > j; ++j)for (out.call(stack, series[0][j], o = offsets[j], points[0][j][1]), i = 1; n > i; ++i)out.call(stack, series[i][j], o += points[i - 1][j][1], points[i][j][1]);
            return data
        }

        var values = d3_identity, order = d3_layout_stackOrderDefault, offset = d3_layout_stackOffsetZero, out = d3_layout_stackOut, x = d3_layout_stackX, y = d3_layout_stackY;
        return stack.values = function (x) {
            return arguments.length ? (values = x, stack) : values
        }, stack.order = function (x) {
            return arguments.length ? (order = "function" == typeof x ? x : d3_layout_stackOrders.get(x) || d3_layout_stackOrderDefault, stack) : order
        }, stack.offset = function (x) {
            return arguments.length ? (offset = "function" == typeof x ? x : d3_layout_stackOffsets.get(x) || d3_layout_stackOffsetZero, stack) : offset
        }, stack.x = function (z) {
            return arguments.length ? (x = z, stack) : x
        }, stack.y = function (z) {
            return arguments.length ? (y = z, stack) : y
        }, stack.out = function (z) {
            return arguments.length ? (out = z, stack) : out
        }, stack
    };
    var d3_layout_stackOrders = d3.map({"inside-out": function (data) {
        var i, j, n = data.length, max = data.map(d3_layout_stackMaxIndex), sums = data.map(d3_layout_stackReduceSum), index = d3.range(n).sort(function (a, b) {
            return max[a] - max[b]
        }), top = 0, bottom = 0, tops = [], bottoms = [];
        for (i = 0; n > i; ++i)j = index[i], bottom > top ? (top += sums[j], tops.push(j)) : (bottom += sums[j], bottoms.push(j));
        return bottoms.reverse().concat(tops)
    }, reverse: function (data) {
        return d3.range(data.length).reverse()
    }, "default": d3_layout_stackOrderDefault}), d3_layout_stackOffsets = d3.map({silhouette: function (data) {
        var i, j, o, n = data.length, m = data[0].length, sums = [], max = 0, y0 = [];
        for (j = 0; m > j; ++j) {
            for (i = 0, o = 0; n > i; i++)o += data[i][j][1];
            o > max && (max = o), sums.push(o)
        }
        for (j = 0; m > j; ++j)y0[j] = (max - sums[j]) / 2;
        return y0
    }, wiggle: function (data) {
        var i, j, k, s1, s2, s3, dx, o, o0, n = data.length, x = data[0], m = x.length, y0 = [];
        for (y0[0] = o = o0 = 0, j = 1; m > j; ++j) {
            for (i = 0, s1 = 0; n > i; ++i)s1 += data[i][j][1];
            for (i = 0, s2 = 0, dx = x[j][0] - x[j - 1][0]; n > i; ++i) {
                for (k = 0, s3 = (data[i][j][1] - data[i][j - 1][1]) / (2 * dx); i > k; ++k)s3 += (data[k][j][1] - data[k][j - 1][1]) / dx;
                s2 += s3 * data[i][j][1]
            }
            y0[j] = o -= s1 ? s2 / s1 * dx : 0, o0 > o && (o0 = o)
        }
        for (j = 0; m > j; ++j)y0[j] -= o0;
        return y0
    }, expand: function (data) {
        var i, j, o, n = data.length, m = data[0].length, k = 1 / n, y0 = [];
        for (j = 0; m > j; ++j) {
            for (i = 0, o = 0; n > i; i++)o += data[i][j][1];
            if (o)for (i = 0; n > i; i++)data[i][j][1] /= o; else for (i = 0; n > i; i++)data[i][j][1] = k
        }
        for (j = 0; m > j; ++j)y0[j] = 0;
        return y0
    }, zero: d3_layout_stackOffsetZero});
    d3.layout.histogram = function () {
        function histogram(data, i) {
            for (var bin, x, bins = [], values = data.map(valuer, this), range = ranger.call(this, values, i), thresholds = binner.call(this, range, values, i), i = -1, n = values.length, m = thresholds.length - 1, k = frequency ? 1 : 1 / n; ++i < m;)bin = bins[i] = [], bin.dx = thresholds[i + 1] - (bin.x = thresholds[i]), bin.y = 0;
            if (m > 0)for (i = -1; ++i < n;)x = values[i], x >= range[0] && x <= range[1] && (bin = bins[d3.bisect(thresholds, x, 1, m) - 1], bin.y += k, bin.push(data[i]));
            return bins
        }

        var frequency = !0, valuer = Number, ranger = d3_layout_histogramRange, binner = d3_layout_histogramBinSturges;
        return histogram.value = function (x) {
            return arguments.length ? (valuer = x, histogram) : valuer
        }, histogram.range = function (x) {
            return arguments.length ? (ranger = d3_functor(x), histogram) : ranger
        }, histogram.bins = function (x) {
            return arguments.length ? (binner = "number" == typeof x ? function (range) {
                return d3_layout_histogramBinFixed(range, x)
            } : d3_functor(x), histogram) : binner
        }, histogram.frequency = function (x) {
            return arguments.length ? (frequency = !!x, histogram) : frequency
        }, histogram
    }, d3.layout.tree = function () {
        function tree(d, i) {
            function firstWalk(node, previousSibling) {
                var children = node.children, layout = node._tree;
                if (children && (n = children.length)) {
                    for (var n, previousChild, child, firstChild = children[0], ancestor = firstChild, i = -1; ++i < n;)child = children[i], firstWalk(child, previousChild), ancestor = apportion(child, previousChild, ancestor), previousChild = child;
                    d3_layout_treeShift(node);
                    var midpoint = .5 * (firstChild._tree.prelim + child._tree.prelim);
                    previousSibling ? (layout.prelim = previousSibling._tree.prelim + separation(node, previousSibling), layout.mod = layout.prelim - midpoint) : layout.prelim = midpoint
                } else previousSibling && (layout.prelim = previousSibling._tree.prelim + separation(node, previousSibling))
            }

            function secondWalk(node, x) {
                node.x = node._tree.prelim + x;
                var children = node.children;
                if (children && (n = children.length)) {
                    var n, i = -1;
                    for (x += node._tree.mod; ++i < n;)secondWalk(children[i], x)
                }
            }

            function apportion(node, previousSibling, ancestor) {
                if (previousSibling) {
                    for (var shift, vip = node, vop = node, vim = previousSibling, vom = node.parent.children[0], sip = vip._tree.mod, sop = vop._tree.mod, sim = vim._tree.mod, som = vom._tree.mod; vim = d3_layout_treeRight(vim), vip = d3_layout_treeLeft(vip), vim && vip;)vom = d3_layout_treeLeft(vom), vop = d3_layout_treeRight(vop), vop._tree.ancestor = node, shift = vim._tree.prelim + sim - vip._tree.prelim - sip + separation(vim, vip), shift > 0 && (d3_layout_treeMove(d3_layout_treeAncestor(vim, node, ancestor), node, shift), sip += shift, sop += shift), sim += vim._tree.mod, sip += vip._tree.mod, som += vom._tree.mod, sop += vop._tree.mod;
                    vim && !d3_layout_treeRight(vop) && (vop._tree.thread = vim, vop._tree.mod += sim - sop), vip && !d3_layout_treeLeft(vom) && (vom._tree.thread = vip, vom._tree.mod += sip - som, ancestor = node)
                }
                return ancestor
            }

            var nodes = hierarchy.call(this, d, i), root = nodes[0];
            d3_layout_treeVisitAfter(root, function (node, previousSibling) {
                node._tree = {ancestor: node, prelim: 0, mod: 0, change: 0, shift: 0, number: previousSibling ? previousSibling._tree.number + 1 : 0}
            }), firstWalk(root), secondWalk(root, -root._tree.prelim);
            var left = d3_layout_treeSearch(root, d3_layout_treeLeftmost), right = d3_layout_treeSearch(root, d3_layout_treeRightmost), deep = d3_layout_treeSearch(root, d3_layout_treeDeepest), x0 = left.x - separation(left, right) / 2, x1 = right.x + separation(right, left) / 2, y1 = deep.depth || 1;
            return d3_layout_treeVisitAfter(root, nodeSize ? function (node) {
                node.x *= size[0], node.y = node.depth * size[1], delete node._tree
            } : function (node) {
                node.x = (node.x - x0) / (x1 - x0) * size[0], node.y = node.depth / y1 * size[1], delete node._tree
            }), nodes
        }

        var hierarchy = d3.layout.hierarchy().sort(null).value(null), separation = d3_layout_treeSeparation, size = [1, 1], nodeSize = !1;
        return tree.separation = function (x) {
            return arguments.length ? (separation = x, tree) : separation
        }, tree.size = function (x) {
            return arguments.length ? (nodeSize = null == (size = x), tree) : nodeSize ? null : size
        }, tree.nodeSize = function (x) {
            return arguments.length ? (nodeSize = null != (size = x), tree) : nodeSize ? size : null
        }, d3_layout_hierarchyRebind(tree, hierarchy)
    }, d3.layout.pack = function () {
        function pack(d, i) {
            var nodes = hierarchy.call(this, d, i), root = nodes[0], w = size[0], h = size[1], r = radius || Math.sqrt;
            if (root.x = root.y = 0, d3_layout_treeVisitAfter(root, function (d) {
                d.r = r(d.value)
            }), d3_layout_treeVisitAfter(root, d3_layout_packSiblings), padding) {
                var dr = padding * (radius ? 1 : Math.max(2 * root.r / w, 2 * root.r / h)) / 2;
                d3_layout_treeVisitAfter(root, function (d) {
                    d.r += dr
                }), d3_layout_treeVisitAfter(root, d3_layout_packSiblings), d3_layout_treeVisitAfter(root, function (d) {
                    d.r -= dr
                })
            }
            return d3_layout_packTransform(root, w / 2, h / 2, radius ? 1 : 1 / Math.max(2 * root.r / w, 2 * root.r / h)), nodes
        }

        var radius, hierarchy = d3.layout.hierarchy().sort(d3_layout_packSort), padding = 0, size = [1, 1];
        return pack.size = function (_) {
            return arguments.length ? (size = _, pack) : size
        }, pack.radius = function (_) {
            return arguments.length ? (radius = _, pack) : radius
        }, pack.padding = function (_) {
            return arguments.length ? (padding = +_, pack) : padding
        }, d3_layout_hierarchyRebind(pack, hierarchy)
    }, d3.layout.cluster = function () {
        function cluster(d, i) {
            var previousNode, nodes = hierarchy.call(this, d, i), root = nodes[0], x = 0;
            d3_layout_treeVisitAfter(root, function (node) {
                var children = node.children;
                children && children.length ? (node.x = d3_layout_clusterX(children), node.y = d3_layout_clusterY(children)) : (node.x = previousNode ? x += separation(node, previousNode) : 0, node.y = 0, previousNode = node)
            });
            var left = d3_layout_clusterLeft(root), right = d3_layout_clusterRight(root), x0 = left.x - separation(left, right) / 2, x1 = right.x + separation(right, left) / 2;
            return d3_layout_treeVisitAfter(root, nodeSize ? function (node) {
                node.x = (node.x - root.x) * size[0], node.y = (root.y - node.y) * size[1]
            } : function (node) {
                node.x = (node.x - x0) / (x1 - x0) * size[0], node.y = (1 - (root.y ? node.y / root.y : 1)) * size[1]
            }), nodes
        }

        var hierarchy = d3.layout.hierarchy().sort(null).value(null), separation = d3_layout_treeSeparation, size = [1, 1], nodeSize = !1;
        return cluster.separation = function (x) {
            return arguments.length ? (separation = x, cluster) : separation
        }, cluster.size = function (x) {
            return arguments.length ? (nodeSize = null == (size = x), cluster) : nodeSize ? null : size
        }, cluster.nodeSize = function (x) {
            return arguments.length ? (nodeSize = null != (size = x), cluster) : nodeSize ? size : null
        }, d3_layout_hierarchyRebind(cluster, hierarchy)
    }, d3.layout.treemap = function () {
        function scale(children, k) {
            for (var child, area, i = -1, n = children.length; ++i < n;)area = (child = children[i]).value * (0 > k ? 0 : k), child.area = isNaN(area) || 0 >= area ? 0 : area
        }

        function squarify(node) {
            var children = node.children;
            if (children && children.length) {
                var child, score, n, rect = pad(node), row = [], remaining = children.slice(), best = 1 / 0, u = "slice" === mode ? rect.dx : "dice" === mode ? rect.dy : "slice-dice" === mode ? 1 & node.depth ? rect.dy : rect.dx : Math.min(rect.dx, rect.dy);
                for (scale(remaining, rect.dx * rect.dy / node.value), row.area = 0; (n = remaining.length) > 0;)row.push(child = remaining[n - 1]), row.area += child.area, "squarify" !== mode || (score = worst(row, u)) <= best ? (remaining.pop(), best = score) : (row.area -= row.pop().area, position(row, u, rect, !1), u = Math.min(rect.dx, rect.dy), row.length = row.area = 0, best = 1 / 0);
                row.length && (position(row, u, rect, !0), row.length = row.area = 0), children.forEach(squarify)
            }
        }

        function stickify(node) {
            var children = node.children;
            if (children && children.length) {
                var child, rect = pad(node), remaining = children.slice(), row = [];
                for (scale(remaining, rect.dx * rect.dy / node.value), row.area = 0; child = remaining.pop();)row.push(child), row.area += child.area, null != child.z && (position(row, child.z ? rect.dx : rect.dy, rect, !remaining.length), row.length = row.area = 0);
                children.forEach(stickify)
            }
        }

        function worst(row, u) {
            for (var r, s = row.area, rmax = 0, rmin = 1 / 0, i = -1, n = row.length; ++i < n;)(r = row[i].area) && (rmin > r && (rmin = r), r > rmax && (rmax = r));
            return s *= s, u *= u, s ? Math.max(u * rmax * ratio / s, s / (u * rmin * ratio)) : 1 / 0
        }

        function position(row, u, rect, flush) {
            var o, i = -1, n = row.length, x = rect.x, y = rect.y, v = u ? round(row.area / u) : 0;
            if (u == rect.dx) {
                for ((flush || v > rect.dy) && (v = rect.dy); ++i < n;)o = row[i], o.x = x, o.y = y, o.dy = v, x += o.dx = Math.min(rect.x + rect.dx - x, v ? round(o.area / v) : 0);
                o.z = !0, o.dx += rect.x + rect.dx - x, rect.y += v, rect.dy -= v
            } else {
                for ((flush || v > rect.dx) && (v = rect.dx); ++i < n;)o = row[i], o.x = x, o.y = y, o.dx = v, y += o.dy = Math.min(rect.y + rect.dy - y, v ? round(o.area / v) : 0);
                o.z = !1, o.dy += rect.y + rect.dy - y, rect.x += v, rect.dx -= v
            }
        }

        function treemap(d) {
            var nodes = stickies || hierarchy(d), root = nodes[0];
            return root.x = 0, root.y = 0, root.dx = size[0], root.dy = size[1], stickies && hierarchy.revalue(root), scale([root], root.dx * root.dy / root.value), (stickies ? stickify : squarify)(root), sticky && (stickies = nodes), nodes
        }

        var stickies, hierarchy = d3.layout.hierarchy(), round = Math.round, size = [1, 1], padding = null, pad = d3_layout_treemapPadNull, sticky = !1, mode = "squarify", ratio = .5 * (1 + Math.sqrt(5));
        return treemap.size = function (x) {
            return arguments.length ? (size = x, treemap) : size
        }, treemap.padding = function (x) {
            function padFunction(node) {
                var p = x.call(treemap, node, node.depth);
                return null == p ? d3_layout_treemapPadNull(node) : d3_layout_treemapPad(node, "number" == typeof p ? [p, p, p, p] : p)
            }

            function padConstant(node) {
                return d3_layout_treemapPad(node, x)
            }

            if (!arguments.length)return padding;
            var type;
            return pad = null == (padding = x) ? d3_layout_treemapPadNull : "function" == (type = typeof x) ? padFunction : "number" === type ? (x = [x, x, x, x], padConstant) : padConstant, treemap
        }, treemap.round = function (x) {
            return arguments.length ? (round = x ? Math.round : Number, treemap) : round != Number
        }, treemap.sticky = function (x) {
            return arguments.length ? (sticky = x, stickies = null, treemap) : sticky
        }, treemap.ratio = function (x) {
            return arguments.length ? (ratio = x, treemap) : ratio
        }, treemap.mode = function (x) {
            return arguments.length ? (mode = x + "", treemap) : mode
        }, d3_layout_hierarchyRebind(treemap, hierarchy)
    }, d3.random = {normal: function (µ, σ) {
        var n = arguments.length;
        return 2 > n && (σ = 1), 1 > n && (µ = 0), function () {
            var x, y, r;
            do x = 2 * Math.random() - 1, y = 2 * Math.random() - 1, r = x * x + y * y; while (!r || r > 1);
            return µ + σ * x * Math.sqrt(-2 * Math.log(r) / r)
        }
    }, logNormal: function () {
        var random = d3.random.normal.apply(d3, arguments);
        return function () {
            return Math.exp(random())
        }
    }, irwinHall: function (m) {
        return function () {
            for (var s = 0, j = 0; m > j; j++)s += Math.random();
            return s / m
        }
    }}, d3.scale = {};
    var d3_scale_niceIdentity = {floor: d3_identity, ceil: d3_identity};
    d3.scale.linear = function () {
        return d3_scale_linear([0, 1], [0, 1], d3_interpolate, !1)
    }, d3.scale.log = function () {
        return d3_scale_log(d3.scale.linear().domain([0, Math.LN10]), 10, d3_scale_logp, d3_scale_powp, [1, 10])
    };
    var d3_scale_logFormat = d3.format(".0e");
    d3.scale.pow = function () {
        return d3_scale_pow(d3.scale.linear(), 1, [0, 1])
    }, d3.scale.sqrt = function () {
        return d3.scale.pow().exponent(.5)
    }, d3.scale.ordinal = function () {
        return d3_scale_ordinal([], {t: "range", a: [
            []
        ]})
    }, d3.scale.category10 = function () {
        return d3.scale.ordinal().range(d3_category10)
    }, d3.scale.category20 = function () {
        return d3.scale.ordinal().range(d3_category20)
    }, d3.scale.category20b = function () {
        return d3.scale.ordinal().range(d3_category20b)
    }, d3.scale.category20c = function () {
        return d3.scale.ordinal().range(d3_category20c)
    };
    var d3_category10 = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"], d3_category20 = ["#1f77b4", "#aec7e8", "#ff7f0e", "#ffbb78", "#2ca02c", "#98df8a", "#d62728", "#ff9896", "#9467bd", "#c5b0d5", "#8c564b", "#c49c94", "#e377c2", "#f7b6d2", "#7f7f7f", "#c7c7c7", "#bcbd22", "#dbdb8d", "#17becf", "#9edae5"], d3_category20b = ["#393b79", "#5254a3", "#6b6ecf", "#9c9ede", "#637939", "#8ca252", "#b5cf6b", "#cedb9c", "#8c6d31", "#bd9e39", "#e7ba52", "#e7cb94", "#843c39", "#ad494a", "#d6616b", "#e7969c", "#7b4173", "#a55194", "#ce6dbd", "#de9ed6"], d3_category20c = ["#3182bd", "#6baed6", "#9ecae1", "#c6dbef", "#e6550d", "#fd8d3c", "#fdae6b", "#fdd0a2", "#31a354", "#74c476", "#a1d99b", "#c7e9c0", "#756bb1", "#9e9ac8", "#bcbddc", "#dadaeb", "#636363", "#969696", "#bdbdbd", "#d9d9d9"];
    d3.scale.quantile = function () {
        return d3_scale_quantile([], [])
    }, d3.scale.quantize = function () {
        return d3_scale_quantize(0, 1, [0, 1])
    }, d3.scale.threshold = function () {
        return d3_scale_threshold([.5], [0, 1])
    }, d3.scale.identity = function () {
        return d3_scale_identity([0, 1])
    }, d3.svg.arc = function () {
        function arc() {
            var r0 = innerRadius.apply(this, arguments), r1 = outerRadius.apply(this, arguments), a0 = startAngle.apply(this, arguments) + d3_svg_arcOffset, a1 = endAngle.apply(this, arguments) + d3_svg_arcOffset, da = (a0 > a1 && (da = a0, a0 = a1, a1 = da), a1 - a0), df = π > da ? "0" : "1", c0 = Math.cos(a0), s0 = Math.sin(a0), c1 = Math.cos(a1), s1 = Math.sin(a1);
            return da >= d3_svg_arcMax ? r0 ? "M0," + r1 + "A" + r1 + "," + r1 + " 0 1,1 0," + -r1 + "A" + r1 + "," + r1 + " 0 1,1 0," + r1 + "M0," + r0 + "A" + r0 + "," + r0 + " 0 1,0 0," + -r0 + "A" + r0 + "," + r0 + " 0 1,0 0," + r0 + "Z" : "M0," + r1 + "A" + r1 + "," + r1 + " 0 1,1 0," + -r1 + "A" + r1 + "," + r1 + " 0 1,1 0," + r1 + "Z" : r0 ? "M" + r1 * c0 + "," + r1 * s0 + "A" + r1 + "," + r1 + " 0 " + df + ",1 " + r1 * c1 + "," + r1 * s1 + "L" + r0 * c1 + "," + r0 * s1 + "A" + r0 + "," + r0 + " 0 " + df + ",0 " + r0 * c0 + "," + r0 * s0 + "Z" : "M" + r1 * c0 + "," + r1 * s0 + "A" + r1 + "," + r1 + " 0 " + df + ",1 " + r1 * c1 + "," + r1 * s1 + "L0,0Z"
        }

        var innerRadius = d3_svg_arcInnerRadius, outerRadius = d3_svg_arcOuterRadius, startAngle = d3_svg_arcStartAngle, endAngle = d3_svg_arcEndAngle;
        return arc.innerRadius = function (v) {
            return arguments.length ? (innerRadius = d3_functor(v), arc) : innerRadius
        }, arc.outerRadius = function (v) {
            return arguments.length ? (outerRadius = d3_functor(v), arc) : outerRadius
        }, arc.startAngle = function (v) {
            return arguments.length ? (startAngle = d3_functor(v), arc) : startAngle
        }, arc.endAngle = function (v) {
            return arguments.length ? (endAngle = d3_functor(v), arc) : endAngle
        }, arc.centroid = function () {
            var r = (innerRadius.apply(this, arguments) + outerRadius.apply(this, arguments)) / 2, a = (startAngle.apply(this, arguments) + endAngle.apply(this, arguments)) / 2 + d3_svg_arcOffset;
            return[Math.cos(a) * r, Math.sin(a) * r]
        }, arc
    };
    var d3_svg_arcOffset = -π / 2, d3_svg_arcMax = 2 * π - 1e-6;
    d3.svg.line.radial = function () {
        var line = d3_svg_line(d3_svg_lineRadial);
        return line.radius = line.x, delete line.x, line.angle = line.y, delete line.y, line
    }, d3_svg_lineStepBefore.reverse = d3_svg_lineStepAfter, d3_svg_lineStepAfter.reverse = d3_svg_lineStepBefore, d3.svg.area = function () {
        return d3_svg_area(d3_identity)
    }, d3.svg.area.radial = function () {
        var area = d3_svg_area(d3_svg_lineRadial);
        return area.radius = area.x, delete area.x, area.innerRadius = area.x0, delete area.x0, area.outerRadius = area.x1, delete area.x1, area.angle = area.y, delete area.y, area.startAngle = area.y0, delete area.y0, area.endAngle = area.y1, delete area.y1, area
    }, d3.svg.chord = function () {
        function chord(d, i) {
            var s = subgroup(this, source, d, i), t = subgroup(this, target, d, i);
            return"M" + s.p0 + arc(s.r, s.p1, s.a1 - s.a0) + (equals(s, t) ? curve(s.r, s.p1, s.r, s.p0) : curve(s.r, s.p1, t.r, t.p0) + arc(t.r, t.p1, t.a1 - t.a0) + curve(t.r, t.p1, s.r, s.p0)) + "Z"
        }

        function subgroup(self, f, d, i) {
            var subgroup = f.call(self, d, i), r = radius.call(self, subgroup, i), a0 = startAngle.call(self, subgroup, i) + d3_svg_arcOffset, a1 = endAngle.call(self, subgroup, i) + d3_svg_arcOffset;
            return{r: r, a0: a0, a1: a1, p0: [r * Math.cos(a0), r * Math.sin(a0)], p1: [r * Math.cos(a1), r * Math.sin(a1)]}
        }

        function equals(a, b) {
            return a.a0 == b.a0 && a.a1 == b.a1
        }

        function arc(r, p, a) {
            return"A" + r + "," + r + " 0 " + +(a > π) + ",1 " + p
        }

        function curve(r0, p0, r1, p1) {
            return"Q 0,0 " + p1
        }

        var source = d3_source, target = d3_target, radius = d3_svg_chordRadius, startAngle = d3_svg_arcStartAngle, endAngle = d3_svg_arcEndAngle;
        return chord.radius = function (v) {
            return arguments.length ? (radius = d3_functor(v), chord) : radius
        }, chord.source = function (v) {
            return arguments.length ? (source = d3_functor(v), chord) : source
        }, chord.target = function (v) {
            return arguments.length ? (target = d3_functor(v), chord) : target
        }, chord.startAngle = function (v) {
            return arguments.length ? (startAngle = d3_functor(v), chord) : startAngle
        }, chord.endAngle = function (v) {
            return arguments.length ? (endAngle = d3_functor(v), chord) : endAngle
        }, chord
    }, d3.svg.diagonal = function () {
        function diagonal(d, i) {
            var p0 = source.call(this, d, i), p3 = target.call(this, d, i), m = (p0.y + p3.y) / 2, p = [p0, {x: p0.x, y: m}, {x: p3.x, y: m}, p3];
            return p = p.map(projection), "M" + p[0] + "C" + p[1] + " " + p[2] + " " + p[3]
        }

        var source = d3_source, target = d3_target, projection = d3_svg_diagonalProjection;
        return diagonal.source = function (x) {
            return arguments.length ? (source = d3_functor(x), diagonal) : source
        }, diagonal.target = function (x) {
            return arguments.length ? (target = d3_functor(x), diagonal) : target
        }, diagonal.projection = function (x) {
            return arguments.length ? (projection = x, diagonal) : projection
        }, diagonal
    }, d3.svg.diagonal.radial = function () {
        var diagonal = d3.svg.diagonal(), projection = d3_svg_diagonalProjection, projection_ = diagonal.projection;
        return diagonal.projection = function (x) {
            return arguments.length ? projection_(d3_svg_diagonalRadialProjection(projection = x)) : projection
        }, diagonal
    }, d3.svg.symbol = function () {
        function symbol(d, i) {
            return(d3_svg_symbols.get(type.call(this, d, i)) || d3_svg_symbolCircle)(size.call(this, d, i))
        }

        var type = d3_svg_symbolType, size = d3_svg_symbolSize;
        return symbol.type = function (x) {
            return arguments.length ? (type = d3_functor(x), symbol) : type
        }, symbol.size = function (x) {
            return arguments.length ? (size = d3_functor(x), symbol) : size
        }, symbol
    };
    var d3_svg_symbols = d3.map({circle: d3_svg_symbolCircle, cross: function (size) {
        var r = Math.sqrt(size / 5) / 2;
        return"M" + -3 * r + "," + -r + "H" + -r + "V" + -3 * r + "H" + r + "V" + -r + "H" + 3 * r + "V" + r + "H" + r + "V" + 3 * r + "H" + -r + "V" + r + "H" + -3 * r + "Z"
    }, diamond: function (size) {
        var ry = Math.sqrt(size / (2 * d3_svg_symbolTan30)), rx = ry * d3_svg_symbolTan30;
        return"M0," + -ry + "L" + rx + ",0 0," + ry + " " + -rx + ",0Z"
    }, square: function (size) {
        var r = Math.sqrt(size) / 2;
        return"M" + -r + "," + -r + "L" + r + "," + -r + " " + r + "," + r + " " + -r + "," + r + "Z"
    }, "triangle-down": function (size) {
        var rx = Math.sqrt(size / d3_svg_symbolSqrt3), ry = rx * d3_svg_symbolSqrt3 / 2;
        return"M0," + ry + "L" + rx + "," + -ry + " " + -rx + "," + -ry + "Z"
    }, "triangle-up": function (size) {
        var rx = Math.sqrt(size / d3_svg_symbolSqrt3), ry = rx * d3_svg_symbolSqrt3 / 2;
        return"M0," + -ry + "L" + rx + "," + ry + " " + -rx + "," + ry + "Z"
    }});
    d3.svg.symbolTypes = d3_svg_symbols.keys();
    var d3_transitionInheritId, d3_svg_symbolSqrt3 = Math.sqrt(3), d3_svg_symbolTan30 = Math.tan(30 * d3_radians), d3_transitionPrototype = [], d3_transitionId = 0, d3_transitionInherit = {ease: d3_ease_cubicInOut, delay: 0, duration: 250};
    d3_transitionPrototype.call = d3_selectionPrototype.call, d3_transitionPrototype.empty = d3_selectionPrototype.empty, d3_transitionPrototype.node = d3_selectionPrototype.node, d3.transition = function (selection) {
        return arguments.length ? d3_transitionInheritId ? selection.transition() : selection : d3_selectionRoot.transition()
    }, d3.transition.prototype = d3_transitionPrototype, d3_transitionPrototype.select = function (selector) {
        var subgroup, subnode, node, id = this.id, subgroups = [];
        "function" != typeof selector && (selector = d3_selection_selector(selector));
        for (var j = -1, m = this.length; ++j < m;) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = -1, n = group.length; ++i < n;)(node = group[i]) && (subnode = selector.call(node, node.__data__, i)) ? ("__data__"in node && (subnode.__data__ = node.__data__), d3_transitionNode(subnode, i, id, node.__transition__[id]), subgroup.push(subnode)) : subgroup.push(null)
        }
        return d3_transition(subgroups, id)
    }, d3_transitionPrototype.selectAll = function (selector) {
        var subgroup, subnodes, node, subnode, transition, id = this.id, subgroups = [];
        "function" != typeof selector && (selector = d3_selection_selectorAll(selector));
        for (var j = -1, m = this.length; ++j < m;)for (var group = this[j], i = -1, n = group.length; ++i < n;)if (node = group[i]) {
            transition = node.__transition__[id], subnodes = selector.call(node, node.__data__, i), subgroups.push(subgroup = []);
            for (var k = -1, o = subnodes.length; ++k < o;)d3_transitionNode(subnode = subnodes[k], k, id, transition), subgroup.push(subnode)
        }
        return d3_transition(subgroups, id)
    }, d3_transitionPrototype.filter = function (filter) {
        var subgroup, group, node, subgroups = [];
        "function" != typeof filter && (filter = d3_selection_filter(filter));
        for (var j = 0, m = this.length; m > j; j++) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = 0, n = group.length; n > i; i++)(node = group[i]) && filter.call(node, node.__data__, i) && subgroup.push(node)
        }
        return d3_transition(subgroups, this.id, this.time).ease(this.ease())
    }, d3_transitionPrototype.tween = function (name, tween) {
        var id = this.id;
        return arguments.length < 2 ? this.node().__transition__[id].tween.get(name) : d3_selection_each(this, null == tween ? function (node) {
            node.__transition__[id].tween.remove(name)
        } : function (node) {
            node.__transition__[id].tween.set(name, tween)
        })
    }, d3_transitionPrototype.attr = function (nameNS, value) {
        function attrNull() {
            this.removeAttribute(name)
        }

        function attrNullNS() {
            this.removeAttributeNS(name.space, name.local)
        }

        function attrTween(b) {
            return null == b ? attrNull : (b += "", function () {
                var i, a = this.getAttribute(name);
                return a !== b && (i = interpolate(a, b), function (t) {
                    this.setAttribute(name, i(t))
                })
            })
        }

        function attrTweenNS(b) {
            return null == b ? attrNullNS : (b += "", function () {
                var i, a = this.getAttributeNS(name.space, name.local);
                return a !== b && (i = interpolate(a, b), function (t) {
                    this.setAttributeNS(name.space, name.local, i(t))
                })
            })
        }

        if (arguments.length < 2) {
            for (value in nameNS)this.attr(value, nameNS[value]);
            return this
        }
        var interpolate = d3_interpolateByName(nameNS), name = d3.ns.qualify(nameNS);
        return d3_transition_tween(this, "attr." + nameNS, value, name.local ? attrTweenNS : attrTween)
    }, d3_transitionPrototype.attrTween = function (nameNS, tween) {
        function attrTween(d, i) {
            var f = tween.call(this, d, i, this.getAttribute(name));
            return f && function (t) {
                this.setAttribute(name, f(t))
            }
        }

        function attrTweenNS(d, i) {
            var f = tween.call(this, d, i, this.getAttributeNS(name.space, name.local));
            return f && function (t) {
                this.setAttributeNS(name.space, name.local, f(t))
            }
        }

        var name = d3.ns.qualify(nameNS);
        return this.tween("attr." + nameNS, name.local ? attrTweenNS : attrTween)
    }, d3_transitionPrototype.style = function (name, value, priority) {
        function styleNull() {
            this.style.removeProperty(name)
        }

        function styleString(b) {
            return null == b ? styleNull : (b += "", function () {
                var i, a = d3_window.getComputedStyle(this, null).getPropertyValue(name);
                return a !== b && (i = interpolate(a, b), function (t) {
                    this.style.setProperty(name, i(t), priority)
                })
            })
        }

        var n = arguments.length;
        if (3 > n) {
            if ("string" != typeof name) {
                2 > n && (value = "");
                for (priority in name)this.style(priority, name[priority], value);
                return this
            }
            priority = ""
        }
        var interpolate = d3_interpolateByName(name);
        return d3_transition_tween(this, "style." + name, value, styleString)
    }, d3_transitionPrototype.styleTween = function (name, tween, priority) {
        function styleTween(d, i) {
            var f = tween.call(this, d, i, d3_window.getComputedStyle(this, null).getPropertyValue(name));
            return f && function (t) {
                this.style.setProperty(name, f(t), priority)
            }
        }

        return arguments.length < 3 && (priority = ""), this.tween("style." + name, styleTween)
    }, d3_transitionPrototype.text = function (value) {
        return d3_transition_tween(this, "text", value, d3_transition_text)
    }, d3_transitionPrototype.remove = function () {
        return this.each("end.transition", function () {
            var p;
            !this.__transition__ && (p = this.parentNode) && p.removeChild(this)
        })
    }, d3_transitionPrototype.ease = function (value) {
        var id = this.id;
        return arguments.length < 1 ? this.node().__transition__[id].ease : ("function" != typeof value && (value = d3.ease.apply(d3, arguments)), d3_selection_each(this, function (node) {
            node.__transition__[id].ease = value
        }))
    }, d3_transitionPrototype.delay = function (value) {
        var id = this.id;
        return d3_selection_each(this, "function" == typeof value ? function (node, i, j) {
            node.__transition__[id].delay = 0 | value.call(node, node.__data__, i, j)
        } : (value |= 0, function (node) {
            node.__transition__[id].delay = value
        }))
    }, d3_transitionPrototype.duration = function (value) {
        var id = this.id;
        return d3_selection_each(this, "function" == typeof value ? function (node, i, j) {
            node.__transition__[id].duration = Math.max(1, 0 | value.call(node, node.__data__, i, j))
        } : (value = Math.max(1, 0 | value), function (node) {
            node.__transition__[id].duration = value
        }))
    }, d3_transitionPrototype.each = function (type, listener) {
        var id = this.id;
        if (arguments.length < 2) {
            var inherit = d3_transitionInherit, inheritId = d3_transitionInheritId;
            d3_transitionInheritId = id, d3_selection_each(this, function (node, i, j) {
                d3_transitionInherit = node.__transition__[id], type.call(node, node.__data__, i, j)
            }), d3_transitionInherit = inherit, d3_transitionInheritId = inheritId
        } else d3_selection_each(this, function (node) {
            node.__transition__[id].event.on(type, listener)
        });
        return this
    }, d3_transitionPrototype.transition = function () {
        for (var subgroup, group, node, transition, id0 = this.id, id1 = ++d3_transitionId, subgroups = [], j = 0, m = this.length; m > j; j++) {
            subgroups.push(subgroup = []);
            for (var group = this[j], i = 0, n = group.length; n > i; i++)(node = group[i]) && (transition = Object.create(node.__transition__[id0]), transition.delay += transition.duration, d3_transitionNode(node, i, id1, transition)), subgroup.push(node)
        }
        return d3_transition(subgroups, id1)
    }, d3.svg.axis = function () {
        function axis(g) {
            g.each(function () {
                var tickTransform, g = d3.select(this), ticks = null == tickValues ? scale.ticks ? scale.ticks.apply(scale, tickArguments_) : scale.domain() : tickValues, tickFormat = null == tickFormat_ ? scale.tickFormat ? scale.tickFormat.apply(scale, tickArguments_) : String : tickFormat_, subticks = d3_svg_axisSubdivide(scale, ticks, tickSubdivide), subtick = g.selectAll(".tick.minor").data(subticks, String), subtickEnter = subtick.enter().insert("line", ".tick").attr("class", "tick minor").style("opacity", 1e-6), subtickExit = d3.transition(subtick.exit()).style("opacity", 1e-6).remove(), subtickUpdate = d3.transition(subtick).style("opacity", 1), tick = g.selectAll(".tick.major").data(ticks, String), tickEnter = tick.enter().insert("g", ".domain").attr("class", "tick major").style("opacity", 1e-6), tickExit = d3.transition(tick.exit()).style("opacity", 1e-6).remove(), tickUpdate = d3.transition(tick).style("opacity", 1), range = d3_scaleRange(scale), path = g.selectAll(".domain").data([0]), pathUpdate = (path.enter().append("path").attr("class", "domain"), d3.transition(path)), scale1 = scale.copy(), scale0 = this.__chart__ || scale1;
                this.__chart__ = scale1, tickEnter.append("line"), tickEnter.append("text");
                var lineEnter = tickEnter.select("line"), lineUpdate = tickUpdate.select("line"), text = tick.select("text").text(tickFormat), textEnter = tickEnter.select("text"), textUpdate = tickUpdate.select("text");
                switch (orient) {
                    case"bottom":
                        tickTransform = d3_svg_axisX, subtickEnter.attr("y2", tickMinorSize), subtickUpdate.attr("x2", 0).attr("y2", tickMinorSize), lineEnter.attr("y2", tickMajorSize), textEnter.attr("y", Math.max(tickMajorSize, 0) + tickPadding), lineUpdate.attr("x2", 0).attr("y2", tickMajorSize), textUpdate.attr("x", 0).attr("y", Math.max(tickMajorSize, 0) + tickPadding), text.attr("dy", ".71em").style("text-anchor", "middle"), pathUpdate.attr("d", "M" + range[0] + "," + tickEndSize + "V0H" + range[1] + "V" + tickEndSize);
                        break;
                    case"top":
                        tickTransform = d3_svg_axisX, subtickEnter.attr("y2", -tickMinorSize), subtickUpdate.attr("x2", 0).attr("y2", -tickMinorSize), lineEnter.attr("y2", -tickMajorSize), textEnter.attr("y", -(Math.max(tickMajorSize, 0) + tickPadding)), lineUpdate.attr("x2", 0).attr("y2", -tickMajorSize), textUpdate.attr("x", 0).attr("y", -(Math.max(tickMajorSize, 0) + tickPadding)), text.attr("dy", "0em").style("text-anchor", "middle"), pathUpdate.attr("d", "M" + range[0] + "," + -tickEndSize + "V0H" + range[1] + "V" + -tickEndSize);
                        break;
                    case"left":
                        tickTransform = d3_svg_axisY, subtickEnter.attr("x2", -tickMinorSize), subtickUpdate.attr("x2", -tickMinorSize).attr("y2", 0), lineEnter.attr("x2", -tickMajorSize), textEnter.attr("x", -(Math.max(tickMajorSize, 0) + tickPadding)), lineUpdate.attr("x2", -tickMajorSize).attr("y2", 0), textUpdate.attr("x", -(Math.max(tickMajorSize, 0) + tickPadding)).attr("y", 0), text.attr("dy", ".32em").style("text-anchor", "end"), pathUpdate.attr("d", "M" + -tickEndSize + "," + range[0] + "H0V" + range[1] + "H" + -tickEndSize);
                        break;
                    case"right":
                        tickTransform = d3_svg_axisY, subtickEnter.attr("x2", tickMinorSize), subtickUpdate.attr("x2", tickMinorSize).attr("y2", 0), lineEnter.attr("x2", tickMajorSize), textEnter.attr("x", Math.max(tickMajorSize, 0) + tickPadding), lineUpdate.attr("x2", tickMajorSize).attr("y2", 0), textUpdate.attr("x", Math.max(tickMajorSize, 0) + tickPadding).attr("y", 0), text.attr("dy", ".32em").style("text-anchor", "start"), pathUpdate.attr("d", "M" + tickEndSize + "," + range[0] + "H0V" + range[1] + "H" + tickEndSize)
                }
                if (scale.ticks)tickEnter.call(tickTransform, scale0), tickUpdate.call(tickTransform, scale1), tickExit.call(tickTransform, scale1), subtickEnter.call(tickTransform, scale0), subtickUpdate.call(tickTransform, scale1), subtickExit.call(tickTransform, scale1); else {
                    var dx = scale1.rangeBand() / 2, x = function (d) {
                        return scale1(d) + dx
                    };
                    tickEnter.call(tickTransform, x), tickUpdate.call(tickTransform, x)
                }
            })
        }

        var tickFormat_, scale = d3.scale.linear(), orient = d3_svg_axisDefaultOrient, tickMajorSize = 6, tickMinorSize = 6, tickEndSize = 6, tickPadding = 3, tickArguments_ = [10], tickValues = null, tickSubdivide = 0;
        return axis.scale = function (x) {
            return arguments.length ? (scale = x, axis) : scale
        }, axis.orient = function (x) {
            return arguments.length ? (orient = x in d3_svg_axisOrients ? x + "" : d3_svg_axisDefaultOrient, axis) : orient
        }, axis.ticks = function () {
            return arguments.length ? (tickArguments_ = arguments, axis) : tickArguments_
        }, axis.tickValues = function (x) {
            return arguments.length ? (tickValues = x, axis) : tickValues
        }, axis.tickFormat = function (x) {
            return arguments.length ? (tickFormat_ = x, axis) : tickFormat_
        }, axis.tickSize = function (x, y) {
            if (!arguments.length)return tickMajorSize;
            var n = arguments.length - 1;
            return tickMajorSize = +x, tickMinorSize = n > 1 ? +y : tickMajorSize, tickEndSize = n > 0 ? +arguments[n] : tickMajorSize, axis
        }, axis.tickPadding = function (x) {
            return arguments.length ? (tickPadding = +x, axis) : tickPadding
        }, axis.tickSubdivide = function (x) {
            return arguments.length ? (tickSubdivide = +x, axis) : tickSubdivide
        }, axis
    };
    var d3_svg_axisDefaultOrient = "bottom", d3_svg_axisOrients = {top: 1, right: 1, bottom: 1, left: 1};
    d3.svg.brush = function () {
        function brush(g) {
            g.each(function () {
                var e, g = d3.select(this), bg = g.selectAll(".background").data([0]), fg = g.selectAll(".extent").data([0]), tz = g.selectAll(".resize").data(resizes, String);
                g.style("pointer-events", "all").on("mousedown.brush", brushstart).on("touchstart.brush", brushstart), bg.enter().append("rect").attr("class", "background").style("visibility", "hidden").style("cursor", "crosshair"), fg.enter().append("rect").attr("class", "extent").style("cursor", "move"), tz.enter().append("g").attr("class",function (d) {
                    return"resize " + d
                }).style("cursor",function (d) {
                    return d3_svg_brushCursor[d]
                }).append("rect").attr("x",function (d) {
                    return/[ew]$/.test(d) ? -3 : null
                }).attr("y",function (d) {
                    return/^[ns]/.test(d) ? -3 : null
                }).attr("width", 6).attr("height", 6).style("visibility", "hidden"), tz.style("display", brush.empty() ? "none" : null), tz.exit().remove(), x && (e = d3_scaleRange(x), bg.attr("x", e[0]).attr("width", e[1] - e[0]), redrawX(g)), y && (e = d3_scaleRange(y), bg.attr("y", e[0]).attr("height", e[1] - e[0]), redrawY(g)), redraw(g)
            })
        }

        function redraw(g) {
            g.selectAll(".resize").attr("transform", function (d) {
                return"translate(" + extent[+/e$/.test(d)][0] + "," + extent[+/^s/.test(d)][1] + ")"
            })
        }

        function redrawX(g) {
            g.select(".extent").attr("x", extent[0][0]), g.selectAll(".extent,.n>rect,.s>rect").attr("width", extent[1][0] - extent[0][0])
        }

        function redrawY(g) {
            g.select(".extent").attr("y", extent[0][1]), g.selectAll(".extent,.e>rect,.w>rect").attr("height", extent[1][1] - extent[0][1])
        }

        function brushstart() {
            function mouse() {
                var touches = d3.event.changedTouches;
                return touches ? d3.touches(target, touches)[0] : d3.mouse(target)
            }

            function keydown() {
                32 == d3.event.keyCode && (dragging || (center = null, origin[0] -= extent[1][0], origin[1] -= extent[1][1], dragging = 2), d3_eventCancel())
            }

            function keyup() {
                32 == d3.event.keyCode && 2 == dragging && (origin[0] += extent[1][0], origin[1] += extent[1][1], dragging = 0, d3_eventCancel())
            }

            function brushmove() {
                var point = mouse(), moved = !1;
                offset && (point[0] += offset[0], point[1] += offset[1]), dragging || (d3.event.altKey ? (center || (center = [(extent[0][0] + extent[1][0]) / 2, (extent[0][1] + extent[1][1]) / 2]), origin[0] = extent[+(point[0] < center[0])][0], origin[1] = extent[+(point[1] < center[1])][1]) : center = null), resizingX && move1(point, x, 0) && (redrawX(g), moved = !0), resizingY && move1(point, y, 1) && (redrawY(g), moved = !0), moved && (redraw(g), event_({type: "brush", mode: dragging ? "move" : "resize"}))
            }

            function move1(point, scale, i) {
                var min, max, range = d3_scaleRange(scale), r0 = range[0], r1 = range[1], position = origin[i], size = extent[1][i] - extent[0][i];
                return dragging && (r0 -= position, r1 -= size + position), min = clamp[i] ? Math.max(r0, Math.min(r1, point[i])) : point[i], dragging ? max = (min += position) + size : (center && (position = Math.max(r0, Math.min(r1, 2 * center[i] - min))), min > position ? (max = min, min = position) : max = position), extent[0][i] !== min || extent[1][i] !== max ? (extentDomain = null, extent[0][i] = min, extent[1][i] = max, !0) : void 0
            }

            function brushend() {
                brushmove(), g.style("pointer-events", "all").selectAll(".resize").style("display", brush.empty() ? "none" : null), d3.select("body").style("cursor", null), w.on("mousemove.brush", null).on("mouseup.brush", null).on("touchmove.brush", null).on("touchend.brush", null).on("keydown.brush", null).on("keyup.brush", null), event_({type: "brushend"}), d3_eventCancel()
            }

            var center, offset, target = this, eventTarget = d3.select(d3.event.target), event_ = event.of(target, arguments), g = d3.select(target), resizing = eventTarget.datum(), resizingX = !/^(n|s)$/.test(resizing) && x, resizingY = !/^(e|w)$/.test(resizing) && y, dragging = eventTarget.classed("extent"), origin = mouse(), w = d3.select(d3_window).on("mousemove.brush", brushmove).on("mouseup.brush", brushend).on("touchmove.brush", brushmove).on("touchend.brush", brushend).on("keydown.brush", keydown).on("keyup.brush", keyup);
            if (dragging)origin[0] = extent[0][0] - origin[0], origin[1] = extent[0][1] - origin[1]; else if (resizing) {
                var ex = +/w$/.test(resizing), ey = +/^n/.test(resizing);
                offset = [extent[1 - ex][0] - origin[0], extent[1 - ey][1] - origin[1]], origin[0] = extent[ex][0], origin[1] = extent[ey][1]
            } else d3.event.altKey && (center = origin.slice());
            g.style("pointer-events", "none").selectAll(".resize").style("display", null), d3.select("body").style("cursor", eventTarget.style("cursor")), event_({type: "brushstart"}), brushmove(), d3_eventCancel()
        }

        var extentDomain, event = d3_eventDispatch(brush, "brushstart", "brush", "brushend"), x = null, y = null, resizes = d3_svg_brushResizes[0], extent = [
            [0, 0],
            [0, 0]
        ], clamp = [!0, !0];
        return brush.x = function (z) {
            return arguments.length ? (x = z, resizes = d3_svg_brushResizes[!x << 1 | !y], brush) : x
        }, brush.y = function (z) {
            return arguments.length ? (y = z, resizes = d3_svg_brushResizes[!x << 1 | !y], brush) : y
        }, brush.clamp = function (z) {
            return arguments.length ? (x && y ? clamp = [!!z[0], !!z[1]] : clamp[+!x] = !!z, brush) : x && y ? clamp : clamp[+!x]
        }, brush.extent = function (z) {
            var x0, x1, y0, y1, t;
            return arguments.length ? (extentDomain = [
                [0, 0],
                [0, 0]
            ], x && (x0 = z[0], x1 = z[1], y && (x0 = x0[0], x1 = x1[0]), extentDomain[0][0] = x0, extentDomain[1][0] = x1, x.invert && (x0 = x(x0), x1 = x(x1)), x0 > x1 && (t = x0, x0 = x1, x1 = t), extent[0][0] = 0 | x0, extent[1][0] = 0 | x1), y && (y0 = z[0], y1 = z[1], x && (y0 = y0[1], y1 = y1[1]), extentDomain[0][1] = y0, extentDomain[1][1] = y1, y.invert && (y0 = y(y0), y1 = y(y1)), y0 > y1 && (t = y0, y0 = y1, y1 = t), extent[0][1] = 0 | y0, extent[1][1] = 0 | y1), brush) : (z = extentDomain || extent, x && (x0 = z[0][0], x1 = z[1][0], extentDomain || (x0 = extent[0][0], x1 = extent[1][0], x.invert && (x0 = x.invert(x0), x1 = x.invert(x1)), x0 > x1 && (t = x0, x0 = x1, x1 = t))), y && (y0 = z[0][1], y1 = z[1][1], extentDomain || (y0 = extent[0][1], y1 = extent[1][1], y.invert && (y0 = y.invert(y0), y1 = y.invert(y1)), y0 > y1 && (t = y0, y0 = y1, y1 = t))), x && y ? [
                [x0, y0],
                [x1, y1]
            ] : x ? [x0, x1] : y && [y0, y1])
        }, brush.clear = function () {
            return extentDomain = null, extent[0][0] = extent[0][1] = extent[1][0] = extent[1][1] = 0, brush
        }, brush.empty = function () {
            return x && extent[0][0] === extent[1][0] || y && extent[0][1] === extent[1][1]
        }, d3.rebind(brush, event, "on")
    };
    var d3_svg_brushCursor = {n: "ns-resize", e: "ew-resize", s: "ns-resize", w: "ew-resize", nw: "nwse-resize", ne: "nesw-resize", se: "nwse-resize", sw: "nesw-resize"}, d3_svg_brushResizes = [
        ["n", "e", "s", "w", "nw", "ne", "se", "sw"],
        ["e", "w"],
        ["n", "s"],
        []
    ];
    d3.time = {};
    var d3_time = Date, d3_time_daySymbols = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    d3_time_utc.prototype = {getDate: function () {
        return this._.getUTCDate()
    }, getDay: function () {
        return this._.getUTCDay()
    }, getFullYear: function () {
        return this._.getUTCFullYear()
    }, getHours: function () {
        return this._.getUTCHours()
    }, getMilliseconds: function () {
        return this._.getUTCMilliseconds()
    }, getMinutes: function () {
        return this._.getUTCMinutes()
    }, getMonth: function () {
        return this._.getUTCMonth()
    }, getSeconds: function () {
        return this._.getUTCSeconds()
    }, getTime: function () {
        return this._.getTime()
    }, getTimezoneOffset: function () {
        return 0
    }, valueOf: function () {
        return this._.valueOf()
    }, setDate: function () {
        d3_time_prototype.setUTCDate.apply(this._, arguments)
    }, setDay: function () {
        d3_time_prototype.setUTCDay.apply(this._, arguments)
    }, setFullYear: function () {
        d3_time_prototype.setUTCFullYear.apply(this._, arguments)
    }, setHours: function () {
        d3_time_prototype.setUTCHours.apply(this._, arguments)
    }, setMilliseconds: function () {
        d3_time_prototype.setUTCMilliseconds.apply(this._, arguments)
    }, setMinutes: function () {
        d3_time_prototype.setUTCMinutes.apply(this._, arguments)
    }, setMonth: function () {
        d3_time_prototype.setUTCMonth.apply(this._, arguments)
    }, setSeconds: function () {
        d3_time_prototype.setUTCSeconds.apply(this._, arguments)
    }, setTime: function () {
        d3_time_prototype.setTime.apply(this._, arguments)
    }};
    var d3_time_prototype = Date.prototype, d3_time_formatDateTime = "%a %b %e %X %Y", d3_time_formatDate = "%m/%d/%Y", d3_time_formatTime = "%H:%M:%S", d3_time_days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], d3_time_dayAbbreviations = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], d3_time_months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], d3_time_monthAbbreviations = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    d3.time.year = d3_time_interval(function (date) {
        return date = d3.time.day(date), date.setMonth(0, 1), date
    }, function (date, offset) {
        date.setFullYear(date.getFullYear() + offset)
    }, function (date) {
        return date.getFullYear()
    }), d3.time.years = d3.time.year.range, d3.time.years.utc = d3.time.year.utc.range, d3.time.day = d3_time_interval(function (date) {
        var day = new d3_time(2e3, 0);
        return day.setFullYear(date.getFullYear(), date.getMonth(), date.getDate()), day
    }, function (date, offset) {
        date.setDate(date.getDate() + offset)
    }, function (date) {
        return date.getDate() - 1
    }), d3.time.days = d3.time.day.range, d3.time.days.utc = d3.time.day.utc.range, d3.time.dayOfYear = function (date) {
        var year = d3.time.year(date);
        return Math.floor((date - year - 6e4 * (date.getTimezoneOffset() - year.getTimezoneOffset())) / 864e5)
    }, d3_time_daySymbols.forEach(function (day, i) {
        day = day.toLowerCase(), i = 7 - i;
        var interval = d3.time[day] = d3_time_interval(function (date) {
            return(date = d3.time.day(date)).setDate(date.getDate() - (date.getDay() + i) % 7), date
        }, function (date, offset) {
            date.setDate(date.getDate() + 7 * Math.floor(offset))
        }, function (date) {
            var day = d3.time.year(date).getDay();
            return Math.floor((d3.time.dayOfYear(date) + (day + i) % 7) / 7) - (day !== i)
        });
        d3.time[day + "s"] = interval.range, d3.time[day + "s"].utc = interval.utc.range, d3.time[day + "OfYear"] = function (date) {
            var day = d3.time.year(date).getDay();
            return Math.floor((d3.time.dayOfYear(date) + (day + i) % 7) / 7)
        }
    }), d3.time.week = d3.time.sunday, d3.time.weeks = d3.time.sunday.range, d3.time.weeks.utc = d3.time.sunday.utc.range, d3.time.weekOfYear = d3.time.sundayOfYear, d3.time.format = function (template) {
        function format(date) {
            for (var c, p, f, string = [], i = -1, j = 0; ++i < n;)37 === template.charCodeAt(i) && (string.push(template.substring(j, i)), null != (p = d3_time_formatPads[c = template.charAt(++i)]) && (c = template.charAt(++i)), (f = d3_time_formats[c]) && (c = f(date, null == p ? "e" === c ? " " : "0" : p)), string.push(c), j = i + 1);
            return string.push(template.substring(j, i)), string.join("")
        }

        var n = template.length;
        return format.parse = function (string) {
            var d = {y: 1900, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0}, i = d3_time_parse(d, template, string, 0);
            if (i != string.length)return null;
            "p"in d && (d.H = d.H % 12 + 12 * d.p);
            var date = new d3_time;
            return"j"in d ? date.setFullYear(d.y, 0, d.j) : "w"in d && ("W"in d || "U"in d) ? (date.setFullYear(d.y, 0, 1), date.setFullYear(d.y, 0, "W"in d ? (d.w + 6) % 7 + 7 * d.W - (date.getDay() + 5) % 7 : d.w + 7 * d.U - (date.getDay() + 6) % 7)) : date.setFullYear(d.y, d.m, d.d), date.setHours(d.H, d.M, d.S, d.L), date
        }, format.toString = function () {
            return template
        }, format
    };
    var d3_time_dayRe = d3_time_formatRe(d3_time_days), d3_time_dayLookup = d3_time_formatLookup(d3_time_days), d3_time_dayAbbrevRe = d3_time_formatRe(d3_time_dayAbbreviations), d3_time_dayAbbrevLookup = d3_time_formatLookup(d3_time_dayAbbreviations), d3_time_monthRe = d3_time_formatRe(d3_time_months), d3_time_monthLookup = d3_time_formatLookup(d3_time_months), d3_time_monthAbbrevRe = d3_time_formatRe(d3_time_monthAbbreviations), d3_time_monthAbbrevLookup = d3_time_formatLookup(d3_time_monthAbbreviations), d3_time_percentRe = /^%/, d3_time_formatPads = {"-": "", _: " ", 0: "0"}, d3_time_formats = {a: function (d) {
        return d3_time_dayAbbreviations[d.getDay()]
    }, A: function (d) {
        return d3_time_days[d.getDay()]
    }, b: function (d) {
        return d3_time_monthAbbreviations[d.getMonth()]
    }, B: function (d) {
        return d3_time_months[d.getMonth()]
    }, c: d3.time.format(d3_time_formatDateTime), d: function (d, p) {
        return d3_time_formatPad(d.getDate(), p, 2)
    }, e: function (d, p) {
        return d3_time_formatPad(d.getDate(), p, 2)
    }, H: function (d, p) {
        return d3_time_formatPad(d.getHours(), p, 2)
    }, I: function (d, p) {
        return d3_time_formatPad(d.getHours() % 12 || 12, p, 2)
    }, j: function (d, p) {
        return d3_time_formatPad(1 + d3.time.dayOfYear(d), p, 3)
    }, L: function (d, p) {
        return d3_time_formatPad(d.getMilliseconds(), p, 3)
    }, m: function (d, p) {
        return d3_time_formatPad(d.getMonth() + 1, p, 2)
    }, M: function (d, p) {
        return d3_time_formatPad(d.getMinutes(), p, 2)
    }, p: function (d) {
        return d.getHours() >= 12 ? "PM" : "AM"
    }, S: function (d, p) {
        return d3_time_formatPad(d.getSeconds(), p, 2)
    }, U: function (d, p) {
        return d3_time_formatPad(d3.time.sundayOfYear(d), p, 2)
    }, w: function (d) {
        return d.getDay()
    }, W: function (d, p) {
        return d3_time_formatPad(d3.time.mondayOfYear(d), p, 2)
    }, x: d3.time.format(d3_time_formatDate), X: d3.time.format(d3_time_formatTime), y: function (d, p) {
        return d3_time_formatPad(d.getFullYear() % 100, p, 2)
    }, Y: function (d, p) {
        return d3_time_formatPad(d.getFullYear() % 1e4, p, 4)
    }, Z: d3_time_zone, "%": function () {
        return"%"
    }}, d3_time_parsers = {a: d3_time_parseWeekdayAbbrev, A: d3_time_parseWeekday, b: d3_time_parseMonthAbbrev, B: d3_time_parseMonth, c: d3_time_parseLocaleFull, d: d3_time_parseDay, e: d3_time_parseDay, H: d3_time_parseHour24, I: d3_time_parseHour24, j: d3_time_parseDayOfYear, L: d3_time_parseMilliseconds, m: d3_time_parseMonthNumber, M: d3_time_parseMinutes, p: d3_time_parseAmPm, S: d3_time_parseSeconds, U: d3_time_parseWeekNumberSunday, w: d3_time_parseWeekdayNumber, W: d3_time_parseWeekNumberMonday, x: d3_time_parseLocaleDate, X: d3_time_parseLocaleTime, y: d3_time_parseYear, Y: d3_time_parseFullYear, "%": d3_time_parseLiteralPercent}, d3_time_numberRe = /^\s*\d+/, d3_time_amPmLookup = d3.map({am: 0, pm: 1});
    d3.time.format.utc = function (template) {
        function format(date) {
            try {
                d3_time = d3_time_utc;
                var utc = new d3_time;
                return utc._ = date, local(utc)
            } finally {
                d3_time = Date
            }
        }

        var local = d3.time.format(template);
        return format.parse = function (string) {
            try {
                d3_time = d3_time_utc;
                var date = local.parse(string);
                return date && date._
            } finally {
                d3_time = Date
            }
        }, format.toString = local.toString, format
    };
    var d3_time_formatIso = d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");
    d3.time.format.iso = Date.prototype.toISOString && +new Date("2000-01-01T00:00:00.000Z") ? d3_time_formatIsoNative : d3_time_formatIso, d3_time_formatIsoNative.parse = function (string) {
        var date = new Date(string);
        return isNaN(date) ? null : date
    }, d3_time_formatIsoNative.toString = d3_time_formatIso.toString, d3.time.second = d3_time_interval(function (date) {
        return new d3_time(1e3 * Math.floor(date / 1e3))
    }, function (date, offset) {
        date.setTime(date.getTime() + 1e3 * Math.floor(offset))
    }, function (date) {
        return date.getSeconds()
    }), d3.time.seconds = d3.time.second.range, d3.time.seconds.utc = d3.time.second.utc.range, d3.time.minute = d3_time_interval(function (date) {
        return new d3_time(6e4 * Math.floor(date / 6e4))
    }, function (date, offset) {
        date.setTime(date.getTime() + 6e4 * Math.floor(offset))
    }, function (date) {
        return date.getMinutes()
    }), d3.time.minutes = d3.time.minute.range, d3.time.minutes.utc = d3.time.minute.utc.range, d3.time.hour = d3_time_interval(function (date) {
        var timezone = date.getTimezoneOffset() / 60;
        return new d3_time(36e5 * (Math.floor(date / 36e5 - timezone) + timezone))
    }, function (date, offset) {
        date.setTime(date.getTime() + 36e5 * Math.floor(offset))
    }, function (date) {
        return date.getHours()
    }), d3.time.hours = d3.time.hour.range, d3.time.hours.utc = d3.time.hour.utc.range, d3.time.month = d3_time_interval(function (date) {
        return date = d3.time.day(date), date.setDate(1), date
    }, function (date, offset) {
        date.setMonth(date.getMonth() + offset)
    }, function (date) {
        return date.getMonth()
    }), d3.time.months = d3.time.month.range, d3.time.months.utc = d3.time.month.utc.range;
    var d3_time_scaleSteps = [1e3, 5e3, 15e3, 3e4, 6e4, 3e5, 9e5, 18e5, 36e5, 108e5, 216e5, 432e5, 864e5, 1728e5, 6048e5, 2592e6, 7776e6, 31536e6], d3_time_scaleLocalMethods = [
        [d3.time.second, 1],
        [d3.time.second, 5],
        [d3.time.second, 15],
        [d3.time.second, 30],
        [d3.time.minute, 1],
        [d3.time.minute, 5],
        [d3.time.minute, 15],
        [d3.time.minute, 30],
        [d3.time.hour, 1],
        [d3.time.hour, 3],
        [d3.time.hour, 6],
        [d3.time.hour, 12],
        [d3.time.day, 1],
        [d3.time.day, 2],
        [d3.time.week, 1],
        [d3.time.month, 1],
        [d3.time.month, 3],
        [d3.time.year, 1]
    ], d3_time_scaleLocalFormats = [
        [d3.time.format("%Y"), d3_true],
        [d3.time.format("%B"), function (d) {
            return d.getMonth()
        }],
        [d3.time.format("%b %d"), function (d) {
            return 1 != d.getDate()
        }],
        [d3.time.format("%a %d"), function (d) {
            return d.getDay() && 1 != d.getDate()
        }],
        [d3.time.format("%I %p"), function (d) {
            return d.getHours()
        }],
        [d3.time.format("%I:%M"), function (d) {
            return d.getMinutes()
        }],
        [d3.time.format(":%S"), function (d) {
            return d.getSeconds()
        }],
        [d3.time.format(".%L"), function (d) {
            return d.getMilliseconds()
        }]
    ], d3_time_scaleLinear = d3.scale.linear(), d3_time_scaleLocalFormat = d3_time_scaleFormat(d3_time_scaleLocalFormats);
    d3_time_scaleLocalMethods.year = function (extent, m) {
        return d3_time_scaleLinear.domain(extent.map(d3_time_scaleGetYear)).ticks(m).map(d3_time_scaleSetYear)
    }, d3.time.scale = function () {
        return d3_time_scale(d3.scale.linear(), d3_time_scaleLocalMethods, d3_time_scaleLocalFormat)
    };
    var d3_time_scaleUTCMethods = d3_time_scaleLocalMethods.map(function (m) {
        return[m[0].utc, m[1]]
    }), d3_time_scaleUTCFormats = [
        [d3.time.format.utc("%Y"), d3_true],
        [d3.time.format.utc("%B"), function (d) {
            return d.getUTCMonth()
        }],
        [d3.time.format.utc("%b %d"), function (d) {
            return 1 != d.getUTCDate()
        }],
        [d3.time.format.utc("%a %d"), function (d) {
            return d.getUTCDay() && 1 != d.getUTCDate()
        }],
        [d3.time.format.utc("%I %p"), function (d) {
            return d.getUTCHours()
        }],
        [d3.time.format.utc("%I:%M"), function (d) {
            return d.getUTCMinutes()
        }],
        [d3.time.format.utc(":%S"), function (d) {
            return d.getUTCSeconds()
        }],
        [d3.time.format.utc(".%L"), function (d) {
            return d.getUTCMilliseconds()
        }]
    ], d3_time_scaleUTCFormat = d3_time_scaleFormat(d3_time_scaleUTCFormats);
    return d3_time_scaleUTCMethods.year = function (extent, m) {
        return d3_time_scaleLinear.domain(extent.map(d3_time_scaleUTCGetYear)).ticks(m).map(d3_time_scaleUTCSetYear)
    }, d3.time.scale.utc = function () {
        return d3_time_scale(d3.scale.linear(), d3_time_scaleUTCMethods, d3_time_scaleUTCFormat)
    }, d3.text = d3_xhrType(function (request) {
        return request.responseText
    }), d3.json = function (url, callback) {
        return d3_xhr(url, "application/json", d3_json, callback)
    }, d3.html = function (url, callback) {
        return d3_xhr(url, "text/html", d3_html, callback)
    }, d3.xml = d3_xhrType(function (request) {
        return request.responseXML
    }), d3
}(), function (window) {
    function basicIndexOf(array, value, fromIndex) {
        for (var index = (fromIndex || 0) - 1, length = array.length; ++index < length;)if (array[index] === value)return index;
        return-1
    }

    function cacheIndexOf(cache, value) {
        var type = typeof value;
        if (cache = cache.cache, "boolean" == type || null == value)return cache[value];
        "number" != type && "string" != type && (type = "object");
        var key = "number" == type ? value : keyPrefix + value;
        return cache = cache[type] || (cache[type] = {}), "object" == type ? cache[key] && basicIndexOf(cache[key], value) > -1 ? 0 : -1 : cache[key] ? 0 : -1
    }

    function cachePush(value) {
        var cache = this.cache, type = typeof value;
        if ("boolean" == type || null == value)cache[value] = !0; else {
            "number" != type && "string" != type && (type = "object");
            var key = "number" == type ? value : keyPrefix + value, typeCache = cache[type] || (cache[type] = {});
            "object" == type ? (typeCache[key] || (typeCache[key] = [])).push(value) == this.array.length && (cache[type] = !1) : typeCache[key] = !0
        }
    }

    function charAtCallback(value) {
        return value.charCodeAt(0)
    }

    function compareAscending(a, b) {
        var ai = a.index, bi = b.index;
        if (a = a.criteria, b = b.criteria, a !== b) {
            if (a > b || "undefined" == typeof a)return 1;
            if (b > a || "undefined" == typeof b)return-1
        }
        return bi > ai ? -1 : 1
    }

    function createCache(array) {
        var index = -1, length = array.length, cache = getObject();
        cache["false"] = cache["null"] = cache["true"] = cache.undefined = !1;
        var result = getObject();
        for (result.array = array, result.cache = cache, result.push = cachePush; ++index < length;)result.push(array[index]);
        return cache.object === !1 ? (releaseObject(result), null) : result
    }

    function escapeStringChar(match) {
        return"\\" + stringEscapes[match]
    }

    function getArray() {
        return arrayPool.pop() || []
    }

    function getObject() {
        return objectPool.pop() || {array: null, cache: null, criteria: null, "false": !1, index: 0, leading: !1, maxWait: 0, "null": !1, number: null, object: null, push: null, string: null, trailing: !1, "true": !1, undefined: !1, value: null}
    }

    function releaseArray(array) {
        array.length = 0, arrayPool.length < maxPoolSize && arrayPool.push(array)
    }

    function releaseObject(object) {
        var cache = object.cache;
        cache && releaseObject(cache), object.array = object.cache = object.criteria = object.object = object.number = object.string = object.value = null, objectPool.length < maxPoolSize && objectPool.push(object)
    }

    function slice(array, start, end) {
        start || (start = 0), "undefined" == typeof end && (end = array ? array.length : 0);
        for (var index = -1, length = end - start || 0, result = Array(0 > length ? 0 : length); ++index < length;)result[index] = array[start + index];
        return result
    }

    function runInContext(context) {
        function lodash(value) {
            return value && "object" == typeof value && !isArray(value) && hasOwnProperty.call(value, "__wrapped__") ? value : new lodashWrapper(value)
        }

        function lodashWrapper(value) {
            this.__wrapped__ = value
        }

        function createBound(func, thisArg, partialArgs, indicator) {
            function bound() {
                var args = arguments, thisBinding = isPartial ? this : thisArg;
                if (isFunc || (func = thisArg[key]), partialArgs.length && (args = args.length ? (args = nativeSlice.call(args), rightIndicator ? args.concat(partialArgs) : partialArgs.concat(args)) : partialArgs), this instanceof bound) {
                    thisBinding = createObject(func.prototype);
                    var result = func.apply(thisBinding, args);
                    return isObject(result) ? result : thisBinding
                }
                return func.apply(thisBinding, args)
            }

            var isFunc = isFunction(func), isPartial = !partialArgs, key = thisArg;
            if (isPartial) {
                var rightIndicator = indicator;
                partialArgs = thisArg
            } else if (!isFunc) {
                if (!indicator)throw new TypeError;
                thisArg = func
            }
            return bound
        }

        function createObject(prototype) {
            return isObject(prototype) ? nativeCreate(prototype) : {}
        }

        function escapeHtmlChar(match) {
            return htmlEscapes[match]
        }

        function getIndexOf() {
            var result = (result = lodash.indexOf) === indexOf ? basicIndexOf : result;
            return result
        }

        function overloadWrapper(func) {
            return function (array, flag, callback, thisArg) {
                return"boolean" != typeof flag && null != flag && (thisArg = callback, callback = thisArg && thisArg[flag] === array ? undefined : flag, flag = !1), null != callback && (callback = lodash.createCallback(callback, thisArg)), func(array, flag, callback, thisArg)
            }
        }

        function shimIsPlainObject(value) {
            var ctor, result;
            return value && toString.call(value) == objectClass && (ctor = value.constructor, !isFunction(ctor) || ctor instanceof ctor) ? (forIn(value, function (value, key) {
                result = key
            }), result === undefined || hasOwnProperty.call(value, result)) : !1
        }

        function unescapeHtmlChar(match) {
            return htmlUnescapes[match]
        }

        function isArguments(value) {
            return toString.call(value) == argsClass
        }

        function clone(value, deep, callback, thisArg, stackA, stackB) {
            var result = value;
            if ("boolean" != typeof deep && null != deep && (thisArg = callback, callback = deep, deep = !1), "function" == typeof callback) {
                if (callback = "undefined" == typeof thisArg ? callback : lodash.createCallback(callback, thisArg, 1), result = callback(result), "undefined" != typeof result)return result;
                result = value
            }
            var isObj = isObject(result);
            if (isObj) {
                var className = toString.call(result);
                if (!cloneableClasses[className])return result;
                var isArr = isArray(result)
            }
            if (!isObj || !deep)return isObj ? isArr ? slice(result) : assign({}, result) : result;
            var ctor = ctorByClass[className];
            switch (className) {
                case boolClass:
                case dateClass:
                    return new ctor(+result);
                case numberClass:
                case stringClass:
                    return new ctor(result);
                case regexpClass:
                    return ctor(result.source, reFlags.exec(result))
            }
            var initedStack = !stackA;
            stackA || (stackA = getArray()), stackB || (stackB = getArray());
            for (var length = stackA.length; length--;)if (stackA[length] == value)return stackB[length];
            return result = isArr ? ctor(result.length) : {}, isArr && (hasOwnProperty.call(value, "index") && (result.index = value.index), hasOwnProperty.call(value, "input") && (result.input = value.input)), stackA.push(value), stackB.push(result), (isArr ? forEach : forOwn)(value, function (objValue, key) {
                result[key] = clone(objValue, deep, callback, undefined, stackA, stackB)
            }), initedStack && (releaseArray(stackA), releaseArray(stackB)), result
        }

        function cloneDeep(value, callback, thisArg) {
            return clone(value, !0, callback, thisArg)
        }

        function findKey(object, callback, thisArg) {
            var result;
            return callback = lodash.createCallback(callback, thisArg), forOwn(object, function (value, key, object) {
                return callback(value, key, object) ? (result = key, !1) : void 0
            }), result
        }

        function functions(object) {
            var result = [];
            return forIn(object, function (value, key) {
                isFunction(value) && result.push(key)
            }), result.sort()
        }

        function has(object, property) {
            return object ? hasOwnProperty.call(object, property) : !1
        }

        function invert(object) {
            for (var index = -1, props = keys(object), length = props.length, result = {}; ++index < length;) {
                var key = props[index];
                result[object[key]] = key
            }
            return result
        }

        function isBoolean(value) {
            return value === !0 || value === !1 || toString.call(value) == boolClass
        }

        function isDate(value) {
            return value ? "object" == typeof value && toString.call(value) == dateClass : !1
        }

        function isElement(value) {
            return value ? 1 === value.nodeType : !1
        }

        function isEmpty(value) {
            var result = !0;
            if (!value)return result;
            var className = toString.call(value), length = value.length;
            return className == arrayClass || className == stringClass || className == argsClass || className == objectClass && "number" == typeof length && isFunction(value.splice) ? !length : (forOwn(value, function () {
                return result = !1
            }), result)
        }

        function isEqual(a, b, callback, thisArg, stackA, stackB) {
            var whereIndicator = callback === indicatorObject;
            if ("function" == typeof callback && !whereIndicator) {
                callback = lodash.createCallback(callback, thisArg, 2);
                var result = callback(a, b);
                if ("undefined" != typeof result)return!!result
            }
            if (a === b)return 0 !== a || 1 / a == 1 / b;
            var type = typeof a, otherType = typeof b;
            if (a === a && (!a || "function" != type && "object" != type) && (!b || "function" != otherType && "object" != otherType))return!1;
            if (null == a || null == b)return a === b;
            var className = toString.call(a), otherClass = toString.call(b);
            if (className == argsClass && (className = objectClass), otherClass == argsClass && (otherClass = objectClass), className != otherClass)return!1;
            switch (className) {
                case boolClass:
                case dateClass:
                    return+a == +b;
                case numberClass:
                    return a != +a ? b != +b : 0 == a ? 1 / a == 1 / b : a == +b;
                case regexpClass:
                case stringClass:
                    return a == String(b)
            }
            var isArr = className == arrayClass;
            if (!isArr) {
                if (hasOwnProperty.call(a, "__wrapped__ ") || hasOwnProperty.call(b, "__wrapped__"))return isEqual(a.__wrapped__ || a, b.__wrapped__ || b, callback, thisArg, stackA, stackB);
                if (className != objectClass)return!1;
                var ctorA = a.constructor, ctorB = b.constructor;
                if (ctorA != ctorB && !(isFunction(ctorA) && ctorA instanceof ctorA && isFunction(ctorB) && ctorB instanceof ctorB))return!1
            }
            var initedStack = !stackA;
            stackA || (stackA = getArray()), stackB || (stackB = getArray());
            for (var length = stackA.length; length--;)if (stackA[length] == a)return stackB[length] == b;
            var size = 0;
            if (result = !0, stackA.push(a), stackB.push(b), isArr) {
                if (length = a.length, size = b.length, result = size == a.length, !result && !whereIndicator)return result;
                for (; size--;) {
                    var index = length, value = b[size];
                    if (whereIndicator)for (; index-- && !(result = isEqual(a[index], value, callback, thisArg, stackA, stackB));); else if (!(result = isEqual(a[size], value, callback, thisArg, stackA, stackB)))break
                }
                return result
            }
            return forIn(b, function (value, key, b) {
                return hasOwnProperty.call(b, key) ? (size++, result = hasOwnProperty.call(a, key) && isEqual(a[key], value, callback, thisArg, stackA, stackB)) : void 0
            }), result && !whereIndicator && forIn(a, function (value, key, a) {
                return hasOwnProperty.call(a, key) ? result = --size > -1 : void 0
            }), initedStack && (releaseArray(stackA), releaseArray(stackB)), result
        }

        function isFinite(value) {
            return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value))
        }

        function isFunction(value) {
            return"function" == typeof value
        }

        function isObject(value) {
            return!(!value || !objectTypes[typeof value])
        }

        function isNaN(value) {
            return isNumber(value) && value != +value
        }

        function isNull(value) {
            return null === value
        }

        function isNumber(value) {
            return"number" == typeof value || toString.call(value) == numberClass
        }

        function isRegExp(value) {
            return value ? "object" == typeof value && toString.call(value) == regexpClass : !1
        }

        function isString(value) {
            return"string" == typeof value || toString.call(value) == stringClass
        }

        function isUndefined(value) {
            return"undefined" == typeof value
        }

        function merge(object, source, deepIndicator) {
            var args = arguments, index = 0, length = 2;
            if (!isObject(object))return object;
            if (deepIndicator === indicatorObject)var callback = args[3], stackA = args[4], stackB = args[5]; else {
                var initedStack = !0;
                stackA = getArray(), stackB = getArray(), "number" != typeof deepIndicator && (length = args.length), length > 3 && "function" == typeof args[length - 2] ? callback = lodash.createCallback(args[--length - 1], args[length--], 2) : length > 2 && "function" == typeof args[length - 1] && (callback = args[--length])
            }
            for (; ++index < length;)(isArray(args[index]) ? forEach : forOwn)(args[index], function (source, key) {
                var found, isArr, result = source, value = object[key];
                if (source && ((isArr = isArray(source)) || isPlainObject(source))) {
                    for (var stackLength = stackA.length; stackLength--;)if (found = stackA[stackLength] == source) {
                        value = stackB[stackLength];
                        break
                    }
                    if (!found) {
                        var isShallow;
                        callback && (result = callback(value, source), (isShallow = "undefined" != typeof result) && (value = result)), isShallow || (value = isArr ? isArray(value) ? value : [] : isPlainObject(value) ? value : {}), stackA.push(source), stackB.push(value), isShallow || (value = merge(value, source, indicatorObject, callback, stackA, stackB))
                    }
                } else callback && (result = callback(value, source), "undefined" == typeof result && (result = source)), "undefined" != typeof result && (value = result);
                object[key] = value
            });
            return initedStack && (releaseArray(stackA), releaseArray(stackB)), object
        }

        function omit(object, callback, thisArg) {
            var indexOf = getIndexOf(), isFunc = "function" == typeof callback, result = {};
            if (isFunc)callback = lodash.createCallback(callback, thisArg); else var props = concat.apply(arrayRef, nativeSlice.call(arguments, 1));
            return forIn(object, function (value, key, object) {
                (isFunc ? !callback(value, key, object) : indexOf(props, key) < 0) && (result[key] = value)
            }), result
        }

        function pairs(object) {
            for (var index = -1, props = keys(object), length = props.length, result = Array(length); ++index < length;) {
                var key = props[index];
                result[index] = [key, object[key]]
            }
            return result
        }

        function pick(object, callback, thisArg) {
            var result = {};
            if ("function" != typeof callback)for (var index = -1, props = concat.apply(arrayRef, nativeSlice.call(arguments, 1)), length = isObject(object) ? props.length : 0; ++index < length;) {
                var key = props[index];
                key in object && (result[key] = object[key])
            } else callback = lodash.createCallback(callback, thisArg), forIn(object, function (value, key, object) {
                callback(value, key, object) && (result[key] = value)
            });
            return result
        }

        function transform(object, callback, accumulator, thisArg) {
            var isArr = isArray(object);
            if (callback = lodash.createCallback(callback, thisArg, 4), null == accumulator)if (isArr)accumulator = []; else {
                var ctor = object && object.constructor, proto = ctor && ctor.prototype;
                accumulator = createObject(proto)
            }
            return(isArr ? forEach : forOwn)(object, function (value, index, object) {
                return callback(accumulator, value, index, object)
            }), accumulator
        }

        function values(object) {
            for (var index = -1, props = keys(object), length = props.length, result = Array(length); ++index < length;)result[index] = object[props[index]];
            return result
        }

        function at(collection) {
            for (var index = -1, props = concat.apply(arrayRef, nativeSlice.call(arguments, 1)), length = props.length, result = Array(length); ++index < length;)result[index] = collection[props[index]];
            return result
        }

        function contains(collection, target, fromIndex) {
            var index = -1, indexOf = getIndexOf(), length = collection ? collection.length : 0, result = !1;
            return fromIndex = (0 > fromIndex ? nativeMax(0, length + fromIndex) : fromIndex) || 0, length && "number" == typeof length ? result = (isString(collection) ? collection.indexOf(target, fromIndex) : indexOf(collection, target, fromIndex)) > -1 : forOwn(collection, function (value) {
                return++index >= fromIndex ? !(result = value === target) : void 0
            }), result
        }

        function countBy(collection, callback, thisArg) {
            var result = {};
            return callback = lodash.createCallback(callback, thisArg), forEach(collection, function (value, key, collection) {
                key = String(callback(value, key, collection)), hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1
            }), result
        }

        function every(collection, callback, thisArg) {
            var result = !0;
            callback = lodash.createCallback(callback, thisArg);
            var index = -1, length = collection ? collection.length : 0;
            if ("number" == typeof length)for (; ++index < length && (result = !!callback(collection[index], index, collection));); else forOwn(collection, function (value, index, collection) {
                return result = !!callback(value, index, collection)
            });
            return result
        }

        function filter(collection, callback, thisArg) {
            var result = [];
            callback = lodash.createCallback(callback, thisArg);
            var index = -1, length = collection ? collection.length : 0;
            if ("number" == typeof length)for (; ++index < length;) {
                var value = collection[index];
                callback(value, index, collection) && result.push(value)
            } else forOwn(collection, function (value, index, collection) {
                callback(value, index, collection) && result.push(value)
            });
            return result
        }

        function find(collection, callback, thisArg) {
            callback = lodash.createCallback(callback, thisArg);
            var index = -1, length = collection ? collection.length : 0;
            if ("number" != typeof length) {
                var result;
                return forOwn(collection, function (value, index, collection) {
                    return callback(value, index, collection) ? (result = value, !1) : void 0
                }), result
            }
            for (; ++index < length;) {
                var value = collection[index];
                if (callback(value, index, collection))return value
            }
        }

        function forEach(collection, callback, thisArg) {
            var index = -1, length = collection ? collection.length : 0;
            if (callback = callback && "undefined" == typeof thisArg ? callback : lodash.createCallback(callback, thisArg), "number" == typeof length)for (; ++index < length && callback(collection[index], index, collection) !== !1;); else forOwn(collection, callback);
            return collection
        }

        function groupBy(collection, callback, thisArg) {
            var result = {};
            return callback = lodash.createCallback(callback, thisArg), forEach(collection, function (value, key, collection) {
                key = String(callback(value, key, collection)), (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value)
            }), result
        }

        function invoke(collection, methodName) {
            var args = nativeSlice.call(arguments, 2), index = -1, isFunc = "function" == typeof methodName, length = collection ? collection.length : 0, result = Array("number" == typeof length ? length : 0);
            return forEach(collection, function (value) {
                result[++index] = (isFunc ? methodName : value[methodName]).apply(value, args)
            }), result
        }

        function map(collection, callback, thisArg) {
            var index = -1, length = collection ? collection.length : 0;
            if (callback = lodash.createCallback(callback, thisArg), "number" == typeof length)for (var result = Array(length); ++index < length;)result[index] = callback(collection[index], index, collection); else result = [], forOwn(collection, function (value, key, collection) {
                result[++index] = callback(value, key, collection)
            });
            return result
        }

        function max(collection, callback, thisArg) {
            var computed = -1 / 0, result = computed;
            if (!callback && isArray(collection))for (var index = -1, length = collection.length; ++index < length;) {
                var value = collection[index];
                value > result && (result = value)
            } else callback = !callback && isString(collection) ? charAtCallback : lodash.createCallback(callback, thisArg), forEach(collection, function (value, index, collection) {
                var current = callback(value, index, collection);
                current > computed && (computed = current, result = value)
            });
            return result
        }

        function min(collection, callback, thisArg) {
            var computed = 1 / 0, result = computed;
            if (!callback && isArray(collection))for (var index = -1, length = collection.length; ++index < length;) {
                var value = collection[index];
                result > value && (result = value)
            } else callback = !callback && isString(collection) ? charAtCallback : lodash.createCallback(callback, thisArg), forEach(collection, function (value, index, collection) {
                var current = callback(value, index, collection);
                computed > current && (computed = current, result = value)
            });
            return result
        }

        function pluck(collection, property) {
            var index = -1, length = collection ? collection.length : 0;
            if ("number" == typeof length)for (var result = Array(length); ++index < length;)result[index] = collection[index][property];
            return result || map(collection, property)
        }

        function reduce(collection, callback, accumulator, thisArg) {
            if (!collection)return accumulator;
            var noaccum = arguments.length < 3;
            callback = lodash.createCallback(callback, thisArg, 4);
            var index = -1, length = collection.length;
            if ("number" == typeof length)for (noaccum && (accumulator = collection[++index]); ++index < length;)accumulator = callback(accumulator, collection[index], index, collection); else forOwn(collection, function (value, index, collection) {
                accumulator = noaccum ? (noaccum = !1, value) : callback(accumulator, value, index, collection)
            });
            return accumulator
        }

        function reduceRight(collection, callback, accumulator, thisArg) {
            var iterable = collection, length = collection ? collection.length : 0, noaccum = arguments.length < 3;
            if ("number" != typeof length) {
                var props = keys(collection);
                length = props.length
            }
            return callback = lodash.createCallback(callback, thisArg, 4), forEach(collection, function (value, index, collection) {
                index = props ? props[--length] : --length, accumulator = noaccum ? (noaccum = !1, iterable[index]) : callback(accumulator, iterable[index], index, collection)
            }), accumulator
        }

        function reject(collection, callback, thisArg) {
            return callback = lodash.createCallback(callback, thisArg), filter(collection, function (value, index, collection) {
                return!callback(value, index, collection)
            })
        }

        function shuffle(collection) {
            var index = -1, length = collection ? collection.length : 0, result = Array("number" == typeof length ? length : 0);
            return forEach(collection, function (value) {
                var rand = floor(nativeRandom() * (++index + 1));
                result[index] = result[rand], result[rand] = value
            }), result
        }

        function size(collection) {
            var length = collection ? collection.length : 0;
            return"number" == typeof length ? length : keys(collection).length
        }

        function some(collection, callback, thisArg) {
            var result;
            callback = lodash.createCallback(callback, thisArg);
            var index = -1, length = collection ? collection.length : 0;
            if ("number" == typeof length)for (; ++index < length && !(result = callback(collection[index], index, collection));); else forOwn(collection, function (value, index, collection) {
                return!(result = callback(value, index, collection))
            });
            return!!result
        }

        function sortBy(collection, callback, thisArg) {
            var index = -1, length = collection ? collection.length : 0, result = Array("number" == typeof length ? length : 0);
            for (callback = lodash.createCallback(callback, thisArg), forEach(collection, function (value, key, collection) {
                var object = result[++index] = getObject();
                object.criteria = callback(value, key, collection), object.index = index, object.value = value
            }), length = result.length, result.sort(compareAscending); length--;) {
                var object = result[length];
                result[length] = object.value, releaseObject(object)
            }
            return result
        }

        function toArray(collection) {
            return collection && "number" == typeof collection.length ? slice(collection) : values(collection)
        }

        function compact(array) {
            for (var index = -1, length = array ? array.length : 0, result = []; ++index < length;) {
                var value = array[index];
                value && result.push(value)
            }
            return result
        }

        function difference(array) {
            var index = -1, indexOf = getIndexOf(), length = array ? array.length : 0, seen = concat.apply(arrayRef, nativeSlice.call(arguments, 1)), result = [], isLarge = length >= largeArraySize && indexOf === basicIndexOf;
            if (isLarge) {
                var cache = createCache(seen);
                cache ? (indexOf = cacheIndexOf, seen = cache) : isLarge = !1
            }
            for (; ++index < length;) {
                var value = array[index];
                indexOf(seen, value) < 0 && result.push(value)
            }
            return isLarge && releaseObject(seen), result
        }

        function findIndex(array, callback, thisArg) {
            var index = -1, length = array ? array.length : 0;
            for (callback = lodash.createCallback(callback, thisArg); ++index < length;)if (callback(array[index], index, array))return index;
            return-1
        }

        function first(array, callback, thisArg) {
            if (array) {
                var n = 0, length = array.length;
                if ("number" != typeof callback && null != callback) {
                    var index = -1;
                    for (callback = lodash.createCallback(callback, thisArg); ++index < length && callback(array[index], index, array);)n++
                } else if (n = callback, null == n || thisArg)return array[0];
                return slice(array, 0, nativeMin(nativeMax(0, n), length))
            }
        }

        function indexOf(array, value, fromIndex) {
            if ("number" == typeof fromIndex) {
                var length = array ? array.length : 0;
                fromIndex = 0 > fromIndex ? nativeMax(0, length + fromIndex) : fromIndex || 0
            } else if (fromIndex) {
                var index = sortedIndex(array, value);
                return array[index] === value ? index : -1
            }
            return array ? basicIndexOf(array, value, fromIndex) : -1
        }

        function initial(array, callback, thisArg) {
            if (!array)return[];
            var n = 0, length = array.length;
            if ("number" != typeof callback && null != callback) {
                var index = length;
                for (callback = lodash.createCallback(callback, thisArg); index-- && callback(array[index], index, array);)n++
            } else n = null == callback || thisArg ? 1 : callback || n;
            return slice(array, 0, nativeMin(nativeMax(0, length - n), length))
        }

        function intersection(array) {
            for (var args = arguments, argsLength = args.length, argsIndex = -1, caches = getArray(), index = -1, indexOf = getIndexOf(), length = array ? array.length : 0, result = [], seen = getArray(); ++argsIndex < argsLength;) {
                var value = args[argsIndex];
                caches[argsIndex] = indexOf === basicIndexOf && (value ? value.length : 0) >= largeArraySize && createCache(argsIndex ? args[argsIndex] : seen)
            }
            outer:for (; ++index < length;) {
                var cache = caches[0];
                if (value = array[index], (cache ? cacheIndexOf(cache, value) : indexOf(seen, value)) < 0) {
                    for (argsIndex = argsLength, (cache || seen).push(value); --argsIndex;)if (cache = caches[argsIndex], (cache ? cacheIndexOf(cache, value) : indexOf(args[argsIndex], value)) < 0)continue outer;
                    result.push(value)
                }
            }
            for (; argsLength--;)cache = caches[argsLength], cache && releaseObject(cache);
            return releaseArray(caches), releaseArray(seen), result
        }

        function last(array, callback, thisArg) {
            if (array) {
                var n = 0, length = array.length;
                if ("number" != typeof callback && null != callback) {
                    var index = length;
                    for (callback = lodash.createCallback(callback, thisArg); index-- && callback(array[index], index, array);)n++
                } else if (n = callback, null == n || thisArg)return array[length - 1];
                return slice(array, nativeMax(0, length - n))
            }
        }

        function lastIndexOf(array, value, fromIndex) {
            var index = array ? array.length : 0;
            for ("number" == typeof fromIndex && (index = (0 > fromIndex ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1); index--;)if (array[index] === value)return index;
            return-1
        }

        function range(start, end, step) {
            start = +start || 0, step = +step || 1, null == end && (end = start, start = 0);
            for (var index = -1, length = nativeMax(0, ceil((end - start) / step)), result = Array(length); ++index < length;)result[index] = start, start += step;
            return result
        }

        function rest(array, callback, thisArg) {
            if ("number" != typeof callback && null != callback) {
                var n = 0, index = -1, length = array ? array.length : 0;
                for (callback = lodash.createCallback(callback, thisArg); ++index < length && callback(array[index], index, array);)n++
            } else n = null == callback || thisArg ? 1 : nativeMax(0, callback);
            return slice(array, n)
        }

        function sortedIndex(array, value, callback, thisArg) {
            var low = 0, high = array ? array.length : low;
            for (callback = callback ? lodash.createCallback(callback, thisArg, 1) : identity, value = callback(value); high > low;) {
                var mid = low + high >>> 1;
                callback(array[mid]) < value ? low = mid + 1 : high = mid
            }
            return low
        }

        function union(array) {
            return isArray(array) || (arguments[0] = array ? nativeSlice.call(array) : arrayRef), uniq(concat.apply(arrayRef, arguments))
        }

        function unzip(array) {
            for (var index = -1, length = array ? max(pluck(array, "length")) : 0, result = Array(0 > length ? 0 : length); ++index < length;)result[index] = pluck(array, index);
            return result
        }

        function without(array) {
            return difference(array, nativeSlice.call(arguments, 1))
        }

        function zip(array) {
            return array ? unzip(arguments) : []
        }

        function zipObject(keys, values) {
            for (var index = -1, length = keys ? keys.length : 0, result = {}; ++index < length;) {
                var key = keys[index];
                values ? result[key] = values[index] : result[key[0]] = key[1]
            }
            return result
        }

        function after(n, func) {
            return 1 > n ? func() : function () {
                return--n < 1 ? func.apply(this, arguments) : void 0
            }
        }

        function bind(func, thisArg) {
            return support.fastBind || nativeBind && arguments.length > 2 ? nativeBind.call.apply(nativeBind, arguments) : createBound(func, thisArg, nativeSlice.call(arguments, 2))
        }

        function bindAll(object) {
            for (var funcs = arguments.length > 1 ? concat.apply(arrayRef, nativeSlice.call(arguments, 1)) : functions(object), index = -1, length = funcs.length; ++index < length;) {
                var key = funcs[index];
                object[key] = bind(object[key], object)
            }
            return object
        }

        function bindKey(object, key) {
            return createBound(object, key, nativeSlice.call(arguments, 2), indicatorObject)
        }

        function compose() {
            var funcs = arguments;
            return function () {
                for (var args = arguments, length = funcs.length; length--;)args = [funcs[length].apply(this, args)];
                return args[0]
            }
        }

        function createCallback(func, thisArg, argCount) {
            if (null == func)return identity;
            var type = typeof func;
            if ("function" != type) {
                if ("object" != type)return function (object) {
                    return object[func]
                };
                var props = keys(func);
                return function (object) {
                    for (var length = props.length, result = !1; length-- && (result = isEqual(object[props[length]], func[props[length]], indicatorObject)););
                    return result
                }
            }
            return"undefined" == typeof thisArg || reThis && !reThis.test(fnToString.call(func)) ? func : 1 === argCount ? function (value) {
                return func.call(thisArg, value)
            } : 2 === argCount ? function (a, b) {
                return func.call(thisArg, a, b)
            } : 4 === argCount ? function (accumulator, value, index, collection) {
                return func.call(thisArg, accumulator, value, index, collection)
            } : function (value, index, collection) {
                return func.call(thisArg, value, index, collection)
            }
        }

        function debounce(func, wait, options) {
            function clear() {
                clearTimeout(maxTimeoutId), clearTimeout(timeoutId), callCount = 0, maxTimeoutId = timeoutId = null
            }

            function delayed() {
                var isCalled = trailing && (!leading || callCount > 1);
                clear(), isCalled && (maxWait !== !1 && (lastCalled = new Date), result = func.apply(thisArg, args))
            }

            function maxDelayed() {
                clear(), (trailing || maxWait !== wait) && (lastCalled = new Date, result = func.apply(thisArg, args))
            }

            var args, result, thisArg, callCount = 0, lastCalled = 0, maxWait = !1, maxTimeoutId = null, timeoutId = null, trailing = !0;
            if (wait = nativeMax(0, wait || 0), options === !0) {
                var leading = !0;
                trailing = !1
            } else isObject(options) && (leading = options.leading, maxWait = "maxWait"in options && nativeMax(wait, options.maxWait || 0), trailing = "trailing"in options ? options.trailing : trailing);
            return function () {
                if (args = arguments, thisArg = this, callCount++, clearTimeout(timeoutId), maxWait === !1)leading && 2 > callCount && (result = func.apply(thisArg, args)); else {
                    var now = new Date;
                    maxTimeoutId || leading || (lastCalled = now);
                    var remaining = maxWait - (now - lastCalled);
                    0 >= remaining ? (clearTimeout(maxTimeoutId), maxTimeoutId = null, lastCalled = now, result = func.apply(thisArg, args)) : maxTimeoutId || (maxTimeoutId = setTimeout(maxDelayed, remaining))
                }
                return wait !== maxWait && (timeoutId = setTimeout(delayed, wait)), result
            }
        }

        function defer(func) {
            var args = nativeSlice.call(arguments, 1);
            return setTimeout(function () {
                func.apply(undefined, args)
            }, 1)
        }

        function delay(func, wait) {
            var args = nativeSlice.call(arguments, 2);
            return setTimeout(function () {
                func.apply(undefined, args)
            }, wait)
        }

        function memoize(func, resolver) {
            function memoized() {
                var cache = memoized.cache, key = keyPrefix + (resolver ? resolver.apply(this, arguments) : arguments[0]);
                return hasOwnProperty.call(cache, key) ? cache[key] : cache[key] = func.apply(this, arguments)
            }

            return memoized.cache = {}, memoized
        }

        function once(func) {
            var ran, result;
            return function () {
                return ran ? result : (ran = !0, result = func.apply(this, arguments), func = null, result)
            }
        }

        function partial(func) {
            return createBound(func, nativeSlice.call(arguments, 1))
        }

        function partialRight(func) {
            return createBound(func, nativeSlice.call(arguments, 1), null, indicatorObject)
        }

        function throttle(func, wait, options) {
            var leading = !0, trailing = !0;
            options === !1 ? leading = !1 : isObject(options) && (leading = "leading"in options ? options.leading : leading, trailing = "trailing"in options ? options.trailing : trailing), options = getObject(), options.leading = leading, options.maxWait = wait, options.trailing = trailing;
            var result = debounce(func, wait, options);
            return releaseObject(options), result
        }

        function wrap(value, wrapper) {
            return function () {
                var args = [value];
                return push.apply(args, arguments), wrapper.apply(this, args)
            }
        }

        function escape(string) {
            return null == string ? "" : String(string).replace(reUnescapedHtml, escapeHtmlChar)
        }

        function identity(value) {
            return value
        }

        function mixin(object) {
            forEach(functions(object), function (methodName) {
                var func = lodash[methodName] = object[methodName];
                lodash.prototype[methodName] = function () {
                    var value = this.__wrapped__, args = [value];
                    push.apply(args, arguments);
                    var result = func.apply(lodash, args);
                    return value && "object" == typeof value && value === result ? this : new lodashWrapper(result)
                }
            })
        }

        function noConflict() {
            return context._ = oldDash, this
        }

        function random(min, max) {
            null == min && null == max && (max = 1), min = +min || 0, null == max ? (max = min, min = 0) : max = +max || 0;
            var rand = nativeRandom();
            return min % 1 || max % 1 ? min + nativeMin(rand * (max - min + parseFloat("1e-" + ((rand + "").length - 1))), max) : min + floor(rand * (max - min + 1))
        }

        function result(object, property) {
            var value = object ? object[property] : undefined;
            return isFunction(value) ? object[property]() : value
        }

        function template(text, data, options) {
            var settings = lodash.templateSettings;
            text || (text = ""), options = defaults({}, options, settings);
            var isEvaluating, imports = defaults({}, options.imports, settings.imports), importsKeys = keys(imports), importsValues = values(imports), index = 0, interpolate = options.interpolate || reNoMatch, source = "__p += '", reDelimiters = RegExp((options.escape || reNoMatch).source + "|" + interpolate.source + "|" + (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + "|" + (options.evaluate || reNoMatch).source + "|$", "g");
            text.replace(reDelimiters, function (match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {
                return interpolateValue || (interpolateValue = esTemplateValue), source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar), escapeValue && (source += "' +\n__e(" + escapeValue + ") +\n'"), evaluateValue && (isEvaluating = !0, source += "';\n" + evaluateValue + ";\n__p += '"), interpolateValue && (source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'"), index = offset + match.length, match
            }), source += "';\n";
            var variable = options.variable, hasVariable = variable;
            hasVariable || (variable = "obj", source = "with (" + variable + ") {\n" + source + "\n}\n"), source = (isEvaluating ? source.replace(reEmptyStringLeading, "") : source).replace(reEmptyStringMiddle, "$1").replace(reEmptyStringTrailing, "$1;"), source = "function(" + variable + ") {\n" + (hasVariable ? "" : variable + " || (" + variable + " = {});\n") + "var __t, __p = '', __e = _.escape" + (isEvaluating ? ", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n" : ";\n") + source + "return __p\n}";
            var sourceURL = "\n/*\n//@ sourceURL=" + (options.sourceURL || "/lodash/template/source[" + templateCounter++ + "]") + "\n*/";
            try {
                var result = Function(importsKeys, "return " + source + sourceURL).apply(undefined, importsValues)
            } catch (e) {
                throw e.source = source, e
            }
            return data ? result(data) : (result.source = source, result)
        }

        function times(n, callback, thisArg) {
            n = (n = +n) > -1 ? n : 0;
            var index = -1, result = Array(n);
            for (callback = lodash.createCallback(callback, thisArg, 1); ++index < n;)result[index] = callback(index);
            return result
        }

        function unescape(string) {
            return null == string ? "" : String(string).replace(reEscapedHtml, unescapeHtmlChar)
        }

        function uniqueId(prefix) {
            var id = ++idCounter;
            return String(null == prefix ? "" : prefix) + id
        }

        function tap(value, interceptor) {
            return interceptor(value), value
        }

        function wrapperToString() {
            return String(this.__wrapped__)
        }

        function wrapperValueOf() {
            return this.__wrapped__
        }

        context = context ? _.defaults(window.Object(), context, _.pick(window, contextProps)) : window;
        var Array = context.Array, Boolean = context.Boolean, Date = context.Date, Function = context.Function, Math = context.Math, Number = context.Number, Object = context.Object, RegExp = context.RegExp, String = context.String, TypeError = context.TypeError, arrayRef = [], objectProto = Object.prototype;
        String.prototype;
        var oldDash = context._, reNative = RegExp("^" + String(objectProto.valueOf).replace(/[.*+?^${}()|[\]\\]/g, "\\$&").replace(/valueOf|for [^\]]+/g, ".+?") + "$"), ceil = Math.ceil, clearTimeout = context.clearTimeout, concat = arrayRef.concat, floor = Math.floor, fnToString = Function.prototype.toString, getPrototypeOf = reNative.test(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf, hasOwnProperty = objectProto.hasOwnProperty, push = arrayRef.push, setImmediate = (objectProto.propertyIsEnumerable, context.setImmediate), setTimeout = context.setTimeout, toString = objectProto.toString, nativeBind = reNative.test(nativeBind = toString.bind) && nativeBind, nativeCreate = reNative.test(nativeCreate = Object.create) && nativeCreate, nativeIsArray = reNative.test(nativeIsArray = Array.isArray) && nativeIsArray, nativeIsFinite = context.isFinite, nativeIsNaN = context.isNaN, nativeKeys = reNative.test(nativeKeys = Object.keys) && nativeKeys, nativeMax = Math.max, nativeMin = Math.min, nativeParseInt = context.parseInt, nativeRandom = Math.random, nativeSlice = arrayRef.slice, isIeOpera = reNative.test(context.attachEvent), isV8 = nativeBind && !/\n|true/.test(nativeBind + isIeOpera), ctorByClass = {};
        ctorByClass[arrayClass] = Array, ctorByClass[boolClass] = Boolean, ctorByClass[dateClass] = Date, ctorByClass[funcClass] = Function, ctorByClass[objectClass] = Object, ctorByClass[numberClass] = Number, ctorByClass[regexpClass] = RegExp, ctorByClass[stringClass] = String, lodashWrapper.prototype = lodash.prototype;
        var support = lodash.support = {};
        support.fastBind = nativeBind && !isV8, lodash.templateSettings = {escape: /<%-([\s\S]+?)%>/g, evaluate: /<%([\s\S]+?)%>/g, interpolate: reInterpolate, variable: "", imports: {_: lodash}};
        var isArray = nativeIsArray, shimKeys = function (object) {
            var index, iterable = object, result = [];
            if (!iterable)return result;
            if (!objectTypes[typeof object])return result;
            for (index in iterable)hasOwnProperty.call(iterable, index) && result.push(index);
            return result
        }, keys = nativeKeys ? function (object) {
            return isObject(object) ? nativeKeys(object) : []
        } : shimKeys, htmlEscapes = {"&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;"}, htmlUnescapes = invert(htmlEscapes), assign = function (object, source, guard) {
            var index, iterable = object, result = iterable;
            if (!iterable)return result;
            var args = arguments, argsIndex = 0, argsLength = "number" == typeof guard ? 2 : args.length;
            if (argsLength > 3 && "function" == typeof args[argsLength - 2])var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2); else argsLength > 2 && "function" == typeof args[argsLength - 1] && (callback = args[--argsLength]);
            for (; ++argsIndex < argsLength;)if (iterable = args[argsIndex], iterable && objectTypes[typeof iterable])for (var ownIndex = -1, ownProps = objectTypes[typeof iterable] && keys(iterable), length = ownProps ? ownProps.length : 0; ++ownIndex < length;)index = ownProps[ownIndex], result[index] = callback ? callback(result[index], iterable[index]) : iterable[index];
            return result
        }, defaults = function (object, source, guard) {
            var index, iterable = object, result = iterable;
            if (!iterable)return result;
            for (var args = arguments, argsIndex = 0, argsLength = "number" == typeof guard ? 2 : args.length; ++argsIndex < argsLength;)if (iterable = args[argsIndex], iterable && objectTypes[typeof iterable])for (var ownIndex = -1, ownProps = objectTypes[typeof iterable] && keys(iterable), length = ownProps ? ownProps.length : 0; ++ownIndex < length;)index = ownProps[ownIndex], "undefined" == typeof result[index] && (result[index] = iterable[index]);
            return result
        }, forIn = function (collection, callback, thisArg) {
            var index, iterable = collection, result = iterable;
            if (!iterable)return result;
            if (!objectTypes[typeof iterable])return result;
            callback = callback && "undefined" == typeof thisArg ? callback : lodash.createCallback(callback, thisArg);
            for (index in iterable)if (callback(iterable[index], index, collection) === !1)return result;
            return result
        }, forOwn = function (collection, callback, thisArg) {
            var index, iterable = collection, result = iterable;
            if (!iterable)return result;
            if (!objectTypes[typeof iterable])return result;
            callback = callback && "undefined" == typeof thisArg ? callback : lodash.createCallback(callback, thisArg);
            for (var ownIndex = -1, ownProps = objectTypes[typeof iterable] && keys(iterable), length = ownProps ? ownProps.length : 0; ++ownIndex < length;)if (index = ownProps[ownIndex], callback(iterable[index], index, collection) === !1)return result;
            return result
        }, isPlainObject = function (value) {
            if (!value || toString.call(value) != objectClass)return!1;
            var valueOf = value.valueOf, objProto = "function" == typeof valueOf && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);
            return objProto ? value == objProto || getPrototypeOf(value) == objProto : shimIsPlainObject(value)
        }, where = filter, flatten = overloadWrapper(function flatten(array, isShallow, callback) {
            for (var index = -1, length = array ? array.length : 0, result = []; ++index < length;) {
                var value = array[index];
                callback && (value = callback(value, index, array)), isArray(value) ? push.apply(result, isShallow ? value : flatten(value)) : result.push(value)
            }
            return result
        }), uniq = overloadWrapper(function (array, isSorted, callback) {
            var index = -1, indexOf = getIndexOf(), length = array ? array.length : 0, result = [], isLarge = !isSorted && length >= largeArraySize && indexOf === basicIndexOf, seen = callback || isLarge ? getArray() : result;
            if (isLarge) {
                var cache = createCache(seen);
                cache ? (indexOf = cacheIndexOf, seen = cache) : (isLarge = !1, seen = callback ? seen : (releaseArray(seen), result))
            }
            for (; ++index < length;) {
                var value = array[index], computed = callback ? callback(value, index, array) : value;
                (isSorted ? !index || seen[seen.length - 1] !== computed : indexOf(seen, computed) < 0) && ((callback || isLarge) && seen.push(computed), result.push(value))
            }
            return isLarge ? (releaseArray(seen.array), releaseObject(seen)) : callback && releaseArray(seen), result
        });
        isV8 && freeModule && "function" == typeof setImmediate && (defer = bind(setImmediate, context));
        var parseInt = 8 == nativeParseInt(whitespace + "08") ? nativeParseInt : function (value, radix) {
            return nativeParseInt(isString(value) ? value.replace(reLeadingSpacesAndZeros, "") : value, radix || 0)
        };
        return lodash.after = after, lodash.assign = assign, lodash.at = at, lodash.bind = bind, lodash.bindAll = bindAll, lodash.bindKey = bindKey, lodash.compact = compact, lodash.compose = compose, lodash.countBy = countBy, lodash.createCallback = createCallback, lodash.debounce = debounce, lodash.defaults = defaults, lodash.defer = defer, lodash.delay = delay, lodash.difference = difference, lodash.filter = filter, lodash.flatten = flatten, lodash.forEach = forEach, lodash.forIn = forIn, lodash.forOwn = forOwn, lodash.functions = functions, lodash.groupBy = groupBy, lodash.initial = initial, lodash.intersection = intersection, lodash.invert = invert, lodash.invoke = invoke, lodash.keys = keys, lodash.map = map, lodash.max = max, lodash.memoize = memoize, lodash.merge = merge, lodash.min = min, lodash.omit = omit, lodash.once = once, lodash.pairs = pairs, lodash.partial = partial, lodash.partialRight = partialRight, lodash.pick = pick, lodash.pluck = pluck, lodash.range = range, lodash.reject = reject, lodash.rest = rest, lodash.shuffle = shuffle, lodash.sortBy = sortBy, lodash.tap = tap, lodash.throttle = throttle, lodash.times = times, lodash.toArray = toArray, lodash.transform = transform, lodash.union = union, lodash.uniq = uniq, lodash.unzip = unzip, lodash.values = values, lodash.where = where, lodash.without = without, lodash.wrap = wrap, lodash.zip = zip, lodash.zipObject = zipObject, lodash.collect = map, lodash.drop = rest, lodash.each = forEach, lodash.extend = assign, lodash.methods = functions, lodash.object = zipObject, lodash.select = filter, lodash.tail = rest, lodash.unique = uniq, mixin(lodash), lodash.chain = lodash, lodash.prototype.chain = function () {
            return this
        }, lodash.clone = clone, lodash.cloneDeep = cloneDeep, lodash.contains = contains, lodash.escape = escape, lodash.every = every, lodash.find = find, lodash.findIndex = findIndex, lodash.findKey = findKey, lodash.has = has, lodash.identity = identity, lodash.indexOf = indexOf, lodash.isArguments = isArguments, lodash.isArray = isArray, lodash.isBoolean = isBoolean, lodash.isDate = isDate, lodash.isElement = isElement, lodash.isEmpty = isEmpty, lodash.isEqual = isEqual, lodash.isFinite = isFinite, lodash.isFunction = isFunction, lodash.isNaN = isNaN, lodash.isNull = isNull, lodash.isNumber = isNumber, lodash.isObject = isObject, lodash.isPlainObject = isPlainObject, lodash.isRegExp = isRegExp, lodash.isString = isString, lodash.isUndefined = isUndefined, lodash.lastIndexOf = lastIndexOf, lodash.mixin = mixin, lodash.noConflict = noConflict, lodash.parseInt = parseInt, lodash.random = random, lodash.reduce = reduce, lodash.reduceRight = reduceRight, lodash.result = result, lodash.runInContext = runInContext, lodash.size = size, lodash.some = some, lodash.sortedIndex = sortedIndex, lodash.template = template, lodash.unescape = unescape, lodash.uniqueId = uniqueId, lodash.all = every, lodash.any = some, lodash.detect = find, lodash.findWhere = find, lodash.foldl = reduce, lodash.foldr = reduceRight, lodash.include = contains, lodash.inject = reduce, forOwn(lodash, function (func, methodName) {
            lodash.prototype[methodName] || (lodash.prototype[methodName] = function () {
                var args = [this.__wrapped__];
                return push.apply(args, arguments), func.apply(lodash, args)
            })
        }), lodash.first = first, lodash.last = last, lodash.take = first, lodash.head = first, forOwn(lodash, function (func, methodName) {
            lodash.prototype[methodName] || (lodash.prototype[methodName] = function (callback, thisArg) {
                var result = func(this.__wrapped__, callback, thisArg);
                return null == callback || thisArg && "function" != typeof callback ? result : new lodashWrapper(result)
            })
        }), lodash.VERSION = "1.3.1", lodash.prototype.toString = wrapperToString, lodash.prototype.value = wrapperValueOf, lodash.prototype.valueOf = wrapperValueOf, forEach(["join", "pop", "shift"], function (methodName) {
            var func = arrayRef[methodName];
            lodash.prototype[methodName] = function () {
                return func.apply(this.__wrapped__, arguments)
            }
        }), forEach(["push", "reverse", "sort", "unshift"], function (methodName) {
            var func = arrayRef[methodName];
            lodash.prototype[methodName] = function () {
                return func.apply(this.__wrapped__, arguments), this
            }
        }), forEach(["concat", "slice", "splice"], function (methodName) {
            var func = arrayRef[methodName];
            lodash.prototype[methodName] = function () {
                return new lodashWrapper(func.apply(this.__wrapped__, arguments))
            }
        }), lodash
    }

    var undefined, arrayPool = [], objectPool = [], idCounter = 0, indicatorObject = {}, keyPrefix = +new Date + "", largeArraySize = 75, maxPoolSize = 40, reEmptyStringLeading = /\b__p \+= '';/g, reEmptyStringMiddle = /\b(__p \+=) '' \+/g, reEmptyStringTrailing = /(__e\(.*?\)|\b__t\)) \+\n'';/g, reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g, reEsTemplate = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, reFlags = /\w*$/, reInterpolate = /<%=([\s\S]+?)%>/g, reThis = (reThis = /\bthis\b/) && reThis.test(runInContext) && reThis, whitespace = " 	\f ﻿\n\r\u2028\u2029 ᠎             　", reLeadingSpacesAndZeros = RegExp("^[" + whitespace + "]*0+(?=.$)"), reNoMatch = /($^)/, reUnescapedHtml = /[&<>"']/g, reUnescapedString = /['\n\r\t\u2028\u2029\\]/g, contextProps = ["Array", "Boolean", "Date", "Function", "Math", "Number", "Object", "RegExp", "String", "_", "attachEvent", "clearTimeout", "isFinite", "isNaN", "parseInt", "setImmediate", "setTimeout"], templateCounter = 0, argsClass = "[object Arguments]", arrayClass = "[object Array]", boolClass = "[object Boolean]", dateClass = "[object Date]", funcClass = "[object Function]", numberClass = "[object Number]", objectClass = "[object Object]", regexpClass = "[object RegExp]", stringClass = "[object String]", cloneableClasses = {};
    cloneableClasses[funcClass] = !1, cloneableClasses[argsClass] = cloneableClasses[arrayClass] = cloneableClasses[boolClass] = cloneableClasses[dateClass] = cloneableClasses[numberClass] = cloneableClasses[objectClass] = cloneableClasses[regexpClass] = cloneableClasses[stringClass] = !0;
    var objectTypes = {"boolean": !1, "function": !0, object: !0, number: !1, string: !1, undefined: !1}, stringEscapes = {"\\": "\\", "'": "'", "\n": "n", "\r": "r", "	": "t", "\u2028": "u2028", "\u2029": "u2029"}, freeExports = objectTypes[typeof exports] && exports, freeModule = objectTypes[typeof module] && module && module.exports == freeExports && module, freeGlobal = objectTypes[typeof global] && global;
    !freeGlobal || freeGlobal.global !== freeGlobal && freeGlobal.window !== freeGlobal || (window = freeGlobal);
    var _ = runInContext();
    "function" == typeof define && "object" == typeof define.amd && define.amd ? (window._ = _, define(function () {
        return _
    })) : freeExports && !freeExports.nodeType ? freeModule ? (freeModule.exports = _)._ = _ : freeExports._ = _ : window._ = _
}(this), function (undefined) {
    function padToken(func, count) {
        return function (a) {
            return leftZeroFill(func.call(this, a), count)
        }
    }

    function ordinalizeToken(func, period) {
        return function (a) {
            return this.lang().ordinal(func.call(this, a), period)
        }
    }

    function Language() {
    }

    function Moment(config) {
        extend(this, config)
    }

    function Duration(duration) {
        var years = duration.years || duration.year || duration.y || 0, months = duration.months || duration.month || duration.M || 0, weeks = duration.weeks || duration.week || duration.w || 0, days = duration.days || duration.day || duration.d || 0, hours = duration.hours || duration.hour || duration.h || 0, minutes = duration.minutes || duration.minute || duration.m || 0, seconds = duration.seconds || duration.second || duration.s || 0, milliseconds = duration.milliseconds || duration.millisecond || duration.ms || 0;
        this._input = duration, this._milliseconds = +milliseconds + 1e3 * seconds + 6e4 * minutes + 36e5 * hours, this._days = +days + 7 * weeks, this._months = +months + 12 * years, this._data = {}, this._bubble()
    }

    function extend(a, b) {
        for (var i in b)b.hasOwnProperty(i) && (a[i] = b[i]);
        return a
    }

    function absRound(number) {
        return 0 > number ? Math.ceil(number) : Math.floor(number)
    }

    function leftZeroFill(number, targetLength) {
        for (var output = number + ""; output.length < targetLength;)output = "0" + output;
        return output
    }

    function addOrSubtractDurationFromMoment(mom, duration, isAdding, ignoreUpdateOffset) {
        var minutes, hours, milliseconds = duration._milliseconds, days = duration._days, months = duration._months;
        milliseconds && mom._d.setTime(+mom._d + milliseconds * isAdding), (days || months) && (minutes = mom.minute(), hours = mom.hour()), days && mom.date(mom.date() + days * isAdding), months && mom.month(mom.month() + months * isAdding), milliseconds && !ignoreUpdateOffset && moment.updateOffset(mom), (days || months) && (mom.minute(minutes), mom.hour(hours))
    }

    function isArray(input) {
        return"[object Array]" === Object.prototype.toString.call(input)
    }

    function compareArrays(array1, array2) {
        var i, len = Math.min(array1.length, array2.length), lengthDiff = Math.abs(array1.length - array2.length), diffs = 0;
        for (i = 0; len > i; i++)~~array1[i] !== ~~array2[i] && diffs++;
        return diffs + lengthDiff
    }

    function normalizeUnits(units) {
        return units ? unitAliases[units] || units.toLowerCase().replace(/(.)s$/, "$1") : units
    }

    function loadLang(key, values) {
        return values.abbr = key, languages[key] || (languages[key] = new Language), languages[key].set(values), languages[key]
    }

    function unloadLang(key) {
        delete languages[key]
    }

    function getLangDefinition(key) {
        if (!key)return moment.fn._lang;
        if (!languages[key] && hasModule)try {
            require("./lang/" + key)
        } catch (e) {
            return moment.fn._lang
        }
        return languages[key] || moment.fn._lang
    }

    function removeFormattingTokens(input) {
        return input.match(/\[.*\]/) ? input.replace(/^\[|\]$/g, "") : input.replace(/\\/g, "")
    }

    function makeFormatFunction(format) {
        var i, length, array = format.match(formattingTokens);
        for (i = 0, length = array.length; length > i; i++)array[i] = formatTokenFunctions[array[i]] ? formatTokenFunctions[array[i]] : removeFormattingTokens(array[i]);
        return function (mom) {
            var output = "";
            for (i = 0; length > i; i++)output += array[i]instanceof Function ? array[i].call(mom, format) : array[i];
            return output
        }
    }

    function formatMoment(m, format) {
        return format = expandFormat(format, m.lang()), formatFunctions[format] || (formatFunctions[format] = makeFormatFunction(format)), formatFunctions[format](m)
    }

    function expandFormat(format, lang) {
        function replaceLongDateFormatTokens(input) {
            return lang.longDateFormat(input) || input
        }

        for (var i = 5; i-- && (localFormattingTokens.lastIndex = 0, localFormattingTokens.test(format));)format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
        return format
    }

    function getParseRegexForToken(token, config) {
        switch (token) {
            case"DDDD":
                return parseTokenThreeDigits;
            case"YYYY":
                return parseTokenFourDigits;
            case"YYYYY":
                return parseTokenSixDigits;
            case"S":
            case"SS":
            case"SSS":
            case"DDD":
                return parseTokenOneToThreeDigits;
            case"MMM":
            case"MMMM":
            case"dd":
            case"ddd":
            case"dddd":
                return parseTokenWord;
            case"a":
            case"A":
                return getLangDefinition(config._l)._meridiemParse;
            case"X":
                return parseTokenTimestampMs;
            case"Z":
            case"ZZ":
                return parseTokenTimezone;
            case"T":
                return parseTokenT;
            case"MM":
            case"DD":
            case"YY":
            case"HH":
            case"hh":
            case"mm":
            case"ss":
            case"M":
            case"D":
            case"d":
            case"H":
            case"h":
            case"m":
            case"s":
                return parseTokenOneOrTwoDigits;
            default:
                return new RegExp(token.replace("\\", ""))
        }
    }

    function timezoneMinutesFromString(string) {
        var tzchunk = (parseTokenTimezone.exec(string) || [])[0], parts = (tzchunk + "").match(parseTimezoneChunker) || ["-", 0, 0], minutes = +(60 * parts[1]) + ~~parts[2];
        return"+" === parts[0] ? -minutes : minutes
    }

    function addTimeToArrayFromToken(token, input, config) {
        var a, datePartArray = config._a;
        switch (token) {
            case"M":
            case"MM":
                null != input && (datePartArray[1] = ~~input - 1);
                break;
            case"MMM":
            case"MMMM":
                a = getLangDefinition(config._l).monthsParse(input), null != a ? datePartArray[1] = a : config._isValid = !1;
                break;
            case"D":
            case"DD":
                null != input && (datePartArray[2] = ~~input);
                break;
            case"DDD":
            case"DDDD":
                null != input && (datePartArray[1] = 0, datePartArray[2] = ~~input);
                break;
            case"YY":
                datePartArray[0] = ~~input + (~~input > 68 ? 1900 : 2e3);
                break;
            case"YYYY":
            case"YYYYY":
                datePartArray[0] = ~~input;
                break;
            case"a":
            case"A":
                config._isPm = getLangDefinition(config._l).isPM(input);
                break;
            case"H":
            case"HH":
            case"h":
            case"hh":
                datePartArray[3] = ~~input;
                break;
            case"m":
            case"mm":
                datePartArray[4] = ~~input;
                break;
            case"s":
            case"ss":
                datePartArray[5] = ~~input;
                break;
            case"S":
            case"SS":
            case"SSS":
                datePartArray[6] = ~~(1e3 * ("0." + input));
                break;
            case"X":
                config._d = new Date(1e3 * parseFloat(input));
                break;
            case"Z":
            case"ZZ":
                config._useUTC = !0, config._tzm = timezoneMinutesFromString(input)
        }
        null == input && (config._isValid = !1)
    }

    function dateFromArray(config) {
        var i, date, currentDate, input = [];
        if (!config._d) {
            for (currentDate = currentDateArray(config), i = 0; 3 > i && null == config._a[i]; ++i)config._a[i] = input[i] = currentDate[i];
            for (; 7 > i; i++)config._a[i] = input[i] = null == config._a[i] ? 2 === i ? 1 : 0 : config._a[i];
            input[3] += ~~((config._tzm || 0) / 60), input[4] += ~~((config._tzm || 0) % 60), date = new Date(0), config._useUTC ? (date.setUTCFullYear(input[0], input[1], input[2]), date.setUTCHours(input[3], input[4], input[5], input[6])) : (date.setFullYear(input[0], input[1], input[2]), date.setHours(input[3], input[4], input[5], input[6])), config._d = date
        }
    }

    function dateFromObject(config) {
        var o = config._i;
        config._d || (config._a = [o.years || o.year || o.y, o.months || o.month || o.M, o.days || o.day || o.d, o.hours || o.hour || o.h, o.minutes || o.minute || o.m, o.seconds || o.second || o.s, o.milliseconds || o.millisecond || o.ms], dateFromArray(config))
    }

    function currentDateArray(config) {
        var now = new Date;
        return config._useUTC ? [now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()] : [now.getFullYear(), now.getMonth(), now.getDate()]
    }

    function makeDateFromStringAndFormat(config) {
        var i, parsedInput, tokens, lang = getLangDefinition(config._l), string = "" + config._i;
        for (tokens = expandFormat(config._f, lang).match(formattingTokens), config._a = [], i = 0; i < tokens.length; i++)parsedInput = (getParseRegexForToken(tokens[i], config).exec(string) || [])[0], parsedInput && (string = string.slice(string.indexOf(parsedInput) + parsedInput.length)), formatTokenFunctions[tokens[i]] && addTimeToArrayFromToken(tokens[i], parsedInput, config);
        string && (config._il = string), config._isPm && config._a[3] < 12 && (config._a[3] += 12), config._isPm === !1 && 12 === config._a[3] && (config._a[3] = 0), dateFromArray(config)
    }

    function makeDateFromStringAndArray(config) {
        var tempConfig, tempMoment, bestMoment, i, currentScore, scoreToBeat = 99;
        for (i = 0; i < config._f.length; i++)tempConfig = extend({}, config), tempConfig._f = config._f[i], makeDateFromStringAndFormat(tempConfig), tempMoment = new Moment(tempConfig), currentScore = compareArrays(tempConfig._a, tempMoment.toArray()), tempMoment._il && (currentScore += tempMoment._il.length), scoreToBeat > currentScore && (scoreToBeat = currentScore, bestMoment = tempMoment);
        extend(config, bestMoment)
    }

    function makeDateFromString(config) {
        var i, string = config._i, match = isoRegex.exec(string);
        if (match) {
            for (config._f = "YYYY-MM-DD" + (match[2] || " "), i = 0; 4 > i; i++)if (isoTimes[i][1].exec(string)) {
                config._f += isoTimes[i][0];
                break
            }
            parseTokenTimezone.exec(string) && (config._f += " Z"), makeDateFromStringAndFormat(config)
        } else config._d = new Date(string)
    }

    function makeDateFromInput(config) {
        var input = config._i, matched = aspNetJsonRegex.exec(input);
        input === undefined ? config._d = new Date : matched ? config._d = new Date(+matched[1]) : "string" == typeof input ? makeDateFromString(config) : isArray(input) ? (config._a = input.slice(0), dateFromArray(config)) : input instanceof Date ? config._d = new Date(+input) : "object" == typeof input ? dateFromObject(config) : config._d = new Date(input)
    }

    function substituteTimeAgo(string, number, withoutSuffix, isFuture, lang) {
        return lang.relativeTime(number || 1, !!withoutSuffix, string, isFuture)
    }

    function relativeTime(milliseconds, withoutSuffix, lang) {
        var seconds = round(Math.abs(milliseconds) / 1e3), minutes = round(seconds / 60), hours = round(minutes / 60), days = round(hours / 24), years = round(days / 365), args = 45 > seconds && ["s", seconds] || 1 === minutes && ["m"] || 45 > minutes && ["mm", minutes] || 1 === hours && ["h"] || 22 > hours && ["hh", hours] || 1 === days && ["d"] || 25 >= days && ["dd", days] || 45 >= days && ["M"] || 345 > days && ["MM", round(days / 30)] || 1 === years && ["y"] || ["yy", years];
        return args[2] = withoutSuffix, args[3] = milliseconds > 0, args[4] = lang, substituteTimeAgo.apply({}, args)
    }

    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {
        var adjustedMoment, end = firstDayOfWeekOfYear - firstDayOfWeek, daysToDayOfWeek = firstDayOfWeekOfYear - mom.day();
        return daysToDayOfWeek > end && (daysToDayOfWeek -= 7), end - 7 > daysToDayOfWeek && (daysToDayOfWeek += 7), adjustedMoment = moment(mom).add("d", daysToDayOfWeek), {week: Math.ceil(adjustedMoment.dayOfYear() / 7), year: adjustedMoment.year()}
    }

    function makeMoment(config) {
        var input = config._i, format = config._f;
        return null === input || "" === input ? null : ("string" == typeof input && (config._i = input = getLangDefinition().preparse(input)), moment.isMoment(input) ? (config = extend({}, input), config._d = new Date(+input._d)) : format ? isArray(format) ? makeDateFromStringAndArray(config) : makeDateFromStringAndFormat(config) : makeDateFromInput(config), new Moment(config))
    }

    function makeGetterAndSetter(name, key) {
        moment.fn[name] = moment.fn[name + "s"] = function (input) {
            var utc = this._isUTC ? "UTC" : "";
            return null != input ? (this._d["set" + utc + key](input), moment.updateOffset(this), this) : this._d["get" + utc + key]()
        }
    }

    function makeDurationGetter(name) {
        moment.duration.fn[name] = function () {
            return this._data[name]
        }
    }

    function makeDurationAsGetter(name, factor) {
        moment.duration.fn["as" + name] = function () {
            return+this / factor
        }
    }

    for (var moment, i, VERSION = "2.2.1", round = Math.round, languages = {}, hasModule = "undefined" != typeof module && module.exports, aspNetJsonRegex = /^\/?Date\((\-?\d+)/i, aspNetTimeSpanJsonRegex = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/, formattingTokens = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g, localFormattingTokens = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, parseTokenOneOrTwoDigits = /\d\d?/, parseTokenOneToThreeDigits = /\d{1,3}/, parseTokenThreeDigits = /\d{3}/, parseTokenFourDigits = /\d{1,4}/, parseTokenSixDigits = /[+\-]?\d{1,6}/, parseTokenWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, parseTokenTimezone = /Z|[\+\-]\d\d:?\d\d/i, parseTokenT = /T/i, parseTokenTimestampMs = /[\+\-]?\d+(\.\d{1,3})?/, isoRegex = /^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/, isoFormat = "YYYY-MM-DDTHH:mm:ssZ", isoTimes = [
        ["HH:mm:ss.S", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/],
        ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/],
        ["HH:mm", /(T| )\d\d:\d\d/],
        ["HH", /(T| )\d\d/]
    ], parseTimezoneChunker = /([\+\-]|\d\d)/gi, proxyGettersAndSetters = "Date|Hours|Minutes|Seconds|Milliseconds".split("|"), unitMillisecondFactors = {Milliseconds: 1, Seconds: 1e3, Minutes: 6e4, Hours: 36e5, Days: 864e5, Months: 2592e6, Years: 31536e6}, unitAliases = {ms: "millisecond", s: "second", m: "minute", h: "hour", d: "day", w: "week", W: "isoweek", M: "month", y: "year"}, formatFunctions = {}, ordinalizeTokens = "DDD w W M D d".split(" "), paddedTokens = "M D H h m s w W".split(" "), formatTokenFunctions = {M: function () {
        return this.month() + 1
    }, MMM: function (format) {
        return this.lang().monthsShort(this, format)
    }, MMMM: function (format) {
        return this.lang().months(this, format)
    }, D: function () {
        return this.date()
    }, DDD: function () {
        return this.dayOfYear()
    }, d: function () {
        return this.day()
    }, dd: function (format) {
        return this.lang().weekdaysMin(this, format)
    }, ddd: function (format) {
        return this.lang().weekdaysShort(this, format)
    }, dddd: function (format) {
        return this.lang().weekdays(this, format)
    }, w: function () {
        return this.week()
    }, W: function () {
        return this.isoWeek()
    }, YY: function () {
        return leftZeroFill(this.year() % 100, 2)
    }, YYYY: function () {
        return leftZeroFill(this.year(), 4)
    }, YYYYY: function () {
        return leftZeroFill(this.year(), 5)
    }, gg: function () {
        return leftZeroFill(this.weekYear() % 100, 2)
    }, gggg: function () {
        return this.weekYear()
    }, ggggg: function () {
        return leftZeroFill(this.weekYear(), 5)
    }, GG: function () {
        return leftZeroFill(this.isoWeekYear() % 100, 2)
    }, GGGG: function () {
        return this.isoWeekYear()
    }, GGGGG: function () {
        return leftZeroFill(this.isoWeekYear(), 5)
    }, e: function () {
        return this.weekday()
    }, E: function () {
        return this.isoWeekday()
    }, a: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !0)
    }, A: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !1)
    }, H: function () {
        return this.hours()
    }, h: function () {
        return this.hours() % 12 || 12
    }, m: function () {
        return this.minutes()
    }, s: function () {
        return this.seconds()
    }, S: function () {
        return~~(this.milliseconds() / 100)
    }, SS: function () {
        return leftZeroFill(~~(this.milliseconds() / 10), 2)
    }, SSS: function () {
        return leftZeroFill(this.milliseconds(), 3)
    }, Z: function () {
        var a = -this.zone(), b = "+";
        return 0 > a && (a = -a, b = "-"), b + leftZeroFill(~~(a / 60), 2) + ":" + leftZeroFill(~~a % 60, 2)
    }, ZZ: function () {
        var a = -this.zone(), b = "+";
        return 0 > a && (a = -a, b = "-"), b + leftZeroFill(~~(10 * a / 6), 4)
    }, z: function () {
        return this.zoneAbbr()
    }, zz: function () {
        return this.zoneName()
    }, X: function () {
        return this.unix()
    }}; ordinalizeTokens.length;)i = ordinalizeTokens.pop(), formatTokenFunctions[i + "o"] = ordinalizeToken(formatTokenFunctions[i], i);
    for (; paddedTokens.length;)i = paddedTokens.pop(), formatTokenFunctions[i + i] = padToken(formatTokenFunctions[i], 2);
    for (formatTokenFunctions.DDDD = padToken(formatTokenFunctions.DDD, 3), extend(Language.prototype, {set: function (config) {
        var prop, i;
        for (i in config)prop = config[i], "function" == typeof prop ? this[i] = prop : this["_" + i] = prop
    }, _months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), months: function (m) {
        return this._months[m.month()]
    }, _monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), monthsShort: function (m) {
        return this._monthsShort[m.month()]
    }, monthsParse: function (monthName) {
        var i, mom, regex;
        for (this._monthsParse || (this._monthsParse = []), i = 0; 12 > i; i++)if (this._monthsParse[i] || (mom = moment.utc([2e3, i]), regex = "^" + this.months(mom, "") + "|^" + this.monthsShort(mom, ""), this._monthsParse[i] = new RegExp(regex.replace(".", ""), "i")), this._monthsParse[i].test(monthName))return i
    }, _weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdays: function (m) {
        return this._weekdays[m.day()]
    }, _weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysShort: function (m) {
        return this._weekdaysShort[m.day()]
    }, _weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), weekdaysMin: function (m) {
        return this._weekdaysMin[m.day()]
    }, weekdaysParse: function (weekdayName) {
        var i, mom, regex;
        for (this._weekdaysParse || (this._weekdaysParse = []), i = 0; 7 > i; i++)if (this._weekdaysParse[i] || (mom = moment([2e3, 1]).day(i), regex = "^" + this.weekdays(mom, "") + "|^" + this.weekdaysShort(mom, "") + "|^" + this.weekdaysMin(mom, ""), this._weekdaysParse[i] = new RegExp(regex.replace(".", ""), "i")), this._weekdaysParse[i].test(weekdayName))return i
    }, _longDateFormat: {LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D YYYY", LLL: "MMMM D YYYY LT", LLLL: "dddd, MMMM D YYYY LT"}, longDateFormat: function (key) {
        var output = this._longDateFormat[key];
        return!output && this._longDateFormat[key.toUpperCase()] && (output = this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (val) {
            return val.slice(1)
        }), this._longDateFormat[key] = output), output
    }, isPM: function (input) {
        return"p" === (input + "").toLowerCase().charAt(0)
    }, _meridiemParse: /[ap]\.?m?\.?/i, meridiem: function (hours, minutes, isLower) {
        return hours > 11 ? isLower ? "pm" : "PM" : isLower ? "am" : "AM"
    }, _calendar: {sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L"}, calendar: function (key, mom) {
        var output = this._calendar[key];
        return"function" == typeof output ? output.apply(mom) : output
    }, _relativeTime: {future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years"}, relativeTime: function (number, withoutSuffix, string, isFuture) {
        var output = this._relativeTime[string];
        return"function" == typeof output ? output(number, withoutSuffix, string, isFuture) : output.replace(/%d/i, number)
    }, pastFuture: function (diff, output) {
        var format = this._relativeTime[diff > 0 ? "future" : "past"];
        return"function" == typeof format ? format(output) : format.replace(/%s/i, output)
    }, ordinal: function (number) {
        return this._ordinal.replace("%d", number)
    }, _ordinal: "%d", preparse: function (string) {
        return string
    }, postformat: function (string) {
        return string
    }, week: function (mom) {
        return weekOfYear(mom, this._week.dow, this._week.doy).week
    }, _week: {dow: 0, doy: 6}}), moment = function (input, format, lang) {
        return makeMoment({_i: input, _f: format, _l: lang, _isUTC: !1})
    }, moment.utc = function (input, format, lang) {
        return makeMoment({_useUTC: !0, _isUTC: !0, _l: lang, _i: input, _f: format}).utc()
    }, moment.unix = function (input) {
        return moment(1e3 * input)
    }, moment.duration = function (input, key) {
        var sign, ret, isDuration = moment.isDuration(input), isNumber = "number" == typeof input, duration = isDuration ? input._input : isNumber ? {} : input, matched = aspNetTimeSpanJsonRegex.exec(input);
        return isNumber ? key ? duration[key] = input : duration.milliseconds = input : matched && (sign = "-" === matched[1] ? -1 : 1, duration = {y: 0, d: ~~matched[2] * sign, h: ~~matched[3] * sign, m: ~~matched[4] * sign, s: ~~matched[5] * sign, ms: ~~matched[6] * sign}), ret = new Duration(duration), isDuration && input.hasOwnProperty("_lang") && (ret._lang = input._lang), ret
    }, moment.version = VERSION, moment.defaultFormat = isoFormat, moment.updateOffset = function () {
    }, moment.lang = function (key, values) {
        return key ? (key = key.toLowerCase(), key = key.replace("_", "-"), values ? loadLang(key, values) : null === values ? (unloadLang(key), key = "en") : languages[key] || getLangDefinition(key), moment.duration.fn._lang = moment.fn._lang = getLangDefinition(key), void 0) : moment.fn._lang._abbr
    }, moment.langData = function (key) {
        return key && key._lang && key._lang._abbr && (key = key._lang._abbr), getLangDefinition(key)
    }, moment.isMoment = function (obj) {
        return obj instanceof Moment
    }, moment.isDuration = function (obj) {
        return obj instanceof Duration
    }, extend(moment.fn = Moment.prototype, {clone: function () {
        return moment(this)
    }, valueOf: function () {
        return+this._d + 6e4 * (this._offset || 0)
    }, unix: function () {
        return Math.floor(+this / 1e3)
    }, toString: function () {
        return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
    }, toDate: function () {
        return this._offset ? new Date(+this) : this._d
    }, toISOString: function () {
        return formatMoment(moment(this).utc(), "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
    }, toArray: function () {
        var m = this;
        return[m.year(), m.month(), m.date(), m.hours(), m.minutes(), m.seconds(), m.milliseconds()]
    }, isValid: function () {
        return null == this._isValid && (this._isValid = this._a ? !compareArrays(this._a, (this._isUTC ? moment.utc(this._a) : moment(this._a)).toArray()) : !isNaN(this._d.getTime())), !!this._isValid
    }, invalidAt: function () {
        var i, arr1 = this._a, arr2 = (this._isUTC ? moment.utc(this._a) : moment(this._a)).toArray();
        for (i = 6; i >= 0 && arr1[i] === arr2[i]; --i);
        return i
    }, utc: function () {
        return this.zone(0)
    }, local: function () {
        return this.zone(0), this._isUTC = !1, this
    }, format: function (inputString) {
        var output = formatMoment(this, inputString || moment.defaultFormat);
        return this.lang().postformat(output)
    }, add: function (input, val) {
        var dur;
        return dur = "string" == typeof input ? moment.duration(+val, input) : moment.duration(input, val), addOrSubtractDurationFromMoment(this, dur, 1), this
    }, subtract: function (input, val) {
        var dur;
        return dur = "string" == typeof input ? moment.duration(+val, input) : moment.duration(input, val), addOrSubtractDurationFromMoment(this, dur, -1), this
    }, diff: function (input, units, asFloat) {
        var diff, output, that = this._isUTC ? moment(input).zone(this._offset || 0) : moment(input).local(), zoneDiff = 6e4 * (this.zone() - that.zone());
        return units = normalizeUnits(units), "year" === units || "month" === units ? (diff = 432e5 * (this.daysInMonth() + that.daysInMonth()), output = 12 * (this.year() - that.year()) + (this.month() - that.month()), output += (this - moment(this).startOf("month") - (that - moment(that).startOf("month"))) / diff, output -= 6e4 * (this.zone() - moment(this).startOf("month").zone() - (that.zone() - moment(that).startOf("month").zone())) / diff, "year" === units && (output /= 12)) : (diff = this - that, output = "second" === units ? diff / 1e3 : "minute" === units ? diff / 6e4 : "hour" === units ? diff / 36e5 : "day" === units ? (diff - zoneDiff) / 864e5 : "week" === units ? (diff - zoneDiff) / 6048e5 : diff), asFloat ? output : absRound(output)
    }, from: function (time, withoutSuffix) {
        return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)
    }, fromNow: function (withoutSuffix) {
        return this.from(moment(), withoutSuffix)
    }, calendar: function () {
        var diff = this.diff(moment().zone(this.zone()).startOf("day"), "days", !0), format = -6 > diff ? "sameElse" : -1 > diff ? "lastWeek" : 0 > diff ? "lastDay" : 1 > diff ? "sameDay" : 2 > diff ? "nextDay" : 7 > diff ? "nextWeek" : "sameElse";
        return this.format(this.lang().calendar(format, this))
    }, isLeapYear: function () {
        var year = this.year();
        return 0 === year % 4 && 0 !== year % 100 || 0 === year % 400
    }, isDST: function () {
        return this.zone() < this.clone().month(0).zone() || this.zone() < this.clone().month(5).zone()
    }, day: function (input) {
        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
        return null != input ? "string" == typeof input && (input = this.lang().weekdaysParse(input), "number" != typeof input) ? this : this.add({d: input - day}) : day
    }, month: function (input) {
        var dayOfMonth, utc = this._isUTC ? "UTC" : "";
        return null != input ? "string" == typeof input && (input = this.lang().monthsParse(input), "number" != typeof input) ? this : (dayOfMonth = this.date(), this.date(1), this._d["set" + utc + "Month"](input), this.date(Math.min(dayOfMonth, this.daysInMonth())), moment.updateOffset(this), this) : this._d["get" + utc + "Month"]()
    }, startOf: function (units) {
        switch (units = normalizeUnits(units)) {
            case"year":
                this.month(0);
            case"month":
                this.date(1);
            case"week":
            case"isoweek":
            case"day":
                this.hours(0);
            case"hour":
                this.minutes(0);
            case"minute":
                this.seconds(0);
            case"second":
                this.milliseconds(0)
        }
        return"week" === units ? this.weekday(0) : "isoweek" === units && this.isoWeekday(1), this
    }, endOf: function (units) {
        return units = normalizeUnits(units), this.startOf(units).add("isoweek" === units ? "week" : units, 1).subtract("ms", 1)
    }, isAfter: function (input, units) {
        return units = "undefined" != typeof units ? units : "millisecond", +this.clone().startOf(units) > +moment(input).startOf(units)
    }, isBefore: function (input, units) {
        return units = "undefined" != typeof units ? units : "millisecond", +this.clone().startOf(units) < +moment(input).startOf(units)
    }, isSame: function (input, units) {
        return units = "undefined" != typeof units ? units : "millisecond", +this.clone().startOf(units) === +moment(input).startOf(units)
    }, min: function (other) {
        return other = moment.apply(null, arguments), this > other ? this : other
    }, max: function (other) {
        return other = moment.apply(null, arguments), other > this ? this : other
    }, zone: function (input) {
        var offset = this._offset || 0;
        return null == input ? this._isUTC ? offset : this._d.getTimezoneOffset() : ("string" == typeof input && (input = timezoneMinutesFromString(input)), Math.abs(input) < 16 && (input = 60 * input), this._offset = input, this._isUTC = !0, offset !== input && addOrSubtractDurationFromMoment(this, moment.duration(offset - input, "m"), 1, !0), this)
    }, zoneAbbr: function () {
        return this._isUTC ? "UTC" : ""
    }, zoneName: function () {
        return this._isUTC ? "Coordinated Universal Time" : ""
    }, hasAlignedHourOffset: function (input) {
        return input = input ? moment(input).zone() : 0, 0 === (this.zone() - input) % 60
    }, daysInMonth: function () {
        return moment.utc([this.year(), this.month() + 1, 0]).date()
    }, dayOfYear: function (input) {
        var dayOfYear = round((moment(this).startOf("day") - moment(this).startOf("year")) / 864e5) + 1;
        return null == input ? dayOfYear : this.add("d", input - dayOfYear)
    }, weekYear: function (input) {
        var year = weekOfYear(this, this.lang()._week.dow, this.lang()._week.doy).year;
        return null == input ? year : this.add("y", input - year)
    }, isoWeekYear: function (input) {
        var year = weekOfYear(this, 1, 4).year;
        return null == input ? year : this.add("y", input - year)
    }, week: function (input) {
        var week = this.lang().week(this);
        return null == input ? week : this.add("d", 7 * (input - week))
    }, isoWeek: function (input) {
        var week = weekOfYear(this, 1, 4).week;
        return null == input ? week : this.add("d", 7 * (input - week))
    }, weekday: function (input) {
        var weekday = (this._d.getDay() + 7 - this.lang()._week.dow) % 7;
        return null == input ? weekday : this.add("d", input - weekday)
    }, isoWeekday: function (input) {
        return null == input ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7)
    }, get: function (units) {
        return units = normalizeUnits(units), this[units.toLowerCase()]()
    }, set: function (units, value) {
        units = normalizeUnits(units), this[units.toLowerCase()](value)
    }, lang: function (key) {
        return key === undefined ? this._lang : (this._lang = getLangDefinition(key), this)
    }}), i = 0; i < proxyGettersAndSetters.length; i++)makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase().replace(/s$/, ""), proxyGettersAndSetters[i]);
    makeGetterAndSetter("year", "FullYear"), moment.fn.days = moment.fn.day, moment.fn.months = moment.fn.month, moment.fn.weeks = moment.fn.week, moment.fn.isoWeeks = moment.fn.isoWeek, moment.fn.toJSON = moment.fn.toISOString, extend(moment.duration.fn = Duration.prototype, {_bubble: function () {
        var seconds, minutes, hours, years, milliseconds = this._milliseconds, days = this._days, months = this._months, data = this._data;
        data.milliseconds = milliseconds % 1e3, seconds = absRound(milliseconds / 1e3), data.seconds = seconds % 60, minutes = absRound(seconds / 60), data.minutes = minutes % 60, hours = absRound(minutes / 60), data.hours = hours % 24, days += absRound(hours / 24), data.days = days % 30, months += absRound(days / 30), data.months = months % 12, years = absRound(months / 12), data.years = years
    }, weeks: function () {
        return absRound(this.days() / 7)
    }, valueOf: function () {
        return this._milliseconds + 864e5 * this._days + 2592e6 * (this._months % 12) + 31536e6 * ~~(this._months / 12)
    }, humanize: function (withSuffix) {
        var difference = +this, output = relativeTime(difference, !withSuffix, this.lang());
        return withSuffix && (output = this.lang().pastFuture(difference, output)), this.lang().postformat(output)
    }, add: function (input, val) {
        var dur = moment.duration(input, val);
        return this._milliseconds += dur._milliseconds, this._days += dur._days, this._months += dur._months, this._bubble(), this
    }, subtract: function (input, val) {
        var dur = moment.duration(input, val);
        return this._milliseconds -= dur._milliseconds, this._days -= dur._days, this._months -= dur._months, this._bubble(), this
    }, get: function (units) {
        return units = normalizeUnits(units), this[units.toLowerCase() + "s"]()
    }, as: function (units) {
        return units = normalizeUnits(units), this["as" + units.charAt(0).toUpperCase() + units.slice(1) + "s"]()
    }, lang: moment.fn.lang});
    for (i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i) && (makeDurationAsGetter(i, unitMillisecondFactors[i]), makeDurationGetter(i.toLowerCase()));
    makeDurationAsGetter("Weeks", 6048e5), moment.duration.fn.asMonths = function () {
        return(+this - 31536e6 * this.years()) / 2592e6 + 12 * this.years()
    }, moment.lang("en", {ordinal: function (number) {
        var b = number % 10, output = 1 === ~~(number % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th";
        return number + output
    }}), hasModule && (module.exports = moment), "undefined" == typeof ender && (this.moment = moment), "function" == typeof define && define.amd && define("moment", [], function () {
        return moment
    })
}.call(this), function () {
    var module = angular.module("restangular", []);
    module.provider("Restangular", function () {
        var Configurer = {};
        Configurer.init = function (object, config) {
            function RestangularResource(config, $http, url, configurer) {
                var resource = {};
                return _.each(_.keys(configurer), function (key) {
                    var value = configurer[key];
                    value.params = _.extend({}, value.params, config.defaultRequestParams[value.method.toLowerCase()]), _.isEmpty(value.params) && delete value.params, resource[key] = config.isSafe(value.method) ? function () {
                        return $http(_.extend(value, {url: url}))
                    } : function (data) {
                        return $http(_.extend(value, {url: url, data: data}))
                    }
                }), resource
            }

            var safeMethods = ["get", "head", "options", "trace"];
            config.isSafe = function (operation) {
                return _.contains(safeMethods, operation.toLowerCase())
            };
            var absolutePattern = /^https?:\/\//i;
            config.isAbsoluteUrl = function (string) {
                return string && absolutePattern.test(string)
            }, config.baseUrl = _.isUndefined(config.baseUrl) ? "" : config.baseUrl, object.setBaseUrl = function (newBaseUrl) {
                config.baseUrl = "/" === _.last(newBaseUrl) ? _.initial(newBaseUrl).join("") : newBaseUrl
            }, config.extraFields = config.extraFields || [], object.setExtraFields = function (newExtraFields) {
                config.extraFields = newExtraFields
            }, config.defaultHttpFields = config.defaultHttpFields || {}, object.setDefaultHttpFields = function (values) {
                config.defaultHttpFields = values
            }, config.withHttpDefaults = function (obj) {
                return _.defaults(obj, config.defaultHttpFields)
            }, config.defaultRequestParams = config.defaultRequestParams || {get: {}, post: {}, put: {}, remove: {}, common: {}}, object.setDefaultRequestParams = function (values) {
                config.defaultRequestParams.common = values
            }, object.requestParams = config.defaultRequestParams, config.defaultHeaders = config.defaultHeaders || {}, object.setDefaultHeaders = function (headers) {
                config.defaultHeaders = headers, object.defaultHeaders = config.defaultHeaders
            }, object.defaultHeaders = config.defaultHeaders, config.methodOverriders = config.methodOverriders || [], object.setMethodOverriders = function (values) {
                var overriders = _.extend([], values);
                config.isOverridenMethod("delete", overriders) && overriders.push("remove"), config.methodOverriders = overriders
            }, config.isOverridenMethod = function (method, values) {
                var search = values || config.methodOverriders;
                return!_.isUndefined(_.find(search, function (one) {
                    return one.toLowerCase() === method.toLowerCase()
                }))
            }, config.urlCreator = config.urlCreator || "path", object.setUrlCreator = function (name) {
                if (!_.has(config.urlCreatorFactory, name))throw new Error("URL Path selected isn't valid");
                config.urlCreator = name
            }, config.restangularFields = config.restangularFields || {id: "id", route: "route", parentResource: "parentResource", restangularCollection: "restangularCollection", cannonicalId: "__cannonicalId", etag: "restangularEtag", selfLink: "href"}, object.setRestangularFields = function (resFields) {
                config.restangularFields = _.extend(config.restangularFields, resFields)
            }, config.setFieldToElem = function (field, elem, value) {
                var properties = field.split("."), idValue = elem;
                _.each(_.initial(properties), function (prop) {
                    idValue[prop] = {}, idValue = idValue[prop]
                }), idValue[_.last(properties)] = value
            }, config.getFieldFromElem = function (field, elem) {
                var properties = field.split("."), idValue = angular.copy(elem);
                return _.each(properties, function (prop) {
                    idValue = idValue[prop]
                }), idValue
            }, config.setIdToElem = function (elem, id) {
                config.setFieldToElem(config.restangularFields.id, elem, id)
            }, config.getIdFromElem = function (elem) {
                return config.getFieldFromElem(config.restangularFields.id, elem)
            }, config.isValidId = function (elemId) {
                return"" !== elemId && !_.isUndefined(elemId) && !_.isNull(elemId)
            }, config.setUrlToElem = function (elem, url) {
                config.setFieldToElem(config.restangularFields.selfLink, elem, url)
            }, config.getUrlFromElem = function (elem) {
                return config.getFieldFromElem(config.restangularFields.selfLink, elem)
            }, config.useCannonicalId = _.isUndefined(config.useCannonicalId) ? !1 : config.useCannonicalId, object.setUseCannonicalId = function (value) {
                config.useCannonicalId = value
            }, config.getCannonicalIdFromElem = function (elem) {
                var cannonicalId = elem[config.restangularFields.cannonicalId], actualId = config.isValidId(cannonicalId) ? cannonicalId : config.getIdFromElem(elem);
                return actualId
            }, config.responseExtractor = config.responseExtractor || function (data) {
                return data
            }, object.setResponseExtractor = function (extractor) {
                config.responseExtractor = extractor
            }, object.setResponseInterceptor = object.setResponseExtractor, config.fullRequestInterceptor = config.fullRequestInterceptor || function (element, operation, path, url, headers, params) {
                return{element: element, headers: headers, params: params}
            }, object.setRequestInterceptor = function (interceptor) {
                config.fullRequestInterceptor = function (elem, operation, path, url, headers, params) {
                    return{headers: headers, params: params, element: interceptor(elem, operation, path, url)}
                }
            }, object.setFullRequestInterceptor = function (interceptor) {
                config.fullRequestInterceptor = interceptor
            }, config.errorInterceptor = config.errorInterceptor || function () {
            }, object.setErrorInterceptor = function (interceptor) {
                config.errorInterceptor = interceptor
            }, config.onBeforeElemRestangularized = config.onBeforeElemRestangularized || function (elem) {
                return elem
            }, object.setOnBeforeElemRestangularized = function (post) {
                config.onBeforeElemRestangularized = post
            }, config.onElemRestangularized = config.onElemRestangularized || function (elem) {
                return elem
            }, object.setOnElemRestangularized = function (post) {
                config.onElemRestangularized = post
            }, object.setListTypeIsArray = function () {
            }, config.shouldSaveParent = config.shouldSaveParent || function () {
                return!0
            }, object.setParentless = function (values) {
                _.isArray(values) ? config.shouldSaveParent = function (route) {
                    return!_.contains(values, route)
                } : _.isBoolean(values) && (config.shouldSaveParent = function () {
                    return!values
                })
            }, config.suffix = _.isUndefined(config.suffix) ? null : config.suffix, object.setRequestSuffix = function (newSuffix) {
                config.suffix = newSuffix
            }, config.transformers = config.transformers || {}, object.addElementTransformer = function (type, secondArg, thirdArg) {
                var isCollection = null, transformer = null;
                2 === arguments.length ? transformer = secondArg : (transformer = thirdArg, isCollection = secondArg);
                var typeTransformers = config.transformers[type];
                typeTransformers || (typeTransformers = config.transformers[type] = []), typeTransformers.push(function (coll, elem) {
                    return _.isNull(isCollection) || coll == isCollection ? transformer(elem) : elem
                })
            }, object.extendCollection = function (route, fn) {
                return object.addElementTransformer(route, !0, fn)
            }, object.extendModel = function (route, fn) {
                return object.addElementTransformer(route, !1, fn)
            }, config.transformElem = function (elem, isCollection, route, Restangular) {
                var typeTransformers = config.transformers[route], changedElem = elem;
                return typeTransformers && _.each(typeTransformers, function (transformer) {
                    changedElem = transformer(isCollection, changedElem)
                }), config.onElemRestangularized(changedElem, isCollection, route, Restangular)
            }, config.fullResponse = _.isUndefined(config.fullResponse) ? !1 : config.fullResponse, object.setFullResponse = function (full) {
                config.fullResponse = full
            }, config.urlCreatorFactory = {};
            var BaseCreator = function () {
            };
            BaseCreator.prototype.setConfig = function (config) {
                this.config = config
            }, BaseCreator.prototype.parentsArray = function (current) {
                for (var parents = []; current;)parents.push(current), current = current[this.config.restangularFields.parentResource];
                return parents.reverse()
            }, BaseCreator.prototype.resource = function (current, $http, callHeaders, callParams, what, etag) {
                var params = _.defaults(callParams || {}, this.config.defaultRequestParams.common), headers = _.defaults(callHeaders || {}, this.config.defaultHeaders);
                etag && (headers["If-None-Match"] = etag);
                var url = this.base(current);
                return url += what ? "/" + what : "", url += this.config.suffix || "", RestangularResource(this.config, $http, url, {getList: this.config.withHttpDefaults({method: "GET", params: params, headers: headers}), get: this.config.withHttpDefaults({method: "GET", params: params, headers: headers}), put: this.config.withHttpDefaults({method: "PUT", params: params, headers: headers}), post: this.config.withHttpDefaults({method: "POST", params: params, headers: headers}), remove: this.config.withHttpDefaults({method: "DELETE", params: params, headers: headers}), head: this.config.withHttpDefaults({method: "HEAD", params: params, headers: headers}), trace: this.config.withHttpDefaults({method: "TRACE", params: params, headers: headers}), options: this.config.withHttpDefaults({method: "OPTIONS", params: params, headers: headers}), patch: this.config.withHttpDefaults({method: "PATCH", params: params, headers: headers})})
            };
            var Path = function () {
            };
            Path.prototype = new BaseCreator, Path.prototype.base = function (current) {
                var __this = this;
                return _.reduce(this.parentsArray(current), function (acum, elem) {
                    var elemUrl, elemSelfLink = __this.config.getUrlFromElem(elem);
                    if (elemSelfLink) {
                        if (__this.config.isAbsoluteUrl(elemSelfLink))return elemSelfLink;
                        elemUrl = elemSelfLink
                    } else if (elemUrl = elem[__this.config.restangularFields.route], !elem[__this.config.restangularFields.restangularCollection]) {
                        var elemId;
                        elemId = __this.config.useCannonicalId ? __this.config.getCannonicalIdFromElem(elem) : __this.config.getIdFromElem(elem), config.isValidId(elemId) && (elemUrl += "/" + elemId)
                    }
                    return acum + "/" + elemUrl
                }, this.config.baseUrl)
            }, Path.prototype.fetchUrl = function (current, what) {
                var baseUrl = this.base(current);
                return what && (baseUrl += "/" + what), baseUrl
            }, config.urlCreatorFactory.path = Path
        };
        var globalConfiguration = {};
        Configurer.init(this, globalConfiguration), this.$get = ["$http", "$q", function ($http, $q) {
            function createServiceForConfiguration(config) {
                function restangularizeBase(parent, elem, route) {
                    if (elem[config.restangularFields.route] = route, elem.getRestangularUrl = _.bind(urlHandler.fetchUrl, urlHandler, elem), elem.addRestangularMethod = _.bind(addRestangularMethodFunction, elem), elem.one = _.bind(one, elem, elem), elem.all = _.bind(all, elem, elem), elem.oneUrl = _.bind(oneUrl, elem, elem), elem.allUrl = _.bind(allUrl, elem, elem), parent && config.shouldSaveParent(route)) {
                        var parentId = config.getIdFromElem(parent), parentUrl = config.getUrlFromElem(parent), restangularFieldsForParent = _.union(_.values(_.pick(config.restangularFields, ["route", "parentResource"])), config.extraFields), parentResource = _.pick(parent, restangularFieldsForParent);
                        config.isValidId(parentId) && config.setIdToElem(parentResource, parentId), config.isValidId(parentUrl) && config.setUrlToElem(parentResource, parentUrl), elem[config.restangularFields.parentResource] = parentResource
                    } else elem[config.restangularFields.parentResource] = null;
                    return elem
                }

                function one(parent, route, id) {
                    var elem = {};
                    return config.setIdToElem(elem, id), restangularizeElem(parent, elem, route)
                }

                function all(parent, route) {
                    return restangularizeCollection(parent, {}, route, !0)
                }

                function oneUrl(parent, route, url) {
                    var elem = {};
                    return config.setUrlToElem(elem, url), restangularizeElem(parent, elem, route)
                }

                function allUrl(parent, route, url) {
                    var elem = {};
                    return config.setUrlToElem(elem, url), restangularizeCollection(parent, elem, route, !0)
                }

                function restangularizePromise(promise, isCollection) {
                    return promise.call = _.bind(promiseCall, promise), promise.get = _.bind(promiseGet, promise), promise[config.restangularFields.restangularCollection] = isCollection, isCollection && (promise.push = _.bind(promiseCall, promise, "push")), promise
                }

                function promiseCall(method) {
                    var deferred = $q.defer(), callArgs = arguments;
                    return this.then(function (val) {
                        var params = Array.prototype.slice.call(callArgs, 1), func = val[method];
                        func.apply(val, params), deferred.resolve(val)
                    }), restangularizePromise(deferred.promise, this[config.restangularFields.restangularCollection])
                }

                function promiseGet(what) {
                    var deferred = $q.defer();
                    return this.then(function (val) {
                        deferred.resolve(val[what])
                    }), restangularizePromise(deferred.promise, this[config.restangularFields.restangularCollection])
                }

                function resolvePromise(deferred, response, data) {
                    return config.fullResponse ? deferred.resolve(_.extend(response, {data: data})) : (deferred.resolve(data), void 0)
                }

                function stripRestangular(elem) {
                    return _.omit(elem, _.values(_.omit(config.restangularFields, "id")))
                }

                function addCustomOperation(elem) {
                    elem.customOperation = _.bind(customFunction, elem), _.each(["put", "post", "get", "delete"], function (oper) {
                        _.each(["do", "custom"], function (alias) {
                            var callFunction, callOperation = "delete" === oper ? "remove" : oper, name = alias + oper.toUpperCase();
                            callFunction = "put" !== callOperation && "post" !== callOperation ? customFunction : function (operation, elem, path, params, headers) {
                                return _.bind(customFunction, this)(operation, path, params, headers, elem)
                            }, elem[name] = _.bind(callFunction, elem, callOperation)
                        })
                    }), elem.customGETLIST = _.bind(fetchFunction, elem), elem.doGETLIST = elem.customGETLIST
                }

                function copyRestangularizedElement(fromElement) {
                    var copiedElement = angular.copy(fromElement);
                    return restangularizeElem(copiedElement[config.restangularFields.parentResource], copiedElement, copiedElement[config.restangularFields.route])
                }

                function restangularizeElem(parent, element, route) {
                    var elem = config.onBeforeElemRestangularized(element, !1, route), localElem = restangularizeBase(parent, elem, route);
                    return config.useCannonicalId && (localElem[config.restangularFields.cannonicalId] = config.getIdFromElem(localElem)), localElem[config.restangularFields.restangularCollection] = !1, localElem.get = _.bind(getFunction, localElem), localElem.getList = _.bind(fetchFunction, localElem), localElem.put = _.bind(putFunction, localElem), localElem.post = _.bind(postFunction, localElem), localElem.remove = _.bind(deleteFunction, localElem), localElem.head = _.bind(headFunction, localElem), localElem.trace = _.bind(traceFunction, localElem), localElem.options = _.bind(optionsFunction, localElem), localElem.patch = _.bind(patchFunction, localElem), addCustomOperation(localElem), config.transformElem(localElem, !1, route, service)
                }

                function restangularizeCollection(parent, element, route) {
                    var elem = config.onBeforeElemRestangularized(element, !0, route), localElem = restangularizeBase(parent, elem, route);
                    return localElem[config.restangularFields.restangularCollection] = !0, localElem.post = _.bind(postFunction, localElem, null), localElem.head = _.bind(headFunction, localElem), localElem.trace = _.bind(traceFunction, localElem), localElem.putElement = _.bind(putElementFunction, localElem), localElem.options = _.bind(optionsFunction, localElem), localElem.patch = _.bind(patchFunction, localElem), localElem.getList = _.bind(fetchFunction, localElem, null), addCustomOperation(localElem), config.transformElem(localElem, !0, route, service)
                }

                function putElementFunction(idx, params, headers) {
                    var __this = this, elemToPut = this[idx], deferred = $q.defer();
                    return elemToPut.put(params, headers).then(function (serverElem) {
                        var newArray = copyRestangularizedElement(__this);
                        newArray[idx] = serverElem, deferred.resolve(newArray)
                    }, function (response) {
                        deferred.reject(response)
                    }), restangularizePromise(deferred.promise, !0)
                }

                function parseResponse(resData, operation, route, fetchUrl, response, deferred) {
                    var data = config.responseExtractor(resData, operation, route, fetchUrl, response, deferred), etag = response.headers("ETag");
                    return data && etag && (data[config.restangularFields.etag] = etag), data
                }

                function fetchFunction(what, reqParams, headers) {
                    var __this = this, deferred = $q.defer(), operation = "getList", url = urlHandler.fetchUrl(this, what), whatFetched = what || __this[config.restangularFields.route], request = config.fullRequestInterceptor(null, operation, whatFetched, url, headers || {}, reqParams || {});
                    return urlHandler.resource(this, $http, request.headers, request.params, what, this[config.restangularFields.etag]).getList().then(function (response) {
                        var resData = response.data, data = parseResponse(resData, operation, whatFetched, url, response, deferred), processedData = _.map(data, function (elem) {
                            return __this[config.restangularFields.restangularCollection] ? restangularizeElem(__this[config.restangularFields.parentResource], elem, __this[config.restangularFields.route]) : restangularizeElem(__this, elem, what)
                        });
                        processedData = _.extend(data, processedData), __this[config.restangularFields.restangularCollection] ? resolvePromise(deferred, response, restangularizeCollection(null, processedData, __this[config.restangularFields.route])) : resolvePromise(deferred, response, restangularizeCollection(__this, processedData, what))
                    }, function (response) {
                        config.errorInterceptor(response) !== !1 && deferred.reject(response)
                    }), restangularizePromise(deferred.promise, !0)
                }

                function elemFunction(operation, what, params, obj, headers) {
                    var __this = this, etag = this[config.restangularFields.etag], deferred = $q.defer(), resParams = params || {}, route = what || this[config.restangularFields.route], fetchUrl = urlHandler.fetchUrl(this, what), callObj = obj || ("remove" === operation ? void 0 : stripRestangular(this)), request = config.fullRequestInterceptor(callObj, operation, route, fetchUrl, headers || {}, resParams || {}), okCallback = function (response) {
                        var resData = response.data, elem = parseResponse(resData, operation, route, fetchUrl, response, deferred);
                        elem ? "post" !== operation || __this[config.restangularFields.restangularCollection] ? resolvePromise(deferred, response, restangularizeElem(__this[config.restangularFields.parentResource], elem, __this[config.restangularFields.route])) : resolvePromise(deferred, response, restangularizeElem(__this, elem, what)) : resolvePromise(deferred, response, void 0)
                    }, errorCallback = function (response) {
                        config.errorInterceptor(response) !== !1 && deferred.reject(response)
                    }, callOperation = operation, callHeaders = _.extend({}, request.headers), isOverrideOperation = config.isOverridenMethod(operation);
                    return isOverrideOperation && (callOperation = "post", callHeaders = _.extend(callHeaders, {"X-HTTP-Method-Override": "remove" === operation ? "DELETE" : operation})), config.isSafe(operation) ? isOverrideOperation ? urlHandler.resource(this, $http, callHeaders, request.params, what, etag)[callOperation]({}).then(okCallback, errorCallback) : urlHandler.resource(this, $http, callHeaders, request.params, what, etag)[callOperation]().then(okCallback, errorCallback) : urlHandler.resource(this, $http, callHeaders, request.params, what, etag)[callOperation](request.element).then(okCallback, errorCallback), restangularizePromise(deferred.promise)
                }

                function getFunction(params, headers) {
                    return _.bind(elemFunction, this)("get", void 0, params, void 0, headers)
                }

                function deleteFunction(params, headers) {
                    return _.bind(elemFunction, this)("remove", void 0, params, void 0, headers)
                }

                function putFunction(params, headers) {
                    return _.bind(elemFunction, this)("put", void 0, params, void 0, headers)
                }

                function postFunction(what, elem, params, headers) {
                    return _.bind(elemFunction, this)("post", what, params, elem, headers)
                }

                function headFunction(params, headers) {
                    return _.bind(elemFunction, this)("head", void 0, params, void 0, headers)
                }

                function traceFunction(params, headers) {
                    return _.bind(elemFunction, this)("trace", void 0, params, void 0, headers)
                }

                function optionsFunction(params, headers) {
                    return _.bind(elemFunction, this)("options", void 0, params, void 0, headers)
                }

                function patchFunction(elem, params, headers) {
                    return _.bind(elemFunction, this)("patch", void 0, params, elem, headers)
                }

                function customFunction(operation, path, params, headers, elem) {
                    return _.bind(elemFunction, this)(operation, path, params, elem, headers)
                }

                function addRestangularMethodFunction(name, operation, path, defaultParams, defaultHeaders, defaultElem) {
                    var bindedFunction;
                    bindedFunction = "getList" === operation ? _.bind(fetchFunction, this, path) : _.bind(customFunction, this, operation, path);
                    var createdFunction = function (params, headers, elem) {
                        var callParams = _.defaults({params: params, headers: headers, elem: elem}, {params: defaultParams, headers: defaultHeaders, elem: defaultElem});
                        return bindedFunction(callParams.params, callParams.headers, callParams.elem)
                    };
                    this[name] = config.isSafe(operation) ? createdFunction : function (elem, params, headers) {
                        return createdFunction(params, headers, elem)
                    }
                }

                function withConfigurationFunction(configurer) {
                    var newConfig = angular.copy(globalConfiguration);
                    return Configurer.init(newConfig, newConfig), configurer(newConfig), createServiceForConfiguration(newConfig)
                }

                var service = {}, urlHandler = new config.urlCreatorFactory[config.urlCreator];
                return urlHandler.setConfig(config), Configurer.init(service, config), service.copy = _.bind(copyRestangularizedElement, service), service.withConfig = _.bind(withConfigurationFunction, service), service.one = _.bind(one, service, null), service.all = _.bind(all, service, null), service.oneUrl = _.bind(oneUrl, service, null), service.allUrl = _.bind(allUrl, service, null), service.restangularizeElement = _.bind(restangularizeElem, service), service.restangularizeCollection = _.bind(restangularizeCollection, service), service
            }

            return createServiceForConfiguration(globalConfiguration)
        }]
    })
}(), function (angular) {
    "use strict";
    var angulartics = window.angulartics || (window.angulartics = {});
    angulartics.waitForVendorApi = function (objectName, delay, registerFn) {
        window.hasOwnProperty(objectName) ? registerFn(window[objectName]) : setTimeout(function () {
            angulartics.waitForVendorApi(objectName, delay, registerFn)
        }, delay)
    }, angular.module("angulartics", []).provider("$analytics",function () {
        var settings = {pageTracking: {autoTrackFirstPage: !0, autoTrackVirtualPages: !0, bufferFlushDelay: 1e3}, eventTracking: {bufferFlushDelay: 1e3}}, cache = {pageviews: [], events: []}, bufferedPageTrack = function (path) {
            cache.pageviews.push(path)
        }, bufferedEventTrack = function (event, properties) {
            cache.events.push({name: event, properties: properties})
        }, api = {settings: settings, pageTrack: bufferedPageTrack, eventTrack: bufferedEventTrack}, registerPageTrack = function (fn) {
            api.pageTrack = fn, angular.forEach(cache.pageviews, function (path, index) {
                setTimeout(function () {
                    api.pageTrack(path)
                }, index * settings.pageTracking.bufferFlushDelay)
            })
        }, registerEventTrack = function (fn) {
            api.eventTrack = fn, angular.forEach(cache.events, function (event, index) {
                setTimeout(function () {
                    api.eventTrack(event.name, event.properties)
                }, index * settings.eventTracking.bufferFlushDelay)
            })
        };
        return{$get: function () {
            return api
        }, settings: settings, virtualPageviews: function (value) {
            this.settings.pageTracking.autoTrackVirtualPages = value
        }, firstPageview: function (value) {
            this.settings.pageTracking.autoTrackFirstPage = value
        }, registerPageTrack: registerPageTrack, registerEventTrack: registerEventTrack}
    }).run(["$rootScope", "$location", "$analytics", function ($rootScope, $location, $analytics) {
        $analytics.settings.pageTracking.autoTrackFirstPage && $analytics.pageTrack($location.absUrl()), $analytics.settings.pageTracking.autoTrackVirtualPages && $rootScope.$on("$routeChangeSuccess", function (event, current) {
            current && (current.$$route || current).redirectTo || $analytics.pageTrack($location.url())
        })
    }]).directive("analyticsOn", ["$analytics", function ($analytics) {
        function isCommand(element) {
            return["a:", "button:", "button:button", "button:submit", "input:button", "input:submit"].indexOf(element.tagName.toLowerCase() + ":" + (element.type || "")) >= 0
        }

        function inferEventType(element) {
            return isCommand(element) ? "click" : "click"
        }

        function inferEventName(element) {
            return isCommand(element) ? element.innerText || element.value : element.id || element.name || element.tagName
        }

        function isProperty(name) {
            return"analytics" === name.substr(0, 9) && -1 === ["on", "event"].indexOf(name.substr(10))
        }

        return{restrict: "A", scope: !1, link: function ($scope, $element, $attrs) {
            var eventType = $attrs.analyticsOn || inferEventType($element[0]), eventName = $attrs.analyticsEvent || inferEventName($element[0]), properties = {};
            angular.forEach($attrs.$attr, function (attr, name) {
                isProperty(attr) && (properties[name.slice(9).toLowerCase()] = $attrs[name])
            }), angular.element($element[0]).bind(eventType, function () {
                $analytics.eventTrack(eventName, properties)
            })
        }}
    }])
}(angular), function (angular) {
    "use strict";
    angular.module("angulartics.google.analytics", ["angulartics"]).config(["$analyticsProvider", function ($analyticsProvider) {
        $analyticsProvider.registerPageTrack(function (path) {
            window._gaq && _gaq.push(["_trackPageview", path]), window.ga && ga("send", "pageview", path)
        }), $analyticsProvider.registerEventTrack(function (action, properties) {
            window._gaq && _gaq.push(["_trackEvent", properties.category, action, properties.label, properties.value]), window.ga && ga("send", "event", properties.category, action, properties.label, properties.value)
        })
    }])
}(angular), ClusterIcon.prototype.onAdd = function () {
    var cMouseDownInCluster, cDraggingMapByCluster, cClusterIcon = this;
    this.div_ = document.createElement("div"), this.div_.className = this.className_, this.visible_ && this.show(), this.getPanes().overlayMouseTarget.appendChild(this.div_), this.boundsChangedListener_ = google.maps.event.addListener(this.getMap(), "bounds_changed", function () {
        cDraggingMapByCluster = cMouseDownInCluster
    }), google.maps.event.addDomListener(this.div_, "mousedown", function () {
        cMouseDownInCluster = !0, cDraggingMapByCluster = !1
    }), google.maps.event.addDomListener(this.div_, "click", function (e) {
        if (cMouseDownInCluster = !1, !cDraggingMapByCluster) {
            var theBounds, mz, mc = cClusterIcon.cluster_.getMarkerClusterer();
            google.maps.event.trigger(mc, "click", cClusterIcon.cluster_), google.maps.event.trigger(mc, "clusterclick", cClusterIcon.cluster_), mc.getZoomOnClick() && (mz = mc.getMaxZoom(), theBounds = cClusterIcon.cluster_.getBounds(), mc.getMap().fitBounds(theBounds), setTimeout(function () {
                mc.getMap().fitBounds(theBounds), null !== mz && mc.getMap().getZoom() > mz && mc.getMap().setZoom(mz + 1)
            }, 100)), e.cancelBubble = !0, e.stopPropagation && e.stopPropagation()
        }
    }), google.maps.event.addDomListener(this.div_, "mouseover", function () {
        var mc = cClusterIcon.cluster_.getMarkerClusterer();
        google.maps.event.trigger(mc, "mouseover", cClusterIcon.cluster_)
    }), google.maps.event.addDomListener(this.div_, "mouseout", function () {
        var mc = cClusterIcon.cluster_.getMarkerClusterer();
        google.maps.event.trigger(mc, "mouseout", cClusterIcon.cluster_)
    }), google.maps.event.addDomListener(this.div_, "mousemove", function (evnt) {
        var mc = cClusterIcon.cluster_.getMarkerClusterer();
        google.maps.event.trigger(mc, "mousemove", cClusterIcon.cluster_, evnt)
    })
}, ClusterIcon.prototype.onRemove = function () {
    this.div_ && this.div_.parentNode && (this.hide(), google.maps.event.removeListener(this.boundsChangedListener_), google.maps.event.clearInstanceListeners(this.div_), this.div_.parentNode.removeChild(this.div_), this.div_ = null)
}, ClusterIcon.prototype.draw = function () {
    if (this.visible_) {
        var pos = this.getPosFromLatLng_(this.center_);
        this.div_.style.top = pos.y + "px", this.div_.style.left = pos.x + "px"
    }
}, ClusterIcon.prototype.hide = function () {
    this.div_ && (this.div_.style.display = "none"), this.visible_ = !1
}, ClusterIcon.prototype.show = function () {
    if (this.div_) {
        var pos = this.getPosFromLatLng_(this.center_);
        this.div_.style.cssText = this.createCss(pos), this.div_.innerHTML = this.cluster_.printable_ ? "<img src='" + this.url_ + "'><div style='position: absolute; top: 0px; left: 0px; width: " + this.width_ + "px;'>" + this.sums_.text + "</div>" : this.sums_.text, this.div_.title = "undefined" == typeof this.sums_.title || "" === this.sums_.title ? this.cluster_.getMarkerClusterer().getTitle() : this.sums_.title, this.div_.style.display = ""
    }
    this.visible_ = !0
}, ClusterIcon.prototype.useStyle = function (sums) {
    this.sums_ = sums;
    var index = Math.max(0, sums.index - 1);
    index = Math.min(this.styles_.length - 1, index);
    var style = this.styles_[index];
    this.url_ = style.url, this.height_ = style.height, this.width_ = style.width, this.anchor_ = style.anchor, this.anchorIcon_ = style.anchorIcon || [parseInt(this.height_ / 2, 10), parseInt(this.width_ / 2, 10)], this.textColor_ = style.textColor || "black", this.textSize_ = style.textSize || 11, this.textDecoration_ = style.textDecoration || "none", this.fontWeight_ = style.fontWeight || "bold", this.fontStyle_ = style.fontStyle || "normal", this.fontFamily_ = style.fontFamily || "Arial,sans-serif", this.backgroundPosition_ = style.backgroundPosition || "0 0"
}, ClusterIcon.prototype.setCenter = function (center) {
    this.center_ = center
}, ClusterIcon.prototype.createCss = function (pos) {
    var style = [];
    return this.cluster_.printable_ || (style.push("background-image:url(" + this.url_ + ");"), style.push("background-position:" + this.backgroundPosition_ + ";")), "object" == typeof this.anchor_ ? ("number" == typeof this.anchor_[0] && this.anchor_[0] > 0 && this.anchor_[0] < this.height_ ? style.push("height:" + (this.height_ - this.anchor_[0]) + "px; padding-top:" + this.anchor_[0] + "px;") : style.push("height:" + this.height_ + "px; line-height:" + this.height_ + "px;"), "number" == typeof this.anchor_[1] && this.anchor_[1] > 0 && this.anchor_[1] < this.width_ ? style.push("width:" + (this.width_ - this.anchor_[1]) + "px; padding-left:" + this.anchor_[1] + "px;") : style.push("width:" + this.width_ + "px; text-align:center;")) : style.push("height:" + this.height_ + "px; line-height:" + this.height_ + "px; width:" + this.width_ + "px; text-align:center;"), style.push("cursor:pointer; top:" + pos.y + "px; left:" + pos.x + "px; color:" + this.textColor_ + "; position:absolute; font-size:" + this.textSize_ + "px; font-family:" + this.fontFamily_ + "; font-weight:" + this.fontWeight_ + "; font-style:" + this.fontStyle_ + "; text-decoration:" + this.textDecoration_ + ";"), style.join("")
}, ClusterIcon.prototype.getPosFromLatLng_ = function (latlng) {
    var pos = this.getProjection().fromLatLngToDivPixel(latlng);
    return pos.x -= this.anchorIcon_[1], pos.y -= this.anchorIcon_[0], pos
}, Cluster.prototype.getSize = function () {
    return this.markers_.length
}, Cluster.prototype.getMarkers = function () {
    return this.markers_
}, Cluster.prototype.getCenter = function () {
    return this.center_
}, Cluster.prototype.getMap = function () {
    return this.map_
}, Cluster.prototype.getMarkerClusterer = function () {
    return this.markerClusterer_
}, Cluster.prototype.getBounds = function () {
    var i, bounds = new google.maps.LatLngBounds(this.center_, this.center_), markers = this.getMarkers();
    for (i = 0; i < markers.length; i++)bounds.extend(markers[i].getPosition());
    return bounds
}, Cluster.prototype.remove = function () {
    this.clusterIcon_.setMap(null), this.markers_ = [], delete this.markers_
}, Cluster.prototype.addMarker = function (marker) {
    var i, mCount, mz;
    if (this.isMarkerAlreadyAdded_(marker))return!1;
    if (this.center_) {
        if (this.averageCenter_) {
            var l = this.markers_.length + 1, lat = (this.center_.lat() * (l - 1) + marker.getPosition().lat()) / l, lng = (this.center_.lng() * (l - 1) + marker.getPosition().lng()) / l;
            this.center_ = new google.maps.LatLng(lat, lng), this.calculateBounds_()
        }
    } else this.center_ = marker.getPosition(), this.calculateBounds_();
    if (marker.isAdded = !0, this.markers_.push(marker), mCount = this.markers_.length, mz = this.markerClusterer_.getMaxZoom(), null !== mz && this.map_.getZoom() > mz)marker.getMap() !== this.map_ && marker.setMap(this.map_); else if (mCount < this.minClusterSize_)marker.getMap() !== this.map_ && marker.setMap(this.map_); else if (mCount === this.minClusterSize_)for (i = 0; mCount > i; i++)this.markers_[i].setMap(null); else marker.setMap(null);
    return this.updateIcon_(), !0
}, Cluster.prototype.isMarkerInClusterBounds = function (marker) {
    return this.bounds_.contains(marker.getPosition())
}, Cluster.prototype.calculateBounds_ = function () {
    var bounds = new google.maps.LatLngBounds(this.center_, this.center_);
    this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds)
}, Cluster.prototype.updateIcon_ = function () {
    var mCount = this.markers_.length, mz = this.markerClusterer_.getMaxZoom();
    if (null !== mz && this.map_.getZoom() > mz)return this.clusterIcon_.hide(), void 0;
    if (mCount < this.minClusterSize_)return this.clusterIcon_.hide(), void 0;
    var numStyles = this.markerClusterer_.getStyles().length, sums = this.markerClusterer_.getCalculator()(this.markers_, numStyles);
    this.clusterIcon_.setCenter(this.center_), this.clusterIcon_.useStyle(sums), this.clusterIcon_.show()
}, Cluster.prototype.isMarkerAlreadyAdded_ = function (marker) {
    var i;
    if (this.markers_.indexOf)return-1 !== this.markers_.indexOf(marker);
    for (i = 0; i < this.markers_.length; i++)if (marker === this.markers_[i])return!0;
    return!1
}, MarkerClusterer.prototype.onAdd = function () {
    var cMarkerClusterer = this;
    this.activeMap_ = this.getMap(), this.ready_ = !0, this.repaint(), this.listeners_ = [google.maps.event.addListener(this.getMap(), "zoom_changed", function () {
        cMarkerClusterer.resetViewport_(!1), (this.getZoom() === (this.get("minZoom") || 0) || this.getZoom() === this.get("maxZoom")) && google.maps.event.trigger(this, "idle")
    }), google.maps.event.addListener(this.getMap(), "idle", function () {
        cMarkerClusterer.redraw_()
    })]
}, MarkerClusterer.prototype.onRemove = function () {
    var i;
    for (i = 0; i < this.markers_.length; i++)this.markers_[i].getMap() !== this.activeMap_ && this.markers_[i].setMap(this.activeMap_);
    for (i = 0; i < this.clusters_.length; i++)this.clusters_[i].remove();
    for (this.clusters_ = [], i = 0; i < this.listeners_.length; i++)google.maps.event.removeListener(this.listeners_[i]);
    this.listeners_ = [], this.activeMap_ = null, this.ready_ = !1
}, MarkerClusterer.prototype.draw = function () {
}, MarkerClusterer.prototype.setupStyles_ = function () {
    var i, size;
    if (!(this.styles_.length > 0))for (i = 0; i < this.imageSizes_.length; i++)size = this.imageSizes_[i], this.styles_.push({url: this.imagePath_ + (i + 1) + "." + this.imageExtension_, height: size, width: size})
}, MarkerClusterer.prototype.fitMapToMarkers = function () {
    var i, markers = this.getMarkers(), bounds = new google.maps.LatLngBounds;
    for (i = 0; i < markers.length; i++)bounds.extend(markers[i].getPosition());
    this.getMap().fitBounds(bounds)
}, MarkerClusterer.prototype.getGridSize = function () {
    return this.gridSize_
}, MarkerClusterer.prototype.setGridSize = function (gridSize) {
    this.gridSize_ = gridSize
}, MarkerClusterer.prototype.getMinimumClusterSize = function () {
    return this.minClusterSize_
}, MarkerClusterer.prototype.setMinimumClusterSize = function (minimumClusterSize) {
    this.minClusterSize_ = minimumClusterSize
}, MarkerClusterer.prototype.getMaxZoom = function () {
    return this.maxZoom_
}, MarkerClusterer.prototype.setMaxZoom = function (maxZoom) {
    this.maxZoom_ = maxZoom
}, MarkerClusterer.prototype.getStyles = function () {
    return this.styles_
}, MarkerClusterer.prototype.setStyles = function (styles) {
    this.styles_ = styles
}, MarkerClusterer.prototype.getTitle = function () {
    return this.title_
}, MarkerClusterer.prototype.setTitle = function (title) {
    this.title_ = title
}, MarkerClusterer.prototype.getZoomOnClick = function () {
    return this.zoomOnClick_
}, MarkerClusterer.prototype.setZoomOnClick = function (zoomOnClick) {
    this.zoomOnClick_ = zoomOnClick
}, MarkerClusterer.prototype.getAverageCenter = function () {
    return this.averageCenter_
}, MarkerClusterer.prototype.setAverageCenter = function (averageCenter) {
    this.averageCenter_ = averageCenter
}, MarkerClusterer.prototype.getIgnoreHidden = function () {
    return this.ignoreHidden_
}, MarkerClusterer.prototype.setIgnoreHidden = function (ignoreHidden) {
    this.ignoreHidden_ = ignoreHidden
}, MarkerClusterer.prototype.getImageExtension = function () {
    return this.imageExtension_
}, MarkerClusterer.prototype.setImageExtension = function (imageExtension) {
    this.imageExtension_ = imageExtension
}, MarkerClusterer.prototype.getImagePath = function () {
    return this.imagePath_
}, MarkerClusterer.prototype.setImagePath = function (imagePath) {
    this.imagePath_ = imagePath
}, MarkerClusterer.prototype.getImageSizes = function () {
    return this.imageSizes_
}, MarkerClusterer.prototype.setImageSizes = function (imageSizes) {
    this.imageSizes_ = imageSizes
}, MarkerClusterer.prototype.getCalculator = function () {
    return this.calculator_
}, MarkerClusterer.prototype.setCalculator = function (calculator) {
    this.calculator_ = calculator
}, MarkerClusterer.prototype.getPrintable = function () {
    return this.printable_
}, MarkerClusterer.prototype.setPrintable = function (printable) {
    this.printable_ = printable
}, MarkerClusterer.prototype.getBatchSizeIE = function () {
    return this.batchSizeIE_
}, MarkerClusterer.prototype.setBatchSizeIE = function (batchSizeIE) {
    this.batchSizeIE_ = batchSizeIE
}, MarkerClusterer.prototype.getClusterClass = function () {
    return this.clusterClass_
}, MarkerClusterer.prototype.setClusterClass = function (clusterClass) {
    this.clusterClass_ = clusterClass
}, MarkerClusterer.prototype.getMarkers = function () {
    return this.markers_
}, MarkerClusterer.prototype.getTotalMarkers = function () {
    return this.markers_.length
}, MarkerClusterer.prototype.getClusters = function () {
    return this.clusters_
}, MarkerClusterer.prototype.getTotalClusters = function () {
    return this.clusters_.length
}, MarkerClusterer.prototype.addMarker = function (marker, opt_nodraw) {
    this.pushMarkerTo_(marker), opt_nodraw || this.redraw_()
}, MarkerClusterer.prototype.addMarkers = function (markers, opt_nodraw) {
    var i;
    for (i = 0; i < markers.length; i++)this.pushMarkerTo_(markers[i]);
    opt_nodraw || this.redraw_()
}, MarkerClusterer.prototype.pushMarkerTo_ = function (marker) {
    if (marker.getDraggable()) {
        var cMarkerClusterer = this;
        google.maps.event.addListener(marker, "dragend", function () {
            cMarkerClusterer.ready_ && (this.isAdded = !1, cMarkerClusterer.repaint())
        })
    }
    marker.isAdded = !1, this.markers_.push(marker)
}, MarkerClusterer.prototype.removeMarker = function (marker, opt_nodraw) {
    var removed = this.removeMarker_(marker);
    return!opt_nodraw && removed && this.repaint(), removed
}, MarkerClusterer.prototype.removeMarkers = function (markers, opt_nodraw) {
    var i, r, removed = !1;
    for (i = 0; i < markers.length; i++)r = this.removeMarker_(markers[i]), removed = removed || r;
    return!opt_nodraw && removed && this.repaint(), removed
}, MarkerClusterer.prototype.removeMarker_ = function (marker) {
    var i, index = -1;
    if (this.markers_.indexOf)index = this.markers_.indexOf(marker); else for (i = 0; i < this.markers_.length; i++)if (marker === this.markers_[i]) {
        index = i;
        break
    }
    return-1 === index ? !1 : (marker.setMap(null), this.markers_.splice(index, 1), !0)
}, MarkerClusterer.prototype.clearMarkers = function () {
    this.resetViewport_(!0), this.markers_ = []
}, MarkerClusterer.prototype.repaint = function () {
    var oldClusters = this.clusters_.slice();
    this.clusters_ = [], this.resetViewport_(!1), this.redraw_(), setTimeout(function () {
        var i;
        for (i = 0; i < oldClusters.length; i++)oldClusters[i].remove()
    }, 0)
}, MarkerClusterer.prototype.getExtendedBounds = function (bounds) {
    var projection = this.getProjection(), tr = new google.maps.LatLng(bounds.getNorthEast().lat(), bounds.getNorthEast().lng()), bl = new google.maps.LatLng(bounds.getSouthWest().lat(), bounds.getSouthWest().lng()), trPix = projection.fromLatLngToDivPixel(tr);
    trPix.x += this.gridSize_, trPix.y -= this.gridSize_;
    var blPix = projection.fromLatLngToDivPixel(bl);
    blPix.x -= this.gridSize_, blPix.y += this.gridSize_;
    var ne = projection.fromDivPixelToLatLng(trPix), sw = projection.fromDivPixelToLatLng(blPix);
    return bounds.extend(ne), bounds.extend(sw), bounds
}, MarkerClusterer.prototype.redraw_ = function () {
    this.createClusters_(0)
}, MarkerClusterer.prototype.resetViewport_ = function (opt_hide) {
    var i, marker;
    for (i = 0; i < this.clusters_.length; i++)this.clusters_[i].remove();
    for (this.clusters_ = [], i = 0; i < this.markers_.length; i++)marker = this.markers_[i], marker.isAdded = !1, opt_hide && marker.setMap(null)
}, MarkerClusterer.prototype.distanceBetweenPoints_ = function (p1, p2) {
    var R = 6371, dLat = (p2.lat() - p1.lat()) * Math.PI / 180, dLon = (p2.lng() - p1.lng()) * Math.PI / 180, a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(p1.lat() * Math.PI / 180) * Math.cos(p2.lat() * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2), c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)), d = R * c;
    return d
}, MarkerClusterer.prototype.isMarkerInBounds_ = function (marker, bounds) {
    return bounds.contains(marker.getPosition())
}, MarkerClusterer.prototype.addToClosestCluster_ = function (marker) {
    var i, d, cluster, center, distance = 4e4, clusterToAddTo = null;
    for (i = 0; i < this.clusters_.length; i++)cluster = this.clusters_[i], center = cluster.getCenter(), center && (d = this.distanceBetweenPoints_(center, marker.getPosition()), distance > d && (distance = d, clusterToAddTo = cluster));
    clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker) ? clusterToAddTo.addMarker(marker) : (cluster = new Cluster(this), cluster.addMarker(marker), this.clusters_.push(cluster))
}, MarkerClusterer.prototype.createClusters_ = function (iFirst) {
    var i, marker, mapBounds, cMarkerClusterer = this;
    if (this.ready_) {
        0 === iFirst && (google.maps.event.trigger(this, "clusteringbegin", this), "undefined" != typeof this.timerRefStatic && (clearTimeout(this.timerRefStatic), delete this.timerRefStatic)), mapBounds = this.getMap().getZoom() > 3 ? new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(), this.getMap().getBounds().getNorthEast()) : new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472, -178.48388434375), new google.maps.LatLng(-85.08136444384544, 178.00048865625));
        var bounds = this.getExtendedBounds(mapBounds), iLast = Math.min(iFirst + this.batchSize_, this.markers_.length);
        for (i = iFirst; iLast > i; i++)marker = this.markers_[i], !marker.isAdded && this.isMarkerInBounds_(marker, bounds) && (!this.ignoreHidden_ || this.ignoreHidden_ && marker.getVisible()) && this.addToClosestCluster_(marker);
        iLast < this.markers_.length ? this.timerRefStatic = setTimeout(function () {
            cMarkerClusterer.createClusters_(iLast)
        }, 0) : (delete this.timerRefStatic, google.maps.event.trigger(this, "clusteringend", this))
    }
}, MarkerClusterer.prototype.extend = function (obj1, obj2) {
    return function (object) {
        var property;
        for (property in object.prototype)this.prototype[property] = object.prototype[property];
        return this
    }.apply(obj1, [obj2])
}, MarkerClusterer.CALCULATOR = function (markers, numStyles) {
    for (var index = 0, title = "", count = markers.length.toString(), dv = count; 0 !== dv;)dv = parseInt(dv / 10, 10), index++;
    return index = Math.min(index, numStyles), {text: count, index: index, title: title}
}, MarkerClusterer.BATCH_SIZE = 2e3, MarkerClusterer.BATCH_SIZE_IE = 500, MarkerClusterer.IMAGE_PATH = "http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m", MarkerClusterer.IMAGE_EXTENSION = "png", MarkerClusterer.IMAGE_SIZES = [53, 56, 66, 78, 90], eval(function (p, a, c, k, e, r) {
    if (e = function (c) {
        return(a > c ? "" : e(parseInt(c / a))) + ((c %= a) > 35 ? String.fromCharCode(c + 29) : c.toString(36))
    }, !"".replace(/^/, String)) {
        for (; c--;)r[e(c)] = k[c] || e(c);
        k = [function (e) {
            return r[e]
        }], e = function () {
            return"\\w+"
        }, c = 1
    }
    for (; c--;)k[c] && (p = p.replace(new RegExp("\\b" + e(c) + "\\b", "g"), k[c]));
    return p
}('6 8(a){a=a||{};r.s.1P.2j(2,36);2.M=a.1y||"";2.1z=a.1q||J;2.U=a.1H||0;2.G=a.1B||1g r.s.1Y(0,0);2.E=a.Y||1g r.s.2B(0,0);2.X=a.V||t;2.1p=a.1s||"2g";2.1m=a.F||{};2.1G=a.1E||"39";2.N=a.1j||"34://31.r.2W/2Q/2O/2K/1u.2I";3(a.1j===""){2.N=""}2.19=a.1A||1g r.s.1Y(1,1);3(p a.A==="q"){3(p a.18==="q"){a.A=L}v{a.A=!a.18}}2.w=!a.A;2.17=a.1n||J;2.1I=a.2f||"2d";2.15=a.1l||J;2.4=t;2.z=t;2.14=t;2.T=t;2.B=t;2.R=t}8.9=1g r.s.1P();8.9.24=6(){5 i;5 f;5 a;5 d=2;5 c=6(e){e.20=L;3(e.1i){e.1i()}};5 b=6(e){e.2T=J;3(e.1Z){e.1Z()}3(!d.15){c(e)}};3(!2.4){2.4=16.2N("2M");2.1d();3(p 2.M.1v==="q"){2.4.Q=2.I()+2.M}v{2.4.Q=2.I();2.4.1e(2.M)}2.2F()[2.1I].1e(2.4);2.1t();3(2.4.7.C){2.R=L}v{3(2.U!==0&&2.4.Z>2.U){2.4.7.C=2.U;2.4.7.2A="2x";2.R=L}v{a=2.22();2.4.7.C=(2.4.Z-a.13-a.12)+"11";2.R=J}}2.1r(2.1z);3(!2.15){2.B=[];f=["2q","1N","2p","2o","1M","2n","2m","2l","2k"];1o(i=0;i<f.1L;i++){2.B.1K(r.s.u.1c(2.4,f[i],c))}2.B.1K(r.s.u.1c(2.4,"1N",6(e){2.7.1J="2i"}))}2.T=r.s.u.1c(2.4,"2h",b);r.s.u.S(2,"2e")}};8.9.I=6(){5 a="";3(2.N!==""){a="<2c";a+=" 2b=\'"+2.N+"\'";a+=" 2a=12";a+=" 7=\'";a+=" Y: 29;";a+=" 1J: 28;";a+=" 27: "+2.1G+";";a+="\'>"}K a};8.9.1t=6(){5 a;3(2.N!==""){a=2.4.3f;2.z=r.s.u.1c(a,"1M",2.26())}v{2.z=t}};8.9.26=6(){5 a=2;K 6(e){e.20=L;3(e.1i){e.1i()}r.s.u.S(a,"3e");a.1u()}};8.9.1r=6(d){5 m;5 n;5 e=0,H=0;3(!d){m=2.1F();3(m 3d r.s.3c){3(!m.25().3a(2.E)){m.38(2.E)}n=m.25();5 a=m.37();5 h=a.Z;5 f=a.23;5 k=2.G.C;5 l=2.G.1k;5 g=2.4.Z;5 b=2.4.23;5 i=2.19.C;5 j=2.19.1k;5 o=2.21().35(2.E);3(o.x<(-k+i)){e=o.x+k-i}v 3((o.x+g+k+i)>h){e=o.x+g+k+i-h}3(2.17){3(o.y<(-l+j+b)){H=o.y+l-j-b}v 3((o.y+l+j)>f){H=o.y+l+j-f}}v{3(o.y<(-l+j)){H=o.y+l-j}v 3((o.y+b+l+j)>f){H=o.y+b+l+j-f}}3(!(e===0&&H===0)){5 c=m.33();m.32(e,H)}}}};8.9.1d=6(){5 i,F;3(2.4){2.4.30=2.1p;2.4.7.2Z="";F=2.1m;1o(i 2Y F){3(F.2X(i)){2.4.7[i]=F[i]}}3(p 2.4.7.1f!=="q"&&2.4.7.1f!==""){2.4.7.2V="2S(1f="+(2.4.7.1f*2R)+")"}2.4.7.Y="2P";2.4.7.P=\'1b\';3(2.X!==t){2.4.7.V=2.X}}};8.9.22=6(){5 c;5 a={1a:0,1h:0,13:0,12:0};5 b=2.4;3(16.1w&&16.1w.1X){c=b.2L.1w.1X(b,"");3(c){a.1a=D(c.1W,10)||0;a.1h=D(c.1V,10)||0;a.13=D(c.1U,10)||0;a.12=D(c.1T,10)||0}}v 3(16.2J.O){3(b.O){a.1a=D(b.O.1W,10)||0;a.1h=D(b.O.1V,10)||0;a.13=D(b.O.1U,10)||0;a.12=D(b.O.1T,10)||0}}K a};8.9.2H=6(){3(2.4){2.4.2G.2U(2.4);2.4=t}};8.9.1x=6(){2.24();5 a=2.21().2E(2.E);2.4.7.13=(a.x+2.G.C)+"11";3(2.17){2.4.7.1h=-(a.y+2.G.1k)+"11"}v{2.4.7.1a=(a.y+2.G.1k)+"11"}3(2.w){2.4.7.P=\'1b\'}v{2.4.7.P="A"}};8.9.2D=6(a){3(p a.1s!=="q"){2.1p=a.1s;2.1d()}3(p a.F!=="q"){2.1m=a.F;2.1d()}3(p a.1y!=="q"){2.1S(a.1y)}3(p a.1q!=="q"){2.1z=a.1q}3(p a.1H!=="q"){2.U=a.1H}3(p a.1B!=="q"){2.G=a.1B}3(p a.1n!=="q"){2.17=a.1n}3(p a.Y!=="q"){2.1D(a.Y)}3(p a.V!=="q"){2.1R(a.V)}3(p a.1E!=="q"){2.1G=a.1E}3(p a.1j!=="q"){2.N=a.1j}3(p a.1A!=="q"){2.19=a.1A}3(p a.18!=="q"){2.w=a.18}3(p a.A!=="q"){2.w=!a.A}3(p a.1l!=="q"){2.15=a.1l}3(2.4){2.1x()}};8.9.1S=6(a){2.M=a;3(2.4){3(2.z){r.s.u.W(2.z);2.z=t}3(!2.R){2.4.7.C=""}3(p a.1v==="q"){2.4.Q=2.I()+a}v{2.4.Q=2.I();2.4.1e(a)}3(!2.R){2.4.7.C=2.4.Z+"11";3(p a.1v==="q"){2.4.Q=2.I()+a}v{2.4.Q=2.I();2.4.1e(a)}}2.1t()}r.s.u.S(2,"2C")};8.9.1D=6(a){2.E=a;3(2.4){2.1x()}r.s.u.S(2,"1Q")};8.9.1R=6(a){2.X=a;3(2.4){2.4.7.V=a}r.s.u.S(2,"2z")};8.9.2y=6(a){2.w=!a;3(2.4){2.4.7.P=(2.w?"1b":"A")}};8.9.2w=6(){K 2.M};8.9.1C=6(){K 2.E};8.9.2v=6(){K 2.X};8.9.2u=6(){5 a;3((p 2.1F()==="q")||(2.1F()===t)){a=J}v{a=!2.w}K a};8.9.2t=6(){2.w=J;3(2.4){2.4.7.P="A"}};8.9.3b=6(){2.w=L;3(2.4){2.4.7.P="1b"}};8.9.2s=6(c,b){5 a=2;3(b){2.E=b.1C();2.14=r.s.u.2r(b,"1Q",6(){a.1D(2.1C())})}2.1O(c);3(2.4){2.1r()}};8.9.1u=6(){5 i;3(2.z){r.s.u.W(2.z);2.z=t}3(2.B){1o(i=0;i<2.B.1L;i++){r.s.u.W(2.B[i])}2.B=t}3(2.14){r.s.u.W(2.14);2.14=t}3(2.T){r.s.u.W(2.T);2.T=t}2.1O(t)};', 62, 202, "||this|if|div_|var|function|style|InfoBox|prototype||||||||||||||||typeof|undefined|google|maps|null|event|else|isHidden_|||closeListener_|visible|eventListeners_|width|parseInt|position_|boxStyle|pixelOffset_|yOffset|getCloseBoxImg_|false|return|true|content_|closeBoxURL_|currentStyle|visibility|innerHTML|fixedWidthSet_|trigger|contextListener_|maxWidth_|zIndex|removeListener|zIndex_|position|offsetWidth||px|right|left|moveListener_|enableEventPropagation_|document|alignBottom_|isHidden|infoBoxClearance_|top|hidden|addDomListener|setBoxStyle_|appendChild|opacity|new|bottom|stopPropagation|closeBoxURL|height|enableEventPropagation|boxStyle_|alignBottom|for|boxClass_|disableAutoPan|panBox_|boxClass|addClickHandler_|close|nodeType|defaultView|draw|content|disableAutoPan_|infoBoxClearance|pixelOffset|getPosition|setPosition|closeBoxMargin|getMap|closeBoxMargin_|maxWidth|pane_|cursor|push|length|click|mouseover|setMap|OverlayView|position_changed|setZIndex|setContent|borderRightWidth|borderLeftWidth|borderBottomWidth|borderTopWidth|getComputedStyle|Size|preventDefault|cancelBubble|getProjection|getBoxWidths_|offsetHeight|createInfoBoxDiv_|getBounds|getCloseClickHandler_|margin|pointer|relative|align|src|img|floatPane|domready|pane|infoBox|contextmenu|default|apply|touchmove|touchend|touchstart|dblclick|mouseup|mouseout|mousedown|addListener|open|show|getVisible|getZIndex|getContent|auto|setVisible|zindex_changed|overflow|LatLng|content_changed|setOptions|fromLatLngToDivPixel|getPanes|parentNode|onRemove|gif|documentElement|mapfiles|ownerDocument|div|createElement|en_us|absolute|intl|100|alpha|returnValue|removeChild|filter|com|hasOwnProperty|in|cssText|className|www|panBy|getCenter|http|fromLatLngToContainerPixel|arguments|getDiv|setCenter|2px|contains|hide|Map|instanceof|closeclick|firstChild".split("|"), 0, {})), function (root, factory) {
    "object" == typeof exports ? module.exports = factory() : "function" == typeof define && define.amd ? define(factory) : root.Spinner = factory()
}(this, function () {
    "use strict";
    function createEl(tag, prop) {
        var n, el = document.createElement(tag || "div");
        for (n in prop)el[n] = prop[n];
        return el
    }

    function ins(parent) {
        for (var i = 1, n = arguments.length; n > i; i++)parent.appendChild(arguments[i]);
        return parent
    }

    function addAnimation(alpha, trail, i, lines) {
        var name = ["opacity", trail, ~~(100 * alpha), i, lines].join("-"), start = .01 + 100 * (i / lines), z = Math.max(1 - (1 - alpha) / trail * (100 - start), alpha), prefix = useCssAnimations.substring(0, useCssAnimations.indexOf("Animation")).toLowerCase(), pre = prefix && "-" + prefix + "-" || "";
        return animations[name] || (sheet.insertRule("@" + pre + "keyframes " + name + "{0%{opacity:" + z + "}" + start + "%{opacity:" + alpha + "}" + (start + .01) + "%{opacity:1}" + (start + trail) % 100 + "%{opacity:" + alpha + "}100%{opacity:" + z + "}}", sheet.cssRules.length), animations[name] = 1), name
    }

    function vendor(el, prop) {
        var pp, i, s = el.style;
        for (prop = prop.charAt(0).toUpperCase() + prop.slice(1), i = 0; i < prefixes.length; i++)if (pp = prefixes[i] + prop, void 0 !== s[pp])return pp;
        return void 0 !== s[prop] ? prop : void 0
    }

    function css(el, prop) {
        for (var n in prop)el.style[vendor(el, n) || n] = prop[n];
        return el
    }

    function merge(obj) {
        for (var i = 1; i < arguments.length; i++) {
            var def = arguments[i];
            for (var n in def)void 0 === obj[n] && (obj[n] = def[n])
        }
        return obj
    }

    function pos(el) {
        for (var o = {x: el.offsetLeft, y: el.offsetTop}; el = el.offsetParent;)o.x += el.offsetLeft, o.y += el.offsetTop;
        return o
    }

    function getColor(color, idx) {
        return"string" == typeof color ? color : color[idx % color.length]
    }

    function Spinner(o) {
        return"undefined" == typeof this ? new Spinner(o) : (this.opts = merge(o || {}, Spinner.defaults, defaults), void 0)
    }

    function initVML() {
        function vml(tag, attr) {
            return createEl("<" + tag + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', attr)
        }

        sheet.addRule(".spin-vml", "behavior:url(#default#VML)"), Spinner.prototype.lines = function (el, o) {
            function grp() {
                return css(vml("group", {coordsize: s + " " + s, coordorigin: -r + " " + -r}), {width: s, height: s})
            }

            function seg(i, dx, filter) {
                ins(g, ins(css(grp(), {rotation: 360 / o.lines * i + "deg", left: ~~dx}), ins(css(vml("roundrect", {arcsize: o.corners}), {width: r, height: o.width, left: o.radius, top: -o.width >> 1, filter: filter}), vml("fill", {color: getColor(o.color, i), opacity: o.opacity}), vml("stroke", {opacity: 0}))))
            }

            var i, r = o.length + o.width, s = 2 * r, margin = 2 * -(o.width + o.length) + "px", g = css(grp(), {position: "absolute", top: margin, left: margin});
            if (o.shadow)for (i = 1; i <= o.lines; i++)seg(i, -2, "progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");
            for (i = 1; i <= o.lines; i++)seg(i);
            return ins(el, g)
        }, Spinner.prototype.opacity = function (el, i, val, o) {
            var c = el.firstChild;
            o = o.shadow && o.lines || 0, c && i + o < c.childNodes.length && (c = c.childNodes[i + o], c = c && c.firstChild, c = c && c.firstChild, c && (c.opacity = val))
        }
    }

    var useCssAnimations, prefixes = ["webkit", "Moz", "ms", "O"], animations = {}, sheet = function () {
        var el = createEl("style", {type: "text/css"});
        return ins(document.getElementsByTagName("head")[0], el), el.sheet || el.styleSheet
    }(), defaults = {lines: 12, length: 7, width: 5, radius: 10, rotate: 0, corners: 1, color: "#000", direction: 1, speed: 1, trail: 100, opacity: .25, fps: 20, zIndex: 2e9, className: "spinner", top: "auto", left: "auto", position: "relative"};
    Spinner.defaults = {}, merge(Spinner.prototype, {spin: function (target) {
        this.stop();
        var ep, tp, self = this, o = self.opts, el = self.el = css(createEl(0, {className: o.className}), {position: o.position, width: 0, zIndex: o.zIndex}), mid = o.radius + o.length + o.width;
        if (target && (target.insertBefore(el, target.firstChild || null), tp = pos(target), ep = pos(el), css(el, {left: ("auto" == o.left ? tp.x - ep.x + (target.offsetWidth >> 1) : parseInt(o.left, 10) + mid) + "px", top: ("auto" == o.top ? tp.y - ep.y + (target.offsetHeight >> 1) : parseInt(o.top, 10) + mid) + "px"})), el.setAttribute("role", "progressbar"), self.lines(el, self.opts), !useCssAnimations) {
            var alpha, i = 0, start = (o.lines - 1) * (1 - o.direction) / 2, fps = o.fps, f = fps / o.speed, ostep = (1 - o.opacity) / (f * o.trail / 100), astep = f / o.lines;
            !function anim() {
                i++;
                for (var j = 0; j < o.lines; j++)alpha = Math.max(1 - (i + (o.lines - j) * astep) % f * ostep, o.opacity), self.opacity(el, j * o.direction + start, alpha, o);
                self.timeout = self.el && setTimeout(anim, ~~(1e3 / fps))
            }()
        }
        return self
    }, stop: function () {
        var el = this.el;
        return el && (clearTimeout(this.timeout), el.parentNode && el.parentNode.removeChild(el), this.el = void 0), this
    }, lines: function (el, o) {
        function fill(color, shadow) {
            return css(createEl(), {position: "absolute", width: o.length + o.width + "px", height: o.width + "px", background: color, boxShadow: shadow, transformOrigin: "left", transform: "rotate(" + ~~(360 / o.lines * i + o.rotate) + "deg) translate(" + o.radius + "px,0)", borderRadius: (o.corners * o.width >> 1) + "px"})
        }

        for (var seg, i = 0, start = (o.lines - 1) * (1 - o.direction) / 2; i < o.lines; i++)seg = css(createEl(), {position: "absolute", top: 1 + ~(o.width / 2) + "px", transform: o.hwaccel ? "translate3d(0,0,0)" : "", opacity: o.opacity, animation: useCssAnimations && addAnimation(o.opacity, o.trail, start + i * o.direction, o.lines) + " " + 1 / o.speed + "s linear infinite"}), o.shadow && ins(seg, css(fill("#000", "0 0 4px #000"), {top: "2px"})), ins(el, ins(seg, fill(getColor(o.color, i), "0 0 1px rgba(0,0,0,.1)")));
        return el
    }, opacity: function (el, i, val) {
        i < el.childNodes.length && (el.childNodes[i].style.opacity = val)
    }});
    var probe = css(createEl("group"), {behavior: "url(#default#VML)"});
    return!vendor(probe, "transform") && probe.adj ? initVML() : useCssAnimations = vendor(probe, "animation"), Spinner
}), !function ($) {
    "use strict";
    $(function () {
        $.support.transition = function () {
            var transitionEnd = function () {
                var name, el = document.createElement("bootstrap"), transEndEventNames = {WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd otransitionend", transition: "transitionend"};
                for (name in transEndEventNames)if (void 0 !== el.style[name])return transEndEventNames[name]
            }();
            return transitionEnd && {end: transitionEnd}
        }()
    })
}(window.jQuery), !function ($) {
    "use strict";
    var dismiss = '[data-dismiss="alert"]', Alert = function (el) {
        $(el).on("click", dismiss, this.close)
    };
    Alert.prototype.close = function (e) {
        function removeElement() {
            $parent.trigger("closed").remove()
        }

        var $parent, $this = $(this), selector = $this.attr("data-target");
        selector || (selector = $this.attr("href"), selector = selector && selector.replace(/.*(?=#[^\s]*$)/, "")), $parent = $(selector), e && e.preventDefault(), $parent.length || ($parent = $this.hasClass("alert") ? $this : $this.parent()), $parent.trigger(e = $.Event("close")), e.isDefaultPrevented() || ($parent.removeClass("in"), $.support.transition && $parent.hasClass("fade") ? $parent.on($.support.transition.end, removeElement) : removeElement())
    };
    var old = $.fn.alert;
    $.fn.alert = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("alert");
            data || $this.data("alert", data = new Alert(this)), "string" == typeof option && data[option].call($this)
        })
    }, $.fn.alert.Constructor = Alert, $.fn.alert.noConflict = function () {
        return $.fn.alert = old, this
    }, $(document).on("click.alert.data-api", dismiss, Alert.prototype.close)
}(window.jQuery), !function ($) {
    "use strict";
    var Button = function (element, options) {
        this.$element = $(element), this.options = $.extend({}, $.fn.button.defaults, options)
    };
    Button.prototype.setState = function (state) {
        var d = "disabled", $el = this.$element, data = $el.data(), val = $el.is("input") ? "val" : "html";
        state += "Text", data.resetText || $el.data("resetText", $el[val]()), $el[val](data[state] || this.options[state]), setTimeout(function () {
            "loadingText" == state ? $el.addClass(d).attr(d, d) : $el.removeClass(d).removeAttr(d)
        }, 0)
    }, Button.prototype.toggle = function () {
        var $parent = this.$element.closest('[data-toggle="buttons-radio"]');
        $parent && $parent.find(".active").removeClass("active"), this.$element.toggleClass("active")
    };
    var old = $.fn.button;
    $.fn.button = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("button"), options = "object" == typeof option && option;
            data || $this.data("button", data = new Button(this, options)), "toggle" == option ? data.toggle() : option && data.setState(option)
        })
    }, $.fn.button.defaults = {loadingText: "loading..."}, $.fn.button.Constructor = Button, $.fn.button.noConflict = function () {
        return $.fn.button = old, this
    }, $(document).on("click.button.data-api", "[data-toggle^=button]", function (e) {
        var $btn = $(e.target);
        $btn.hasClass("btn") || ($btn = $btn.closest(".btn")), $btn.button("toggle")
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Carousel = function (element, options) {
        this.$element = $(element), this.$indicators = this.$element.find(".carousel-indicators"), this.options = options, "hover" == this.options.pause && this.$element.on("mouseenter", $.proxy(this.pause, this)).on("mouseleave", $.proxy(this.cycle, this))
    };
    Carousel.prototype = {cycle: function (e) {
        return e || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval($.proxy(this.next, this), this.options.interval)), this
    }, getActiveIndex: function () {
        return this.$active = this.$element.find(".item.active"), this.$items = this.$active.parent().children(), this.$items.index(this.$active)
    }, to: function (pos) {
        var activeIndex = this.getActiveIndex(), that = this;
        if (!(pos > this.$items.length - 1 || 0 > pos))return this.sliding ? this.$element.one("slid", function () {
            that.to(pos)
        }) : activeIndex == pos ? this.pause().cycle() : this.slide(pos > activeIndex ? "next" : "prev", $(this.$items[pos]))
    }, pause: function (e) {
        return e || (this.paused = !0), this.$element.find(".next, .prev").length && $.support.transition.end && (this.$element.trigger($.support.transition.end), this.cycle(!0)), clearInterval(this.interval), this.interval = null, this
    }, next: function () {
        return this.sliding ? void 0 : this.slide("next")
    }, prev: function () {
        return this.sliding ? void 0 : this.slide("prev")
    }, slide: function (type, next) {
        var e, $active = this.$element.find(".item.active"), $next = next || $active[type](), isCycling = this.interval, direction = "next" == type ? "left" : "right", fallback = "next" == type ? "first" : "last", that = this;
        if (this.sliding = !0, isCycling && this.pause(), $next = $next.length ? $next : this.$element.find(".item")[fallback](), e = $.Event("slide", {relatedTarget: $next[0], direction: direction}), !$next.hasClass("active")) {
            if (this.$indicators.length && (this.$indicators.find(".active").removeClass("active"), this.$element.one("slid", function () {
                var $nextIndicator = $(that.$indicators.children()[that.getActiveIndex()]);
                $nextIndicator && $nextIndicator.addClass("active")
            })), $.support.transition && this.$element.hasClass("slide")) {
                if (this.$element.trigger(e), e.isDefaultPrevented())return;
                $next.addClass(type), $next[0].offsetWidth, $active.addClass(direction), $next.addClass(direction), this.$element.one($.support.transition.end, function () {
                    $next.removeClass([type, direction].join(" ")).addClass("active"), $active.removeClass(["active", direction].join(" ")), that.sliding = !1, setTimeout(function () {
                        that.$element.trigger("slid")
                    }, 0)
                })
            } else {
                if (this.$element.trigger(e), e.isDefaultPrevented())return;
                $active.removeClass("active"), $next.addClass("active"), this.sliding = !1, this.$element.trigger("slid")
            }
            return isCycling && this.cycle(), this
        }
    }};
    var old = $.fn.carousel;
    $.fn.carousel = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("carousel"), options = $.extend({}, $.fn.carousel.defaults, "object" == typeof option && option), action = "string" == typeof option ? option : options.slide;
            data || $this.data("carousel", data = new Carousel(this, options)), "number" == typeof option ? data.to(option) : action ? data[action]() : options.interval && data.pause().cycle()
        })
    }, $.fn.carousel.defaults = {interval: 5e3, pause: "hover"}, $.fn.carousel.Constructor = Carousel, $.fn.carousel.noConflict = function () {
        return $.fn.carousel = old, this
    }, $(document).on("click.carousel.data-api", "[data-slide], [data-slide-to]", function (e) {
        var href, slideIndex, $this = $(this), $target = $($this.attr("data-target") || (href = $this.attr("href")) && href.replace(/.*(?=#[^\s]+$)/, "")), options = $.extend({}, $target.data(), $this.data());
        $target.carousel(options), (slideIndex = $this.attr("data-slide-to")) && $target.data("carousel").pause().to(slideIndex).cycle(), e.preventDefault()
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Collapse = function (element, options) {
        this.$element = $(element), this.options = $.extend({}, $.fn.collapse.defaults, options), this.options.parent && (this.$parent = $(this.options.parent)), this.options.toggle && this.toggle()
    };
    Collapse.prototype = {constructor: Collapse, dimension: function () {
        var hasWidth = this.$element.hasClass("width");
        return hasWidth ? "width" : "height"
    }, show: function () {
        var dimension, scroll, actives, hasData;
        if (!this.transitioning && !this.$element.hasClass("in")) {
            if (dimension = this.dimension(), scroll = $.camelCase(["scroll", dimension].join("-")), actives = this.$parent && this.$parent.find("> .accordion-group > .in"), actives && actives.length) {
                if (hasData = actives.data("collapse"), hasData && hasData.transitioning)return;
                actives.collapse("hide"), hasData || actives.data("collapse", null)
            }
            this.$element[dimension](0), this.transition("addClass", $.Event("show"), "shown"), $.support.transition && this.$element[dimension](this.$element[0][scroll])
        }
    }, hide: function () {
        var dimension;
        !this.transitioning && this.$element.hasClass("in") && (dimension = this.dimension(), this.reset(this.$element[dimension]()), this.transition("removeClass", $.Event("hide"), "hidden"), this.$element[dimension](0))
    }, reset: function (size) {
        var dimension = this.dimension();
        return this.$element.removeClass("collapse")[dimension](size || "auto")[0].offsetWidth, this.$element[null !== size ? "addClass" : "removeClass"]("collapse"), this
    }, transition: function (method, startEvent, completeEvent) {
        var that = this, complete = function () {
            "show" == startEvent.type && that.reset(), that.transitioning = 0, that.$element.trigger(completeEvent)
        };
        this.$element.trigger(startEvent), startEvent.isDefaultPrevented() || (this.transitioning = 1, this.$element[method]("in"), $.support.transition && this.$element.hasClass("collapse") ? this.$element.one($.support.transition.end, complete) : complete())
    }, toggle: function () {
        this[this.$element.hasClass("in") ? "hide" : "show"]()
    }};
    var old = $.fn.collapse;
    $.fn.collapse = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("collapse"), options = $.extend({}, $.fn.collapse.defaults, $this.data(), "object" == typeof option && option);
            data || $this.data("collapse", data = new Collapse(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.collapse.defaults = {toggle: !0}, $.fn.collapse.Constructor = Collapse, $.fn.collapse.noConflict = function () {
        return $.fn.collapse = old, this
    }, $(document).on("click.collapse.data-api", "[data-toggle=collapse]", function (e) {
        var href, $this = $(this), target = $this.attr("data-target") || e.preventDefault() || (href = $this.attr("href")) && href.replace(/.*(?=#[^\s]+$)/, ""), option = $(target).data("collapse") ? "toggle" : $this.data();
        $this[$(target).hasClass("in") ? "addClass" : "removeClass"]("collapsed"), $(target).collapse(option)
    })
}(window.jQuery), !function ($) {
    "use strict";
    function clearMenus() {
        $(".dropdown-backdrop").remove(), $(toggle).each(function () {
            getParent($(this)).removeClass("open")
        })
    }

    function getParent($this) {
        var $parent, selector = $this.attr("data-target");
        return selector || (selector = $this.attr("href"), selector = selector && /#/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, "")), $parent = selector && $(selector), $parent && $parent.length || ($parent = $this.parent()), $parent
    }

    var toggle = "[data-toggle=dropdown]", Dropdown = function (element) {
        var $el = $(element).on("click.dropdown.data-api", this.toggle);
        $("html").on("click.dropdown.data-api", function () {
            $el.parent().removeClass("open")
        })
    };
    Dropdown.prototype = {constructor: Dropdown, toggle: function () {
        var $parent, isActive, $this = $(this);
        if (!$this.is(".disabled, :disabled"))return $parent = getParent($this), isActive = $parent.hasClass("open"), clearMenus(), isActive || ("ontouchstart"in document.documentElement && $('<div class="dropdown-backdrop"/>').insertBefore($(this)).on("click", clearMenus), $parent.toggleClass("open")), $this.focus(), !1
    }, keydown: function (e) {
        var $this, $items, $parent, isActive, index;
        if (/(38|40|27)/.test(e.keyCode) && ($this = $(this), e.preventDefault(), e.stopPropagation(), !$this.is(".disabled, :disabled"))) {
            if ($parent = getParent($this), isActive = $parent.hasClass("open"), !isActive || isActive && 27 == e.keyCode)return 27 == e.which && $parent.find(toggle).focus(), $this.click();
            $items = $("[role=menu] li:not(.divider):visible a", $parent), $items.length && (index = $items.index($items.filter(":focus")), 38 == e.keyCode && index > 0 && index--, 40 == e.keyCode && index < $items.length - 1 && index++, ~index || (index = 0), $items.eq(index).focus())
        }
    }};
    var old = $.fn.dropdown;
    $.fn.dropdown = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("dropdown");
            data || $this.data("dropdown", data = new Dropdown(this)), "string" == typeof option && data[option].call($this)
        })
    }, $.fn.dropdown.Constructor = Dropdown, $.fn.dropdown.noConflict = function () {
        return $.fn.dropdown = old, this
    }, $(document).on("click.dropdown.data-api", clearMenus).on("click.dropdown.data-api", ".dropdown form",function (e) {
        e.stopPropagation()
    }).on("click.dropdown.data-api", toggle, Dropdown.prototype.toggle).on("keydown.dropdown.data-api", toggle + ", [role=menu]", Dropdown.prototype.keydown)
}(window.jQuery), !function ($) {
    "use strict";
    var Modal = function (element, options) {
        this.options = options, this.$element = $(element).delegate('[data-dismiss="modal"]', "click.dismiss.modal", $.proxy(this.hide, this)), this.options.remote && this.$element.find(".modal-body").load(this.options.remote)
    };
    Modal.prototype = {constructor: Modal, toggle: function () {
        return this[this.isShown ? "hide" : "show"]()
    }, show: function () {
        var that = this, e = $.Event("show");
        this.$element.trigger(e), this.isShown || e.isDefaultPrevented() || (this.isShown = !0, this.escape(), this.backdrop(function () {
            var transition = $.support.transition && that.$element.hasClass("fade");
            that.$element.parent().length || that.$element.appendTo(document.body), that.$element.show(), transition && that.$element[0].offsetWidth, that.$element.addClass("in").attr("aria-hidden", !1), that.enforceFocus(), transition ? that.$element.one($.support.transition.end, function () {
                that.$element.focus().trigger("shown")
            }) : that.$element.focus().trigger("shown")
        }))
    }, hide: function (e) {
        e && e.preventDefault(), e = $.Event("hide"), this.$element.trigger(e), this.isShown && !e.isDefaultPrevented() && (this.isShown = !1, this.escape(), $(document).off("focusin.modal"), this.$element.removeClass("in").attr("aria-hidden", !0), $.support.transition && this.$element.hasClass("fade") ? this.hideWithTransition() : this.hideModal())
    }, enforceFocus: function () {
        var that = this;
        $(document).on("focusin.modal", function (e) {
            that.$element[0] === e.target || that.$element.has(e.target).length || that.$element.focus()
        })
    }, escape: function () {
        var that = this;
        this.isShown && this.options.keyboard ? this.$element.on("keyup.dismiss.modal", function (e) {
            27 == e.which && that.hide()
        }) : this.isShown || this.$element.off("keyup.dismiss.modal")
    }, hideWithTransition: function () {
        var that = this, timeout = setTimeout(function () {
            that.$element.off($.support.transition.end), that.hideModal()
        }, 500);
        this.$element.one($.support.transition.end, function () {
            clearTimeout(timeout), that.hideModal()
        })
    }, hideModal: function () {
        var that = this;
        this.$element.hide(), this.backdrop(function () {
            that.removeBackdrop(), that.$element.trigger("hidden")
        })
    }, removeBackdrop: function () {
        this.$backdrop && this.$backdrop.remove(), this.$backdrop = null
    }, backdrop: function (callback) {
        var animate = this.$element.hasClass("fade") ? "fade" : "";
        if (this.isShown && this.options.backdrop) {
            var doAnimate = $.support.transition && animate;
            if (this.$backdrop = $('<div class="modal-backdrop ' + animate + '" />').appendTo(document.body), this.$backdrop.click("static" == this.options.backdrop ? $.proxy(this.$element[0].focus, this.$element[0]) : $.proxy(this.hide, this)), doAnimate && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !callback)return;
            doAnimate ? this.$backdrop.one($.support.transition.end, callback) : callback()
        } else!this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), $.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one($.support.transition.end, callback) : callback()) : callback && callback()
    }};
    var old = $.fn.modal;
    $.fn.modal = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("modal"), options = $.extend({}, $.fn.modal.defaults, $this.data(), "object" == typeof option && option);
            data || $this.data("modal", data = new Modal(this, options)), "string" == typeof option ? data[option]() : options.show && data.show()
        })
    }, $.fn.modal.defaults = {backdrop: !0, keyboard: !0, show: !0}, $.fn.modal.Constructor = Modal, $.fn.modal.noConflict = function () {
        return $.fn.modal = old, this
    }, $(document).on("click.modal.data-api", '[data-toggle="modal"]', function (e) {
        var $this = $(this), href = $this.attr("href"), $target = $($this.attr("data-target") || href && href.replace(/.*(?=#[^\s]+$)/, "")), option = $target.data("modal") ? "toggle" : $.extend({remote: !/#/.test(href) && href}, $target.data(), $this.data());
        e.preventDefault(), $target.modal(option).one("hide", function () {
            $this.focus()
        })
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Tooltip = function (element, options) {
        this.init("tooltip", element, options)
    };
    Tooltip.prototype = {constructor: Tooltip, init: function (type, element, options) {
        var eventIn, eventOut, triggers, trigger, i;
        for (this.type = type, this.$element = $(element), this.options = this.getOptions(options), this.enabled = !0, triggers = this.options.trigger.split(" "), i = triggers.length; i--;)trigger = triggers[i], "click" == trigger ? this.$element.on("click." + this.type, this.options.selector, $.proxy(this.toggle, this)) : "manual" != trigger && (eventIn = "hover" == trigger ? "mouseenter" : "focus", eventOut = "hover" == trigger ? "mouseleave" : "blur", this.$element.on(eventIn + "." + this.type, this.options.selector, $.proxy(this.enter, this)), this.$element.on(eventOut + "." + this.type, this.options.selector, $.proxy(this.leave, this)));
        this.options.selector ? this._options = $.extend({}, this.options, {trigger: "manual", selector: ""}) : this.fixTitle()
    }, getOptions: function (options) {
        return options = $.extend({}, $.fn[this.type].defaults, this.$element.data(), options), options.delay && "number" == typeof options.delay && (options.delay = {show: options.delay, hide: options.delay}), options
    }, enter: function (e) {
        var self, defaults = $.fn[this.type].defaults, options = {};
        return this._options && $.each(this._options, function (key, value) {
            defaults[key] != value && (options[key] = value)
        }, this), self = $(e.currentTarget)[this.type](options).data(this.type), self.options.delay && self.options.delay.show ? (clearTimeout(this.timeout), self.hoverState = "in", this.timeout = setTimeout(function () {
            "in" == self.hoverState && self.show()
        }, self.options.delay.show), void 0) : self.show()
    }, leave: function (e) {
        var self = $(e.currentTarget)[this.type](this._options).data(this.type);
        return this.timeout && clearTimeout(this.timeout), self.options.delay && self.options.delay.hide ? (self.hoverState = "out", this.timeout = setTimeout(function () {
            "out" == self.hoverState && self.hide()
        }, self.options.delay.hide), void 0) : self.hide()
    }, show: function () {
        var $tip, pos, actualWidth, actualHeight, placement, tp, e = $.Event("show");
        if (this.hasContent() && this.enabled) {
            if (this.$element.trigger(e), e.isDefaultPrevented())return;
            switch ($tip = this.tip(), this.setContent(), this.options.animation && $tip.addClass("fade"), placement = "function" == typeof this.options.placement ? this.options.placement.call(this, $tip[0], this.$element[0]) : this.options.placement, $tip.detach().css({top: 0, left: 0, display: "block"}), this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element), pos = this.getPosition(), actualWidth = $tip[0].offsetWidth, actualHeight = $tip[0].offsetHeight, placement) {
                case"bottom":
                    tp = {top: pos.top + pos.height, left: pos.left + pos.width / 2 - actualWidth / 2};
                    break;
                case"top":
                    tp = {top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2};
                    break;
                case"left":
                    tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth};
                    break;
                case"right":
                    tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width}
            }
            this.applyPlacement(tp, placement), this.$element.trigger("shown")
        }
    }, applyPlacement: function (offset, placement) {
        var actualWidth, actualHeight, delta, replace, $tip = this.tip(), width = $tip[0].offsetWidth, height = $tip[0].offsetHeight;
        $tip.offset(offset).addClass(placement).addClass("in"), actualWidth = $tip[0].offsetWidth, actualHeight = $tip[0].offsetHeight, "top" == placement && actualHeight != height && (offset.top = offset.top + height - actualHeight, replace = !0), "bottom" == placement || "top" == placement ? (delta = 0, offset.left < 0 && (delta = -2 * offset.left, offset.left = 0, $tip.offset(offset), actualWidth = $tip[0].offsetWidth, actualHeight = $tip[0].offsetHeight), this.replaceArrow(delta - width + actualWidth, actualWidth, "left")) : this.replaceArrow(actualHeight - height, actualHeight, "top"), replace && $tip.offset(offset)
    }, replaceArrow: function (delta, dimension, position) {
        this.arrow().css(position, delta ? 50 * (1 - delta / dimension) + "%" : "")
    }, setContent: function () {
        var $tip = this.tip(), title = this.getTitle();
        $tip.find(".tooltip-inner")[this.options.html ? "html" : "text"](title), $tip.removeClass("fade in top bottom left right")
    }, hide: function () {
        function removeWithAnimation() {
            var timeout = setTimeout(function () {
                $tip.off($.support.transition.end).detach()
            }, 500);
            $tip.one($.support.transition.end, function () {
                clearTimeout(timeout), $tip.detach()
            })
        }

        var $tip = this.tip(), e = $.Event("hide");
        return this.$element.trigger(e), e.isDefaultPrevented() ? void 0 : ($tip.removeClass("in"), $.support.transition && this.$tip.hasClass("fade") ? removeWithAnimation() : $tip.detach(), this.$element.trigger("hidden"), this)
    }, fixTitle: function () {
        var $e = this.$element;
        ($e.attr("title") || "string" != typeof $e.attr("data-original-title")) && $e.attr("data-original-title", $e.attr("title") || "").attr("title", "")
    }, hasContent: function () {
        return this.getTitle()
    }, getPosition: function () {
        var el = this.$element[0];
        return $.extend({}, "function" == typeof el.getBoundingClientRect ? el.getBoundingClientRect() : {width: el.offsetWidth, height: el.offsetHeight}, this.$element.offset())
    }, getTitle: function () {
        var title, $e = this.$element, o = this.options;
        return title = $e.attr("data-original-title") || ("function" == typeof o.title ? o.title.call($e[0]) : o.title)
    }, tip: function () {
        return this.$tip = this.$tip || $(this.options.template)
    }, arrow: function () {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    }, validate: function () {
        this.$element[0].parentNode || (this.hide(), this.$element = null, this.options = null)
    }, enable: function () {
        this.enabled = !0
    }, disable: function () {
        this.enabled = !1
    }, toggleEnabled: function () {
        this.enabled = !this.enabled
    }, toggle: function (e) {
        var self = e ? $(e.currentTarget)[this.type](this._options).data(this.type) : this;
        self.tip().hasClass("in") ? self.hide() : self.show()
    }, destroy: function () {
        this.hide().$element.off("." + this.type).removeData(this.type)
    }};
    var old = $.fn.tooltip;
    $.fn.tooltip = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("tooltip"), options = "object" == typeof option && option;
            data || $this.data("tooltip", data = new Tooltip(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.tooltip.Constructor = Tooltip, $.fn.tooltip.defaults = {animation: !0, placement: "top", selector: !1, template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>', trigger: "hover focus", title: "", delay: 0, html: !1, container: !1}, $.fn.tooltip.noConflict = function () {
        return $.fn.tooltip = old, this
    }
}(window.jQuery), !function ($) {
    "use strict";
    var Popover = function (element, options) {
        this.init("popover", element, options)
    };
    Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype, {constructor: Popover, setContent: function () {
        var $tip = this.tip(), title = this.getTitle(), content = this.getContent();
        $tip.find(".popover-title")[this.options.html ? "html" : "text"](title), $tip.find(".popover-content")[this.options.html ? "html" : "text"](content), $tip.removeClass("fade top bottom left right in")
    }, hasContent: function () {
        return this.getTitle() || this.getContent()
    }, getContent: function () {
        var content, $e = this.$element, o = this.options;
        return content = ("function" == typeof o.content ? o.content.call($e[0]) : o.content) || $e.attr("data-content")
    }, tip: function () {
        return this.$tip || (this.$tip = $(this.options.template)), this.$tip
    }, destroy: function () {
        this.hide().$element.off("." + this.type).removeData(this.type)
    }});
    var old = $.fn.popover;
    $.fn.popover = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("popover"), options = "object" == typeof option && option;
            data || $this.data("popover", data = new Popover(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.popover.Constructor = Popover, $.fn.popover.defaults = $.extend({}, $.fn.tooltip.defaults, {placement: "right", trigger: "click", content: "", template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}), $.fn.popover.noConflict = function () {
        return $.fn.popover = old, this
    }
}(window.jQuery), !function ($) {
    "use strict";
    function ScrollSpy(element, options) {
        var href, process = $.proxy(this.process, this), $element = $(element).is("body") ? $(window) : $(element);
        this.options = $.extend({}, $.fn.scrollspy.defaults, options), this.$scrollElement = $element.on("scroll.scroll-spy.data-api", process), this.selector = (this.options.target || (href = $(element).attr("href")) && href.replace(/.*(?=#[^\s]+$)/, "") || "") + " .nav li > a", this.$body = $("body"), this.refresh(), this.process()
    }

    ScrollSpy.prototype = {constructor: ScrollSpy, refresh: function () {
        var $targets, self = this;
        this.offsets = $([]), this.targets = $([]), $targets = this.$body.find(this.selector).map(function () {
            var $el = $(this), href = $el.data("target") || $el.attr("href"), $href = /^#\w/.test(href) && $(href);
            return $href && $href.length && [
                [$href.position().top + (!$.isWindow(self.$scrollElement.get(0)) && self.$scrollElement.scrollTop()), href]
            ] || null
        }).sort(function (a, b) {
            return a[0] - b[0]
        }).each(function () {
            self.offsets.push(this[0]), self.targets.push(this[1])
        })
    }, process: function () {
        var i, scrollTop = this.$scrollElement.scrollTop() + this.options.offset, scrollHeight = this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight, maxScroll = scrollHeight - this.$scrollElement.height(), offsets = this.offsets, targets = this.targets, activeTarget = this.activeTarget;
        if (scrollTop >= maxScroll)return activeTarget != (i = targets.last()[0]) && this.activate(i);
        for (i = offsets.length; i--;)activeTarget != targets[i] && scrollTop >= offsets[i] && (!offsets[i + 1] || scrollTop <= offsets[i + 1]) && this.activate(targets[i])
    }, activate: function (target) {
        var active, selector;
        this.activeTarget = target, $(this.selector).parent(".active").removeClass("active"), selector = this.selector + '[data-target="' + target + '"],' + this.selector + '[href="' + target + '"]', active = $(selector).parent("li").addClass("active"), active.parent(".dropdown-menu").length && (active = active.closest("li.dropdown").addClass("active")), active.trigger("activate")
    }};
    var old = $.fn.scrollspy;
    $.fn.scrollspy = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("scrollspy"), options = "object" == typeof option && option;
            data || $this.data("scrollspy", data = new ScrollSpy(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.scrollspy.Constructor = ScrollSpy, $.fn.scrollspy.defaults = {offset: 10}, $.fn.scrollspy.noConflict = function () {
        return $.fn.scrollspy = old, this
    }, $(window).on("load", function () {
        $('[data-spy="scroll"]').each(function () {
            var $spy = $(this);
            $spy.scrollspy($spy.data())
        })
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Tab = function (element) {
        this.element = $(element)
    };
    Tab.prototype = {constructor: Tab, show: function () {
        var previous, $target, e, $this = this.element, $ul = $this.closest("ul:not(.dropdown-menu)"), selector = $this.attr("data-target");
        selector || (selector = $this.attr("href"), selector = selector && selector.replace(/.*(?=#[^\s]*$)/, "")), $this.parent("li").hasClass("active") || (previous = $ul.find(".active:last a")[0], e = $.Event("show", {relatedTarget: previous}), $this.trigger(e), e.isDefaultPrevented() || ($target = $(selector), this.activate($this.parent("li"), $ul), this.activate($target, $target.parent(), function () {
            $this.trigger({type: "shown", relatedTarget: previous})
        })))
    }, activate: function (element, container, callback) {
        function next() {
            $active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"), element.addClass("active"), transition ? (element[0].offsetWidth, element.addClass("in")) : element.removeClass("fade"), element.parent(".dropdown-menu") && element.closest("li.dropdown").addClass("active"), callback && callback()
        }

        var $active = container.find("> .active"), transition = callback && $.support.transition && $active.hasClass("fade");
        transition ? $active.one($.support.transition.end, next) : next(), $active.removeClass("in")
    }};
    var old = $.fn.tab;
    $.fn.tab = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("tab");
            data || $this.data("tab", data = new Tab(this)), "string" == typeof option && data[option]()
        })
    }, $.fn.tab.Constructor = Tab, $.fn.tab.noConflict = function () {
        return $.fn.tab = old, this
    }, $(document).on("click.tab.data-api", '[data-toggle="tab"], [data-toggle="pill"]', function (e) {
        e.preventDefault(), $(this).tab("show")
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Typeahead = function (element, options) {
        this.$element = $(element), this.options = $.extend({}, $.fn.typeahead.defaults, options), this.matcher = this.options.matcher || this.matcher, this.sorter = this.options.sorter || this.sorter, this.highlighter = this.options.highlighter || this.highlighter, this.updater = this.options.updater || this.updater, this.source = this.options.source, this.$menu = $(this.options.menu), this.shown = !1, this.listen()
    };
    Typeahead.prototype = {constructor: Typeahead, select: function () {
        var val = this.$menu.find(".active").attr("data-value");
        return this.$element.val(this.updater(val)).change(), this.hide()
    }, updater: function (item) {
        return item
    }, show: function () {
        var pos = $.extend({}, this.$element.position(), {height: this.$element[0].offsetHeight});
        return this.$menu.insertAfter(this.$element).css({top: pos.top + pos.height, left: pos.left}).show(), this.shown = !0, this
    }, hide: function () {
        return this.$menu.hide(), this.shown = !1, this
    }, lookup: function () {
        var items;
        return this.query = this.$element.val(), !this.query || this.query.length < this.options.minLength ? this.shown ? this.hide() : this : (items = $.isFunction(this.source) ? this.source(this.query, $.proxy(this.process, this)) : this.source, items ? this.process(items) : this)
    }, process: function (items) {
        var that = this;
        return items = $.grep(items, function (item) {
            return that.matcher(item)
        }), items = this.sorter(items), items.length ? this.render(items.slice(0, this.options.items)).show() : this.shown ? this.hide() : this
    }, matcher: function (item) {
        return~item.toLowerCase().indexOf(this.query.toLowerCase())
    }, sorter: function (items) {
        for (var item, beginswith = [], caseSensitive = [], caseInsensitive = []; item = items.shift();)item.toLowerCase().indexOf(this.query.toLowerCase()) ? ~item.indexOf(this.query) ? caseSensitive.push(item) : caseInsensitive.push(item) : beginswith.push(item);
        return beginswith.concat(caseSensitive, caseInsensitive)
    }, highlighter: function (item) {
        var query = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
        return item.replace(new RegExp("(" + query + ")", "ig"), function ($1, match) {
            return"<strong>" + match + "</strong>"
        })
    }, render: function (items) {
        var that = this;
        return items = $(items).map(function (i, item) {
            return i = $(that.options.item).attr("data-value", item), i.find("a").html(that.highlighter(item)), i[0]
        }), items.first().addClass("active"), this.$menu.html(items), this
    }, next: function () {
        var active = this.$menu.find(".active").removeClass("active"), next = active.next();
        next.length || (next = $(this.$menu.find("li")[0])), next.addClass("active")
    }, prev: function () {
        var active = this.$menu.find(".active").removeClass("active"), prev = active.prev();
        prev.length || (prev = this.$menu.find("li").last()), prev.addClass("active")
    }, listen: function () {
        this.$element.on("focus", $.proxy(this.focus, this)).on("blur", $.proxy(this.blur, this)).on("keypress", $.proxy(this.keypress, this)).on("keyup", $.proxy(this.keyup, this)), this.eventSupported("keydown") && this.$element.on("keydown", $.proxy(this.keydown, this)), this.$menu.on("click", $.proxy(this.click, this)).on("mouseenter", "li", $.proxy(this.mouseenter, this)).on("mouseleave", "li", $.proxy(this.mouseleave, this))
    }, eventSupported: function (eventName) {
        var isSupported = eventName in this.$element;
        return isSupported || (this.$element.setAttribute(eventName, "return;"), isSupported = "function" == typeof this.$element[eventName]), isSupported
    }, move: function (e) {
        if (this.shown) {
            switch (e.keyCode) {
                case 9:
                case 13:
                case 27:
                    e.preventDefault();
                    break;
                case 38:
                    e.preventDefault(), this.prev();
                    break;
                case 40:
                    e.preventDefault(), this.next()
            }
            e.stopPropagation()
        }
    }, keydown: function (e) {
        this.suppressKeyPressRepeat = ~$.inArray(e.keyCode, [40, 38, 9, 13, 27]), this.move(e)
    }, keypress: function (e) {
        this.suppressKeyPressRepeat || this.move(e)
    }, keyup: function (e) {
        switch (e.keyCode) {
            case 40:
            case 38:
            case 16:
            case 17:
            case 18:
                break;
            case 9:
            case 13:
                if (!this.shown)return;
                this.select();
                break;
            case 27:
                if (!this.shown)return;
                this.hide();
                break;
            default:
                this.lookup()
        }
        e.stopPropagation(), e.preventDefault()
    }, focus: function () {
        this.focused = !0
    }, blur: function () {
        this.focused = !1, !this.mousedover && this.shown && this.hide()
    }, click: function (e) {
        e.stopPropagation(), e.preventDefault(), this.select(), this.$element.focus()
    }, mouseenter: function (e) {
        this.mousedover = !0, this.$menu.find(".active").removeClass("active"), $(e.currentTarget).addClass("active")
    }, mouseleave: function () {
        this.mousedover = !1, !this.focused && this.shown && this.hide()
    }};
    var old = $.fn.typeahead;
    $.fn.typeahead = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("typeahead"), options = "object" == typeof option && option;
            data || $this.data("typeahead", data = new Typeahead(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.typeahead.defaults = {source: [], items: 8, menu: '<ul class="typeahead dropdown-menu"></ul>', item: '<li><a href="#"></a></li>', minLength: 1}, $.fn.typeahead.Constructor = Typeahead, $.fn.typeahead.noConflict = function () {
        return $.fn.typeahead = old, this
    }, $(document).on("focus.typeahead.data-api", '[data-provide="typeahead"]', function () {
        var $this = $(this);
        $this.data("typeahead") || $this.typeahead($this.data())
    })
}(window.jQuery), !function ($) {
    "use strict";
    var Affix = function (element, options) {
        this.options = $.extend({}, $.fn.affix.defaults, options), this.$window = $(window).on("scroll.affix.data-api", $.proxy(this.checkPosition, this)).on("click.affix.data-api", $.proxy(function () {
            setTimeout($.proxy(this.checkPosition, this), 1)
        }, this)), this.$element = $(element), this.checkPosition()
    };
    Affix.prototype.checkPosition = function () {
        if (this.$element.is(":visible")) {
            var affix, scrollHeight = $(document).height(), scrollTop = this.$window.scrollTop(), position = this.$element.offset(), offset = this.options.offset, offsetBottom = offset.bottom, offsetTop = offset.top, reset = "affix affix-top affix-bottom";
            "object" != typeof offset && (offsetBottom = offsetTop = offset), "function" == typeof offsetTop && (offsetTop = offset.top()), "function" == typeof offsetBottom && (offsetBottom = offset.bottom()), affix = null != this.unpin && scrollTop + this.unpin <= position.top ? !1 : null != offsetBottom && position.top + this.$element.height() >= scrollHeight - offsetBottom ? "bottom" : null != offsetTop && offsetTop >= scrollTop ? "top" : !1, this.affixed !== affix && (this.affixed = affix, this.unpin = "bottom" == affix ? position.top - scrollTop : null, this.$element.removeClass(reset).addClass("affix" + (affix ? "-" + affix : "")))
        }
    };
    var old = $.fn.affix;
    $.fn.affix = function (option) {
        return this.each(function () {
            var $this = $(this), data = $this.data("affix"), options = "object" == typeof option && option;
            data || $this.data("affix", data = new Affix(this, options)), "string" == typeof option && data[option]()
        })
    }, $.fn.affix.Constructor = Affix, $.fn.affix.defaults = {offset: 0}, $.fn.affix.noConflict = function () {
        return $.fn.affix = old, this
    }, $(window).on("load", function () {
        $('[data-spy="affix"]').each(function () {
            var $spy = $(this), data = $spy.data();
            data.offset = data.offset || {}, data.offsetBottom && (data.offset.bottom = data.offsetBottom), data.offsetTop && (data.offset.top = data.offsetTop), $spy.affix(data)
        })
    })
}(window.jQuery), function ($) {
    var converter = {vertical: {x: !1, y: !0}, horizontal: {x: !0, y: !1}, both: {x: !0, y: !0}, x: {x: !0, y: !1}, y: {x: !1, y: !0}}, settings = {duration: "fast", direction: "both"}, rootrx = /^(?:html)$/i, borders = function (domElement, styles) {
        styles = styles || (document.defaultView && document.defaultView.getComputedStyle ? document.defaultView.getComputedStyle(domElement, null) : domElement.currentStyle);
        var px = document.defaultView && document.defaultView.getComputedStyle ? !0 : !1, b = {top: parseFloat(px ? styles.borderTopWidth : $.css(domElement, "borderTopWidth")) || 0, left: parseFloat(px ? styles.borderLeftWidth : $.css(domElement, "borderLeftWidth")) || 0, bottom: parseFloat(px ? styles.borderBottomWidth : $.css(domElement, "borderBottomWidth")) || 0, right: parseFloat(px ? styles.borderRightWidth : $.css(domElement, "borderRightWidth")) || 0};
        return{top: b.top, left: b.left, bottom: b.bottom, right: b.right, vertical: b.top + b.bottom, horizontal: b.left + b.right}
    }, dimensions = function ($element) {
        var win = $(window), isRoot = rootrx.test($element[0].nodeName);
        return{border: isRoot ? {top: 0, left: 0, bottom: 0, right: 0} : borders($element[0]), scroll: {top: (isRoot ? win : $element).scrollTop(), left: (isRoot ? win : $element).scrollLeft()}, scrollbar: {right: isRoot ? 0 : $element.innerWidth() - $element[0].clientWidth, bottom: isRoot ? 0 : $element.innerHeight() - $element[0].clientHeight}, rect: function () {
            var r = $element[0].getBoundingClientRect();
            return{top: isRoot ? 0 : r.top, left: isRoot ? 0 : r.left, bottom: isRoot ? $element[0].clientHeight : r.bottom, right: isRoot ? $element[0].clientWidth : r.right}
        }()}
    };
    $.fn.extend({scrollintoview: function (options) {
        options = $.extend({}, settings, options), options.direction = converter["string" == typeof options.direction && options.direction.toLowerCase()] || converter.both;
        var dirStr = "";
        options.direction.x === !0 && (dirStr = "horizontal"), options.direction.y === !0 && (dirStr = dirStr ? "both" : "vertical");
        var el = this.eq(0), scroller = el.closest(":scrollable(" + dirStr + ")");
        if (scroller.length > 0) {
            scroller = scroller.eq(0);
            var dim = {e: dimensions(el), s: dimensions(scroller)}, rel = {top: dim.e.rect.top - (dim.s.rect.top + dim.s.border.top), bottom: dim.s.rect.bottom - dim.s.border.bottom - dim.s.scrollbar.bottom - dim.e.rect.bottom, left: dim.e.rect.left - (dim.s.rect.left + dim.s.border.left), right: dim.s.rect.right - dim.s.border.right - dim.s.scrollbar.right - dim.e.rect.right}, animOptions = {};
            options.direction.y === !0 && (rel.top < 0 ? animOptions.scrollTop = dim.s.scroll.top + rel.top : rel.top > 0 && rel.bottom < 0 && (animOptions.scrollTop = dim.s.scroll.top + Math.min(rel.top, -rel.bottom))), options.direction.x === !0 && (rel.left < 0 ? animOptions.scrollLeft = dim.s.scroll.left + rel.left : rel.left > 0 && rel.right < 0 && (animOptions.scrollLeft = dim.s.scroll.left + Math.min(rel.left, -rel.right))), $.isEmptyObject(animOptions) ? $.isFunction(options.complete) && options.complete.call(scroller[0]) : (rootrx.test(scroller[0].nodeName) && (scroller = $("html,body")), scroller.animate(animOptions, options.duration).eq(0).queue(function (next) {
                $.isFunction(options.complete) && options.complete.call(scroller[0]), next()
            }))
        }
        return this
    }});
    var scrollValue = {auto: !0, scroll: !0, visible: !1, hidden: !1};
    $.extend($.expr[":"], {scrollable: function (element, index, meta) {
        var direction = converter["string" == typeof meta[3] && meta[3].toLowerCase()] || converter.both, styles = document.defaultView && document.defaultView.getComputedStyle ? document.defaultView.getComputedStyle(element, null) : element.currentStyle, overflow = {x: scrollValue[styles.overflowX.toLowerCase()] || !1, y: scrollValue[styles.overflowY.toLowerCase()] || !1, isRoot: rootrx.test(element.nodeName)};
        if (!overflow.x && !overflow.y && !overflow.isRoot)return!1;
        var size = {height: {scroll: element.scrollHeight, client: element.clientHeight}, width: {scroll: element.scrollWidth, client: element.clientWidth}, scrollableX: function () {
            return(overflow.x || overflow.isRoot) && this.width.scroll > this.width.client
        }, scrollableY: function () {
            return(overflow.y || overflow.isRoot) && this.height.scroll > this.height.client
        }};
        return direction.y && size.scrollableY() || direction.x && size.scrollableX()
    }})
}(jQuery), angular.module("ui.select2", []).value("uiSelect2Config", {}).directive("uiSelect2", ["uiSelect2Config", "$timeout", function (uiSelect2Config, $timeout) {
    var options = {};
    return uiSelect2Config && angular.extend(options, uiSelect2Config), {require: "ngModel", compile: function (tElm, tAttrs) {
        var watch, repeatOption, repeatAttr, isSelect = tElm.is("select"), isMultiple = void 0 !== tAttrs.multiple;
        return tElm.is("select") && (repeatOption = tElm.find("option[ng-repeat], option[data-ng-repeat]"), repeatOption.length && (repeatAttr = repeatOption.attr("ng-repeat") || repeatOption.attr("data-ng-repeat"), watch = jQuery.trim(repeatAttr.split("|")[0]).split(" ").pop())), function (scope, elm, attrs, controller) {
            var opts = angular.extend({}, options, scope.$eval(attrs.uiSelect2));
            if (isSelect ? (delete opts.multiple, delete opts.initSelection) : isMultiple && (opts.multiple = !0), controller && (scope.$watch(tAttrs.ngModel, function (current, old) {
                current && current != old && controller.$render()
            }, !0), controller.$render = function () {
                isSelect ? elm.select2("val", controller.$viewValue) : isMultiple ? controller.$viewValue ? angular.isArray(controller.$viewValue) ? elm.select2("data", controller.$viewValue) : elm.select2("val", controller.$viewValue) : elm.select2("data", []) : angular.isObject(controller.$viewValue) ? elm.select2("data", controller.$viewValue) : controller.$viewValue ? elm.select2("val", controller.$viewValue) : elm.select2("data", null)
            }, watch && scope.$watch(watch, function (newVal) {
                newVal && $timeout(function () {
                    elm.select2("val", controller.$viewValue), elm.trigger("change")
                })
            }), controller.$parsers.push(function (value) {
                var div = elm.prev();
                return div.toggleClass("ng-invalid", !controller.$valid).toggleClass("ng-valid", controller.$valid).toggleClass("ng-invalid-required", !controller.$valid).toggleClass("ng-valid-required", controller.$valid).toggleClass("ng-dirty", controller.$dirty).toggleClass("ng-pristine", controller.$pristine), value
            }), !isSelect && (elm.bind("change", function () {
                scope.$$phase || scope.$apply(function () {
                    controller.$setViewValue(elm.select2("data"))
                })
            }), opts.initSelection))) {
                var initSelection = opts.initSelection;
                opts.initSelection = function (element, callback) {
                    initSelection(element, function (value) {
                        controller.$setViewValue(value), callback(value)
                    })
                }
            }
            elm.bind("$destroy", function () {
                elm.select2("destroy")
            }), attrs.$observe("disabled", function (value) {
                elm.select2("enable", !value)
            }), attrs.$observe("readonly", function (value) {
                elm.select2("readonly", !!value)
            }), attrs.ngMultiple && scope.$watch(attrs.ngMultiple, function () {
                elm.select2(opts)
            }), $timeout(function () {
                elm.select2(opts), elm.val(controller.$viewValue), controller.$render(), opts.initSelection || isSelect || controller.$setViewValue(elm.select2("data"))
            })
        }
    }}
}]), function (window, angular, undefined) {
    "use strict";
    function inherit(parent, extra) {
        return extend(new (extend(function () {
        }, {prototype: parent})), extra)
    }

    function merge(dst) {
        return forEach(arguments, function (obj) {
            obj !== dst && forEach(obj, function (value, key) {
                dst.hasOwnProperty(key) || (dst[key] = value)
            })
        }), dst
    }

    function $TemplateFactory($http, $templateCache, $injector) {
        this.fromConfig = function (config, params, locals) {
            return isDefined(config.template) ? this.fromString(config.template, params) : isDefined(config.templateUrl) ? this.fromUrl(config.templateUrl, params) : isDefined(config.templateProvider) ? this.fromProvider(config.templateProvider, params, locals) : null
        }, this.fromString = function (template, params) {
            return isFunction(template) ? template(params) : template
        }, this.fromUrl = function (url, params) {
            return isFunction(url) && (url = url(params)), null == url ? null : $http.get(url, {cache: $templateCache}).then(function (response) {
                return response.data
            })
        }, this.fromProvider = function (provider, params, locals) {
            return $injector.invoke(provider, null, locals || {params: params})
        }
    }

    function UrlMatcher(pattern) {
        function addParameter(id) {
            if (!/^\w+$/.test(id))throw new Error("Invalid parameter name '" + id + "' in pattern '" + pattern + "'");
            if (names[id])throw new Error("Duplicate parameter name '" + id + "' in pattern '" + pattern + "'");
            names[id] = !0, params.push(id)
        }

        function quoteRegExp(string) {
            return string.replace(/[\\\[\]\^$*+?.()|{}]/g, "\\$&")
        }

        var m, placeholder = /([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g, names = {}, compiled = "^", last = 0, segments = this.segments = [], params = this.params = [];
        this.source = pattern;
        for (var id, regexp, segment; (m = placeholder.exec(pattern)) && (id = m[2] || m[3], regexp = m[4] || ("*" == m[1] ? ".*" : "[^/]*"), segment = pattern.substring(last, m.index), !(segment.indexOf("?") >= 0));)compiled += quoteRegExp(segment) + "(" + regexp + ")", addParameter(id), segments.push(segment), last = placeholder.lastIndex;
        segment = pattern.substring(last);
        var i = segment.indexOf("?");
        if (i >= 0) {
            var search = this.sourceSearch = segment.substring(i);
            segment = segment.substring(0, i), this.sourcePath = pattern.substring(0, last + i), forEach(search.substring(1).split(/[&?]/), addParameter)
        } else this.sourcePath = pattern, this.sourceSearch = "";
        compiled += quoteRegExp(segment) + "$", segments.push(segment), this.regexp = new RegExp(compiled), this.prefix = segments[0]
    }

    function $UrlMatcherFactory() {
        this.compile = function (pattern) {
            return new UrlMatcher(pattern)
        }, this.isMatcher = function (o) {
            return o instanceof UrlMatcher
        }, this.$get = function () {
            return this
        }
    }

    function $UrlRouterProvider($urlMatcherFactory) {
        function regExpPrefix(re) {
            var prefix = /^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);
            return null != prefix ? prefix[1].replace(/\\(.)/g, "$1") : ""
        }

        function interpolate(pattern, match) {
            return pattern.replace(/\$(\$|\d{1,2})/, function (m, what) {
                return match["$" === what ? 0 : Number(what)]
            })
        }

        function handleIfMatch($injector, handler, match) {
            if (!match)return!1;
            var result = $injector.invoke(handler, handler, {$match: match});
            return isDefined(result) ? result : !0
        }

        var rules = [], otherwise = null;
        this.rule = function (rule) {
            if (!isFunction(rule))throw new Error("'rule' must be a function");
            return rules.push(rule), this
        }, this.otherwise = function (rule) {
            if (isString(rule)) {
                var redirect = rule;
                rule = function () {
                    return redirect
                }
            } else if (!isFunction(rule))throw new Error("'rule' must be a function");
            return otherwise = rule, this
        }, this.when = function (what, handler) {
            var rule, redirect;
            if (isString(what) && (what = $urlMatcherFactory.compile(what)), $urlMatcherFactory.isMatcher(what)) {
                if (isString(handler))redirect = $urlMatcherFactory.compile(handler), handler = ["$match", function ($match) {
                    return redirect.format($match)
                }]; else if (!isFunction(handler) && !isArray(handler))throw new Error("invalid 'handler' in when()");
                rule = function ($injector, $location) {
                    return handleIfMatch($injector, handler, what.exec($location.path(), $location.search()))
                }, rule.prefix = isString(what.prefix) ? what.prefix : ""
            } else {
                if (!(what instanceof RegExp))throw new Error("invalid 'what' in when()");
                if (isString(handler))redirect = handler, handler = ["$match", function ($match) {
                    return interpolate(redirect, $match)
                }]; else if (!isFunction(handler) && !isArray(handler))throw new Error("invalid 'handler' in when()");
                if (what.global || what.sticky)throw new Error("when() RegExp must not be global or sticky");
                rule = function ($injector, $location) {
                    return handleIfMatch($injector, handler, what.exec($location.path()))
                }, rule.prefix = regExpPrefix(what)
            }
            return this.rule(rule)
        }, this.$get = ["$location", "$rootScope", "$injector", function ($location, $rootScope, $injector) {
            function update() {
                var i, handled, n = rules.length;
                for (i = 0; n > i; i++)if (handled = rules[i]($injector, $location)) {
                    isString(handled) && $location.replace().url(handled);
                    break
                }
            }

            return otherwise && rules.push(otherwise), $rootScope.$on("$locationChangeSuccess", update), {}
        }]
    }

    function $StateProvider($urlRouterProvider, $urlMatcherFactory) {
        function findState(stateOrName) {
            var state;
            if (isString(stateOrName)) {
                if (state = states[stateOrName], !state)throw new Error("No such state '" + stateOrName + "'")
            } else if (state = states[stateOrName.name], !state || state !== stateOrName && state.self !== stateOrName)throw new Error("Invalid or unregistered state");
            return state
        }

        function registerState(state) {
            state = inherit(state, {self: state, toString: function () {
                return this.name
            }});
            var name = state.name;
            if (!isString(name) || name.indexOf("@") >= 0)throw new Error("State must have a valid name");
            if (states[name])throw new Error("State '" + name + "'' is already defined");
            var parent = root;
            if (isDefined(state.parent))null != state.parent && (parent = findState(state.parent)); else {
                var compositeName = /^(.+)\.[^.]+$/.exec(name);
                null != compositeName && (parent = findState(compositeName[1]))
            }
            state.parent = parent;
            var url = state.url;
            if (isString(url))url = state.url = "^" == url.charAt(0) ? $urlMatcherFactory.compile(url.substring(1)) : (parent.navigable || root).url.concat(url); else if (isObject(url) && isFunction(url.exec) && isFunction(url.format) && isFunction(url.concat)); else if (null != url)throw new Error("Invalid url '" + url + "' in state '" + state + "'");
            state.navigable = url ? state : parent ? parent.navigable : null;
            var params = state.params;
            if (params) {
                if (!isArray(params))throw new Error("Invalid params in state '" + state + "'");
                if (url)throw new Error("Both params and url specicified in state '" + state + "'")
            } else params = state.params = url ? url.parameters() : state.parent.params;
            var paramNames = {};
            if (forEach(params, function (p) {
                paramNames[p] = !0
            }), parent) {
                forEach(parent.params, function (p) {
                    if (!paramNames[p])throw new Error("Missing required parameter '" + p + "' in state '" + name + "'");
                    paramNames[p] = !1
                });
                var ownParams = state.ownParams = [];
                forEach(paramNames, function (own, p) {
                    own && ownParams.push(p)
                })
            } else state.ownParams = params;
            var views = {};
            forEach(isDefined(state.views) ? state.views : {"": state}, function (view, name) {
                name.indexOf("@") < 0 && (name = name + "@" + state.parent.name), views[name] = view
            }), state.views = views, state.path = parent ? parent.path.concat(state) : [];
            var includes = state.includes = parent ? extend({}, parent.includes) : {};
            return includes[name] = !0, state.resolve || (state.resolve = {}), !state["abstract"] && url && $urlRouterProvider.when(url, ["$match", function ($match) {
                $state.transitionTo(state, $match, !1)
            }]), states[name] = state, state
        }

        function state(name, definition) {
            return isObject(name) ? definition = name : definition.name = name, registerState(definition), this
        }

        function $get($rootScope, $q, $templateFactory, $injector, $stateParams, $location) {
            function resolveState(state, params, paramsAreFiltered, inherited, dst) {
                function resolve(deps, dst) {
                    forEach(deps, function (value, key) {
                        promises.push($q.when(isString(value) ? $injector.get(value) : $injector.invoke(value, state.self, locals)).then(function (result) {
                            dst[key] = result
                        }))
                    })
                }

                var $stateParams, promises = [inherited];
                paramsAreFiltered ? $stateParams = params : ($stateParams = {}, forEach(state.params, function (name) {
                    $stateParams[name] = params[name]
                }));
                var locals = {$stateParams: $stateParams}, globals = dst.globals = {$stateParams: $stateParams};
                return resolve(state.resolve, globals), globals.$$state = state, forEach(state.views, function (view, name) {
                    var $view = dst[name] = {$$controller: view.controller};
                    promises.push($q.when($templateFactory.fromConfig(view, $stateParams, locals) || "").then(function (result) {
                        $view.$template = result
                    })), view.resolve !== state.resolve && resolve(view.resolve, $view)
                }), $q.all(promises).then(function (values) {
                    return merge(dst.globals, values[0].globals), forEach(state.views, function (view, name) {
                        merge(dst[name], dst.globals)
                    }), dst
                })
            }

            function normalize(keys, values) {
                var normalized = {};
                return forEach(keys, function (name) {
                    var value = values[name];
                    normalized[name] = null != value ? String(value) : null
                }), normalized
            }

            function equalForKeys(a, b, keys) {
                for (var i = 0; i < keys.length; i++) {
                    var k = keys[i];
                    if (a[k] != b[k])return!1
                }
                return!0
            }

            var TransitionSuperseded = $q.reject(new Error("transition superseded")), TransitionPrevented = $q.reject(new Error("transition prevented"));
            return $state = {params: {}, current: root.self, $current: root, transition: null}, $state.transitionTo = function (to, toParams, updateLocation) {
                if (isDefined(updateLocation) || (updateLocation = !0), to = findState(to), to["abstract"])throw new Error("Cannot transition to abstract state '" + to + "'");
                var keep, state, toPath = to.path, from = $state.$current, fromParams = $state.params, fromPath = from.path, locals = root.locals, toLocals = [];
                for (keep = 0, state = toPath[keep]; state && state === fromPath[keep] && equalForKeys(toParams, fromParams, state.ownParams); keep++, state = toPath[keep])locals = toLocals[keep] = state.locals;
                if (to === from && locals === from.locals)return $state.transition = null, $q.when($state.current);
                if (toParams = normalize(to.params, toParams || {}), $rootScope.$broadcast("$stateChangeStart", to.self, toParams, from.self, fromParams).defaultPrevented)return TransitionPrevented;
                for (var resolved = $q.when(locals), l = keep; l < toPath.length; l++, state = toPath[l])locals = toLocals[l] = inherit(locals), resolved = resolveState(state, toParams, state === to, resolved, locals);
                var transition = $state.transition = resolved.then(function () {
                    var l, entering, exiting;
                    if ($state.transition !== transition)return TransitionSuperseded;
                    for (l = fromPath.length - 1; l >= keep; l--)exiting = fromPath[l], exiting.self.onExit && $injector.invoke(exiting.self.onExit, exiting.self, exiting.locals.globals), exiting.locals = null;
                    for (l = keep; l < toPath.length; l++)entering = toPath[l], entering.locals = toLocals[l], entering.self.onEnter && $injector.invoke(entering.self.onEnter, entering.self, entering.locals.globals);
                    $state.$current = to, $state.current = to.self, $state.params = toParams, copy($state.params, $stateParams), $state.transition = null;
                    var toNav = to.navigable;
                    return updateLocation && toNav && $location.url(toNav.url.format(toNav.locals.globals.$stateParams)), $rootScope.$broadcast("$stateChangeSuccess", to.self, toParams, from.self, fromParams), $state.current
                }, function (error) {
                    return $state.transition !== transition ? TransitionSuperseded : ($state.transition = null, $rootScope.$broadcast("$stateChangeError", to.self, toParams, from.self, fromParams, error), $q.reject(error))
                });
                return transition
            }, $state.is = function (stateOrName) {
                return $state.$current === findState(stateOrName)
            }, $state.includes = function (stateOrName) {
                return $state.$current.includes[findState(stateOrName).name]
            }, $state.href = function (stateOrName, params) {
                var state = findState(stateOrName), nav = state.navigable;
                if (!nav)throw new Error("State '" + state + "' is not navigable");
                return nav.url.format(normalize(state.params, params || {}))
            }, $state
        }

        var root, $state, states = {};
        root = registerState({name: "", url: "^", views: null, "abstract": !0}), root.locals = {globals: {$stateParams: {}}}, root.navigable = null, this.state = state, this.$get = $get, $get.$inject = ["$rootScope", "$q", "$templateFactory", "$injector", "$stateParams", "$location", "$urlRouter"]
    }

    function $ViewDirective($state, $compile, $controller, $injector, $anchorScroll) {
        var $animator;
        try {
            $animator = $injector.get("$animator")
        } catch (e) {
        }
        var directive = {restrict: "ECA", terminal: !0, link: function (scope, element, attr) {
            function updateView(doAnimate) {
                var locals = $state.$current && $state.$current.locals[name];
                if (locals !== viewLocals)if (viewScope && (animate && doAnimate ? animate.leave(element.contents(), element) : element.html(""), viewScope.$destroy(), viewScope = null), locals) {
                    viewLocals = locals, view.state = locals.$$state;
                    var contents;
                    animate && doAnimate ? (contents = angular.element("<div></div>").html(locals.$template).contents(), animate.enter(contents, element)) : (element.html(locals.$template), contents = element.contents());
                    var link = $compile(contents);
                    if (viewScope = scope.$new(), locals.$$controller) {
                        locals.$scope = viewScope;
                        var controller = $controller(locals.$$controller, locals);
                        element.children().data("$ngControllerController", controller)
                    }
                    link(viewScope), viewScope.$emit("$viewContentLoaded"), viewScope.$eval(onloadExp), $anchorScroll()
                } else viewLocals = null, view.state = null
            }

            var viewScope, viewLocals, name = attr[directive.name] || attr.name || "", onloadExp = attr.onload || "", animate = isDefined($animator) && $animator(scope, attr), parent = element.parent().inheritedData("$uiView");
            name.indexOf("@") < 0 && (name = name + "@" + (parent ? parent.state.name : ""));
            var view = {name: name, state: null};
            element.data("$uiView", view), scope.$on("$stateChangeSuccess", function () {
                updateView(!0)
            }), updateView(!1)
        }};
        return directive
    }

    function $RouteProvider($stateProvider, $urlRouterProvider) {
        function onEnterRoute($$state) {
            this.locals = $$state.locals.globals, this.params = this.locals.$stateParams
        }

        function onExitRoute() {
            this.locals = null, this.params = null
        }

        function when(url, route) {
            if (null != route.redirectTo) {
                var handler, redirect = route.redirectTo;
                if (isString(redirect))handler = redirect; else {
                    if (!isFunction(redirect))throw new Error("Invalid 'redirectTo' in when()");
                    handler = function (params, $location) {
                        return redirect(params, $location.path(), $location.search())
                    }
                }
                $urlRouterProvider.when(url, handler)
            } else $stateProvider.state(inherit(route, {parent: null, name: "route:" + encodeURIComponent(url), url: url, onEnter: onEnterRoute, onExit: onExitRoute}));
            return routes.push(route), this
        }

        function $get($state, $rootScope, $routeParams) {
            function stateAsRoute(state) {
                return"" !== state.name ? state : undefined
            }

            var $route = {routes: routes, params: $routeParams, current: undefined};
            return $rootScope.$on("$stateChangeStart", function (ev, to, toParams, from) {
                $rootScope.$broadcast("$routeChangeStart", stateAsRoute(to), stateAsRoute(from))
            }), $rootScope.$on("$stateChangeSuccess", function (ev, to, toParams, from) {
                $route.current = stateAsRoute(to), $rootScope.$broadcast("$routeChangeSuccess", stateAsRoute(to), stateAsRoute(from)), copy(toParams, $route.params)
            }), $rootScope.$on("$stateChangeError", function (ev, to, toParams, from, fromParams, error) {
                $rootScope.$broadcast("$routeChangeError", stateAsRoute(to), stateAsRoute(from), error)
            }), $route
        }

        var routes = [];
        onEnterRoute.$inject = ["$$state"], this.when = when, this.$get = $get, $get.$inject = ["$state", "$rootScope", "$routeParams"]
    }

    var isDefined = angular.isDefined, isFunction = angular.isFunction, isString = angular.isString, isObject = angular.isObject, isArray = angular.isArray, forEach = angular.forEach, extend = angular.extend, copy = angular.copy;
    angular.module("ui.util", ["ng"]), angular.module("ui.router", ["ui.util"]), angular.module("ui.state", ["ui.router", "ui.util"]), angular.module("ui.compat", ["ui.state"]), $TemplateFactory.$inject = ["$http", "$templateCache", "$injector"], angular.module("ui.util").service("$templateFactory", $TemplateFactory), UrlMatcher.prototype.concat = function (pattern) {
        return new UrlMatcher(this.sourcePath + pattern + this.sourceSearch)
    }, UrlMatcher.prototype.toString = function () {
        return this.source
    }, UrlMatcher.prototype.exec = function (path, searchParams) {
        var m = this.regexp.exec(path);
        if (!m)return null;
        var i, params = this.params, nTotal = params.length, nPath = this.segments.length - 1, values = {};
        for (i = 0; nPath > i; i++)values[params[i]] = decodeURIComponent(m[i + 1]);
        for (; nTotal > i; i++)values[params[i]] = searchParams[params[i]];
        return values
    }, UrlMatcher.prototype.parameters = function () {
        return this.params
    }, UrlMatcher.prototype.format = function (values) {
        var segments = this.segments, params = this.params;
        if (!values)return segments.join("");
        var i, search, value, nPath = segments.length - 1, nTotal = params.length, result = segments[0];
        for (i = 0; nPath > i; i++)value = values[params[i]], null != value && (result += value), result += segments[i + 1];
        for (; nTotal > i; i++)value = values[params[i]], null != value && (result += (search ? "&" : "?") + params[i] + "=" + encodeURIComponent(value), search = !0);
        return result
    }, angular.module("ui.util").provider("$urlMatcherFactory", $UrlMatcherFactory), $UrlRouterProvider.$inject = ["$urlMatcherFactoryProvider"], angular.module("ui.router").provider("$urlRouter", $UrlRouterProvider), $StateProvider.$inject = ["$urlRouterProvider", "$urlMatcherFactoryProvider"], angular.module("ui.state").value("$stateParams", {}).provider("$state", $StateProvider), $ViewDirective.$inject = ["$state", "$compile", "$controller", "$injector", "$anchorScroll"], angular.module("ui.state").directive("uiView", $ViewDirective), $RouteProvider.$inject = ["$stateProvider", "$urlRouterProvider"], angular.module("ui.compat").provider("$route", $RouteProvider).directive("ngView", $ViewDirective)
}(window, window.angular), angular.module("ui.bootstrap", ["ui.bootstrap.transition", "ui.bootstrap.collapse", "ui.bootstrap.accordion", "ui.bootstrap.carousel", "ui.bootstrap.position", "ui.bootstrap.datepicker", "ui.bootstrap.dialog", "ui.bootstrap.modal", "ui.bootstrap.tooltip"]), angular.module("ui.bootstrap.transition", []).factory("$transition", ["$q", "$timeout", "$rootScope", function ($q, $timeout, $rootScope) {
    function findEndEventName(endEventNames) {
        for (var name in endEventNames)if (void 0 !== transElement.style[name])return endEventNames[name]
    }

    var $transition = function (element, trigger, options) {
        options = options || {};
        var deferred = $q.defer(), endEventName = $transition[options.animation ? "animationEndEventName" : "transitionEndEventName"], transitionEndHandler = function () {
            $rootScope.$apply(function () {
                element.unbind(endEventName, transitionEndHandler), deferred.resolve(element)
            })
        };
        return endEventName && element.bind(endEventName, transitionEndHandler), $timeout(function () {
            angular.isString(trigger) ? element.addClass(trigger) : angular.isFunction(trigger) ? trigger(element) : angular.isObject(trigger) && element.css(trigger), endEventName || deferred.resolve(element)
        }), deferred.promise.cancel = function () {
            endEventName && element.unbind(endEventName, transitionEndHandler), deferred.reject("Transition cancelled")
        }, deferred.promise
    }, transElement = document.createElement("trans"), transitionEndEventNames = {WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd", transition: "transitionend"}, animationEndEventNames = {WebkitTransition: "webkitAnimationEnd", MozTransition: "animationend", OTransition: "oAnimationEnd", transition: "animationend"};
    return $transition.transitionEndEventName = findEndEventName(transitionEndEventNames), $transition.animationEndEventName = findEndEventName(animationEndEventNames), $transition
}]), angular.module("ui.bootstrap.collapse", ["ui.bootstrap.transition"]).directive("collapse", ["$transition", function ($transition) {
    var fixUpHeight = function (scope, element, height) {
        element.removeClass("collapse"), element.css({height: height}), element[0].offsetWidth, element.addClass("collapse")
    };
    return{link: function (scope, element, attrs) {
        var isCollapsed, initialAnimSkip = !0;
        scope.$watch(function () {
            return element[0].scrollHeight
        }, function () {
            0 !== element[0].scrollHeight && (isCollapsed || (initialAnimSkip ? fixUpHeight(scope, element, element[0].scrollHeight + "px") : fixUpHeight(scope, element, "auto")))
        }), scope.$watch(attrs.collapse, function (value) {
            value ? collapse() : expand()
        });
        var currentTransition, doTransition = function (change) {
            return currentTransition && currentTransition.cancel(), currentTransition = $transition(element, change), currentTransition.then(function () {
                currentTransition = void 0
            }, function () {
                currentTransition = void 0
            }), currentTransition
        }, expand = function () {
            initialAnimSkip ? (initialAnimSkip = !1, isCollapsed || fixUpHeight(scope, element, "auto")) : doTransition({height: element[0].scrollHeight + "px"}).then(function () {
                isCollapsed || fixUpHeight(scope, element, "auto")
            }), isCollapsed = !1
        }, collapse = function () {
            isCollapsed = !0, initialAnimSkip ? (initialAnimSkip = !1, fixUpHeight(scope, element, 0)) : (fixUpHeight(scope, element, element[0].scrollHeight + "px"), doTransition({height: "0"}))
        }
    }}
}]), angular.module("ui.bootstrap.accordion", ["ui.bootstrap.collapse"]).constant("accordionConfig", {closeOthers: !0}).controller("AccordionController", ["$scope", "$attrs", "accordionConfig", function ($scope, $attrs, accordionConfig) {
    this.groups = [], this.closeOthers = function (openGroup) {
        var closeOthers = angular.isDefined($attrs.closeOthers) ? $scope.$eval($attrs.closeOthers) : accordionConfig.closeOthers;
        closeOthers && angular.forEach(this.groups, function (group) {
            group !== openGroup && (group.isOpen = !1)
        })
    }, this.addGroup = function (groupScope) {
        var that = this;
        this.groups.push(groupScope), groupScope.$on("$destroy", function () {
            that.removeGroup(groupScope)
        })
    }, this.removeGroup = function (group) {
        var index = this.groups.indexOf(group);
        -1 !== index && this.groups.splice(this.groups.indexOf(group), 1)
    }
}]).directive("accordion",function () {
    return{restrict: "EA", controller: "AccordionController", transclude: !0, replace: !1, templateUrl: "template/accordion/accordion.html"}
}).directive("accordionGroup", ["$parse", "$transition", "$timeout", function ($parse) {
    return{require: "^accordion", restrict: "EA", transclude: !0, replace: !0, templateUrl: "template/accordion/accordion-group.html", scope: {heading: "@"}, controller: ["$scope", function () {
        this.setHeading = function (element) {
            this.heading = element
        }
    }], link: function (scope, element, attrs, accordionCtrl) {
        var getIsOpen, setIsOpen;
        accordionCtrl.addGroup(scope), scope.isOpen = !1, attrs.isOpen && (getIsOpen = $parse(attrs.isOpen), setIsOpen = getIsOpen.assign, scope.$watch(function () {
            return getIsOpen(scope.$parent)
        }, function (value) {
            scope.isOpen = value
        }), scope.isOpen = getIsOpen ? getIsOpen(scope.$parent) : !1), scope.$watch("isOpen", function (value) {
            value && accordionCtrl.closeOthers(scope), setIsOpen && setIsOpen(scope.$parent, value)
        })
    }}
}]).directive("accordionHeading",function () {
    return{restrict: "EA", transclude: !0, template: "", replace: !0, require: "^accordionGroup", compile: function (element, attr, transclude) {
        return function (scope, element, attr, accordionGroupCtrl) {
            accordionGroupCtrl.setHeading(transclude(scope, function () {
            }))
        }
    }}
}).directive("accordionTransclude", function () {
    return{require: "^accordionGroup", link: function (scope, element, attr, controller) {
        scope.$watch(function () {
            return controller[attr.accordionTransclude]
        }, function (heading) {
            heading && (element.html(""), element.append(heading))
        })
    }}
}), angular.module("ui.bootstrap.carousel", ["ui.bootstrap.transition"]).controller("CarouselController", ["$scope", "$timeout", "$transition", "$q", function ($scope, $timeout, $transition) {
    function restartTimer() {
        function go() {
            isPlaying ? ($scope.next(), restartTimer()) : $scope.pause()
        }

        currentTimeout && $timeout.cancel(currentTimeout);
        var interval = +$scope.interval;
        !isNaN(interval) && interval >= 0 && (currentTimeout = $timeout(go, interval))
    }

    var currentTimeout, isPlaying, self = this, slides = self.slides = [], currentIndex = -1;
    self.currentSlide = null, self.select = function (nextSlide, direction) {
        function goNext() {
            self.currentSlide && angular.isString(direction) && !$scope.noTransition && nextSlide.$element ? (nextSlide.$element.addClass(direction), nextSlide.$element[0].offsetWidth = nextSlide.$element[0].offsetWidth, angular.forEach(slides, function (slide) {
                angular.extend(slide, {direction: "", entering: !1, leaving: !1, active: !1})
            }), angular.extend(nextSlide, {direction: direction, active: !0, entering: !0}), angular.extend(self.currentSlide || {}, {direction: direction, leaving: !0}), $scope.$currentTransition = $transition(nextSlide.$element, {}), function (next, current) {
                $scope.$currentTransition.then(function () {
                    transitionDone(next, current)
                }, function () {
                    transitionDone(next, current)
                })
            }(nextSlide, self.currentSlide)) : transitionDone(nextSlide, self.currentSlide), self.currentSlide = nextSlide, currentIndex = nextIndex, restartTimer()
        }

        function transitionDone(next, current) {
            angular.extend(next, {direction: "", active: !0, leaving: !1, entering: !1}), angular.extend(current || {}, {direction: "", active: !1, leaving: !1, entering: !1}), $scope.$currentTransition = null
        }

        var nextIndex = slides.indexOf(nextSlide);
        void 0 === direction && (direction = nextIndex > currentIndex ? "next" : "prev"), nextSlide && nextSlide !== self.currentSlide && ($scope.$currentTransition ? ($scope.$currentTransition.cancel(), $timeout(goNext)) : goNext())
    }, self.indexOfSlide = function (slide) {
        return slides.indexOf(slide)
    }, $scope.next = function () {
        var newIndex = (currentIndex + 1) % slides.length;
        return $scope.$currentTransition ? void 0 : self.select(slides[newIndex], "next")
    }, $scope.prev = function () {
        var newIndex = 0 > currentIndex - 1 ? slides.length - 1 : currentIndex - 1;
        return $scope.$currentTransition ? void 0 : self.select(slides[newIndex], "prev")
    }, $scope.select = function (slide) {
        self.select(slide)
    }, $scope.isActive = function (slide) {
        return self.currentSlide === slide
    }, $scope.slides = function () {
        return slides
    }, $scope.$watch("interval", restartTimer), $scope.play = function () {
        isPlaying || (isPlaying = !0, restartTimer())
    }, $scope.pause = function () {
        $scope.noPause || (isPlaying = !1, currentTimeout && $timeout.cancel(currentTimeout))
    }, self.addSlide = function (slide, element) {
        slide.$element = element, slides.push(slide), 1 === slides.length || slide.active ? (self.select(slides[slides.length - 1]), 1 == slides.length && $scope.play()) : slide.active = !1
    }, self.removeSlide = function (slide) {
        var index = slides.indexOf(slide);
        slides.splice(index, 1), slides.length > 0 && slide.active ? index >= slides.length ? self.select(slides[index - 1]) : self.select(slides[index]) : currentIndex > index && currentIndex--
    }
}]).directive("carousel", [function () {
    return{restrict: "EA", transclude: !0, replace: !0, controller: "CarouselController", require: "carousel", templateUrl: "template/carousel/carousel.html", scope: {interval: "=", noTransition: "=", noPause: "="}}
}]).directive("slide", ["$parse", function ($parse) {
    return{require: "^carousel", restrict: "EA", transclude: !0, replace: !0, templateUrl: "template/carousel/slide.html", scope: {}, link: function (scope, element, attrs, carouselCtrl) {
        if (attrs.active) {
            var getActive = $parse(attrs.active), setActive = getActive.assign, lastValue = scope.active = getActive(scope.$parent);
            scope.$watch(function () {
                var parentActive = getActive(scope.$parent);
                return parentActive !== scope.active && (parentActive !== lastValue ? lastValue = scope.active = parentActive : setActive(scope.$parent, parentActive = lastValue = scope.active)), parentActive
            })
        }
        carouselCtrl.addSlide(scope, element), scope.$on("$destroy", function () {
            carouselCtrl.removeSlide(scope)
        }), scope.$watch("active", function (active) {
            active && carouselCtrl.select(scope)
        })
    }}
}]), angular.module("ui.bootstrap.position", []).factory("$position", ["$document", "$window", function ($document, $window) {
    function getStyle(el, cssprop) {
        return el.currentStyle ? el.currentStyle[cssprop] : $window.getComputedStyle ? $window.getComputedStyle(el)[cssprop] : el.style[cssprop]
    }

    function isStaticPositioned(element) {
        return"static" === (getStyle(element, "position") || "static")
    }

    var mouseX, mouseY;
    $document.bind("mousemove", function (event) {
        mouseX = event.pageX, mouseY = event.pageY
    });
    var parentOffsetEl = function (element) {
        for (var docDomEl = $document[0], offsetParent = element.offsetParent || docDomEl; offsetParent && offsetParent !== docDomEl && isStaticPositioned(offsetParent);)offsetParent = offsetParent.offsetParent;
        return offsetParent || docDomEl
    };
    return{position: function (element) {
        var elBCR = this.offset(element), offsetParentBCR = {top: 0, left: 0}, offsetParentEl = parentOffsetEl(element[0]);
        return offsetParentEl != $document[0] && (offsetParentBCR = this.offset(angular.element(offsetParentEl)), offsetParentBCR.top += offsetParentEl.clientTop - offsetParentEl.scrollTop, offsetParentBCR.left += offsetParentEl.clientLeft - offsetParentEl.scrollLeft), {width: element.prop("offsetWidth"), height: element.prop("offsetHeight"), top: elBCR.top - offsetParentBCR.top, left: elBCR.left - offsetParentBCR.left}
    }, offset: function (element) {
        var boundingClientRect = element[0].getBoundingClientRect();
        return{width: element.prop("offsetWidth"), height: element.prop("offsetHeight"), top: boundingClientRect.top + ($window.pageYOffset || $document[0].body.scrollTop), left: boundingClientRect.left + ($window.pageXOffset || $document[0].body.scrollLeft)}
    }, mouse: function () {
        return{x: mouseX, y: mouseY}
    }}
}]), angular.module("ui.bootstrap.datepicker", ["ui.bootstrap.position"]).constant("datepickerConfig", {dayFormat: "dd", monthFormat: "MMMM", yearFormat: "yyyy", dayHeaderFormat: "EEE", dayTitleFormat: "MMMM yyyy", monthTitleFormat: "yyyy", showWeeks: !0, startingDay: 0, yearRange: 20, minDate: null, maxDate: null}).controller("DatepickerController", ["$scope", "$attrs", "dateFilter", "datepickerConfig", function ($scope, $attrs, dateFilter, dtConfig) {
    function getValue(value, defaultValue) {
        return angular.isDefined(value) ? $scope.$parent.$eval(value) : defaultValue
    }

    function getDaysInMonth(year, month) {
        return new Date(year, month, 0).getDate()
    }

    function getDates(startDate, n) {
        for (var dates = new Array(n), current = startDate, i = 0; n > i;)dates[i++] = new Date(current), current.setDate(current.getDate() + 1);
        return dates
    }

    function makeDate(date, format, isSelected, isSecondary) {
        return{date: date, label: dateFilter(date, format), selected: !!isSelected, secondary: !!isSecondary}
    }

    var format = {day: getValue($attrs.dayFormat, dtConfig.dayFormat), month: getValue($attrs.monthFormat, dtConfig.monthFormat), year: getValue($attrs.yearFormat, dtConfig.yearFormat), dayHeader: getValue($attrs.dayHeaderFormat, dtConfig.dayHeaderFormat), dayTitle: getValue($attrs.dayTitleFormat, dtConfig.dayTitleFormat), monthTitle: getValue($attrs.monthTitleFormat, dtConfig.monthTitleFormat)}, startingDay = getValue($attrs.startingDay, dtConfig.startingDay), yearRange = getValue($attrs.yearRange, dtConfig.yearRange);
    this.minDate = dtConfig.minDate ? new Date(dtConfig.minDate) : null, this.maxDate = dtConfig.maxDate ? new Date(dtConfig.maxDate) : null, this.modes = [
        {name: "day", getVisibleDates: function (date, selected) {
            var year = date.getFullYear(), month = date.getMonth(), firstDayOfMonth = new Date(year, month, 1), difference = startingDay - firstDayOfMonth.getDay(), numDisplayedFromPreviousMonth = difference > 0 ? 7 - difference : -difference, firstDate = new Date(firstDayOfMonth), numDates = 0;
            numDisplayedFromPreviousMonth > 0 && (firstDate.setDate(-numDisplayedFromPreviousMonth + 1), numDates += numDisplayedFromPreviousMonth), numDates += getDaysInMonth(year, month + 1), numDates += (7 - numDates % 7) % 7;
            for (var days = getDates(firstDate, numDates), labels = new Array(7), i = 0; numDates > i; i++) {
                var dt = new Date(days[i]);
                days[i] = makeDate(dt, format.day, selected && selected.getDate() === dt.getDate() && selected.getMonth() === dt.getMonth() && selected.getFullYear() === dt.getFullYear(), dt.getMonth() !== month)
            }
            for (var j = 0; 7 > j; j++)labels[j] = dateFilter(days[j].date, format.dayHeader);
            return{objects: days, title: dateFilter(date, format.dayTitle), labels: labels}
        }, compare: function (date1, date2) {
            return new Date(date1.getFullYear(), date1.getMonth(), date1.getDate()) - new Date(date2.getFullYear(), date2.getMonth(), date2.getDate())
        }, split: 7, step: {months: 1}},
        {name: "month", getVisibleDates: function (date, selected) {
            for (var months = new Array(12), year = date.getFullYear(), i = 0; 12 > i; i++) {
                var dt = new Date(year, i, 1);
                months[i] = makeDate(dt, format.month, selected && selected.getMonth() === i && selected.getFullYear() === year)
            }
            return{objects: months, title: dateFilter(date, format.monthTitle)}
        }, compare: function (date1, date2) {
            return new Date(date1.getFullYear(), date1.getMonth()) - new Date(date2.getFullYear(), date2.getMonth())
        }, split: 3, step: {years: 1}},
        {name: "year", getVisibleDates: function (date, selected) {
            for (var years = new Array(yearRange), year = date.getFullYear(), startYear = parseInt((year - 1) / yearRange, 10) * yearRange + 1, i = 0; yearRange > i; i++) {
                var dt = new Date(startYear + i, 0, 1);
                years[i] = makeDate(dt, format.year, selected && selected.getFullYear() === dt.getFullYear())
            }
            return{objects: years, title: [years[0].label, years[yearRange - 1].label].join(" - ")}
        }, compare: function (date1, date2) {
            return date1.getFullYear() - date2.getFullYear()
        }, split: 5, step: {years: yearRange}}
    ], this.isDisabled = function (date, mode) {
        var currentMode = this.modes[mode || 0];
        return this.minDate && currentMode.compare(date, this.minDate) < 0 || this.maxDate && currentMode.compare(date, this.maxDate) > 0 || $scope.dateDisabled && $scope.dateDisabled({date: date, mode: currentMode.name})
    }
}]).directive("datepicker", ["dateFilter", "$parse", "datepickerConfig", "$log", function (dateFilter, $parse, datepickerConfig, $log) {
    return{restrict: "EA", replace: !0, templateUrl: "template/datepicker/datepicker.html", scope: {dateDisabled: "&"}, require: ["datepicker", "?^ngModel"], controller: "DatepickerController", link: function (scope, element, attrs, ctrls) {
        function updateShowWeekNumbers() {
            scope.showWeekNumbers = 0 === mode && showWeeks
        }

        function split(arr, size) {
            for (var arrays = []; arr.length > 0;)arrays.push(arr.splice(0, size));
            return arrays
        }

        function refill(updateSelected) {
            var date = null, valid = !0;
            ngModel.$modelValue && (date = new Date(ngModel.$modelValue), isNaN(date) ? (valid = !1, $log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')) : updateSelected && (selected = date)), ngModel.$setValidity("date", valid);
            var currentMode = datepickerCtrl.modes[mode], data = currentMode.getVisibleDates(selected, date);
            angular.forEach(data.objects, function (obj) {
                obj.disabled = datepickerCtrl.isDisabled(obj.date, mode)
            }), ngModel.$setValidity("date-disabled", !date || !datepickerCtrl.isDisabled(date)), scope.rows = split(data.objects, currentMode.split), scope.labels = data.labels || [], scope.title = data.title
        }

        function setMode(value) {
            mode = value, updateShowWeekNumbers(), refill()
        }

        function getISO8601WeekNumber(date) {
            var checkDate = new Date(date);
            checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));
            var time = checkDate.getTime();
            return checkDate.setMonth(0), checkDate.setDate(1), Math.floor(Math.round((time - checkDate) / 864e5) / 7) + 1
        }

        var datepickerCtrl = ctrls[0], ngModel = ctrls[1];
        if (ngModel) {
            var mode = 0, selected = new Date, showWeeks = datepickerConfig.showWeeks;
            attrs.showWeeks ? scope.$parent.$watch($parse(attrs.showWeeks), function (value) {
                showWeeks = !!value, updateShowWeekNumbers()
            }) : updateShowWeekNumbers(), attrs.min && scope.$parent.$watch($parse(attrs.min), function (value) {
                datepickerCtrl.minDate = value ? new Date(value) : null, refill()
            }), attrs.max && scope.$parent.$watch($parse(attrs.max), function (value) {
                datepickerCtrl.maxDate = value ? new Date(value) : null, refill()
            }), ngModel.$render = function () {
                refill(!0)
            }, scope.select = function (date) {
                if (0 === mode) {
                    var dt = new Date(ngModel.$modelValue);
                    dt.setFullYear(date.getFullYear(), date.getMonth(), date.getDate()), ngModel.$setViewValue(dt), refill(!0)
                } else selected = date, setMode(mode - 1)
            }, scope.move = function (direction) {
                var step = datepickerCtrl.modes[mode].step;
                selected.setMonth(selected.getMonth() + direction * (step.months || 0)), selected.setFullYear(selected.getFullYear() + direction * (step.years || 0)), refill()
            }, scope.toggleMode = function () {
                setMode((mode + 1) % datepickerCtrl.modes.length)
            }, scope.getWeekNumber = function (row) {
                return 0 === mode && scope.showWeekNumbers && 7 === row.length ? getISO8601WeekNumber(row[0].date) : null
            }
        }
    }}
}]).constant("datepickerPopupConfig", {dateFormat: "yyyy-MM-dd", closeOnDateSelection: !0}).directive("datepickerPopup", ["$compile", "$parse", "$document", "$position", "dateFilter", "datepickerPopupConfig", function ($compile, $parse, $document, $position, dateFilter, datepickerPopupConfig) {
    return{restrict: "EA", require: "ngModel", link: function (originalScope, element, attrs, ngModel) {
        function formatDate(value) {
            return value ? dateFilter(value, dateFormat) : null
        }

        function parseDate(value) {
            if (value) {
                var date = new Date(value);
                if (!isNaN(date))return date
            }
            return value
        }

        function setOpen(value) {
            setIsOpen ? setIsOpen(originalScope, !!value) : scope.isOpen = !!value
        }

        function addWatchableAttribute(attribute, scopeProperty, datepickerAttribute) {
            attribute && (originalScope.$watch($parse(attribute), function (value) {
                scope[scopeProperty] = value
            }), datepickerEl.attr(datepickerAttribute || scopeProperty, scopeProperty))
        }

        function updatePosition() {
            scope.position = $position.position(element), scope.position.top = scope.position.top + element.prop("offsetHeight")
        }

        var closeOnDateSelection = angular.isDefined(attrs.closeOnDateSelection) ? scope.$eval(attrs.closeOnDateSelection) : datepickerPopupConfig.closeOnDateSelection, dateFormat = attrs.datepickerPopup || datepickerPopupConfig.dateFormat, scope = originalScope.$new();
        originalScope.$on("$destroy", function () {
            scope.$destroy()
        }), ngModel.$formatters.push(formatDate), ngModel.$parsers.push(parseDate);
        var getIsOpen, setIsOpen;
        attrs.open && (getIsOpen = $parse(attrs.open), setIsOpen = getIsOpen.assign, originalScope.$watch(getIsOpen, function (value) {
            scope.isOpen = !!value
        })), scope.isOpen = getIsOpen ? getIsOpen(originalScope) : !1;
        var documentClickBind = function (event) {
            scope.isOpen && event.target !== element[0] && scope.$apply(function () {
                setOpen(!1)
            })
        }, elementFocusBind = function () {
            scope.$apply(function () {
                setOpen(!0)
            })
        }, popupEl = angular.element("<datepicker-popup-wrap><datepicker></datepicker></datepicker-popup-wrap>");
        popupEl.attr({"ng-model": "date", "ng-change": "dateSelection()"});
        var datepickerEl = popupEl.find("datepicker");
        attrs.datepickerOptions && datepickerEl.attr(angular.extend({}, originalScope.$eval(attrs.datepickerOptions)));
        var $setModelValue = $parse(attrs.ngModel).assign;
        scope.dateSelection = function () {
            $setModelValue(originalScope, scope.date), closeOnDateSelection && setOpen(!1)
        }, scope.$watch(function () {
            return ngModel.$modelValue
        }, function (value) {
            if (angular.isString(value)) {
                var date = parseDate(value);
                if (value && !date)throw $setModelValue(originalScope, null), new Error(value + " cannot be parsed to a date object.");
                value = date
            }
            scope.date = value, updatePosition()
        }), addWatchableAttribute(attrs.min, "min"), addWatchableAttribute(attrs.max, "max"), attrs.showWeeks ? addWatchableAttribute(attrs.showWeeks, "showWeeks", "show-weeks") : (scope.showWeeks = !0, datepickerEl.attr("show-weeks", "showWeeks")), attrs.dateDisabled && datepickerEl.attr("date-disabled", attrs.dateDisabled), scope.$watch("isOpen", function (value) {
            value ? (updatePosition(), $document.bind("click", documentClickBind), element.unbind("focus", elementFocusBind), element.focus()) : ($document.unbind("click", documentClickBind), element.bind("focus", elementFocusBind)), setIsOpen && setIsOpen(originalScope, value)
        }), scope.today = function () {
            $setModelValue(originalScope, new Date)
        }, scope.clear = function () {
            $setModelValue(originalScope, null)
        }, element.after($compile(popupEl)(scope))
    }}
}]).directive("datepickerPopupWrap", [function () {
    return{restrict: "E", replace: !0, transclude: !0, templateUrl: "template/datepicker/popup.html", link: function (scope, element) {
        element.bind("click", function (event) {
            event.preventDefault(), event.stopPropagation()
        })
    }}
}]);
var dialogModule = angular.module("ui.bootstrap.dialog", ["ui.bootstrap.transition"]);
dialogModule.controller("MessageBoxController", ["$scope", "dialog", "model", function ($scope, dialog, model) {
    $scope.title = model.title, $scope.message = model.message, $scope.buttons = model.buttons, $scope.close = function (res) {
        dialog.close(res)
    }
}]), dialogModule.provider("$dialog", function () {
    var defaults = {backdrop: !0, dialogClass: "modal", backdropClass: "modal-backdrop", transitionClass: "fade", triggerClass: "in", resolve: {}, backdropFade: !1, dialogFade: !1, keyboard: !0, backdropClick: !0}, globalOptions = {}, activeBackdrops = {value: 0};
    this.options = function (value) {
        globalOptions = value
    }, this.$get = ["$http", "$document", "$compile", "$rootScope", "$controller", "$templateCache", "$q", "$transition", "$injector", function ($http, $document, $compile, $rootScope, $controller, $templateCache, $q, $transition, $injector) {
        function createElement(clazz) {
            var el = angular.element("<div>");
            return el.addClass(clazz), el
        }

        function Dialog(opts) {
            var self = this, options = this.options = angular.extend({}, defaults, globalOptions, opts);
            this._open = !1, this.backdropEl = createElement(options.backdropClass), options.backdropFade && (this.backdropEl.addClass(options.transitionClass), this.backdropEl.removeClass(options.triggerClass)), this.modalEl = createElement(options.dialogClass), options.dialogFade && (this.modalEl.addClass(options.transitionClass), this.modalEl.removeClass(options.triggerClass)), this.handledEscapeKey = function (e) {
                27 === e.which && (self.close(), e.preventDefault(), self.$scope.$apply())
            }, this.handleBackDropClick = function (e) {
                self.close(), e.preventDefault(), self.$scope.$apply()
            }
        }

        var body = $document.find("body");
        return Dialog.prototype.isOpen = function () {
            return this._open
        }, Dialog.prototype.open = function (templateUrl, controller) {
            var self = this, options = this.options;
            if (templateUrl && (options.templateUrl = templateUrl), controller && (options.controller = controller), !options.template && !options.templateUrl)throw new Error("Dialog.open expected template or templateUrl, neither found. Use options or open method to specify them.");
            return this._loadResolves().then(function (locals) {
                var $scope = locals.$scope = self.$scope = locals.$scope ? locals.$scope : $rootScope.$new();
                if (self.modalEl.html(locals.$template), self.options.controller) {
                    var ctrl = $controller(self.options.controller, locals);
                    self.modalEl.children().data("ngControllerController", ctrl)
                }
                $compile(self.modalEl)($scope), self._addElementsToDom(), setTimeout(function () {
                    self.options.dialogFade && self.modalEl.addClass(self.options.triggerClass), self.options.backdropFade && self.backdropEl.addClass(self.options.triggerClass)
                }), self._bindEvents()
            }), this.deferred = $q.defer(), this.deferred.promise
        }, Dialog.prototype.close = function (result) {
            function removeTriggerClass(el) {
                el.removeClass(self.options.triggerClass)
            }

            function onCloseComplete() {
                self._open && self._onCloseComplete(result)
            }

            var self = this, fadingElements = this._getFadingElements();
            if (fadingElements.length > 0)for (var i = fadingElements.length - 1; i >= 0; i--)$transition(fadingElements[i], removeTriggerClass).then(onCloseComplete); else this._onCloseComplete(result)
        }, Dialog.prototype._getFadingElements = function () {
            var elements = [];
            return this.options.dialogFade && elements.push(this.modalEl), this.options.backdropFade && elements.push(this.backdropEl), elements
        }, Dialog.prototype._bindEvents = function () {
            this.options.keyboard && body.bind("keydown", this.handledEscapeKey), this.options.backdrop && this.options.backdropClick && this.backdropEl.bind("click", this.handleBackDropClick)
        }, Dialog.prototype._unbindEvents = function () {
            this.options.keyboard && body.unbind("keydown", this.handledEscapeKey), this.options.backdrop && this.options.backdropClick && this.backdropEl.unbind("click", this.handleBackDropClick)
        }, Dialog.prototype._onCloseComplete = function (result) {
            this._removeElementsFromDom(), this._unbindEvents(), this.deferred.resolve(result)
        }, Dialog.prototype._addElementsToDom = function () {
            body.append(this.modalEl), this.options.backdrop && (0 === activeBackdrops.value && body.append(this.backdropEl), activeBackdrops.value++), this._open = !0
        }, Dialog.prototype._removeElementsFromDom = function () {
            this.modalEl.remove(), this.options.backdrop && (activeBackdrops.value--, 0 === activeBackdrops.value && this.backdropEl.remove()), this._open = !1
        }, Dialog.prototype._loadResolves = function () {
            var templatePromise, values = [], keys = [], self = this;
            return this.options.template ? templatePromise = $q.when(this.options.template) : this.options.templateUrl && (templatePromise = $http.get(this.options.templateUrl, {cache: $templateCache}).then(function (response) {
                return response.data
            })), angular.forEach(this.options.resolve || [], function (value, key) {
                keys.push(key), values.push(angular.isString(value) ? $injector.get(value) : $injector.invoke(value))
            }), keys.push("$template"), values.push(templatePromise), $q.all(values).then(function (values) {
                var locals = {};
                return angular.forEach(values, function (value, index) {
                    locals[keys[index]] = value
                }), locals.dialog = self, locals
            })
        }, {dialog: function (opts) {
            return new Dialog(opts)
        }, messageBox: function (title, message, buttons) {
            return new Dialog({templateUrl: "template/dialog/message.html", controller: "MessageBoxController", resolve: {model: function () {
                return{title: title, message: message, buttons: buttons}
            }}})
        }}
    }]
}), angular.module("ui.bootstrap.modal", ["ui.bootstrap.dialog"]).directive("modal", ["$parse", "$dialog", function ($parse, $dialog) {
    return{restrict: "EA", terminal: !0, link: function (scope, elm, attrs) {
        var setClosed, opts = angular.extend({}, scope.$eval(attrs.uiOptions || attrs.bsOptions || attrs.options)), shownExpr = attrs.modal || attrs.show;
        opts = angular.extend(opts, {template: elm.html(), resolve: {$scope: function () {
            return scope
        }}});
        var dialog = $dialog.dialog(opts);
        elm.remove(), setClosed = attrs.close ? function () {
            $parse(attrs.close)(scope)
        } : function () {
            angular.isFunction($parse(shownExpr).assign) && $parse(shownExpr).assign(scope, !1)
        }, scope.$watch(shownExpr, function (isShown) {
            isShown ? dialog.open().then(function () {
                setClosed()
            }) : dialog.isOpen() && dialog.close()
        })
    }}
}]), angular.module("ui.bootstrap.tooltip", ["ui.bootstrap.position"]).provider("$tooltip",function () {
    function snake_case(name) {
        var regexp = /[A-Z]/g, separator = "-";
        return name.replace(regexp, function (letter, pos) {
            return(pos ? separator : "") + letter.toLowerCase()
        })
    }

    var defaultOptions = {placement: "top", animation: !0, popupDelay: 0}, triggerMap = {mouseenter: "mouseleave", click: "click", focus: "blur"}, globalOptions = {};
    this.options = function (value) {
        angular.extend(globalOptions, value)
    }, this.setTriggers = function (triggers) {
        angular.extend(triggerMap, triggers)
    }, this.$get = ["$window", "$compile", "$timeout", "$parse", "$document", "$position", "$interpolate", function ($window, $compile, $timeout, $parse, $document, $position, $interpolate) {
        return function (type, prefix, defaultTriggerShow) {
            function getTriggers(trigger) {
                var show = trigger || options.trigger || defaultTriggerShow, hide = triggerMap[show] || show;
                return{show: show, hide: hide}
            }

            var options = angular.extend({}, defaultOptions, globalOptions), directiveName = snake_case(type), startSym = $interpolate.startSymbol(), endSym = $interpolate.endSymbol(), template = "<" + directiveName + '-popup title="' + startSym + "tt_title" + endSym + '" content="' + startSym + "tt_content" + endSym + '" placement="' + startSym + "tt_placement" + endSym + '" animation="tt_animation()" is-open="tt_isOpen"></' + directiveName + "-popup>";
            return{restrict: "EA", scope: !0, link: function (scope, element, attrs) {
                function toggleTooltipBind() {
                    scope.tt_isOpen ? hideTooltipBind() : showTooltipBind()
                }

                function showTooltipBind() {
                    scope.tt_popupDelay ? popupTimeout = $timeout(show, scope.tt_popupDelay) : scope.$apply(show)
                }

                function hideTooltipBind() {
                    scope.$apply(function () {
                        hide()
                    })
                }

                function show() {
                    var position, ttWidth, ttHeight, ttPosition;
                    if (scope.tt_content) {
                        switch (transitionTimeout && $timeout.cancel(transitionTimeout), tooltip.css({top: 0, left: 0, display: "block"}), appendToBody ? ($body = $body || $document.find("body"), $body.append(tooltip)) : element.after(tooltip), position = appendToBody ? $position.offset(element) : $position.position(element), ttWidth = tooltip.prop("offsetWidth"), ttHeight = tooltip.prop("offsetHeight"), scope.tt_placement) {
                            case"mouse":
                                var mousePos = $position.mouse();
                                ttPosition = {top: mousePos.y, left: mousePos.x};
                                break;
                            case"right":
                                ttPosition = {top: position.top + position.height / 2 - ttHeight / 2, left: position.left + position.width};
                                break;
                            case"bottom":
                                ttPosition = {top: position.top + position.height, left: position.left + position.width / 2 - ttWidth / 2};
                                break;
                            case"left":
                                ttPosition = {top: position.top + position.height / 2 - ttHeight / 2, left: position.left - ttWidth};
                                break;
                            default:
                                ttPosition = {top: position.top - ttHeight, left: position.left + position.width / 2 - ttWidth / 2}
                        }
                        ttPosition.top += "px", ttPosition.left += "px", tooltip.css(ttPosition), scope.tt_isOpen = !0
                    }
                }

                function hide() {
                    scope.tt_isOpen = !1, $timeout.cancel(popupTimeout), angular.isDefined(scope.tt_animation) && scope.tt_animation() ? transitionTimeout = $timeout(function () {
                        tooltip.remove()
                    }, 500) : tooltip.remove()
                }

                var transitionTimeout, popupTimeout, $body, tooltip = $compile(template)(scope), appendToBody = angular.isDefined(options.appendToBody) ? options.appendToBody : !1, triggers = getTriggers(void 0), hasRegisteredTriggers = !1;
                scope.tt_isOpen = !1, attrs.$observe(type, function (val) {
                    scope.tt_content = val
                }), attrs.$observe(prefix + "Title", function (val) {
                    scope.tt_title = val
                }), attrs.$observe(prefix + "Placement", function (val) {
                    scope.tt_placement = angular.isDefined(val) ? val : options.placement
                }), attrs.$observe(prefix + "Animation", function (val) {
                    scope.tt_animation = angular.isDefined(val) ? $parse(val) : function () {
                        return options.animation
                    }
                }), attrs.$observe(prefix + "PopupDelay", function (val) {
                    var delay = parseInt(val, 10);
                    scope.tt_popupDelay = isNaN(delay) ? options.popupDelay : delay
                }), attrs.$observe(prefix + "Trigger", function (val) {
                    hasRegisteredTriggers && (element.unbind(triggers.show, showTooltipBind), element.unbind(triggers.hide, hideTooltipBind)), triggers = getTriggers(val), triggers.show === triggers.hide ? element.bind(triggers.show, toggleTooltipBind) : (element.bind(triggers.show, showTooltipBind), element.bind(triggers.hide, hideTooltipBind)), hasRegisteredTriggers = !0
                }), attrs.$observe(prefix + "AppendToBody", function (val) {
                    appendToBody = angular.isDefined(val) ? $parse(val)(scope) : appendToBody
                }), appendToBody && scope.$on("$locationChangeSuccess", function () {
                    scope.tt_isOpen && hide()
                }), scope.$on("$destroy", function () {
                    scope.tt_isOpen ? hide() : tooltip.remove()
                })
            }}
        }
    }]
}).directive("tooltipPopup",function () {
    return{restrict: "E", replace: !0, scope: {content: "@", placement: "@", animation: "&", isOpen: "&"}, templateUrl: "template/tooltip/tooltip-popup.html"}
}).directive("tooltip", ["$tooltip", function ($tooltip) {
    return $tooltip("tooltip", "tooltip", "mouseenter")
}]).directive("tooltipHtmlUnsafePopup",function () {
    return{restrict: "E", replace: !0, scope: {content: "@", placement: "@", animation: "&", isOpen: "&"}, templateUrl: "template/tooltip/tooltip-html-unsafe-popup.html"}
}).directive("tooltipHtmlUnsafe", ["$tooltip", function ($tooltip) {
    return $tooltip("tooltipHtmlUnsafe", "tooltip", "mouseenter")
}]), angular.module("ui.bootstrap", ["ui.bootstrap.tpls", "ui.bootstrap.transition", "ui.bootstrap.collapse", "ui.bootstrap.accordion", "ui.bootstrap.carousel", "ui.bootstrap.position", "ui.bootstrap.datepicker", "ui.bootstrap.dialog", "ui.bootstrap.modal", "ui.bootstrap.tooltip"]), angular.module("ui.bootstrap.tpls", ["template/accordion/accordion-group.html", "template/accordion/accordion.html", "template/carousel/carousel.html", "template/carousel/slide.html", "template/datepicker/datepicker.html", "template/datepicker/popup.html", "template/dialog/message.html", "template/tooltip/tooltip-html-unsafe-popup.html", "template/tooltip/tooltip-popup.html"]), angular.module("ui.bootstrap.transition", []).factory("$transition", ["$q", "$timeout", "$rootScope", function ($q, $timeout, $rootScope) {
    function findEndEventName(endEventNames) {
        for (var name in endEventNames)if (void 0 !== transElement.style[name])return endEventNames[name]
    }

    var $transition = function (element, trigger, options) {
        options = options || {};
        var deferred = $q.defer(), endEventName = $transition[options.animation ? "animationEndEventName" : "transitionEndEventName"], transitionEndHandler = function () {
            $rootScope.$apply(function () {
                element.unbind(endEventName, transitionEndHandler), deferred.resolve(element)
            })
        };
        return endEventName && element.bind(endEventName, transitionEndHandler), $timeout(function () {
            angular.isString(trigger) ? element.addClass(trigger) : angular.isFunction(trigger) ? trigger(element) : angular.isObject(trigger) && element.css(trigger), endEventName || deferred.resolve(element)
        }), deferred.promise.cancel = function () {
            endEventName && element.unbind(endEventName, transitionEndHandler), deferred.reject("Transition cancelled")
        }, deferred.promise
    }, transElement = document.createElement("trans"), transitionEndEventNames = {WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd", transition: "transitionend"}, animationEndEventNames = {WebkitTransition: "webkitAnimationEnd", MozTransition: "animationend", OTransition: "oAnimationEnd", transition: "animationend"};
    return $transition.transitionEndEventName = findEndEventName(transitionEndEventNames), $transition.animationEndEventName = findEndEventName(animationEndEventNames), $transition
}]), angular.module("ui.bootstrap.collapse", ["ui.bootstrap.transition"]).directive("collapse", ["$transition", function ($transition) {
    var fixUpHeight = function (scope, element, height) {
        element.removeClass("collapse"), element.css({height: height}), element[0].offsetWidth, element.addClass("collapse")
    };
    return{link: function (scope, element, attrs) {
        var isCollapsed, initialAnimSkip = !0;
        scope.$watch(function () {
            return element[0].scrollHeight
        }, function () {
            0 !== element[0].scrollHeight && (isCollapsed || (initialAnimSkip ? fixUpHeight(scope, element, element[0].scrollHeight + "px") : fixUpHeight(scope, element, "auto")))
        }), scope.$watch(attrs.collapse, function (value) {
            value ? collapse() : expand()
        });
        var currentTransition, doTransition = function (change) {
            return currentTransition && currentTransition.cancel(), currentTransition = $transition(element, change), currentTransition.then(function () {
                currentTransition = void 0
            }, function () {
                currentTransition = void 0
            }), currentTransition
        }, expand = function () {
            initialAnimSkip ? (initialAnimSkip = !1, isCollapsed || fixUpHeight(scope, element, "auto")) : doTransition({height: element[0].scrollHeight + "px"}).then(function () {
                isCollapsed || fixUpHeight(scope, element, "auto")
            }), isCollapsed = !1
        }, collapse = function () {
            isCollapsed = !0, initialAnimSkip ? (initialAnimSkip = !1, fixUpHeight(scope, element, 0)) : (fixUpHeight(scope, element, element[0].scrollHeight + "px"), doTransition({height: "0"}))
        }
    }}
}]), angular.module("ui.bootstrap.accordion", ["ui.bootstrap.collapse"]).constant("accordionConfig", {closeOthers: !0}).controller("AccordionController", ["$scope", "$attrs", "accordionConfig", function ($scope, $attrs, accordionConfig) {
    this.groups = [], this.closeOthers = function (openGroup) {
        var closeOthers = angular.isDefined($attrs.closeOthers) ? $scope.$eval($attrs.closeOthers) : accordionConfig.closeOthers;
        closeOthers && angular.forEach(this.groups, function (group) {
            group !== openGroup && (group.isOpen = !1)
        })
    }, this.addGroup = function (groupScope) {
        var that = this;
        this.groups.push(groupScope), groupScope.$on("$destroy", function () {
            that.removeGroup(groupScope)
        })
    }, this.removeGroup = function (group) {
        var index = this.groups.indexOf(group);
        -1 !== index && this.groups.splice(this.groups.indexOf(group), 1)
    }
}]).directive("accordion",function () {
    return{restrict: "EA", controller: "AccordionController", transclude: !0, replace: !1, templateUrl: "template/accordion/accordion.html"}
}).directive("accordionGroup", ["$parse", "$transition", "$timeout", function ($parse) {
    return{require: "^accordion", restrict: "EA", transclude: !0, replace: !0, templateUrl: "template/accordion/accordion-group.html", scope: {heading: "@"}, controller: ["$scope", function () {
        this.setHeading = function (element) {
            this.heading = element
        }
    }], link: function (scope, element, attrs, accordionCtrl) {
        var getIsOpen, setIsOpen;
        accordionCtrl.addGroup(scope), scope.isOpen = !1, attrs.isOpen && (getIsOpen = $parse(attrs.isOpen), setIsOpen = getIsOpen.assign, scope.$watch(function () {
            return getIsOpen(scope.$parent)
        }, function (value) {
            scope.isOpen = value
        }), scope.isOpen = getIsOpen ? getIsOpen(scope.$parent) : !1), scope.$watch("isOpen", function (value) {
            value && accordionCtrl.closeOthers(scope), setIsOpen && setIsOpen(scope.$parent, value)
        })
    }}
}]).directive("accordionHeading",function () {
    return{restrict: "EA", transclude: !0, template: "", replace: !0, require: "^accordionGroup", compile: function (element, attr, transclude) {
        return function (scope, element, attr, accordionGroupCtrl) {
            accordionGroupCtrl.setHeading(transclude(scope, function () {
            }))
        }
    }}
}).directive("accordionTransclude", function () {
    return{require: "^accordionGroup", link: function (scope, element, attr, controller) {
        scope.$watch(function () {
            return controller[attr.accordionTransclude]
        }, function (heading) {
            heading && (element.html(""), element.append(heading))
        })
    }}
}), angular.module("ui.bootstrap.carousel", ["ui.bootstrap.transition"]).controller("CarouselController", ["$scope", "$timeout", "$transition", "$q", function ($scope, $timeout, $transition) {
    function restartTimer() {
        function go() {
            isPlaying ? ($scope.next(), restartTimer()) : $scope.pause()
        }

        currentTimeout && $timeout.cancel(currentTimeout);
        var interval = +$scope.interval;
        !isNaN(interval) && interval >= 0 && (currentTimeout = $timeout(go, interval))
    }

    var currentTimeout, isPlaying, self = this, slides = self.slides = [], currentIndex = -1;
    self.currentSlide = null, self.select = function (nextSlide, direction) {
        function goNext() {
            self.currentSlide && angular.isString(direction) && !$scope.noTransition && nextSlide.$element ? (nextSlide.$element.addClass(direction), nextSlide.$element[0].offsetWidth = nextSlide.$element[0].offsetWidth, angular.forEach(slides, function (slide) {
                angular.extend(slide, {direction: "", entering: !1, leaving: !1, active: !1})
            }), angular.extend(nextSlide, {direction: direction, active: !0, entering: !0}), angular.extend(self.currentSlide || {}, {direction: direction, leaving: !0}), $scope.$currentTransition = $transition(nextSlide.$element, {}), function (next, current) {
                $scope.$currentTransition.then(function () {
                    transitionDone(next, current)
                }, function () {
                    transitionDone(next, current)
                })
            }(nextSlide, self.currentSlide)) : transitionDone(nextSlide, self.currentSlide), self.currentSlide = nextSlide, currentIndex = nextIndex, restartTimer()
        }

        function transitionDone(next, current) {
            angular.extend(next, {direction: "", active: !0, leaving: !1, entering: !1}), angular.extend(current || {}, {direction: "", active: !1, leaving: !1, entering: !1}), $scope.$currentTransition = null
        }

        var nextIndex = slides.indexOf(nextSlide);
        void 0 === direction && (direction = nextIndex > currentIndex ? "next" : "prev"), nextSlide && nextSlide !== self.currentSlide && ($scope.$currentTransition ? ($scope.$currentTransition.cancel(), $timeout(goNext)) : goNext())
    }, self.indexOfSlide = function (slide) {
        return slides.indexOf(slide)
    }, $scope.next = function () {
        var newIndex = (currentIndex + 1) % slides.length;
        return $scope.$currentTransition ? void 0 : self.select(slides[newIndex], "next")
    }, $scope.prev = function () {
        var newIndex = 0 > currentIndex - 1 ? slides.length - 1 : currentIndex - 1;
        return $scope.$currentTransition ? void 0 : self.select(slides[newIndex], "prev")
    }, $scope.select = function (slide) {
        self.select(slide)
    }, $scope.isActive = function (slide) {
        return self.currentSlide === slide
    }, $scope.slides = function () {
        return slides
    }, $scope.$watch("interval", restartTimer), $scope.play = function () {
        isPlaying || (isPlaying = !0, restartTimer())
    }, $scope.pause = function () {
        $scope.noPause || (isPlaying = !1, currentTimeout && $timeout.cancel(currentTimeout))
    }, self.addSlide = function (slide, element) {
        slide.$element = element, slides.push(slide), 1 === slides.length || slide.active ? (self.select(slides[slides.length - 1]), 1 == slides.length && $scope.play()) : slide.active = !1
    }, self.removeSlide = function (slide) {
        var index = slides.indexOf(slide);
        slides.splice(index, 1), slides.length > 0 && slide.active ? index >= slides.length ? self.select(slides[index - 1]) : self.select(slides[index]) : currentIndex > index && currentIndex--
    }
}]).directive("carousel", [function () {
    return{restrict: "EA", transclude: !0, replace: !0, controller: "CarouselController", require: "carousel", templateUrl: "template/carousel/carousel.html", scope: {interval: "=", noTransition: "=", noPause: "="}}
}]).directive("slide", ["$parse", function ($parse) {
    return{require: "^carousel", restrict: "EA", transclude: !0, replace: !0, templateUrl: "template/carousel/slide.html", scope: {}, link: function (scope, element, attrs, carouselCtrl) {
        if (attrs.active) {
            var getActive = $parse(attrs.active), setActive = getActive.assign, lastValue = scope.active = getActive(scope.$parent);
            scope.$watch(function () {
                var parentActive = getActive(scope.$parent);
                return parentActive !== scope.active && (parentActive !== lastValue ? lastValue = scope.active = parentActive : setActive(scope.$parent, parentActive = lastValue = scope.active)), parentActive
            })
        }
        carouselCtrl.addSlide(scope, element), scope.$on("$destroy", function () {
            carouselCtrl.removeSlide(scope)
        }), scope.$watch("active", function (active) {
            active && carouselCtrl.select(scope)
        })
    }}
}]), angular.module("ui.bootstrap.position", []).factory("$position", ["$document", "$window", function ($document, $window) {
    function getStyle(el, cssprop) {
        return el.currentStyle ? el.currentStyle[cssprop] : $window.getComputedStyle ? $window.getComputedStyle(el)[cssprop] : el.style[cssprop]
    }

    function isStaticPositioned(element) {
        return"static" === (getStyle(element, "position") || "static")
    }

    var mouseX, mouseY;
    $document.bind("mousemove", function (event) {
        mouseX = event.pageX, mouseY = event.pageY
    });
    var parentOffsetEl = function (element) {
        for (var docDomEl = $document[0], offsetParent = element.offsetParent || docDomEl; offsetParent && offsetParent !== docDomEl && isStaticPositioned(offsetParent);)offsetParent = offsetParent.offsetParent;
        return offsetParent || docDomEl
    };
    return{position: function (element) {
        var elBCR = this.offset(element), offsetParentBCR = {top: 0, left: 0}, offsetParentEl = parentOffsetEl(element[0]);
        return offsetParentEl != $document[0] && (offsetParentBCR = this.offset(angular.element(offsetParentEl)), offsetParentBCR.top += offsetParentEl.clientTop - offsetParentEl.scrollTop, offsetParentBCR.left += offsetParentEl.clientLeft - offsetParentEl.scrollLeft), {width: element.prop("offsetWidth"), height: element.prop("offsetHeight"), top: elBCR.top - offsetParentBCR.top, left: elBCR.left - offsetParentBCR.left}
    }, offset: function (element) {
        var boundingClientRect = element[0].getBoundingClientRect();
        return{width: element.prop("offsetWidth"), height: element.prop("offsetHeight"), top: boundingClientRect.top + ($window.pageYOffset || $document[0].body.scrollTop), left: boundingClientRect.left + ($window.pageXOffset || $document[0].body.scrollLeft)}
    }, mouse: function () {
        return{x: mouseX, y: mouseY}
    }}
}]), angular.module("ui.bootstrap.datepicker", ["ui.bootstrap.position"]).constant("datepickerConfig", {dayFormat: "dd", monthFormat: "MMMM", yearFormat: "yyyy", dayHeaderFormat: "EEE", dayTitleFormat: "MMMM yyyy", monthTitleFormat: "yyyy", showWeeks: !0, startingDay: 0, yearRange: 20, minDate: null, maxDate: null}).controller("DatepickerController", ["$scope", "$attrs", "dateFilter", "datepickerConfig", function ($scope, $attrs, dateFilter, dtConfig) {
    function getValue(value, defaultValue) {
        return angular.isDefined(value) ? $scope.$parent.$eval(value) : defaultValue
    }

    function getDaysInMonth(year, month) {
        return new Date(year, month, 0).getDate()
    }

    function getDates(startDate, n) {
        for (var dates = new Array(n), current = startDate, i = 0; n > i;)dates[i++] = new Date(current), current.setDate(current.getDate() + 1);
        return dates
    }

    function makeDate(date, format, isSelected, isSecondary) {
        return{date: date, label: dateFilter(date, format), selected: !!isSelected, secondary: !!isSecondary}
    }

    var format = {day: getValue($attrs.dayFormat, dtConfig.dayFormat), month: getValue($attrs.monthFormat, dtConfig.monthFormat), year: getValue($attrs.yearFormat, dtConfig.yearFormat), dayHeader: getValue($attrs.dayHeaderFormat, dtConfig.dayHeaderFormat), dayTitle: getValue($attrs.dayTitleFormat, dtConfig.dayTitleFormat), monthTitle: getValue($attrs.monthTitleFormat, dtConfig.monthTitleFormat)}, startingDay = getValue($attrs.startingDay, dtConfig.startingDay), yearRange = getValue($attrs.yearRange, dtConfig.yearRange);
    this.minDate = dtConfig.minDate ? new Date(dtConfig.minDate) : null, this.maxDate = dtConfig.maxDate ? new Date(dtConfig.maxDate) : null, this.modes = [
        {name: "day", getVisibleDates: function (date, selected) {
            var year = date.getFullYear(), month = date.getMonth(), firstDayOfMonth = new Date(year, month, 1), difference = startingDay - firstDayOfMonth.getDay(), numDisplayedFromPreviousMonth = difference > 0 ? 7 - difference : -difference, firstDate = new Date(firstDayOfMonth), numDates = 0;
            numDisplayedFromPreviousMonth > 0 && (firstDate.setDate(-numDisplayedFromPreviousMonth + 1), numDates += numDisplayedFromPreviousMonth), numDates += getDaysInMonth(year, month + 1), numDates += (7 - numDates % 7) % 7;
            for (var days = getDates(firstDate, numDates), labels = new Array(7), i = 0; numDates > i; i++) {
                var dt = new Date(days[i]);
                days[i] = makeDate(dt, format.day, selected && selected.getDate() === dt.getDate() && selected.getMonth() === dt.getMonth() && selected.getFullYear() === dt.getFullYear(), dt.getMonth() !== month)
            }
            for (var j = 0; 7 > j; j++)labels[j] = dateFilter(days[j].date, format.dayHeader);
            return{objects: days, title: dateFilter(date, format.dayTitle), labels: labels}
        }, compare: function (date1, date2) {
            return new Date(date1.getFullYear(), date1.getMonth(), date1.getDate()) - new Date(date2.getFullYear(), date2.getMonth(), date2.getDate())
        }, split: 7, step: {months: 1}},
        {name: "month", getVisibleDates: function (date, selected) {
            for (var months = new Array(12), year = date.getFullYear(), i = 0; 12 > i; i++) {
                var dt = new Date(year, i, 1);
                months[i] = makeDate(dt, format.month, selected && selected.getMonth() === i && selected.getFullYear() === year)
            }
            return{objects: months, title: dateFilter(date, format.monthTitle)}
        }, compare: function (date1, date2) {
            return new Date(date1.getFullYear(), date1.getMonth()) - new Date(date2.getFullYear(), date2.getMonth())
        }, split: 3, step: {years: 1}},
        {name: "year", getVisibleDates: function (date, selected) {
            for (var years = new Array(yearRange), year = date.getFullYear(), startYear = parseInt((year - 1) / yearRange, 10) * yearRange + 1, i = 0; yearRange > i; i++) {
                var dt = new Date(startYear + i, 0, 1);
                years[i] = makeDate(dt, format.year, selected && selected.getFullYear() === dt.getFullYear())
            }
            return{objects: years, title: [years[0].label, years[yearRange - 1].label].join(" - ")}
        }, compare: function (date1, date2) {
            return date1.getFullYear() - date2.getFullYear()
        }, split: 5, step: {years: yearRange}}
    ], this.isDisabled = function (date, mode) {
        var currentMode = this.modes[mode || 0];
        return this.minDate && currentMode.compare(date, this.minDate) < 0 || this.maxDate && currentMode.compare(date, this.maxDate) > 0 || $scope.dateDisabled && $scope.dateDisabled({date: date, mode: currentMode.name})
    }
}]).directive("datepicker", ["dateFilter", "$parse", "datepickerConfig", "$log", function (dateFilter, $parse, datepickerConfig, $log) {
    return{restrict: "EA", replace: !0, templateUrl: "template/datepicker/datepicker.html", scope: {dateDisabled: "&"}, require: ["datepicker", "?^ngModel"], controller: "DatepickerController", link: function (scope, element, attrs, ctrls) {
        function updateShowWeekNumbers() {
            scope.showWeekNumbers = 0 === mode && showWeeks
        }

        function split(arr, size) {
            for (var arrays = []; arr.length > 0;)arrays.push(arr.splice(0, size));
            return arrays
        }

        function refill(updateSelected) {
            var date = null, valid = !0;
            ngModel.$modelValue && (date = new Date(ngModel.$modelValue), isNaN(date) ? (valid = !1, $log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')) : updateSelected && (selected = date)), ngModel.$setValidity("date", valid);
            var currentMode = datepickerCtrl.modes[mode], data = currentMode.getVisibleDates(selected, date);
            angular.forEach(data.objects, function (obj) {
                obj.disabled = datepickerCtrl.isDisabled(obj.date, mode)
            }), ngModel.$setValidity("date-disabled", !date || !datepickerCtrl.isDisabled(date)), scope.rows = split(data.objects, currentMode.split), scope.labels = data.labels || [], scope.title = data.title
        }

        function setMode(value) {
            mode = value, updateShowWeekNumbers(), refill()
        }

        function getISO8601WeekNumber(date) {
            var checkDate = new Date(date);
            checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));
            var time = checkDate.getTime();
            return checkDate.setMonth(0), checkDate.setDate(1), Math.floor(Math.round((time - checkDate) / 864e5) / 7) + 1
        }

        var datepickerCtrl = ctrls[0], ngModel = ctrls[1];
        if (ngModel) {
            var mode = 0, selected = new Date, showWeeks = datepickerConfig.showWeeks;
            attrs.showWeeks ? scope.$parent.$watch($parse(attrs.showWeeks), function (value) {
                showWeeks = !!value, updateShowWeekNumbers()
            }) : updateShowWeekNumbers(), attrs.min && scope.$parent.$watch($parse(attrs.min), function (value) {
                datepickerCtrl.minDate = value ? new Date(value) : null, refill()
            }), attrs.max && scope.$parent.$watch($parse(attrs.max), function (value) {
                datepickerCtrl.maxDate = value ? new Date(value) : null, refill()
            }), ngModel.$render = function () {
                refill(!0)
            }, scope.select = function (date) {
                if (0 === mode) {
                    var dt = new Date(ngModel.$modelValue);
                    dt.setFullYear(date.getFullYear(), date.getMonth(), date.getDate()), ngModel.$setViewValue(dt), refill(!0)
                } else selected = date, setMode(mode - 1)
            }, scope.move = function (direction) {
                var step = datepickerCtrl.modes[mode].step;
                selected.setMonth(selected.getMonth() + direction * (step.months || 0)), selected.setFullYear(selected.getFullYear() + direction * (step.years || 0)), refill()
            }, scope.toggleMode = function () {
                setMode((mode + 1) % datepickerCtrl.modes.length)
            }, scope.getWeekNumber = function (row) {
                return 0 === mode && scope.showWeekNumbers && 7 === row.length ? getISO8601WeekNumber(row[0].date) : null
            }
        }
    }}
}]).constant("datepickerPopupConfig", {dateFormat: "yyyy-MM-dd", closeOnDateSelection: !0}).directive("datepickerPopup", ["$compile", "$parse", "$document", "$position", "dateFilter", "datepickerPopupConfig", function ($compile, $parse, $document, $position, dateFilter, datepickerPopupConfig) {
    return{restrict: "EA", require: "ngModel", link: function (originalScope, element, attrs, ngModel) {
        function formatDate(value) {
            return value ? dateFilter(value, dateFormat) : null
        }

        function parseDate(value) {
            if (value) {
                var date = new Date(value);
                if (!isNaN(date))return date
            }
            return value
        }

        function setOpen(value) {
            setIsOpen ? setIsOpen(originalScope, !!value) : scope.isOpen = !!value
        }

        function addWatchableAttribute(attribute, scopeProperty, datepickerAttribute) {
            attribute && (originalScope.$watch($parse(attribute), function (value) {
                scope[scopeProperty] = value
            }), datepickerEl.attr(datepickerAttribute || scopeProperty, scopeProperty))
        }

        function updatePosition() {
            scope.position = $position.position(element), scope.position.top = scope.position.top + element.prop("offsetHeight")
        }

        var closeOnDateSelection = angular.isDefined(attrs.closeOnDateSelection) ? scope.$eval(attrs.closeOnDateSelection) : datepickerPopupConfig.closeOnDateSelection, dateFormat = attrs.datepickerPopup || datepickerPopupConfig.dateFormat, scope = originalScope.$new();
        originalScope.$on("$destroy", function () {
            scope.$destroy()
        }), ngModel.$formatters.push(formatDate), ngModel.$parsers.push(parseDate);
        var getIsOpen, setIsOpen;
        attrs.open && (getIsOpen = $parse(attrs.open), setIsOpen = getIsOpen.assign, originalScope.$watch(getIsOpen, function (value) {
            scope.isOpen = !!value
        })), scope.isOpen = getIsOpen ? getIsOpen(originalScope) : !1;
        var documentClickBind = function (event) {
            scope.isOpen && event.target !== element[0] && scope.$apply(function () {
                setOpen(!1)
            })
        }, elementFocusBind = function () {
            scope.$apply(function () {
                setOpen(!0)
            })
        }, popupEl = angular.element("<datepicker-popup-wrap><datepicker></datepicker></datepicker-popup-wrap>");
        popupEl.attr({"ng-model": "date", "ng-change": "dateSelection()"});
        var datepickerEl = popupEl.find("datepicker");
        attrs.datepickerOptions && datepickerEl.attr(angular.extend({}, originalScope.$eval(attrs.datepickerOptions)));
        var $setModelValue = $parse(attrs.ngModel).assign;
        scope.dateSelection = function () {
            $setModelValue(originalScope, scope.date), closeOnDateSelection && setOpen(!1)
        }, scope.$watch(function () {
            return ngModel.$modelValue
        }, function (value) {
            if (angular.isString(value)) {
                var date = parseDate(value);
                if (value && !date)throw $setModelValue(originalScope, null), new Error(value + " cannot be parsed to a date object.");
                value = date
            }
            scope.date = value, updatePosition()
        }), addWatchableAttribute(attrs.min, "min"), addWatchableAttribute(attrs.max, "max"), attrs.showWeeks ? addWatchableAttribute(attrs.showWeeks, "showWeeks", "show-weeks") : (scope.showWeeks = !0, datepickerEl.attr("show-weeks", "showWeeks")), attrs.dateDisabled && datepickerEl.attr("date-disabled", attrs.dateDisabled), scope.$watch("isOpen", function (value) {
            value ? (updatePosition(), $document.bind("click", documentClickBind), element.unbind("focus", elementFocusBind), element.focus()) : ($document.unbind("click", documentClickBind), element.bind("focus", elementFocusBind)), setIsOpen && setIsOpen(originalScope, value)
        }), scope.today = function () {
            $setModelValue(originalScope, new Date)
        }, scope.clear = function () {
            $setModelValue(originalScope, null)
        }, element.after($compile(popupEl)(scope))
    }}
}]).directive("datepickerPopupWrap", [function () {
    return{restrict: "E", replace: !0, transclude: !0, templateUrl: "template/datepicker/popup.html", link: function (scope, element) {
        element.bind("click", function (event) {
            event.preventDefault(), event.stopPropagation()
        })
    }}
}]);
var dialogModule = angular.module("ui.bootstrap.dialog", ["ui.bootstrap.transition"]);
dialogModule.controller("MessageBoxController", ["$scope", "dialog", "model", function ($scope, dialog, model) {
    $scope.title = model.title, $scope.message = model.message, $scope.buttons = model.buttons, $scope.close = function (res) {
        dialog.close(res)
    }
}]), dialogModule.provider("$dialog", function () {
    var defaults = {backdrop: !0, dialogClass: "modal", backdropClass: "modal-backdrop", transitionClass: "fade", triggerClass: "in", resolve: {}, backdropFade: !1, dialogFade: !1, keyboard: !0, backdropClick: !0}, globalOptions = {}, activeBackdrops = {value: 0};
    this.options = function (value) {
        globalOptions = value
    }, this.$get = ["$http", "$document", "$compile", "$rootScope", "$controller", "$templateCache", "$q", "$transition", "$injector", function ($http, $document, $compile, $rootScope, $controller, $templateCache, $q, $transition, $injector) {
        function createElement(clazz) {
            var el = angular.element("<div>");
            return el.addClass(clazz), el
        }

        function Dialog(opts) {
            var self = this, options = this.options = angular.extend({}, defaults, globalOptions, opts);
            this._open = !1, this.backdropEl = createElement(options.backdropClass), options.backdropFade && (this.backdropEl.addClass(options.transitionClass), this.backdropEl.removeClass(options.triggerClass)), this.modalEl = createElement(options.dialogClass), options.dialogFade && (this.modalEl.addClass(options.transitionClass), this.modalEl.removeClass(options.triggerClass)), this.handledEscapeKey = function (e) {
                27 === e.which && (self.close(), e.preventDefault(), self.$scope.$apply())
            }, this.handleBackDropClick = function (e) {
                self.close(), e.preventDefault(), self.$scope.$apply()
            }
        }

        var body = $document.find("body");
        return Dialog.prototype.isOpen = function () {
            return this._open
        }, Dialog.prototype.open = function (templateUrl, controller) {
            var self = this, options = this.options;
            if (templateUrl && (options.templateUrl = templateUrl), controller && (options.controller = controller), !options.template && !options.templateUrl)throw new Error("Dialog.open expected template or templateUrl, neither found. Use options or open method to specify them.");
            return this._loadResolves().then(function (locals) {
                var $scope = locals.$scope = self.$scope = locals.$scope ? locals.$scope : $rootScope.$new();
                if (self.modalEl.html(locals.$template), self.options.controller) {
                    var ctrl = $controller(self.options.controller, locals);
                    self.modalEl.children().data("ngControllerController", ctrl)
                }
                $compile(self.modalEl)($scope), self._addElementsToDom(), setTimeout(function () {
                    self.options.dialogFade && self.modalEl.addClass(self.options.triggerClass), self.options.backdropFade && self.backdropEl.addClass(self.options.triggerClass)
                }), self._bindEvents()
            }), this.deferred = $q.defer(), this.deferred.promise
        }, Dialog.prototype.close = function (result) {
            function removeTriggerClass(el) {
                el.removeClass(self.options.triggerClass)
            }

            function onCloseComplete() {
                self._open && self._onCloseComplete(result)
            }

            var self = this, fadingElements = this._getFadingElements();
            if (fadingElements.length > 0)for (var i = fadingElements.length - 1; i >= 0; i--)$transition(fadingElements[i], removeTriggerClass).then(onCloseComplete); else this._onCloseComplete(result)
        }, Dialog.prototype._getFadingElements = function () {
            var elements = [];
            return this.options.dialogFade && elements.push(this.modalEl), this.options.backdropFade && elements.push(this.backdropEl), elements
        }, Dialog.prototype._bindEvents = function () {
            this.options.keyboard && body.bind("keydown", this.handledEscapeKey), this.options.backdrop && this.options.backdropClick && this.backdropEl.bind("click", this.handleBackDropClick)
        }, Dialog.prototype._unbindEvents = function () {
            this.options.keyboard && body.unbind("keydown", this.handledEscapeKey), this.options.backdrop && this.options.backdropClick && this.backdropEl.unbind("click", this.handleBackDropClick)
        }, Dialog.prototype._onCloseComplete = function (result) {
            this._removeElementsFromDom(), this._unbindEvents(), this.deferred.resolve(result)
        }, Dialog.prototype._addElementsToDom = function () {
            body.append(this.modalEl), this.options.backdrop && (0 === activeBackdrops.value && body.append(this.backdropEl), activeBackdrops.value++), this._open = !0
        }, Dialog.prototype._removeElementsFromDom = function () {
            this.modalEl.remove(), this.options.backdrop && (activeBackdrops.value--, 0 === activeBackdrops.value && this.backdropEl.remove()), this._open = !1
        }, Dialog.prototype._loadResolves = function () {
            var templatePromise, values = [], keys = [], self = this;
            return this.options.template ? templatePromise = $q.when(this.options.template) : this.options.templateUrl && (templatePromise = $http.get(this.options.templateUrl, {cache: $templateCache}).then(function (response) {
                return response.data
            })), angular.forEach(this.options.resolve || [], function (value, key) {
                keys.push(key), values.push(angular.isString(value) ? $injector.get(value) : $injector.invoke(value))
            }), keys.push("$template"), values.push(templatePromise), $q.all(values).then(function (values) {
                var locals = {};
                return angular.forEach(values, function (value, index) {
                    locals[keys[index]] = value
                }), locals.dialog = self, locals
            })
        }, {dialog: function (opts) {
            return new Dialog(opts)
        }, messageBox: function (title, message, buttons) {
            return new Dialog({templateUrl: "template/dialog/message.html", controller: "MessageBoxController", resolve: {model: function () {
                return{title: title, message: message, buttons: buttons}
            }}})
        }}
    }]
}), angular.module("ui.bootstrap.modal", ["ui.bootstrap.dialog"]).directive("modal", ["$parse", "$dialog", function ($parse, $dialog) {
    return{restrict: "EA", terminal: !0, link: function (scope, elm, attrs) {
        var setClosed, opts = angular.extend({}, scope.$eval(attrs.uiOptions || attrs.bsOptions || attrs.options)), shownExpr = attrs.modal || attrs.show;
        opts = angular.extend(opts, {template: elm.html(), resolve: {$scope: function () {
            return scope
        }}});
        var dialog = $dialog.dialog(opts);
        elm.remove(), setClosed = attrs.close ? function () {
            $parse(attrs.close)(scope)
        } : function () {
            angular.isFunction($parse(shownExpr).assign) && $parse(shownExpr).assign(scope, !1)
        }, scope.$watch(shownExpr, function (isShown) {
            isShown ? dialog.open().then(function () {
                setClosed()
            }) : dialog.isOpen() && dialog.close()
        })
    }}
}]), angular.module("ui.bootstrap.tooltip", ["ui.bootstrap.position"]).provider("$tooltip",function () {
    function snake_case(name) {
        var regexp = /[A-Z]/g, separator = "-";
        return name.replace(regexp, function (letter, pos) {
            return(pos ? separator : "") + letter.toLowerCase()
        })
    }

    var defaultOptions = {placement: "top", animation: !0, popupDelay: 0}, triggerMap = {mouseenter: "mouseleave", click: "click", focus: "blur"}, globalOptions = {};
    this.options = function (value) {
        angular.extend(globalOptions, value)
    }, this.setTriggers = function (triggers) {
        angular.extend(triggerMap, triggers)
    }, this.$get = ["$window", "$compile", "$timeout", "$parse", "$document", "$position", "$interpolate", function ($window, $compile, $timeout, $parse, $document, $position, $interpolate) {
        return function (type, prefix, defaultTriggerShow) {
            function getTriggers(trigger) {
                var show = trigger || options.trigger || defaultTriggerShow, hide = triggerMap[show] || show;
                return{show: show, hide: hide}
            }

            var options = angular.extend({}, defaultOptions, globalOptions), directiveName = snake_case(type), startSym = $interpolate.startSymbol(), endSym = $interpolate.endSymbol(), template = "<" + directiveName + '-popup title="' + startSym + "tt_title" + endSym + '" content="' + startSym + "tt_content" + endSym + '" placement="' + startSym + "tt_placement" + endSym + '" animation="tt_animation()" is-open="tt_isOpen"></' + directiveName + "-popup>";
            return{restrict: "EA", scope: !0, link: function (scope, element, attrs) {
                function toggleTooltipBind() {
                    scope.tt_isOpen ? hideTooltipBind() : showTooltipBind()
                }

                function showTooltipBind() {
                    scope.tt_popupDelay ? popupTimeout = $timeout(show, scope.tt_popupDelay) : scope.$apply(show)
                }

                function hideTooltipBind() {
                    scope.$apply(function () {
                        hide()
                    })
                }

                function show() {
                    var position, ttWidth, ttHeight, ttPosition;
                    if (scope.tt_content) {
                        switch (transitionTimeout && $timeout.cancel(transitionTimeout), tooltip.css({top: 0, left: 0, display: "block"}), appendToBody ? ($body = $body || $document.find("body"), $body.append(tooltip)) : element.after(tooltip), position = appendToBody ? $position.offset(element) : $position.position(element), ttWidth = tooltip.prop("offsetWidth"), ttHeight = tooltip.prop("offsetHeight"), scope.tt_placement) {
                            case"mouse":
                                var mousePos = $position.mouse();
                                ttPosition = {top: mousePos.y, left: mousePos.x};
                                break;
                            case"right":
                                ttPosition = {top: position.top + position.height / 2 - ttHeight / 2, left: position.left + position.width};
                                break;
                            case"bottom":
                                ttPosition = {top: position.top + position.height, left: position.left + position.width / 2 - ttWidth / 2};
                                break;
                            case"left":
                                ttPosition = {top: position.top + position.height / 2 - ttHeight / 2, left: position.left - ttWidth};
                                break;
                            default:
                                ttPosition = {top: position.top - ttHeight, left: position.left + position.width / 2 - ttWidth / 2}
                        }
                        ttPosition.top += "px", ttPosition.left += "px", tooltip.css(ttPosition), scope.tt_isOpen = !0
                    }
                }

                function hide() {
                    scope.tt_isOpen = !1, $timeout.cancel(popupTimeout), angular.isDefined(scope.tt_animation) && scope.tt_animation() ? transitionTimeout = $timeout(function () {
                        tooltip.remove()
                    }, 500) : tooltip.remove()
                }

                var transitionTimeout, popupTimeout, $body, tooltip = $compile(template)(scope), appendToBody = angular.isDefined(options.appendToBody) ? options.appendToBody : !1, triggers = getTriggers(void 0), hasRegisteredTriggers = !1;
                scope.tt_isOpen = !1, attrs.$observe(type, function (val) {
                    scope.tt_content = val
                }), attrs.$observe(prefix + "Title", function (val) {
                    scope.tt_title = val
                }), attrs.$observe(prefix + "Placement", function (val) {
                    scope.tt_placement = angular.isDefined(val) ? val : options.placement
                }), attrs.$observe(prefix + "Animation", function (val) {
                    scope.tt_animation = angular.isDefined(val) ? $parse(val) : function () {
                        return options.animation
                    }
                }), attrs.$observe(prefix + "PopupDelay", function (val) {
                    var delay = parseInt(val, 10);
                    scope.tt_popupDelay = isNaN(delay) ? options.popupDelay : delay
                }), attrs.$observe(prefix + "Trigger", function (val) {
                    hasRegisteredTriggers && (element.unbind(triggers.show, showTooltipBind), element.unbind(triggers.hide, hideTooltipBind)), triggers = getTriggers(val), triggers.show === triggers.hide ? element.bind(triggers.show, toggleTooltipBind) : (element.bind(triggers.show, showTooltipBind), element.bind(triggers.hide, hideTooltipBind)), hasRegisteredTriggers = !0
                }), attrs.$observe(prefix + "AppendToBody", function (val) {
                    appendToBody = angular.isDefined(val) ? $parse(val)(scope) : appendToBody
                }), appendToBody && scope.$on("$locationChangeSuccess", function () {
                    scope.tt_isOpen && hide()
                }), scope.$on("$destroy", function () {
                    scope.tt_isOpen ? hide() : tooltip.remove()
                })
            }}
        }
    }]
}).directive("tooltipPopup",function () {
    return{restrict: "E", replace: !0, scope: {content: "@", placement: "@", animation: "&", isOpen: "&"}, templateUrl: "template/tooltip/tooltip-popup.html"}
}).directive("tooltip", ["$tooltip", function ($tooltip) {
    return $tooltip("tooltip", "tooltip", "mouseenter")
}]).directive("tooltipHtmlUnsafePopup",function () {
    return{restrict: "E", replace: !0, scope: {content: "@", placement: "@", animation: "&", isOpen: "&"}, templateUrl: "template/tooltip/tooltip-html-unsafe-popup.html"}
}).directive("tooltipHtmlUnsafe", ["$tooltip", function ($tooltip) {
    return $tooltip("tooltipHtmlUnsafe", "tooltip", "mouseenter")
}]), angular.module("template/accordion/accordion-group.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/accordion/accordion-group.html", '<div class="accordion-group">\n  <div class="accordion-heading" ><a class="accordion-toggle" ng-click="isOpen = !isOpen" accordion-transclude="heading">{{heading}}</a></div>\n  <div class="accordion-body" collapse="!isOpen">\n    <div class="accordion-inner" ng-transclude></div>  </div>\n</div>')
}]), angular.module("template/accordion/accordion.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/accordion/accordion.html", '<div class="accordion" ng-transclude></div>')
}]), angular.module("template/carousel/carousel.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/carousel/carousel.html", '<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel">\n    <ol class="carousel-indicators" ng-show="slides().length > 1">\n        <li ng-repeat="slide in slides()" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a ng-click="prev()" class="carousel-control left" ng-show="slides().length > 1">&lsaquo;</a>\n    <a ng-click="next()" class="carousel-control right" ng-show="slides().length > 1">&rsaquo;</a>\n</div>\n')
}]), angular.module("template/carousel/slide.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/carousel/slide.html", "<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item\" ng-transclude></div>\n")
}]), angular.module("template/datepicker/datepicker.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/datepicker/datepicker.html", '<table>\n  <thead>\n    <tr class="text-center">\n      <th><button type="button" class="btn pull-left" ng-click="move(-1)"><i class="icon-chevron-left"></i></button></th>\n      <th colspan="{{rows[0].length - 2 + showWeekNumbers}}"><button type="button" class="btn btn-block" ng-click="toggleMode()"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn pull-right" ng-click="move(1)"><i class="icon-chevron-right"></i></button></th>\n    </tr>\n    <tr class="text-center" ng-show="labels.length > 0">\n      <th ng-show="showWeekNumbers">#</th>\n      <th ng-repeat="label in labels">{{label}}</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows">\n      <td ng-show="showWeekNumbers" class="text-center"><em>{{ getWeekNumber(row) }}</em></td>\n      <td ng-repeat="dt in row" class="text-center">\n        <button type="button" style="width:100%;" class="btn" ng-class="{\'btn-info\': dt.selected}" ng-click="select(dt.date)" ng-disabled="dt.disabled"><span ng-class="{muted: dt.secondary}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')
}]), angular.module("template/datepicker/popup.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/datepicker/popup.html", '<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" class="dropdown-menu">\n	<li ng-transclude></li>\n	<li class="divider"></li>\n	<li style="padding: 9px;">\n		<span class="btn-group">\n			<button class="btn btn-small btn-inverse" ng-click="today()">Today</button>\n			<button class="btn btn-small btn-info" ng-click="showWeeks = ! showWeeks" ng-class="{active: showWeeks}">Weeks</button>\n			<button class="btn btn-small btn-danger" ng-click="clear()">Clear</button>\n		</span>\n		<button class="btn btn-small btn-success pull-right" ng-click="isOpen = false">Close</button>\n	</li>\n</ul>')
}]), angular.module("template/dialog/message.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/dialog/message.html", '<div class="modal-header">\n	<h3>{{ title }}</h3>\n</div>\n<div class="modal-body">\n	<p>{{ message }}</p>\n</div>\n<div class="modal-footer">\n	<button ng-repeat="btn in buttons" ng-click="close(btn.result)" class="btn" ng-class="btn.cssClass">{{ btn.label }}</button>\n</div>\n')
}]), angular.module("template/tooltip/tooltip-html-unsafe-popup.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html", '<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html-unsafe="content"></div>\n</div>\n')
}]), angular.module("template/tooltip/tooltip-popup.html", []).run(["$templateCache", function ($templateCache) {
    $templateCache.put("template/tooltip/tooltip-popup.html", '<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')
}]);
"use strict";
!function () {
    plentific.app = angular.module("plentific.app", ["ngCookies", "ngResource", "ngSanitize", "angulartics", "angulartics.google.analytics", "restangular", "ui.bootstrap", "ui.state", "ui.select2", "plDragDrop"]), plentific.app.constant("ZOOPLA_DEFAULT_VALUE_IDENT", "_DEFAULT_"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_SIZE_LARGE", "LARGE"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_SIZE_UNDOCUMENTED_LARGE", "UNDOCUMENTED_LARGE"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_SIZE_THUMBNAIL", "THUMB"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_SIZE_ORIGINAL", "ORIGINAL"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_TYPE_MAIN", "MAIN"), plentific.app.constant("ZOOPLA_PROPERTY_IMAGE_TYPE_ADDITIONAL", "ADDITIONAL"), plentific.app.constant("PLENTIFIC_API_BASE", plentific.CONFIG.API_BASE), plentific.app.constant("GOOGLE_MAPS_API_KEY", "AIzaSyDtysgDnRCeSaL7Y0Fr2CAvovJBv855DDo"), plentific.app.constant("SPINNER_CONFIGS", {PROPERTY_SEARCH: {lines: 13, length: 28, width: 12, radius: 33, corners: 1, rotate: 0, direction: 1, color: "#fff", speed: 1, trail: 48, shadow: !1, hwaccel: !1, className: "spinner", zIndex: 1e3, top: "auto", left: "auto"}, DEFAULT: {lines: 13, length: 28, width: 12, radius: 33, corners: 1, rotate: 0, direction: 1, color: "#fff", speed: 1, trail: 48, shadow: !1, hwaccel: !1, className: "spinner", zIndex: 1e3, top: "auto", left: "auto"}}), plentific.app.config(["$interpolateProvider", "$locationProvider", "$routeProvider", "$stateProvider", "$urlRouterProvider", "$analyticsProvider", "RestangularProvider", function (a, b, c, d, e, f, g) {
        a.startSymbol("[["), a.endSymbol("]]"), b.html5Mode(!0), f.virtualPageviews(!1), f.firstPageview(!1), e.when("/", "/milestone-tracking/"), e.when("/calculators/", "/calculators/affordability/"), d.state("myaccount", {url: "/my-account/", views: {"screen-content@": {controller: "MyAccountController", templateUrl: "/partials/views/auth/myaccount.html"}}, data: {page_title: "My Account", screen_classname: "screen--myaccount", screen_title: "My Account"}}).state("dashboard", {url: "/dashboard/", views: {"screen-content@": {controller: "DashboardController", templateUrl: "/partials/views/dashboard/dashboard.html"}}, data: {page_title: "Dashboard", sidebar_section: "dashboard", screen_classname: "screen--dashboard", screen_title: "Dashboard"}}).state("milestone-tracking", {url: "/milestone-tracking/", views: {"screen-content@": {controller: "MilestoneTrackingController", templateUrl: "/partials/views/milestone-tracking/milestone-tracking.html"}}, data: {page_title: "Milestone Tracking", sidebar_section: "milestone-tracking", screen_classname: "screen--milestone-tracking", screen_title: "Milestone Tracking"}}).state("calculators", {"abstract": !0, url: "/calculators"}).state("calculators.affordability", {url: "/affordability/", views: {"screen-content@": {controller: "AffordabilityCalculatorController", templateUrl: "/partials/views/calculators/affordability.html"}}, data: {page_title: "Affordability Calculator", sidebar_section: "calculators", screen_classname: "screen--calculators", screen_title: "Calculators"}}).state("calculators.budget", {url: "/budget/", views: {"screen-content@": {controller: "BudgetCalculatorController", templateUrl: "/partials/views/calculators/budget.html"}}, data: {page_title: "Budget Calculator", sidebar_section: "calculators", screen_classname: "screen--calculators", screen_title: "Calculators"}}).state("calculators.networth", {url: "/net-worth/", views: {"screen-content@": {controller: "NetWorthCalculatorController", templateUrl: "/partials/views/calculators/net-worth.html"}}, data: {page_title: "Net Worth Calculator", sidebar_section: "calculators", screen_classname: "screen--calculators", screen_title: "Calculators"}}).state("property-search", {url: "/property-search/", views: {"screen-content@": {controller: "PropertySearchController", templateUrl: "/partials/views/property-search/search.html"}}, data: {page_title: "Property Search", sidebar_section: "property-search", sidebar_style: "minimal", screen_classname: "screen--property-search", screen_title: "Property Search", subnav_section: "search"}}).state("property-details", {parent: "property-search", url: "property/:propertyId/", views: {"property-search-modal@property-search": {controller: "PropertyDetailParentController", templateUrl: "/partials/views/property-search/detail.html"}}, data: {page_title: "Property Details", sidebar_section: "property-search", sidebar_style: "minimal", screen_classname: "screen--property-search", screen_title: "Property Search", subnav_section: "search"}}).state("property-comparison", {parent: "property-search", url: "compare/", views: {"property-search-modal@property-search": {controller: "PropertyComparisonController", templateUrl: "/partials/views/property-search/compare.html"}}, data: {page_title: "Property Comparison", sidebar_section: "property-search", sidebar_style: "minimal", screen_classname: "screen--property-search screen--property-compare", screen_title: "Property Search", subnav_section: "compare"}}).state("mortgage-advice", {url: "/mortgage-advice/", views: {"screen-content@": {controller: "MortgageAdviceController", templateUrl: "/partials/views/mortgage-advice/mortgage-advice.html"}}, data: {page_title: "Mortgage Advice", sidebar_section: "mortgage-advice", screen_classname: "screen--mortgage-advice", screen_title: "Mortgage Advice"}}).state("legal-advice", {url: "/legal-advice/", views: {"screen-content@": {controller: "LegalAdviceController", templateUrl: "/partials/views/legal-advice/legal-advice.html"}}, data: {page_title: "Legal Advice", sidebar_section: "legal-advice", screen_classname: "screen--legal-advice", screen_title: "Legal Advice"}}).state("property-coach", {url: "/property-coach/", views: {"screen-content@": {controller: "PropertyCoachController", templateUrl: "/partials/views/property-coach/property-coach.html"}}, data: {page_title: "Property Coach", sidebar_section: "property-coach", screen_classname: "screen--property-coach", screen_title: "Property Coach"}}).state("my-documents", {url: "/documents/", views: {"screen-content@": {controller: "MyDocumentsController", templateUrl: "/partials/views/my-documents/my-documents.html"}}, data: {page_title: "My Documents", sidebar_section: "my-documents", screen_classname: "screen--my-documents", screen_title: "My Documents"}}), g.setBaseUrl("/api"), g.setRequestSuffix("/"), g.setResponseExtractor(function (a) {
            var b = a, c = angular.copy(a);
            if (angular.isArray(a))angular.forEach(b, function (a, c) {
                b[c].originalResponse = angular.copy(a)
            }); else if (angular.isObject(a)) {
                if ("_meta"in a)return b = angular.copy(a.results), b._meta = a._meta, b;
                b.originalResponse = c
            }
            return b
        })
    }]), plentific.app.run(["$http", "$cookies", "$rootScope", "$state", "$stateParams", function (a, b, c, d, e) {
        c.$debugMode = plentific.CONFIG.DEBUG ? "on" : "off", c.$state = d, c.$stateParams = e, a.defaults.headers.post["X-CSRFToken"] = b.csrftoken, a.defaults.headers.put["X-CSRFToken"] = b.csrftoken, a.defaults.headers["delete"] = a.defaults.headers.put, $(window).keypress(function (a) {
            if (13 === a.keyCode) {
                if (a.target && a.target.form && $(a.target.form).hasClass("submit-on-enter"))return;
                a.preventDefault()
            }
        }), Modernizr.touch === !0 ? $("body").addClass("is-touch") : $("body").addClass("not-touch")
    }])
}(), window.Modernizr = function (a, b, c) {
    function d(a) {
        s.cssText = a
    }

    function e(a, b) {
        return typeof a === b
    }

    function f(a, b) {
        return!!~("" + a).indexOf(b)
    }

    function g(a, b) {
        for (var d in a) {
            var e = a[d];
            if (!f(e, "-") && s[e] !== c)return"pfx" == b ? e : !0
        }
        return!1
    }

    function h(a, b, d) {
        for (var f in a) {
            var g = b[a[f]];
            if (g !== c)return d === !1 ? a[f] : e(g, "function") ? g.bind(d || b) : g
        }
        return!1
    }

    function i(a, b, c) {
        var d = a.charAt(0).toUpperCase() + a.slice(1), f = (a + " " + v.join(d + " ") + d).split(" ");
        return e(b, "string") || e(b, "undefined") ? g(f, b) : (f = (a + " " + w.join(d + " ") + d).split(" "), h(f, b, c))
    }

    var j, k, l, m = "2.6.2", n = {}, o = !0, p = b.documentElement, q = "modernizr", r = b.createElement(q), s = r.style, t = ({}.toString, " -webkit- -moz- -o- -ms- ".split(" ")), u = "Webkit Moz O ms", v = u.split(" "), w = u.toLowerCase().split(" "), x = {}, y = [], z = y.slice, A = function (a, c, d, e) {
        var f, g, h, i, j = b.createElement("div"), k = b.body, l = k || b.createElement("body");
        if (parseInt(d, 10))for (; d--;)h = b.createElement("div"), h.id = e ? e[d] : q + (d + 1), j.appendChild(h);
        return f = ["&#173;", '<style id="s', q, '">', a, "</style>"].join(""), j.id = q, (k ? j : l).innerHTML += f, l.appendChild(j), k || (l.style.background = "", l.style.overflow = "hidden", i = p.style.overflow, p.style.overflow = "hidden", p.appendChild(l)), g = c(j, a), k ? j.parentNode.removeChild(j) : (l.parentNode.removeChild(l), p.style.overflow = i), !!g
    }, B = function (b) {
        var c = a.matchMedia || a.msMatchMedia;
        if (c)return c(b).matches;
        var d;
        return A("@media " + b + " { #" + q + " { position: absolute; } }", function (b) {
            d = "absolute" == (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle).position
        }), d
    }, C = function () {
        function a(a, f) {
            f = f || b.createElement(d[a] || "div"), a = "on" + a;
            var g = a in f;
            return g || (f.setAttribute || (f = b.createElement("div")), f.setAttribute && f.removeAttribute && (f.setAttribute(a, ""), g = e(f[a], "function"), e(f[a], "undefined") || (f[a] = c), f.removeAttribute(a))), f = null, g
        }

        var d = {select: "input", change: "input", submit: "form", reset: "form", error: "img", load: "img", abort: "img"};
        return a
    }(), D = {}.hasOwnProperty;
    l = e(D, "undefined") || e(D.call, "undefined") ? function (a, b) {
        return b in a && e(a.constructor.prototype[b], "undefined")
    } : function (a, b) {
        return D.call(a, b)
    }, Function.prototype.bind || (Function.prototype.bind = function (a) {
        var b = this;
        if ("function" != typeof b)throw new TypeError;
        var c = z.call(arguments, 1), d = function () {
            if (this instanceof d) {
                var e = function () {
                };
                e.prototype = b.prototype;
                var f = new e, g = b.apply(f, c.concat(z.call(arguments)));
                return Object(g) === g ? g : f
            }
            return b.apply(a, c.concat(z.call(arguments)))
        };
        return d
    }), x.touch = function () {
        var c;
        return"ontouchstart"in a || a.DocumentTouch && b instanceof DocumentTouch ? c = !0 : A(["@media (", t.join("touch-enabled),("), q, ")", "{#modernizr{top:9px;position:absolute}}"].join(""), function (a) {
            c = 9 === a.offsetTop
        }), c
    }, x.history = function () {
        return!!a.history && !!history.pushState
    }, x.csstransforms = function () {
        return!!i("transform")
    }, x.csstransforms3d = function () {
        var a = !!i("perspective");
        return a && "webkitPerspective"in p.style && A("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}", function (b) {
            a = 9 === b.offsetLeft && 3 === b.offsetHeight
        }), a
    }, x.csstransitions = function () {
        return i("transition")
    };
    for (var E in x)l(x, E) && (k = E.toLowerCase(), n[k] = x[E](), y.push((n[k] ? "" : "no-") + k));
    return n.addTest = function (a, b) {
        if ("object" == typeof a)for (var d in a)l(a, d) && n.addTest(d, a[d]); else {
            if (a = a.toLowerCase(), n[a] !== c)return n;
            b = "function" == typeof b ? b() : b, "undefined" != typeof o && o && (p.className += " " + (b ? "" : "no-") + a), n[a] = b
        }
        return n
    }, d(""), r = j = null, n._version = m, n._prefixes = t, n._domPrefixes = w, n._cssomPrefixes = v, n.mq = B, n.hasEvent = C, n.testProp = function (a) {
        return g([a])
    }, n.testAllProps = i, n.testStyles = A, n.prefixed = function (a, b, c) {
        return b ? i(a, b, c) : i(a, "pfx")
    }, p.className = p.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (o ? " js " + y.join(" ") : ""), n
}(this, this.document), function (a, b) {
    function c(a, b) {
        var c = a.createElement("p"), d = a.getElementsByTagName("head")[0] || a.documentElement;
        return c.innerHTML = "x<style>" + b + "</style>", d.insertBefore(c.lastChild, d.firstChild)
    }

    function d() {
        var a = w.elements;
        return"string" == typeof a ? a.split(" ") : a
    }

    function e(a) {
        var b = v[a[t]];
        return b || (b = {}, u++, a[t] = u, v[u] = b), b
    }

    function f(a, c, d) {
        if (c || (c = b), p)return c.createElement(a);
        d || (d = e(c));
        var f;
        return f = d.cache[a] ? d.cache[a].cloneNode() : s.test(a) ? (d.cache[a] = d.createElem(a)).cloneNode() : d.createElem(a), f.canHaveChildren && !r.test(a) ? d.frag.appendChild(f) : f
    }

    function g(a, c) {
        if (a || (a = b), p)return a.createDocumentFragment();
        c = c || e(a);
        for (var f = c.frag.cloneNode(), g = 0, h = d(), i = h.length; i > g; g++)f.createElement(h[g]);
        return f
    }

    function h(a, b) {
        b.cache || (b.cache = {}, b.createElem = a.createElement, b.createFrag = a.createDocumentFragment, b.frag = b.createFrag()), a.createElement = function (c) {
            return w.shivMethods ? f(c, a, b) : b.createElem(c)
        }, a.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + d().join().replace(/\w+/g, function (a) {
            return b.createElem(a), b.frag.createElement(a), 'c("' + a + '")'
        }) + ");return n}")(w, b.frag)
    }

    function i(a) {
        a || (a = b);
        var d = e(a);
        return w.shivCSS && !o && !d.hasCSS && (d.hasCSS = !!c(a, "article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")), p || h(a, d), a
    }

    function j(a) {
        for (var b, c = a.getElementsByTagName("*"), e = c.length, f = RegExp("^(?:" + d().join("|") + ")$", "i"), g = []; e--;)b = c[e], f.test(b.nodeName) && g.push(b.applyElement(k(b)));
        return g
    }

    function k(a) {
        for (var b, c = a.attributes, d = c.length, e = a.ownerDocument.createElement(y + ":" + a.nodeName); d--;)b = c[d], b.specified && e.setAttribute(b.nodeName, b.nodeValue);
        return e.style.cssText = a.style.cssText, e
    }

    function l(a) {
        for (var b, c = a.split("{"), e = c.length, f = RegExp("(^|[\\s,>+~])(" + d().join("|") + ")(?=[[\\s,>+~#.:]|$)", "gi"), g = "$1" + y + "\\:$2"; e--;)b = c[e] = c[e].split("}"), b[b.length - 1] = b[b.length - 1].replace(f, g), c[e] = b.join("}");
        return c.join("{")
    }

    function m(a) {
        for (var b = a.length; b--;)a[b].removeNode()
    }

    function n(a) {
        function b() {
            clearTimeout(g._removeSheetTimer), d && d.removeNode(!0), d = null
        }

        var d, f, g = e(a), h = a.namespaces, i = a.parentWindow;
        return!z || a.printShived ? a : ("undefined" == typeof h[y] && h.add(y), i.attachEvent("onbeforeprint", function () {
            b();
            for (var e, g, h, i = a.styleSheets, k = [], m = i.length, n = Array(m); m--;)n[m] = i[m];
            for (; h = n.pop();)if (!h.disabled && x.test(h.media)) {
                try {
                    e = h.imports, g = e.length
                } catch (o) {
                    g = 0
                }
                for (m = 0; g > m; m++)n.push(e[m]);
                try {
                    k.push(h.cssText)
                } catch (o) {
                }
            }
            k = l(k.reverse().join("")), f = j(a), d = c(a, k)
        }), i.attachEvent("onafterprint", function () {
            m(f), clearTimeout(g._removeSheetTimer), g._removeSheetTimer = setTimeout(b, 500)
        }), a.printShived = !0, a)
    }

    var o, p, q = a.html5 || {}, r = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i, s = /^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i, t = "_html5shiv", u = 0, v = {};
    !function () {
        try {
            var a = b.createElement("a");
            a.innerHTML = "<xyz></xyz>", o = "hidden"in a, p = 1 == a.childNodes.length || function () {
                b.createElement("a");
                var a = b.createDocumentFragment();
                return"undefined" == typeof a.cloneNode || "undefined" == typeof a.createDocumentFragment || "undefined" == typeof a.createElement
            }()
        } catch (c) {
            o = !0, p = !0
        }
    }();
    var w = {elements: q.elements || "abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video", shivCSS: q.shivCSS !== !1, supportsUnknownElements: p, shivMethods: q.shivMethods !== !1, type: "default", shivDocument: i, createElement: f, createDocumentFragment: g};
    a.html5 = w, i(b);
    var x = /^$|\b(?:all|print)\b/, y = "html5shiv", z = !p && function () {
        var c = b.documentElement;
        return"undefined" != typeof b.namespaces && "undefined" != typeof b.parentWindow && "undefined" != typeof c.applyElement && "undefined" != typeof c.removeNode && "undefined" != typeof a.attachEvent
    }();
    w.type += " print", w.shivPrint = n, n(b)
}(this, document), function () {
    window.plentific = plentific || {app: null, utils: null}, plentific.utils = {isRetinaDisplay: function () {
        var a = "(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)";
        return window.devicePixelRatio > 1 ? !0 : window.matchMedia && window.matchMedia(a).matches ? !0 : !1
    }, getImageFilename: function (a, b) {
        return angular.isString(a) !== !0 ? null : plentific.utils.isRetinaDisplay() ? a + "-2x." + b : a + "." + b
    }, objToUrl: function (a) {
        var b = /(\[([\w\-_]+)\])/g, c = decodeURIComponent($.param(a));
        return c.replace(b, ".$2")
    }, urlToObj: function (a) {
        angular.isObject(a) && (a = plentific.utils.locationSearchToQueryString(a));
        var b = a.split("&"), c = {}, d = function (a, b) {
            var d = a.split("."), e = c;
            d[0]in e || !e.execScript || e.execScript("var " + d[0]);
            for (var f; d.length && (f = d.shift());)d.length || void 0 === b ? e = e[f] ? e[f] : e[f] = {} : /\[\]$/.test(f) === !0 ? (f = f.replace("[]", ""), angular.isUndefined(e[f]) && (e[f] = []), e[f].push(b.replace(/\+/g, " "))) : e[f] = b.replace(/\+/g, " ")
        };
        return angular.forEach(b, function (a) {
            var b = a.split("=");
            d(b[0], b[1])
        }), c
    }, locationSearchToQueryString: function (a) {
        var b = [];
        return angular.forEach(a, function (a, c) {
            b.push(c + "=" + a)
        }), b.join("&")
    }, setPristine: function (a) {
        angular.forEach(a, function (b) {
            b !== a && b.$name && (b.$pristine = !0, b.$dirty = !1, delete b.$error.serverMessages, $("input[name=" + b.$name + "]").removeClass("ng-dirty").addClass("ng-pristine"))
        }), a.$dirty = !1, a.$pristine = !0, $("form[name=" + a.$name + "]").removeClass("ng-dirty").addClass("ng-pristine")
    }}
}(), function () {
    angular.module("plDragDrop", []).service("plDragDropService", ["$log", function () {
        var a = function (a, c, d) {
            var e = Array.prototype.slice.call(arguments, 0);
            c.on(d, function () {
                var a, c = Array.prototype.slice.call(arguments, 0);
                a = e.slice(0), a.push(c), b.apply(this, a)
            })
        }, b = function (a, b, c, d, e) {
            if (d.callbacks) {
                var f = d.callbacks[c];
                _.isFunction(f) && f.apply(this, e)
            }
        };
        return{bindEventCallback: a}
    }]).directive("plDraggable", ["$log", "plDragDropService", function (a, b) {
        return{controller: function () {
        }, scope: !1, link: function (a, c, d) {
            function e(a, b) {
                var c = $(a.target).outerWidth();
                "original" !== h.jquiOptions.helper && h.setHelperWidth === !0 && b.helper.css("width", c)
            }

            var f, g, h;
            f = {jquiOptions: {}, setHelperWidth: !1}, g = ["dragcreate", "drag", "dragstart", "dragstop"], h = angular.extend({}, f, a.$eval(d.plDraggable)), Modernizr.touch !== !0 && (_.each(g, function (d) {
                b.bindEventCallback(a, c, d, h)
            }), c.draggable(h.jquiOptions), c.on("dragstart", e))
        }}
    }]).directive("plDroppable", ["$log", "plDragDropService", function (a, b) {
        return{controller: function () {
            a.log("Droppable controller function")
        }, scope: !1, link: function (a, c, d) {
            var e, f, g;
            e = {callbacks: {}, jquiOptions: {}}, f = ["dropactivate", "dropcreate", "dropdeactivate", "drop", "dropout", "dropover"], g = angular.extend({}, e, a.$eval(d.plDroppable)), _.each(f, function (d) {
                b.bindEventCallback(a, c, d, g)
            }), c.droppable(g.jquiOptions)
        }}
    }])
}(window, window.angular), function () {
    plentific.app.controller("AffordabilityCalculatorController", ["$scope", "$window", "$dialog", "$log", "$timeout", "AffordabilityUtilService", "UserService", "CaseService", "DataSavedService", "BudgetCalculatorService", "NetWorthCalculatorService", "$rootScope", function (a, b, c, d, e, f, g, h, i, j, k) {
        var l = 2;
        a.showSpinner = !0, a.STATIC_URL = plentific.CONFIG.STATIC_URL, f.getMortgageRates().then(function (b) {
            a.mortgageData = b, a.caseDataPromise.then(function (b) {
                a.showSpinner = !1, null === b.applicants[0].netMonthlyIncome && b.totalIncome && (b.applicants[0].netMonthlyIncome = b.totalIncome), null === b.monthlyExpenses && b.totalNonPropertyExpenses && (b.monthlyExpenses = b.totalNonPropertyExpenses), null === b.savings && b.netWorth && (b.savings = b.netWorth), b.overriddenVars.mortgageTerm = b.overriddenVars.mortgageTerm || f.MORTGAGE_TERM, angular.isUndefined(b.overriddenVars.savings) && (b.overriddenVars.savings = b.savings), void 0 === b.overriddenVars.estimatedAnnualHousePriceIncrease && (b.overriddenVars.estimatedAnnualHousePriceIncrease = 2), h.setFees(b.fees), h.getIncomes(h.getActiveCaseId()).then(function (b) {
                    j.setIncomes(b), a.totalMonthlyIncome = j.getTotalMonthlyIncome()
                }), h.getExpenses(h.getActiveCaseId()).then(function (b) {
                    j.setExpenses(b), a.totalMonthlyExpense = j.getTotalMonthlyExpense(), a.mortgagePaymentExpense = _.find(b, function (a) {
                        return"mortgage-payment" === a.slug
                    }), a.rentExpense = _.find(b, function (a) {
                        return"rent" === a.slug
                    })
                }), h.getAssets(h.getActiveCaseId()).then(function (b) {
                    k.setAssets(b), a.totalAssets = k.assetsTotal().runningTotal, a.realNetWorth = k.getAvailableFundForHouse(a.caseData.rainyDay, a.caseData.overriddenVars.payback) || 0
                }), h.getLiabilities(h.getActiveCaseId()).then(function (b) {
                    k.setLiabilities(b), a.totalLiabilities = k.liabilitiesTotal(), a.realNetWorth = k.getAvailableFundForHouse(a.caseData.rainyDay, a.caseData.overriddenVars.payback) || 0
                }), p(), a.caseData = b, a.caseData.overriddenVars.otherFees = a.sumFees(), a.$watch("caseData.overriddenVars", function (b, c) {
                    b !== c && a.updateResults()
                }, !0)
            })
        }), a.userData = g.userData, a.employmentStatuses = [
            {label: "Employed", value: "employed"},
            {label: "Self-employed", value: "selfemployed"},
            {label: "Other", value: "other"}
        ], a.employmentStatusDropdownOptions = {allowClear: !1, minimumResultsForSearch: 20}, a.savingsSliderMaxValue = 1e7, a.mortgageSliderMaxValue = 5e7, a.totalIncome = function () {
            return a.caseData ? f.totalIncome(a.caseData.applicants) : 0
        }, a.totalGrossAnnualIncome = function () {
            if (!a.caseData)return 0;
            var b = f.totalGrossAnnualIncome(a.caseData.applicants), c = f.totalGrossAnnualBonus(a.caseData.applicants);
            return a.optimisedHousePriceData && (a.mortgageSliderMaxValue = 2 * a.optimisedHousePriceData.loanSize), parseFloat(b) + parseFloat(c / 2)
        }, a.disposableIncome = function () {
            return a.caseData ? a.totalIncome() - a.caseData.monthlyExpenses : 0
        }, a.isDisposableIncomeNegative = function () {
            return a.disposableIncome() < 0 ? !0 : !1
        }, a.applicantName = function (b) {
            return a.caseData.applicants ? _.isEmpty(a.caseData.applicants[b].firstName) ? "Applicant " + (b + 1) : a.caseData.applicants[b].firstName + " " + a.caseData.applicants[b].lastName : void 0
        };
        var m = function () {
            return a.userData.user.id === a.caseData.owner ? !0 : !1
        };
        a.canDeleteApplicant = function (a) {
            return 0 !== a && m() ? !0 : !1
        }, a.deleteApplicant = function (b) {
            if (a.canDeleteApplicant(b)) {
                var c = a.caseData.applicants[b].id;
                h.removeApplicant(h.getActiveCaseId(), c).then(function () {
                    a.caseData.applicants.splice(b, 1)
                })
            }
        }, a.addApplicant = function () {
            h.addApplicant(h.getActiveCaseId()).then(function (b) {
                a.caseData.applicants.push(b)
            })
        }, a.canAddApplicant = function () {
            return a.caseData && m() && a.caseData.applicants.length < l ? !0 : !1
        };
        var n = _.debounce(function (a) {
            a.put().then(function () {
                i.setDataSaved(!0)
            })
        }, 500), o = _.debounce(function () {
            for (var b in a.caseData.applicants)a.caseData.applicants[b] && a.caseData.applicants[b].dirty === !0 && h.saveApplicant(a.caseData, b).then(function (b) {
                var c = _.find(a.caseData.applicants, {id: b.id});
                i.setDataSaved(!0), c.dirty = !1
            })
        }, 500);
        a.updateResults = function () {
            if (a.caseData) {
                var b = null;
                null !== a.caseData.overriddenVars.mortgageValue && (b = a.caseData.overriddenVars.mortgageValue, 0 > b && (b = null, a.caseData.overriddenVars.mortgageValueIsOverridden = !1));
                var c = null;
                if (a.caseData.overriddenVars.interestRateIsOverridden) {
                    if (_.isNaN(a.caseData.overriddenVars.interestRate / 100))return!1;
                    c = a.caseData.overriddenVars.interestRate / 100
                }
                if (_.isUndefined(a.caseData.overriddenVars.mortgageTerm))return!1;
                if (_.isUndefined(a.caseData.overriddenVars.otherFees))return!1;
                a.housePriceData = f.maxHousePrice(a.caseData.overriddenVars.savings, a.totalGrossAnnualIncome(), a.totalIncome(), a.disposableIncome(), a.caseData.overriddenVars.otherFees, b, c, a.caseData.overriddenVars.mortgageTerm, a.mortgageData), a.housePriceData.fees = f.getTotalOtherFees(_.clone(h.getFees(a.housePriceData.price), !0), a.housePriceData.price), a.optimisedHousePriceData = f.maxHousePrice(a.caseData.savings, a.totalGrossAnnualIncome(), a.totalIncome(), a.disposableIncome(), a.caseData.overriddenVars.otherFees, null, c, f.MORTGAGE_TERM, a.mortgageData), a.optimisedHousePriceData.fees = f.getTotalOtherFees(_.clone(h.getFees(a.optimisedHousePriceData.price), !0), a.optimisedHousePriceData.price)
            }
        }, a.optimisedMortgageTerm = function () {
            return f.MORTGAGE_TERM
        }, a.optimise = function () {
            d.warn("OPTIMISE"), a.atLeastOnceOptimised = !0, a.caseData.overriddenVars.mortgageTerm = f.MORTGAGE_TERM, a.caseData.overriddenVars.mortgageTermIsOverridden = !1, a.caseData.overriddenVars.mortgageValue = null, a.caseData.overriddenVars.mortgageValueIsOverridden = !1, a.caseData.overriddenVars.interestRate = parseFloat(a.caseData.overriddenVars.defaultInterestRate), a.caseData.overriddenVars.interestRateIsOverridden = !1, a.caseData.overriddenVars.savings = a.caseData.savings, a.caseData.overriddenVars.savingsIsOverridden = !1, a.caseData.overriddenVars.estimatedAnnualHousePriceIncrease = 2, a.optimised = !0
        }, a.feesDialogOpts = {showDialog: !1}, a.isOptimised = function () {
            return a.optimised
        }, a.unoptimise = function () {
            a.$$phase || a.optimised !== !0 || a.$apply(function () {
                a.optimised = !1
            })
        }, a.advancedClicked = function () {
            var b = c.dialog(a.feesDialogOpts);
            b.open().then(function (b) {
                b && a.caseData && a.caseData.fees !== b && (a.caseData.fees = _.clone(b, !0), a.caseData.overriddenVars.otherFees = a.sumFees(), h.setFees(_.clone(b, !0)), a.caseData.overriddenVars.otherFeesIsOverridden = !1)
            })
        }, a.otherFeesChanged = function () {
            a.caseData && a.caseData.overriddenVars && (a.caseData.overriddenVars.otherFeesIsOverridden = !0)
        }, a.interestRateChanged = function () {
            a.caseData && a.caseData.overriddenVars && (a.caseData.overriddenVars.interestRateIsOverridden = !0, a.unoptimise())
        }, a.savingsValueChanged = function () {
            a.caseData && a.caseData.overriddenVars && (a.caseData.overriddenVars.savingsIsOverridden = !0, a.unoptimise())
        }, a.mortgageValueChanged = function () {
            a.caseData && a.caseData.overriddenVars && (a.caseData.overriddenVars.mortgageValueIsOverridden = !0, a.unoptimise())
        }, a.mortgageTermChanged = function () {
            a.caseData && a.caseData.overriddenVars && (a.caseData.overriddenVars.mortgageTermIsOverridden = !0, a.unoptimise())
        }, a.mortgageMultiplierIndicator = function () {
            return a.housePriceData ? f.incomeMultipleIndicator(a.housePriceData.incomeMultiple) : void 0
        }, a.incomeIndicator = function () {
            return a.housePriceData ? f.incomeIndicator(a.housePriceData.mortgageIncomeRatio) : void 0
        }, a.disposableIncomeIndicator = function () {
            return a.housePriceData ? f.disposableIncomeIndicator(a.housePriceData.mortgageDisposableIncomeRatio) : void 0
        }, a.affordabilityIndicator = function () {
            var b = [a.mortgageMultiplierIndicator(), a.incomeIndicator(), a.disposableIncomeIndicator()], c = _.difference(b, ["amber", "red"]).length, d = _.difference(b, ["amber", "green"]).length;
            return c === b.length ? "green" : d >= 1 || "red" === a.loanToValueColor() ? "red" : "amber"
        }, a.depositIndicator = function () {
            return a.housePriceData && a.housePriceData.deposit < 0 ? "red" : a.affordabilityIndicator()
        }, a.loanToValueColor = function () {
            if (a.housePriceData) {
                var b = 100 * a.housePriceData.ltv;
                return 91 > b ? "green" : 96 > b && b > 90 ? "amber" : "red"
            }
        }, a.sumFees = function () {
            var b = _.reduce(_.pluck(a.caseData.fees, "value"), function (a, b) {
                return a + b
            });
            return b
        }, a.getInterestRateChartData = function () {
            for (var b = a.caseData.overriddenVars.mortgageValue, c = a.caseData.overriddenVars.mortgageTerm, d = parseFloat(a.caseData.overriddenVars.interestRate), e = [], g = 0; 5 > g; g++) {
                var h, i;
                h = 3 > d ? d - .2 * g : d - .5 * g, h = parseFloat(h).toFixed(2), i = Math.abs(f.PMT(h / 100 / 12, 12 * c, b, 0, 0)), e.push({interestRate: h, monthlyPayment: i, category: "blueBar"})
            }
            e = e.reverse();
            for (var g = 1; 6 > g; g++) {
                var h, i, j = "blueBar";
                g > 2 && (j = "blueBar"), h = d + parseFloat(.5 * g), h = parseFloat(h).toFixed(2), i = Math.abs(f.PMT(h / 100 / 12, 12 * c, b, 0, 0)), e.push({interestRate: h, monthlyPayment: i, category: j})
            }
            return{settings: {featuredElementIndex: 5}, data: e}
        }, a.drawInterestRateChart = function () {
            a.$broadcast("barChartDataUpdated", a.getInterestRateChartData())
        }, a.getMonthlyMortgageChartData = function () {
            var b = a.caseData.overriddenVars.mortgageValue, c = a.caseData.overriddenVars.mortgageTerm, d = a.caseData.overriddenVars.interestRate, e = [];
            e[0] = [], e[1] = [], e[2] = [];
            for (var g = 0; c > g; g++) {
                var h = Math.abs(f.PPMT(d / 100 / 12, 12 * (g + 1), 12 * c, b, 0, 0)), i = Math.abs(f.IPMT(d / 100 / 12, 12 * (g + 1), 12 * c, b, 0, 0));
                e[0].push({valueX: g, amount: h, category: "blue"}), e[1].push({valueX: g, amount: i, category: "red"}), e[2].push({valueX: g, amount: h + i, category: "green"})
            }
            return{settings: {startXFrom: 0, areas: !1, blueTooltipMessage: "Principal", redTooltipMessage: "Interest", greenTooltipMessage: "Mortgage payment"}, data: e}
        }, a.drawMonthlyMortgageChart = function () {
            a.$broadcast("linesChartDataUpdated", a.getMonthlyMortgageChartData())
        }, a.housePriceIncreaseChanged = function () {
            a.drawEquityGrowthChart()
        }, a.estimatedPriceFiveYears = 0, a.equityAmountFiveYears = 0, a.mortgagePaidFiveYears = 0, a.outstandingMortgageFiveYears = 0, a.percentageReturn = 0, a.setPercentageReturn = function () {
            var b = 100 * (a.equityAmountFiveYears / a.caseData.overriddenVars.savings);
            a.percentageReturn = b.toFixed(1)
        }, a.getEquityGrowthChartData = function () {
            var b = a.caseData.overriddenVars.mortgageValue, c = a.caseData.overriddenVars.mortgageTerm, d = a.caseData.overriddenVars.interestRate, e = a.caseData.overriddenVars.estimatedAnnualHousePriceIncrease, g = a.housePriceData.price, h = g, i = [], j = 0, k = b, l = h - k;
            i[0] = [], i[1] = [], angular.isUndefined(e) === !0 && (e = 0);
            for (var m = 0; c > m; m++) {
                var n = f.EFFECT(d / 100, 12), o = Math.abs(f.PPMT(n, m, c, b, 0, 0));
                j += o, k = b - j, h = Math.abs(f.FV(e / 100, m + 1, 0, g, 0)), l = h - k, 4 == m && (a.estimatedPriceFiveYears = h, a.mortgagePaidFiveYears = j, a.outstandingMortgageFiveYears = k, a.equityAmountFiveYears = l, a.setPercentageReturn()), i[0].push({valueX: m, amount: h, category: "blue"}), i[1].push({valueX: m, amount: k, category: "red"})
            }
            return{settings: {startXFrom: 0, areas: !0, blueTooltipMessage: "Estimated house price", redTooltipMessage: "Outstanding mortgage", greenTooltipMessage: "Equity"}, data: i}
        }, a.drawEquityGrowthChart = function () {
            a.$broadcast("linesChartDataUpdated", a.getEquityGrowthChartData())
        }, a.showResults = function () {
            a.affordabilitySubTabs[1].select()
        }, a.validateTab = function (b) {
            switch (b) {
                case"inputs-valid":
                    return a.validInputs()
            }
            return!1
        }, a.affordabilityForm = {grossAnnualIncome: {}, netMonthlyIncome: {}, age: [], savings: {}, invalid: !1}, a.validInputs = function () {
            return a.affordabilityForm.invalid = !1, a.totalGrossAnnualIncome() < 1e4 ? (a.affordabilityForm.grossAnnualIncome.errorMessage = "Please note, to use Plentific your gross annual income must be greater than £10,000", a.affordabilityForm.grossAnnualIncome.invalid = !0, a.affordabilityForm.invalid = !0) : a.affordabilityForm.grossAnnualIncome = {}, a.totalIncome() < 1e3 ? (a.affordabilityForm.netMonthlyIncome.errorMessage = "Please note, to use Plentific your monthly income must be greater than £1,000", a.affordabilityForm.netMonthlyIncome.invalid = !0, a.affordabilityForm.invalid = !0) : a.affordabilityForm.netMonthlyIncome = {}, a.affordabilityForm.age = [], angular.forEach(a.caseData.applicants, function (b, c) {
                a.affordabilityForm.age[c] = {}, b.age < 18 && (a.affordabilityForm.age[c].errorMessage = "You'll need to be at least 18 years old to apply for a mortgage.", a.affordabilityForm.age[c].invalid = !0, a.affordabilityForm.invalid = !0)
            }), a.caseData.savings < 5e3 ? (a.affordabilityForm.savings.errorMessage = "Please note, to use Plentific your savings for downpayment must be greater than £5,000", a.affordabilityForm.savings.invalid = !0, a.affordabilityForm.invalid = !0) : a.affordabilityForm.savings = {}, !a.affordabilityForm.invalid
        }, a.selectedChart = "interestRate", a.drawAffordabilityChart = function (b) {
            switch (b) {
                case"interestRate":
                    a.selectedChart = "interestRate", a.drawInterestRateChart();
                    break;
                case"monthlyMortgage":
                    a.selectedChart = "monthlyMortgage", a.drawMonthlyMortgageChart();
                    break;
                case"equityGrowth":
                    a.selectedChart = "equityGrowth", a.drawEquityGrowthChart();
                    break;
                case"allCharts":
                    a.drawAffordabilityChart(a.selectedChart)
            }
            a.atLeastOnceOptimised !== !0 && a.optimise()
        }, a.$watch("housePriceData", function (b, c) {
            b && b !== c && ((a.caseData.overriddenVars.mortgageValue > 0 || null === a.caseData.overriddenVars.mortgageValue) && (a.caseData.overriddenVars.mortgageValue = b.loanSize), a.caseData.overriddenVars.defaultInterestRate = parseFloat((100 * b.mortgageRate).toFixed(2)), (!a.caseData.overriddenVars.interestRateIsOverridden || a.caseData.overriddenVars.interestRate > 100 || null === a.caseData.overriddenVars.interestRate) && (a.caseData.overriddenVars.interestRate = a.caseData.overriddenVars.defaultInterestRate), a.housePriceData.excessCash < 0 && 0 === Math.round(a.housePriceData.excessCash) && (a.housePriceData.excessCash = 0), a.caseData.overriddenVars.otherFees = a.housePriceData.fees)
        });
        var p = function () {
            a.$watch("caseData.savings", function (b, c) {
                b && (a.caseData.overriddenVars.savings = b, a.savingsSliderMaxValue = 2 * b, angular.equals(b, c) || (a.atLeastOnceOptimised = !1))
            }), a.$watch("caseData.monthlyExpenses", function (b, c) {
                angular.equals(b, c) || (a.atLeastOnceOptimised = !1)
            }), a.$watch("caseData", function (a, b) {
                b && (_.isEqual(_.omit(a, "applicants", "overriddenVars"), _.omit(b, "applicants", "overriddenVars")) || (i.setDataSaved(!1), n(a)))
            }, !0), a.$watch("caseData.applicants", function (b, c) {
                var d, e = !1, f = ["age", "employmentStatus", "grossAnnualIncome", "grossAnnualBonus", "netMonthlyIncome"];
                if (b && c) {
                    for (var g in b) {
                        var h = b[g], j = c[g];
                        if (h && j && (d = i.checkDirty(h, j, f))) {
                            h.dirty = !0, h.grossAnnualIncomeIncludingBonus = h.grossAnnualIncome + h.grossAnnualBonus / 2, e = !0, i.setDataSaved(!1);
                            break
                        }
                    }
                    e && (o(), a.atLeastOnceOptimised = !1)
                }
            }, !0)
        }
    }])
}(), function () {
    plentific.app.controller("ApplicationController", ["$scope", "$rootScope", "$state", "$location", "AnalyticsService", "UserService", "DialogService", "CaseService", "ZOOPLA_DEFAULT_VALUE_IDENT", function (a, b, c, d, e, f, g, h, i) {
        function j() {
            a.caseDataPromise = h.getActiveCase()
        }

        function k() {
            var a = " - Plentific", d = c.current.data.page_title, e = "";
            e = _.isUndefined(d) ? "Plentific" : d + a, b.title = e
        }

        a.userData = f.userData, a.screenClassname = null, a.sidebar = {expanded: !1}, a.caseData = null, a.caseDataPromise = null, a.milestones = null, a.milestonePromise = null, a.DROPDOWN_CONFIG = {defaults: {options: {minimumResultsForSearch: -1}}};
        var l = 100, m = 500;
        a.SEARCH_RESULTS_LIMIT = l, a.SEARCH_MAX_RESULTS = m, a.search = {isPristine: !0, filters: ["keywords", "radius", "property_type", "new_homes"], isForcedQuarterMileSearch: !1, defaults: {area: "W1", keywords: "", minimum_beds: i, maximum_beds: i, minimum_price: i, maximum_price: i, new_homes: i, order_value: "_AGE_DESCENDING_", order_by: "age", ordering: "descending", page_number: 1, page_size: l, property_type: i, radius: i}, params: {area: "W1", keywords: "", minimum_beds: i, maximum_beds: i, minimum_price: i, maximum_price: i, new_homes: i, order_value: "_AGE_DESCENDING_", order_by: "age", ordering: "descending", page_number: 1, page_size: l, property_type: i, radius: i}, prices: ["10000", "20000", "30000", "40000", "50000", "60000", "70000", "80000", "90000", "100000", "110000", "120000", "130000", "140000", "150000", "160000", "170000", "180000", "190000", "200000", "210000", "220000", "230000", "240000", "250000", "275000", "300000", "325000", "350000", "375000", "400000", "425000", "450000", "475000", "500000", "550000", "600000", "650000", "700000", "750000", "800000", "850000", "900000", "950000", "1000000", "1100000", "1200000", "1300000", "1400000", "1500000", "1600000", "1700000", "1800000", "1900000", "2000000", "2100000", "2200000", "2300000", "2400000", "2500000", "2750000", "3000000", "3500000", "3750000", "4000000", "4250000", "4500000", "4750000", "5000000", "5500000", "6000000", "6500000", "7000000", "7500000", "8000000", "8500000", "9000000", "9500000", "10000000", "12500000", "15000000"]}, a.$on("avatarUpdated", function (b, c) {
            a.userData.user.avatar_30 = c
        }), b.$on("$stateChangeSuccess", function () {
            var b = [];
            console.warn("$stateChangeSuccess", arguments), k(), e.trackPage(d.url()), c.current.data.screen_classname !== a.screenClassname && b.push(c.current.data.screen_classname), c.current.data.sidebar_style ? b.push("screen-sidebar-style--" + c.current.data.sidebar_style) : b.push("screen-sidebar-style--normal"), a.screenClassname = b.join(" ")
        }), a.openDialog = function (b) {
            var c = g.getDialog(b);
            c.options.resolve && c.options.resolve.$scope || g.setDialogOptions(c, {resolve: {$scope: function () {
                return a
            }}}), c.open()
        }, j()
    }])
}(), function () {
    plentific.app.controller("ApplicationHeaderController", ["$cookies", "$scope", "DialogService", "$rootScope", "$state", function (a, b, c, d, e) {
        b.screenTitle = null, b.STATIC_URL = plentific.CONFIG.STATIC_URL, b.hideCookieMsg = a.hideCookieMsg, b.doHideCookieMsg = function () {
            a.hideCookieMsg = "true", b.hideCookieMsg = a.hideCookieMsg
        }, d.$on("$stateChangeSuccess", function () {
            e.current.data.screen_title !== b.screenTitle && (b.screenTitle = e.current.data.screen_title)
        }), b.openLoginDialog = function () {
            var a = c.getDialog("login");
            a.open()
        }, b.openSignupDialog = function () {
            var a = c.getDialog("signup");
            a.open().then(function (a) {
                a && (b.user = a, b.caseId = a.cases[0])
            })
        }
    }])
}(), function () {
    plentific.app.controller("AuthController", ["$analytics", "$log", "$scope", "$parse", "$route", "$timeout", "dialog", "DialogService", "UserService", function (a, b, c, d, e, f, g, h, i) {
        c.login = {}, c.user = {}, c.validationErrors = null, c.STATIC_URL = plentific.CONFIG.STATIC_URL;
        var j = function (a, b) {
            b.isSaving = !0, b.isSaved = !1, a.then(function () {
                b.isSaving = !1, b.isSaved = !0, plentific.utils.setPristine(b)
            }, function () {
                b.isSaving = !1, b.isSaved = !1
            })
        };
        c.close = function (a) {
            g.close(a)
        }, c.openLoginDialog = function () {
            g.close(), h.getDialog("login").open()
        }, c.openSignupDialog = function () {
            g.close(), h.getDialog("signup").open()
        }, c.openPasswordResetDialog = function () {
            g.close(), h.getDialog("passwordReset").open()
        }, c.emailOptIn = !1, c.signUp = function () {
            if (c.signupForm.submitAttempted = !0, c.newUser = {firstName: c.user.firstName, lastName: c.user.lastName, email: c.user.email, password: c.user.password, password2: c.user.password2}, angular.forEach(c.newUser, function (a, b) {
                var e = d("signupForm." + b + ".$error.serverMessages");
                c.signupForm.$setValidity(b, !0, c.signupForm), e.assign(c, [])
            }), c.newUser.password !== c.newUser.password2) {
                var e = "password2", g = "Both passwords should match.", h = d("signupForm." + e + ".$error.serverMessages");
                c.signupForm.$setValidity(e, !1, c.signupForm), h.assign(c, [g]), f(function () {
                    $("form[name=" + c.signupForm.$name + "] input[name=" + e + "]").focus()
                })
            } else c.signupForm.emailOptIn = !c.emailOptIn, i.createUser(c.newUser).then(function () {
                b.log("Tracking successful signup"), a.eventTrack("signup", {category: "user", label: "success"}), window.location = window.location
            }, function (a) {
                angular.forEach(c.login, function (a, b) {
                    var e = d("loginForm." + b + ".$error.serverMessages");
                    c.loginForm.$setValidity(b, !0, c.loginForm), e.assign(c, [])
                }), angular.forEach(a.data, function (a, b) {
                    if (a) {
                        var e = d("signupForm." + b + ".$error.serverMessages");
                        c.signupForm.$setValidity(b, !1, c.signupForm), e.assign(c, a), $("form[name=" + c.signupForm.$name + "] input[name=" + b + "]").focus()
                    }
                }), c.signupForm.$error.serverError = a.data.error
            })
        }, c.logIn = function () {
            c.loginForm.submitAttempted = !0, i.logIn(c.login).then(function () {
                window.location = window.location
            }, function (a) {
                angular.forEach(c.login, function (a, b) {
                    var e = d("loginForm." + b + ".$error.serverMessages");
                    c.loginForm.$setValidity(b, !0, c.loginForm), e.assign(c, [])
                }), angular.forEach(a.data, function (a, b) {
                    if (a) {
                        var e = d("loginForm." + b + ".$error.serverMessages");
                        c.loginForm.$setValidity(b, !1, c.loginForm), e.assign(c, a), f(function () {
                            $("form[name=" + c.loginForm.$name + "] input[name=" + b + "]").focus()
                        })
                    }
                }), c.loginForm.$error.serverError = a.data.error
            })
        }, c.resetPassword = function () {
            var a = i.resetPassword(c.passwordReset);
            j(a, c.passwordResetForm), a.then(function () {
                c.passwordResetSuccess = !0
            }, function (a) {
                angular.forEach(c.passwordReset, function (a, b) {
                    var e = d("passwordResetForm." + b + ".$error.serverMessages");
                    c.passwordResetForm.$setValidity(b, !0, c.passwordResetForm), e.assign(c, [])
                }), angular.forEach(a.data, function (a, b) {
                    if (a) {
                        var e = d("passwordResetForm." + b + ".$error.serverMessages");
                        c.passwordResetForm.$setValidity(b, !1, c.passwordResetForm), e.assign(c, a), f(function () {
                            $("form[name=" + c.passwordResetForm.$name + "] input[name=" + b + "]").focus()
                        })
                    }
                }), c.passwordResetForm.$error.serverError = a.data.error
            })
        }
    }])
}(), function () {
    plentific.app.controller("BudgetCalculatorController", ["$scope", "$timeout", "$location", "UserService", "CaseService", "DataSavedService", "BudgetCalculatorService", function (a, b, c, d, e, f, g) {
        a.showSpinner = !0, a.Math = window.Math, a.caseDataPromise.then(function (c) {
            a.caseData = c, e.getIncomes(e.getActiveCaseId()).then(function (c) {
                a.incomes = {}, b(function () {
                    g.setIncomes(c), a.incomes = c, a.showSpinner = !1
                }, 0)
            }), e.getExpenses(e.getActiveCaseId()).then(function (c) {
                a.expenses = {}, b(function () {
                    g.setExpenses(c), a.expenses = c
                }, 0)
            })
        }), a.userData = d.userData, a.totalIncome = 0, a.expensesStructure = [
            {title: "Household", slug: "household", items: [
                {title: "Mortgage related", slug: "mortgage-related", items: ["mortgage-payment", "mortgage-other", "mortgage-insurance"]},
                "rent",
                "council-tax",
                {title: "Utilities", slug: "utilities", items: ["electricity", "gas", "water", "media", "tv-license"]}
            ], suggestions: ["Home / garden maintenance", "Alarm"]},
            {title: "Living", slug: "living", items: ["groceries", "lunches-takeouts", "mobile-phone", "clothes-shoes"], suggestions: ["Hairdressing & beauty", "Cleaning / laundry", "Pharmacy"]},
            {title: "Financial Products", slug: "financial", items: ["loan-repayments", "health-insurance", "professional-advice", "pension"], suggestions: ["Credit-card & bank charges", "Life insurance", "Critical illness insurance", "Car lease payments", "Bank charges"]},
            {title: "Family & Friends", slug: "family", items: [
                {title: "Children", slug: "children", items: ["childcare", "school-expenses", "activities-clubs", "children-other"]},
                "pets",
                "charity"
            ], suggestions: ["Gifts"]},
            {title: "Transportation", slug: "transportation", items: [
                {title: "Car / motorbike", slug: "car-motorbike", items: ["fuel", "road-tax", "maintenance-repairs", "insurance", "parking", "breakdown-cover"]},
                "public-transport",
                "taxis"
            ], suggestions: ["Bicycle rental"]},
            {title: "Leisure", slug: "leisure", items: [
                {title: "Travel / holidays", slug: "travel-holidays", items: ["air-fares", "hotels", "travel-insurance", "misc"]},
                "dining-out",
                "theatre-movies",
                "gym"
            ], suggestions: ["Music (CDs, streaming)", "DVDs"]}
        ], a.cachedValues = {disposableIncome: 0, amountPerCategory: {}}, a.mortgageRentRelated = ["mortgage-payment", "mortgage-other", "mortgage-insurance", "rent"], a.householdRelated = ["mortgage-payment", "mortgage-other", "mortgage-insurance", "rent", "council-tax", "electricity", "gas", "water", "media", "tv-license"], a.ongoingItems = [
            {slug: "mortgage-related", brothers: ["mortgage-payment", "mortgage-other", "mortgage-insurance"]},
            {slug: "rent"}
        ], a.canBeOngoing = function (b) {
            return void 0 === _.find(a.ongoingItems, function (a) {
                return a.slug === b.slug
            }) ? !1 : !0
        }, a.ongoingItemChanged = function (b) {
            var c = _.find(a.ongoingItems, function (a) {
                return a.slug === b.slug
            });
            if (angular.isUndefined(c.brothers) === !1)for (var d = 0; d < c.brothers.length; d++) {
                var e = _.find(a.expenses, function (a) {
                    return a.slug === c.brothers[d]
                });
                e.ongoing = b.ongoing, e.put()
            }
        }, a.isOngoing = function (b) {
            if (a.expenses && _.isEmpty(a.expenses) === !1) {
                var c = _.find(a.ongoingItems, function (a) {
                    return a.slug === b.slug
                });
                if (c && angular.isUndefined(c.brothers) === !1)for (var d = 0; d < c.brothers.length; d++) {
                    var e = _.find(a.expenses, function (a) {
                        return a.slug === c.brothers[d]
                    });
                    if (e && e.ongoing === !0)return!0
                }
            }
        }, a.frequencyDropdownOptions = {allowClear: !1, minimumResultsForSearch: 20, width: "resolve"};
        var h = function (a, b) {
            a.dirty = b, f.setDataSaved(!b)
        };
        a.isObject = function (a) {
            return _.isObject(a)
        }, a.expensesInCategoryBySlug = function (b, c) {
            return _.where(a.expenses, {slug: b, categorySlug: c})
        }, a.expensesInCategory = function (b) {
            return _.where(a.expenses, {categorySlug: b})
        }, a.userGeneratedExpensesByCategory = function (b) {
            return _.where(a.expenses, {categorySlug: b, deletable: !0})
        };
        var i = _.debounce(function () {
            angular.forEach(a.incomes, function (a) {
                a.dirty && l(a)
            })
        }, 500), j = _.debounce(function () {
            angular.forEach(a.expenses, function (a) {
                a.dirty && l(a)
            })
        }, 500), k = _.debounce(function () {
            a.caseData.applicants[0] && e.saveApplicant(a.caseData, 0).then(function () {
                f.setDataSaved(!0)
            })
        }, 500);
        a.$watch("incomes", function (b, c) {
            if (c) {
                for (var d in b)m(b[d], c[d]) && h(a.incomes[d], !0);
                i()
            }
            b && (g.setIncomes(b), a.totalIncome = g.getTotalMonthlyIncome()), b !== c && _.isEmpty(c) === !1 && (a.caseData.applicants[0].netMonthlyIncome = a.totalIncome, k())
        }, !0), a.$watch("expenses", function (b, c) {
            if (c) {
                for (var d in b)m(b[d], c[d]) && h(a.expenses[d], !0);
                j()
            }
            b && (g.setExpenses(b), a.totalExpense = g.getTotalMonthlyExpense())
        }, !0);
        var l = function (a) {
            a.id ? a.put().then(function () {
                h(a, !1)
            }) : a.post().then(function (b) {
                a.id = b.id, a.resourceUri = b.resourceUri, h(a, !1)
            })
        }, m = function (a, b) {
            return f.checkDirty(a, b, ["title", "amount", "frequency", "order", "ongoing"])
        };
        a.frequencies = [
            {label: "Daily", value: "daily"},
            {label: "Weekly", value: "weekly"},
            {label: "Monthly", value: "monthly"},
            {label: "Quarterly", value: "quarterly"},
            {label: "Yearly", value: "yearly"}
        ], a.monthlyAmount = g.monthlyAmount, a.netAnnualIncome = function (a, b) {
            switch (b) {
                case"paye":
                    return 2790 >= a && a >= 0 ? a - .1 * a : a > 2790 && 32010 >= a ? a - (279 + .2 * (a - 2790)) : a > 32010 && 15e4 >= a ? a - (6123 + .4 * (a - 32010)) : a > 15e4 ? a - (53319 + .45 * (a - 15e4)) : a;
                default:
                    return a
            }
        }, a.totalExpenses = function () {
            var b = 0;
            for (var c in a.expenses)a.expenses[c] && (b += a.monthlyAmount(a.expenses[c]));
            return b
        }, a.totalHouseholdExpenses = function () {
            var b = 0;
            for (var c in a.expenses)a.expenses[c] && _.contains(a.householdRelated, a.expenses[c].slug) === !0 && (b += a.monthlyAmount(a.expenses[c]));
            return b
        }, a.totalMortgageRentExpenses = function () {
            var b = 0;
            for (var c in a.expenses)a.expenses[c] && _.contains(a.mortgageRentRelated, a.expenses[c].slug) === !0 && (b += a.monthlyAmount(a.expenses[c]));
            return b
        }, a.totalOngoingExpenses = function () {
            var b = 0;
            for (var c in a.expenses)a.expenses[c] && (_.contains(a.mortgageRentRelated, a.expenses[c].slug) === !0 ? a.expenses[c].ongoing === !0 && (b += a.monthlyAmount(a.expenses[c])) : b += a.monthlyAmount(a.expenses[c]));
            return b
        }, a.disposableIncomeToPayMortgage = function () {
            return a.totalIncome - a.totalOngoingExpenses()
        }, a.expensesCategoryTotal = function (b) {
            var c = 0, d = _.filter(a.expenses, {categorySlug: b.slug});
            for (var e in d)d[e] && (c += a.monthlyAmount(d[e]));
            return c
        }, a.expensesGroupTotalBySlug = function (b, c) {
            var d = 0, e = a.expensesInCategory(c);
            return _.forEach(b, function (b) {
                var c = _.find(e, {slug: b});
                c && (d += a.monthlyAmount(c))
            }), d
        }, a.expensesGroupTotal = function (b) {
            var c = 0;
            for (var d in b)if (b[d]) {
                var e = _.find(a.expenses, {slug: b[d].slug, categorySlug: b[d].categorySlug});
                angular.isUndefined(e) === !1 && (c += a.monthlyAmount(e))
            }
            return c
        }, a.disposableIncome = function () {
            return a.cachedValues.disposableIncome = a.totalIncome - a.totalExpenses(), a.cachedValues.disposableIncome
        }, a.isDisposableIncomeNegative = function () {
            return a.disposableIncome() < 0 ? !0 : !1
        }, a.addIncome = function () {
            var c = {title: "New income", amount: 0, order: a.incomes.length + 1, editableTitle: !0, deletable: !0};
            a.incomes.post(c).then(function (c) {
                a.incomes.push(c), b(function () {
                    var a = $('div[data-ng-model="incomes"]').find(".inline-fieldset__label input:last");
                    a.focus()
                }, 0)
            })
        }, a.deleteIncome = function (b) {
            var c = _.find(a.incomes, {id: b.id});
            c.remove().then(function () {
                var b = _.findIndex(a.incomes, c);
                a.incomes.splice(b, 1)
            })
        }, a.addExpense = function (c, d) {
            d = d || "New expense";
            var e = {title: d, categorySlug: c, amount: 0, frequency: "monthly", order: a.expenses.length + 1, editableTitle: !0, deletable: !0};
            a.expenses.post(e).then(function (d) {
                a.expenses.push(d), b(function () {
                    var a = $(".expensecategory-" + c).find('input[data-ng-model="expense.title"]:last');
                    a.focus()
                }, 0)
            })
        }, a.deleteExpense = function (b) {
            var c = _.find(a.expenses, {id: b.id});
            c.remove().then(function () {
                var b = _.findIndex(a.expenses, c);
                a.expenses.splice(b, 1)
            })
        }, a.positiveBalance = function () {
            return a.cachedValues.disposableIncome > -1 ? !0 : !1
        }, a.negativeBalance = function () {
            return a.cachedValues.disposableIncome < 0 ? !0 : !1
        }, a.insufficientBudgetData = function () {
            return 0 === a.totalIncome || 0 === a.totalExpenses() ? !0 : !1
        }, a.disposableClass = function () {
            return a.positiveBalance() === !0 && a.insufficientBudgetData() === !1 ? "positive" : "negative"
        }, a.categoryHasExpenses = function (b) {
            if (null !== b) {
                var c = a.expensesInCategory(b.slug);
                return a.cachedValues.amountPerCategory[b.slug] = a.expensesGroupTotal(c), a.cachedValues.amountPerCategory[b.slug] > 0
            }
        }, a.expenseHasExpenses = function (b) {
            return a.monthlyAmount(b) > 0
        }, a.expenseOverCategory = function (b, c) {
            var d = a.cachedValues.amountPerCategory[c.slug], e = a.monthlyAmount(b);
            return 100 * (e / d)
        }, a.percentageBox1 = 0, a.valueBox1 = 0, a.percentageBox2 = 0, a.percentageBox3 = 0, a.calculateBox1 = function () {
            var b = a.totalIncome, c = a.totalExpenses();
            return a.percentageBox1 = 100 * (c / b), a.percentageBox1
        }, a.calculateBox2 = function () {
            var b = a.totalHouseholdExpenses(), c = a.totalIncome;
            return a.percentageBox2 = 100 * (b / c), a.percentageBox2
        }, a.calculateBox3 = function () {
            var b = a.totalHouseholdExpenses(), c = a.disposableIncome();
            return a.percentageBox3 = 100 * (b / (b + c)), a.percentageBox3
        }, a.box1Class = function () {
            return a.percentageBox1 < 75 ? "green" : a.percentageBox1 > 74 && a.percentageBox1 < 90 ? "orange" : "red"
        }, a.box2Class = function () {
            return a.percentageBox2 > 50 ? "red" : a.percentageBox2 > 35 && a.percentageBox2 < 51 ? "orange" : "green"
        }, a.box3Class = function () {
            return a.percentageBox3 > 75 ? "red" : "green"
        }, a.getHouseholdExpenses = function () {
            var b = {title: "Household (Rent, Mortgage)", slug: "household-rent-mortgage", items: []}, c = {title: "Household (Others)", slug: "household-others", items: []};
            for (var d in a.expensesStructure)if (a.expensesStructure[d]) {
                var e = a.expensesStructure[d];
                if ("household" === e.slug) {
                    var f = a.expensesInCategory(e.slug);
                    for (var g in f)_.indexOf(a.mortgageRentRelated, f[g].slug) > -1 ? b.items.push(f[g]) : c.items.push(f[g])
                }
            }
            return[b, c]
        }, a.getCommonExpenses = function () {
            var b = [];
            for (var c in a.expensesStructure)if (a.expensesStructure[c]) {
                var d = a.expensesStructure[c];
                if ("household" !== d.slug) {
                    var e = a.expensesInCategory(d.slug);
                    b.push({title: d.title, slug: d.slug, items: e})
                }
            }
            return b
        }, a.getWaterfallData = function () {
            var b = [], c = a.getCommonExpenses(), d = a.getHouseholdExpenses(), e = 0, f = function (a, b, c) {
                return{value: 100, amount: a, category: "income", label: b, slug: c}
            }, g = function (a, b, c, d) {
                return{value: 100 * (a / d), amount: a, category: "partial", label: b, slug: c}
            }, h = function (a, b, c, d) {
                var e = 100;
                return 0 !== d && (e = 100 * (a / d)), {value: e, amount: a, category: "leftover", label: b, slug: c}
            };
            b.push(f(a.totalIncome, "Income", "income"));
            var i, j;
            for (i in c)c[i] && (j = g(a.expensesGroupTotal(c[i].items), c[i].title, c[i].slug, a.totalIncome), j.amount > 0 && b.push(j));
            for (i in d)d[i] && (e += a.expensesGroupTotal(d[i].items));
            e += a.cachedValues.disposableIncome, e > 0 && b.push(h(e, "Available for Rent/Mortgage", "available-rent-mortgage", a.totalIncome));
            for (i in d)d[i] && (j = g(a.expensesGroupTotal(d[i].items), d[i].title, d[i].slug, a.totalIncome), j.amount > 0 && b.push(j));
            return a.cachedValues.disposableIncome > 0 && b.push(h(a.cachedValues.disposableIncome, "Savings", "savings", a.totalIncome)), b
        }, a.categoriesWithExpenses = [], a.calculateCategoriesWithExpenses = function () {
            for (var b = [], c = 0; c < a.expensesStructure.length; c++) {
                var d = a.expensesStructure[c];
                a.categoryHasExpenses(d) && b.push(d)
            }
            return a.categoriesWithExpenses = b, a.categoriesWithExpenses
        }, a.rowHasTwoElements = function (a) {
            return 2 === a.length ? 100 : 51.5
        }, a.incomeHasHelp = function (a) {
            return"" !== a.help
        }, a.drawWaterfall = function () {
            a.$broadcast("waterfallDataUpdated", a.getWaterfallData()), a.calculateCategoriesWithExpenses()
        }
    }])
}(), function () {
    plentific.app.controller("ContactDialogController", ["$scope", "$window", "dialog", "EmailService", function (a, b, c, d) {
        a.STATIC_URL = b.plentific.CONFIG.STATIC_URL, a.sent = !1, a.formErrors = {}, a.showErrors = !1;
        var e = a.userData.user, f = function (b) {
            a.formErrors = b.data, a.showErrors = !0
        }, g = function (b) {
            a.showErrors = !1, a.formData.type = b, d.sendMessage(b, a.formData).then(function () {
                a.sent = !0
            }, f)
        };
        a.formData = {interested: "The Rental", searching: "London", firstName: e.firstName, lastName: e.lastName, phoneNumber: e.telephone, email: e.email, showErrorrs: {}}, a.dropdownOptions = {minimumResultsForSearch: -1}, a.close = function () {
            c.close()
        }, a.sendSolicitor = function () {
            g("legal")
        }, a.sendMortgage = function () {
            g("mortgage")
        }, a.sendPropertyCoach = function () {
            g("coach")
        }
    }])
}(), function () {
    plentific.app.controller("ConveyancingFormController", ["$scope", "DialogService", "AffordabilityUtilService", function (a, b, c) {
        a.conveyancing = {type: "buying", buyingPropertyType: "freehold", sellingPropertyType: "freehold", isFirstTimeBuyer: !1, legalFeesOnRequest: !1, discount: 0, purchasePrice: 0, fees: {legalFees: null, bankTransfer: 25, hmrcCompletion: 10, stampDuty: 0, landRegistry: 0, search: 225}, priceGroup1Total: 0, priceGroup1VAT: 0, priceGroup2Total: 0, priceGroup2VAT: 45, grandTotal: 0};
        var d = {templateUrl: "/partials/views/calculators/affordability/dialog-conveyancing-quote.html", controller: "ContactDialogController", resolve: {$scope: function () {
            return a
        }}}, e = (b.addDialog("conveyancingQuote", d), ["legalFees", "bankTransfer", "hmrcCompletion"]), f = ["stampDuty", "landRegistry", "search"], g = function () {
            var b = 0, c = 0, d = 0, g = a.conveyancing.priceGroup2VAT;
            angular.forEach(e, function (d) {
                b += a.conveyancing.fees[d], c += .2 * a.conveyancing.fees[d]
            }), angular.forEach(f, function (b) {
                d += a.conveyancing.fees[b]
            }), a.conveyancing.priceGroup1Total = b, a.conveyancing.priceGroup1VAT = c, a.conveyancing.priceGroup2Total = d, a.conveyancing.grandTotal = b + c + d + g
        }, h = function () {
            var b = parseInt(a.conveyancing.purchasePrice, 10), d = c.legalFees(b), e = b > 2e6, f = a.conveyancing.isFirstTimeBuyer;
            a.conveyancing.fees.stampDuty = b * c.stampDuty(b), a.conveyancing.fees.landRegistry = c.landRegistry(b), a.conveyancing.discount = f ? .1 * d : 0, a.conveyancing.fees.legalFees = f ? .9 * d : d, a.conveyancing.legalFeesOnRequest = e, g()
        };
        h(), a.onPurchasePriceChanged = h, a.$watch("housePriceData.price", function (b) {
            angular.isUndefined(b) !== !0 && (a.conveyancing.purchasePrice = b, h())
        })
    }])
}(), plentific.app.controller("DashboardController", ["$scope", function () {
}]), function () {
    plentific.app.controller("FeesDialogController", ["$scope", "AffordabilityUtilService", "CaseService", function (a, b, c) {
        var d = function () {
            var b = _.reduce(_.pluck(a.fees, "value"), function (a, b) {
                return a + b
            });
            return b
        }, e = {landRegistry: b.landRegistry, conveyancing: b.legalFees};
        a.housePriceData && (a.fees = _.clone(c.getFees(a.housePriceData.price), !0)), a.defaultFees = b.defaultFees, a.$watch("housePriceData.price", function (b) {
            a.fees = _.clone(c.getFees(b), !0)
        }), a.$watch("fees", function () {
            a.totalFees = d()
        }, !0), a.close = function (d) {
            d && a.caseData && a.caseData.fees !== d && (a.caseData.fees = _.clone(d, !0), a.caseData.overriddenVars.otherFees = b.getTotalOtherFees(a.caseData.fees), c.setFees(_.clone(d, !0)), a.caseData.overriddenVars.otherFeesIsOverridden = !1), a.feesDialogOpts.showDialog = !1
        }, a.resetAllFees = function () {
            angular.forEach(a.fees, function (b, c) {
                a.fees[c].value = b.dynamic ? e[c](a.housePriceData.price) : a.defaultFees[c].value, b.plusVAT && (a.fees[c].fakeValue = a.fees[c].value / 1.2)
            })
        }
    }])
}(), function () {
    plentific.app.controller("LegalAdviceController", ["$scope", "$dialog", function (a) {
        a.accordionStates = [];
        for (var b = 0; 7 > b; b++)a.accordionStates.push(!0);
        a.expandAll = function () {
            for (var b in a.accordionStates)a.accordionStates && (a.accordionStates[b] = !0)
        }, a.collapseAll = function () {
            for (var b in a.accordionStates)a.accordionStates && (a.accordionStates[b] = !1)
        }, a.showExpand = function () {
            var b = 0;
            for (var c in a.accordionStates)a.accordionStates[c] === !0 && b++;
            return b === a.accordionStates.length ? !1 : !0
        }
    }])
}(), function () {
    plentific.app.controller("MilestoneTrackingController", ["$scope", "$window", "$log", "$timeout", "$location", "UserService", "CaseService", function (a, b, c, d, e, f, g) {
        a.overviewReady = !1, a.showSpinner = !0, a.currentMilestone = null, a.currentItem = null, a.caseDataPromise.then(function (b) {
            a.milestones || (a.milestonePromise = g.getMilestoneOverview(b.id), a.milestonePromise.then(function (b) {
                a.milestones = b, a.milestoneGroups = _.uniq(_.pluck(b, "group")), a.overviewReady = !0, a.showSpinner = !1
            }))
        }), a.userData = f.userData, a.loc = e, _.extend({}, plentific.utils.urlToObj(e.search()).milestonetracking), a.itemChanged = function (b, c) {
            a.caseDataPromise.then(function (a) {
                g.setMilestoneItem(a.id, b, c.number, c.completed)
            })
        }, a.expandAllItems = function (a) {
            _.each(a, function (a) {
                a.open = !0
            })
        }, a.collapseAllItems = function (a) {
            _.each(a, function (a) {
                a.open = !1
            })
        }, a.showExpand = function (a) {
            var b = 0;
            return _.each(a, function (a) {
                a.open === !0 && b++
            }), b === a.length ? !1 : !0
        }, a.milestonesByGroup = function (b) {
            return a.milestones ? _.filter(a.milestones, {group: b}) : void 0
        }, a.isMilestoneCompleted = function (a) {
            for (var b in a.items)if (a.items[b].completed === !1)return!1;
            return!0
        }, a.isMilestoneGroupCompleted = function (b) {
            if (a.milestones) {
                var c = a.milestonesByGroup(b);
                for (var d in c)if (a.isMilestoneCompleted(c[d]) === !1)return!1;
                return!0
            }
        }, a.groupWidthPercentage = function (b) {
            if (a.milestones) {
                var c = a.milestonesByGroup(b).length, d = a.milestones.length;
                return 100 * (c / d)
            }
        }, a.$watch("loc.search()", function (b, f) {
            c.warn("querystring changed from ", f, " to ", b);
            var g = plentific.utils.urlToObj(b).milestonetracking || {}, h = plentific.utils.urlToObj(f).milestonetracking;
            if (g.milestone) {
                var i = parseInt(g.milestone, 10);
                i !== a.currentMilestone || h.item || g.item || e.search(""), a.currentMilestone = i;
                var j = "#milestone-" + a.currentMilestone;
                g.item ? (a.currentItem = parseInt(g.item, 10), j += "-" + a.currentItem) : (j = "#milestoneOverview", a.currentItem = null), d(function () {
                    $(j).scrollintoview()
                }, 100)
            } else a.currentMilestone = null, a.currentItem = null
        })
    }])
}(), function () {
    plentific.app.controller("MortgageAdviceController", ["$dialog", "$scope", function (a, b) {
        b.STATIC_URL = plentific.CONFIG.STATIC_URL, b.accordionStates = [];
        for (var c = 0; 7 > c; c++)b.accordionStates.push(!0);
        b.expandAll = function () {
            for (var a in b.accordionStates)b.accordionStates && (b.accordionStates[a] = !0)
        }, b.collapseAll = function () {
            for (var a in b.accordionStates)b.accordionStates && (b.accordionStates[a] = !1)
        }, b.showExpand = function () {
            var a = 0;
            for (var c in b.accordionStates)b.accordionStates[c] === !0 && a++;
            return a === b.accordionStates.length ? !1 : !0
        }
    }])
}(), function () {
    plentific.app.controller("MyAccountController", ["$scope", "$parse", "$timeout", "datepickerConfig", "UserService", function (a, b, c, d, e) {
        d.startingDay = 1, a.myAccount = {user: {}}, a.defaultAvatar = plentific.CONFIG.STATIC_URL + "images/avatar-96x96.png", a.countries = plentific.COUNTRIES;
        var f = function (a) {
            console.error(a)
        }, g = function (a, b) {
            b.isSaving = !0, b.isSaved = !1, a.then(function () {
                b.isSaving = !1, b.isSaved = !0, plentific.utils.setPristine(b)
            }, function (a) {
                b.isSaving = !1, b.isSaved = !1, f(a)
            })
        }, h = function (d, e) {
            var f = !0;
            (angular.isObject(d.data) || angular.isArray(d.data)) && angular.forEach(d.data, function (d, g) {
                var h = b(e.$name + "." + g + ".$error.serverMessages");
                e.$setValidity(g, !0), h.assign(a, []), d && (f && (f = !1, c(function () {
                    $("input[name=" + g + "]").focus()
                })), e.$setValidity(g, !1), h.assign(a, d))
            })
        }, i = function (c) {
            angular.forEach(c, function (d) {
                if (d !== c && d.$name) {
                    var e = b(c.$name + "." + d.$name + ".$error.serverMessages");
                    c.$setValidity(d.$name, !0), e.assign(a, [])
                }
            })
        }, j = function (a, b) {
            var c = e.updateUser(a);
            g(c, b), c.then(function () {
                i(b)
            }, function (a) {
                h(a, b)
            })
        }, k = function (b, c) {
            var d = e.updateEmail(b);
            g(d, c), d.then(function () {
                i(c, !0), a.myAccount.emailForm = {}
            }, function (a) {
                h(a, c)
            })
        }, l = function (b, c) {
            var d = e.updatePassword(b);
            g(d, c), d.then(function () {
                i(c, !0), a.myAccount.passwordForm = {}
            }, function (a) {
                h(a, c)
            })
        }, m = function (b, c) {
            var d = e.deactivateAccount(b);
            g(d, c), d.then(function () {
                window.location = "/"
            }, function (b) {
                h(b, c), a.deactivateForm.submiAttempted = !1
            })
        }, n = function () {
            a.myAccount.deactivateForm.password = "", a.deactivateForm.password.$error.serverMessages = [], a.deactivateForm.submiAttempted = !1
        };
        a.updateUser = j, a.updateEmail = k, a.updatePassword = l, a.deactivateAccount = m, a.changedMind = n, a.myAccount.emailForm = {}, a.myAccount.passwordForm = {}, a.myAccount.deactivateForm = {}, a.$watch("userData.user", function (b) {
            a.myAccount.user = angular.copy(b)
        }, !0), c(function () {
            plentific.utils.setPristine(a.accountForm)
        }, 200), a.$watch("myAccount.user.birthday", function (b, c) {
            angular.equals(new Date(b), new Date(c)) || a.accountForm.$setDirty()
        })
    }])
}(), plentific.app.controller("MyDocumentsController", ["$scope", function () {
}]), function () {
    plentific.app.controller("NetWorthCalculatorController", ["$scope", "$timeout", "UserService", "CaseService", "DataSavedService", "NetWorthCalculatorService", function (a, b, c, d, e, f) {
        a.showSpinner = !0, d.getAssets(d.getActiveCaseId()).then(function (c) {
            b(function () {
                a.assets = f.setAssets(c)
            })
        }), d.getLiabilities(d.getActiveCaseId()).then(function (c) {
            b(function () {
                a.liabilities = f.setLiabilities(c)
            })
        }), a.caseDataPromise.then(function (c) {
            a.totalIncome = 0, b(function () {
                if (c.totalIncome)a.totalIncome = c.totalIncome; else {
                    for (var b = 0, d = 0; d < c.applicants.length; d++)b += c.applicants[d].netMonthlyIncome;
                    a.totalIncome = b
                }
                0 === a.caseData.rainyDay && (a.caseData.rainyDay = Math.round(3 * a.totalIncome)), a.showSpinner = !1
            }), a.caseData = c, angular.isUndefined(a.caseData.overriddenVars.payback) === !0 && (a.caseData.overriddenVars.payback = 0)
        }), a.userData = c.userData, a.assetStructure = f.assetStructure, a.availabilityOptions = [
            {label: "Available", value: "available"},
            {label: "Unavailable", value: "unavailable"}
        ], a.availabilityDropdownOptions = {allowClear: !1, minimumResultsForSearch: 20}, a.overriddenVars = {}, a.cachedValues = {assetsTotal: 0, liabilitiesTotal: 0, accessibleFunds: 0};
        var g = function (a, b) {
            a.dirty = b, e.setDataSaved(!b)
        };
        a.assetCategoryIsActive = function (a) {
            return f.assetTotalByCategory(a, !0) > 0 ? !0 : !1
        }, a.assetsTotal = function () {
            var b = f.assetsTotal();
            return a.cachedValues.assetsTotal = b.runningTotal, a.cachedValues.cashAndSavings = b.runningCashAndSavings, a.cachedValues.assetsTotal
        }, a.liabilitiesTotal = function () {
            return a.cachedValues.liabilitiesTotal = f.liabilitiesTotal(), a.cachedValues.liabilitiesTotal
        }, a.getPropertyMortgages = function () {
            var b = 0, c = _.where(a.assets, {categorySlug: "property"});
            return _.forEach(c, function (a) {
                b += a.owed
            }), b
        }, a.netWorth = f.netWorth, a.netLiabilities = function () {
            return a.liabilitiesTotal() - a.assetsTotal()
        }, a.isNetWorthNegative = function () {
            return a.netWorth() < 0 ? !0 : !1
        }, a.isNetWorthLow = function () {
            return a.netWorth() > 0 && a.netWorth() < 5e3 ? !0 : !1
        }, a.isNetWorthAboveThreshold = function () {
            return a.netWorth() > 4999 ? !0 : !1
        }, a.insufficientNetWorthData = function () {
            return 0 === a.assetsTotal() && 0 === a.liabilitiesTotal() ? !0 : !1
        }, a.addAsset = function (c) {
            var d = {title: "New asset", amount: 0, order: a.assets.length + 1, availability: "available", categorySlug: c};
            "property" === c && (d.owed = 0), a.assets.post(d).then(function (d) {
                a.assets.push(d), b(function () {
                    var a = $(".asset-tree__group--" + c).find(".asset-tree__item-title:last");
                    a.focus()
                }, 0)
            })
        };
        var h = function (a) {
            a.id ? a.put().then(function () {
                g(a, !1)
            }) : a.post().then(function (b) {
                a.id = b.id, a.resourceUri = b.resourceUri, g(a, !1)
            })
        }, i = function (a, b) {
            return e.checkDirty(a, b, ["title", "amount", "owed", "availability", "order"])
        };
        a.$watch("assets", function (b, c) {
            if (c) {
                for (var d in b)i(b[d], c[d]) && g(a.assets[d], !0);
                j()
            }
        }, !0);
        var j = _.debounce(function () {
            _.forEach(a.assets, function (a) {
                a.dirty && h(a)
            })
        }, 500), k = _.debounce(function (a) {
            a.put().then(function () {
                e.setDataSaved(!0)
            })
        }, 500);
        a.$watch("caseData", function (b, c) {
            c && (_.isEqual(_.omit(b, "applicants"), _.omit(c, "applicants")) || (e.setDataSaved(!1), k(b)), c.savings !== b.savings && (a.caseData.overriddenVars.savings = b.savings)), b && (a.savingsSliderMaxValue = 2 * b.savings)
        }, !0), a.assetDeletable = function (a, b) {
            return a.deletable && !b ? !0 : !1
        }, a.deleteAsset = function (b) {
            var c = _.find(a.assets, {id: b.id});
            c.remove().then(function () {
                var b = _.findIndex(a.assets, c);
                a.assets.splice(b, 1)
            })
        }, a.addLiability = function () {
            var c = {title: "New liability", amount: 0, order: a.assets.length + 1, editableTitle: !0, deletable: !0};
            a.liabilities.post(c).then(function (c) {
                a.liabilities.push(c), b(function () {
                    var a = $(".liability-list").find(".liability-list__item-title:last");
                    a.focus()
                }, 0)
            })
        }, a.$watch("liabilities", function (b, c) {
            if (c) {
                for (var d in b)i(b[d], c[d]) && g(a.liabilities[d], !0);
                l()
            }
        }, !0);
        var l = _.debounce(function () {
            _.forEach(a.liabilities, function (a) {
                a.dirty && h(a)
            })
        }, 500);
        a.deleteLiability = function (b) {
            var c = _.find(a.liabilities, {id: b.id});
            c.remove().then(function () {
                var b = _.findIndex(a.liabilities, c);
                a.liabilities.splice(b, 1)
            })
        }, a.getWaterfallData = function () {
            var b, c = [], d = a.liabilities, e = a.assetsTotal(), g = a.liabilitiesTotal(), h = a.netWorth(), i = 0, j = ["credit-card-debt"], k = function (a, b, c, d) {
                return{value: 100 * (a / d), amount: a, category: "income", label: b, slug: c}
            }, l = function (a, b, c, d) {
                return{value: 100 * (a / d), amount: a, category: "partial", label: b, slug: c}
            }, m = function (a, b, c, d) {
                var e = 100;
                return 0 !== d && (e = 100 * (a / d)), {value: e, amount: a, category: "leftover", label: b, slug: c}
            };
            return b = Math.max(e, g), angular.forEach(a.assetStructure, function (a) {
                if (a) {
                    var d = f.assetTotalByCategory(a.slug, !0);
                    d > 0 && c.push(k(d, a.chartTitle, a.slug, b))
                }
            }), angular.forEach(d, function (a) {
                a && (j.indexOf(a.slug) < 0 && a.amount > 0 ? i += a.amount : a.amount > 0 && c.push(l(a.amount, a.title, a.slug, b)))
            }), i > 0 && c.push(l(i, "Other Financial Debts", "other-financial-debts", b)), h > 0 && c.push(m(h, "Net Worth", "net-worth", b)), c
        }, a.accessibility = 0, a.leverage = 0, a.debt = 0, a.calculateAccessibility = function () {
            return a.accessibility = 0 === a.cachedValues.assetsTotal ? 0 : 100 * (a.cachedValues.accessibleFunds / a.cachedValues.assetsTotal), a.accessibility
        }, a.calculateAccessibleFunds = function () {
            var b = 0;
            return angular.forEach(a.assets, function (a) {
                "available" === a.availability && (b += null !== a.owed ? a.amount - a.owed : a.amount)
            }), a.cachedValues.accessibleFunds = Math.round(b), a.cachedValues.accessibleFunds
        }, a.$watch("cachedValues.accessibleFunds+caseData.rainyDay+caseData.overriddenVars.payback", function () {
            var b = 0, c = 0;
            a.caseData && (b = a.caseData.rainyDay, c = a.caseData.overriddenVars.payback), a.availableFundForHouse = Math.round(a.cachedValues.accessibleFunds - b - c), a.availableFundForHouseColor = a.availableFundForHouse > 0 ? "green" : "red"
        }), a.availableFundForHouseColor = function () {
        }, a.calculateLeverage = function () {
            return a.leverage = 0 === a.cachedValues.assetsTotal ? 0 : 100 * (a.cachedValues.liabilitiesTotal / a.cachedValues.assetsTotal), a.leverage
        }, a.calculateDebt = function () {
            var b = 0, c = a.cachedValues.liabilitiesTotal;
            return _.forEach(a.assets, function (a) {
                ("cash-current-accounts" === a.categorySlug || "savings-accounts" === a.categorySlug) && (b += a.amount)
            }), a.debt = c > 0 ? b / c : 0, a.debt <= 1 && a.debt > 0 ? 100 * a.debt : a.debt
        }, a.leverageColor = function () {
            return a.leverage > 99 ? "red" : "blue"
        }, a.debtColor = function () {
            return a.debt >= 1 || 0 === a.debt ? "green" : a.debt < 1 && a.debt >= .5 ? "orange" : "red"
        }, a.debtFormat = function () {
            return a.debt > 1 ? "x" : "percentage"
        }, a.positiveNumber = function (a) {
            return a > 0 ? !0 : !1
        }, a.drawWaterfall = function () {
            a.$broadcast("waterfallDataUpdated", a.getWaterfallData())
        }
    }])
}(), function () {
    plentific.app.controller("PropertyCoachController", ["$dialog", "$scope", "$window", function (a, b, c) {
        b.STATIC_URL = c.plentific.CONFIG.STATIC_URL, b.accordionStates = [];
        for (var d = 0; 3 > d; d++)b.accordionStates.push(!0)
    }])
}(), function () {
    plentific.app.controller("PropertyComparisonController", ["$scope", "$location", "$log", "$rootScope", "$state", "$stateParams", "$timeout", "AnalyticsService", "EmailService", "PropertyComparisonService", function (a, b, c, d, e, f, g, h, i, j) {
        function k() {
            var c = function (c) {
                angular.forEach(["compare.property1", "compare.property2"], function (b, d) {
                    if (c[b]) {
                        if (!a.properties[d] || parseInt(c[b], 10) !== a.properties[d].id) {
                            var e = j.setPropertyToCompare(d, c[b]).data;
                            e.id = parseInt(c[b], 10), a.properties[d] = e
                        }
                    } else a.properties[d] = j.setPropertyToCompare(d, null)
                }), h.trackPage(b.url())
            };
            a.properties = [null, null], a.$watch("loc.search()", function (a, b) {
                a && !angular.equals(a, b) && c(a)
            }, !0), a.$watch("properties[0] || properties[1]", function () {
                l()
            }), a.caseDataPromise.then(function (b) {
                a.caseData = b
            }), c(b.search())
        }

        function l() {
            a.numProperties = _.filter(a.properties,function (a) {
                return null !== a
            }).length
        }

        function m() {
            var a = b.search(), c = plentific.utils.urlToObj(a);
            j.clearAllProperties(), delete c.compare, b.search(plentific.utils.objToUrl(c))
        }

        c.warn("PropertyComparisonController"), c.warn(f), a.messages = {agent: null}, a.forms = {agent_choice: {agentIndex: 0}, agent: {firstName: "", lastName: "", email: "", message: "", phoneNumber: "", phoneType: "home", timeToCall: "anytime"}}, a.numProperties = 0, a.financialScenarios = [
            {title: "Base Case", ltv: 75}
        ], a.accordionSections = {description: !0, listing_info: !0, ownership_status: !0, floorplan: !0, location: !0, financials: !0, contact: !0}, a.$on("$destroy", m), a.onPropertyDropped = function (c, e) {
            var f = parseInt($(this).attr("data-dropzone-id"), 10), g = "" + e.draggable.data("property-id"), h = b.search(), i = plentific.utils.urlToObj(h), j = i.compare || {};
            d.$apply(function () {
                if (0 === f)j.property1 = g; else {
                    if (1 !== f)throw new Error("Unknown dropzone id: " + f);
                    j.property2 = g
                }
                _.isEmpty(j) || (i.compare = j), b.search(plentific.utils.objToUrl(i))
            }), a.messages.agent && (a.forms.agent.message = "", a.messages.agent.prompt.visible = !1)
        }, a.getMessageData = function (b) {
            var c, d, e = {};
            return d = parseInt(a.forms.agent_choice.agentIndex, 10), c = a.properties[d], "agent" === b && (e = _.extend(e, a.forms[b], {listing_id: c.id, property_index: d})), e
        }, a.sendMessage = function (b, c) {
            var d, e, f = {};
            return d = function (c, d, e, f) {
                a.messages[b].sent = !0, a.messages[b].prompt.type = "success", a.messages[b].prompt.visible = !0, a.messages[b].prompt.agent_index = f.data.data.property_index
            }, e = function (d) {
                var e = !0;
                a.messages[b].sent = !1, a.messages[b].prompt.type = "failure", a.messages[b].prompt.visible = !1, angular.forEach(c, function (a) {
                    a.$name && (c.$setValidity(a.$name, !0), c[a.$name].$error.serverMessages = [])
                }), angular.forEach(d, function (a, d) {
                    a && (e && (e = !1, g(function () {
                        $("#frm-" + b + " input[name=" + d + "]").focus()
                    })), c.$setValidity(d, !1), c[d].$error.serverMessages = a)
                })
            }, f = a.getMessageData(b), a.messages[b] = {sent: !1, prompt: {type: "sending", visible: !0}}, i.sendMessage(b, f).success(d).error(e)
        }, a.removeProperty = function (a) {
            var c = b.search();
            delete c["compare.property" + (parseInt(a, 10) + 1)], b.search(c)
        }, a.scrollToContact = function () {
            var a = $(".property-compare").parent();
            a.animate({scrollTop: a.get(0).scrollHeight}, {duration: 400})
        }, k()
    }])
}(), function () {
    plentific.app.controller("PropertyDetailController", ["$dialog", "$scope", "$log", "$rootScope", "$stateParams", "$timeout", "$window", "$parse", "AffordabilityUtilService", "CaseService", "EmailService", "DataSavedService", "GoogleDirectionsApiService", "GoogleDistanceMatrixApiService", "PropertyComparisonService", "TransportApiService", "UnitConverterService", "UserService", "ZooplaApiService", "ZooplaPropertyImagesService", function (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t) {
        function u(a, b) {
            var c, d = {lat: a, lon: b};
            return c = p.getNearbyStations(d), c.then(function (a) {
                var b = q.time.minsToHours(20);
                _.forEach(a, function (a) {
                    var c, d, e = q.length.metersToMiles(a.distance), f = e / 3;
                    d = f > b ? 100 : 100 * (f / b), c = f <= q.time.minsToHours(10) ? "green" : f < q.time.minsToHours(15) ? "amber" : "red", a.__plentific__computed = {walkingBarColor: c, walkingBarLength: d, distanceInMiles: e, estimatedWalkingDuration: f}
                })
            }), c
        }

        function v(a, d, e) {
            var f = {driving: n, walking: n, bicycling: n, transit: m}, g = "participant" + a, h = {driving: google.maps.TravelMode.DRIVING, walking: google.maps.TravelMode.WALKING, bicycling: google.maps.TravelMode.BICYCLING, transit: google.maps.TravelMode.TRANSIT};
            c.warn("Updating times for " + e), b.travelTimes[g].travelModes.driving.status = "FETCHING", _.forEach(b.travelTimes[g].travelModes, function (a, i) {
                var j, k;
                if (j = moment().startOf("week"), j.add("weeks", 1), j.set("hour", 9), f[i] === n)k = n.getDistanceMatrix({destinations: [e], origins: [d], travelMode: h[i]}), k.then(function (a) {
                    a.rows[0].elements[0].distance && a.rows[0].elements[0].duration ? (b.travelTimes[g].travelModes[i].distance = a.rows[0].elements[0].distance.text, b.travelTimes[g].travelModes[i].duration = a.rows[0].elements[0].duration.text) : (b.travelTimes[g].travelModes[i].distance = "Could not find distance", b.travelTimes[g].travelModes[i].duration = "Could not find distance")
                }); else {
                    if (f[i] !== m)throw new Error("Unknown API - Cannot fetch travel time for mode: " + i + ".");
                    k = m.getDirections({destination: e, origin: d, region: "uk", transitOptions: {arrivalTime: j.toDate()}, travelMode: h[i]}), k.then(function (a) {
                        c.warn("Retrieved directions", a), a.routes[0] && a.routes[0].legs[0].distance.text ? (b.travelTimes[g].travelModes[i].distance = a.routes[0].legs[0].distance.text, b.travelTimes[g].travelModes[i].duration = a.routes[0].legs[0].duration.text) : (b.travelTimes[g].travelModes[i].distance = "Could not find distance", b.travelTimes[g].travelModes[i].duration = "Could not find distance"), b.travelTimes[g].travelModes[i].status = "FETCHED"
                    }, function () {
                        b.travelTimes[g].travelModes[i].status = "ERROR"
                    })
                }
            })
        }

        function w() {
            b.setActiveSection("details")
        }

        function x() {
            b.computedFields.grossInternalAreaSqM = parseFloat(q.area.sqFtToSqM(b.property.customFields.grossInternalArea).toFixed(2))
        }

        function y() {
            b.property.customFields && (b.computedFields.pricePerSqFt = b.property.customFields.estimatedPrice / b.property.customFields.grossInternalArea)
        }

        function z() {
            var a = b.travelTimes.participant1.workPostcode, c = b.travelTimes.participant2.workPostcode, d = null, e = null;
            angular.isString(a) && (d = a.replace(/\s/gi, "")), angular.isString(c) && (e = c.replace(/\s/gi, "")), d && (b.travelTimes.participant1.times = v(1, new google.maps.LatLng(b.property.latitude, b.property.longitude), a)), e && (b.travelTimes.participant2.times = v(2, new google.maps.LatLng(b.property.latitude, b.property.longitude), c))
        }

        var A = {"property.customFields": {deep: !0, fn: null}}, B = {"property.customFields": null, map: null}, C = !1, D = null, E = _.debounce(function () {
            l.setDataSaved(!1), s.savePropertyData(b.property, b.property.listing_id).then(function () {
                l.setDataSaved(!0)
            })
        }, 500), F = _.debounce(z, 1e3);
        b.messages = {share: null, agent: null}, b.property = {}, b.refs = {images: t.createImageCollection(), floorplanIndex: 0, property_map: null}, b.refreshTriggers = {sv: null, map: null}, b.streetviewOptions = {position: null}, b.property.customFields = {estimatedPrice: 0, grossInternalArea: 0, garden: null, gardenFacing: null, floors: null, sellerChain: null, ownershipType: null, groundRentMonthly: null, groundRentAnnually: null, managementFeeMonthly: null, managementFeeAnnually: null}, b.maxLoanMultiple = i.MAX_LOAN_MULTIPLE, b.groundRentMonthlyChanged = function () {
            b.property.customFields.groundRentAnnually = 12 * b.property.customFields.groundRentMonthly
        }, b.managementFeeMonthlyChanged = function () {
            b.property.customFields.managementFeeAnnually = 12 * b.property.customFields.managementFeeMonthly
        }, b.computedFields = {grossInternalAreaSqM: 0, pricePerSqFt: 0}, b.forms = {agent: {firstName: "", lastName: "", email: "", message: "", phoneNumber: "", phoneType: "home", timeToCall: "anytime"}, share: {friendsEmail: "", userEmail: "", subject: "", message: ""}}, b.nearbyStations = [], b.$on("$destroy", w), b.configure = function (a) {
            c.log("PropertyDetailController::_init() propertyIndex: " + a), o.getPropertyToCompare(a) && (b.property = o.getPropertyToCompare(a).data, b.property.then(function (a) {
                b.property = a
            }))
        }, b.getDirectionsUrl = function (a, c) {
            if (!b.travelTimes["participant" + a] || !b.property.outcode)return null;
            var d = "https://www.google.com/maps?", e = d, f = b.property.outcode, g = {car: null, transit: "r", walk: "w", cycle: "b"}, h = b.travelTimes["participant" + a].workPostcode;
            if (b.property.incode && (f += " " + b.property.incode), f && h) {
                if (e += "saddr=" + encodeURIComponent(f), e += "&daddr=" + encodeURIComponent(h), c) {
                    var i = g[c];
                    i && (e += "&dirflg=" + i)
                }
                return e
            }
            return null
        }, b.dismissShareOverlay = function () {
            b.forms.share = {friendsEmail: "", userEmail: "", subject: "", message: ""}, b.messages.share = null, b.sharePopoverVisible = !1
        }, b.getFloorplanFiletype = function (a) {
            var c, d = b.property.floor_plan[a], e = null;
            return d ? (c = d.split("."), e = c[c.length - 1]) : null
        };
        var G = function () {
            if (b.caseData) {
                b.housePriceData = i.maxHousePrice(b.caseData.savings, i.totalGrossAnnualIncome(b.caseData.applicants), i.totalIncome(b.caseData.applicants), i.totalIncome(b.caseData.applicants) - b.caseData.monthlyExpenses, i.totalDefaultFees(), .75 * b.property.price, .75, i.MORTGAGE_TERM, b.mortgageData);
                var a = [i.incomeMultipleIndicator(b.housePriceData.incomeMultiple), i.incomeIndicator(b.housePriceData.mortgageIncomeRatio / 100), i.disposableIncomeIndicator(b.housePriceData.mortgageDisposableIncomeRatio / 100)], c = _.difference(a, ["amber", "red"]).length, d = _.difference(a, ["amber", "green"]).length;
                return c === a.length ? "green" : d >= 1 ? "red" : "amber"
            }
            return"grey"
        };
        b.getMessageData = function (a) {
            var c = {};
            return"share" === a ? c = angular.extend(c, b.forms[a], {listing_id: b.property.listing_id, price: b.property.price, num_bedrooms: b.property.num_bedrooms, county: b.property.county, outcode: b.property.outcode}) : "agent" === a && (c = angular.extend(c, b.forms[a], {listing_id: b.property.listing_id})), c
        }, b.sendMessage = function (a, c) {
            var d, e, g = {};
            return d = function () {
                b.messages[a].sent = !0, b.messages[a].prompt.type = "success", b.messages[a].prompt.visible = !0, plentific.utils.setPristine(c)
            }, e = function (d) {
                var e = !0;
                b.messages[a].sent = !1, b.messages[a].prompt.type = "failure", b.messages[a].prompt.visible = !1, angular.forEach(c, function (a) {
                    a.$name && (c.$setValidity(a.$name, !0), c[a.$name].$error.serverMessages = [])
                }), angular.forEach(d, function (b, d) {
                    b && (e && (e = !1, f(function () {
                        $("#frm-" + a + " input[name=" + d + "]").focus()
                    })), c.$setValidity(d, !1), c[d].$error.serverMessages = b)
                })
            }, g = b.getMessageData(a), b.messages[a] = {sent: !1, prompt: {type: "sending", visible: !0}}, k.sendMessage(a, g).success(d).error(e)
        }, b.tabChanged = function () {
            function a() {
                var a = new google.maps.LatLng(b.property.latitude, b.property.longitude);
                f(function () {
                    google.maps.event.trigger(b.refs.property_map, "resize"), b.refs.property_map.setCenter(a), b.refs.property_map.setZoom(16)
                })
            }

            var d = (new Date).getTime();
            c.warn("Tab Changed"), b.refreshTriggers.sv = d, b.refreshTriggers.map = d, C || a()
        }, A["property.customFields"].fn = function (a, b) {
            var c = !1;
            if (b) {
                for (var d in a)a[d] !== b[d] && (c = !0);
                c && E()
            }
        }, b.$watch("property", function (a) {
            var c;
            a && a.listing_id && (b.refs.images = t.createImageCollectionFromApiResponse(a), a.customFields ? a.customFields.estimatedPrice || (b.property.customFields.estimatedPrice = parseFloat(a.price)) : b.property.customFields = {estimatedPrice: parseFloat(a.price)}, c = A["property.customFields"], B["property.customFields"] = b.$watch("property.customFields", c.fn, c.deep), b.caseDataPromise.then(function (a) {
                b.caseData = a, i.getMortgageRates().then(function (a) {
                    b.mortgageData = a, b.affordabilityColour = G()
                })
            }), b.userData = r.userData, b.forms.share.userEmail = b.userData.user.email)
        }), b.$watch("caseData.applicants", function (a) {
            angular.isArray(a) && (b.travelTimes.participant1.workPostcode = a[0].work_postcode, angular.isDefined(a[1]) && (b.travelTimes.participant2.workPostcode = a[1].work_postcode), b.totalGrossAnnualIncome = i.totalGrossAnnualIncome(a))
        }, !0), b.$watch("property.latitude", function (a) {
            angular.isDefined(a) && (c.log("Property latitude changed"), b.streetviewOptions = {position: new google.maps.LatLng(b.property.latitude, b.property.longitude)}, b.nearbyStations = u(b.property.latitude, b.property.longitude), F())
        }), b.$watch("travelTimes.participant1.workPostcode", function (a, b) {
            c.log("Participant 1 Postcode Updated"), a !== b && F()
        }), b.$watch("travelTimes.participant2.workPostcode", function (a, b) {
            c.log("Participant 2 Postcode Updated"), a !== b && F()
        }), b.$watch("property.customFields.grossInternalArea", function (a, b) {
            null === a && (a = 0), a !== b && (x(), y())
        }), b.$watch("property.customFields.estimatedPrice", function (a, b) {
            a !== b && y()
        }), B.map = b.$watch("refs.property_map", function (a) {
            function c(a) {
                var c = new google.maps.LatLngBounds, d = null, e = b.getMarkerIcon(a), f = new google.maps.LatLng(a.latitude, a.longitude);
                d = new google.maps.Marker({draggable: !1, icon: e, map: b.refs.property_map, position: f}), D = d, c.extend(f), b.refs.property_map.fitBounds(c), b.refs.property_map.setCenter(f), b.refs.property_map.setZoom(16)
            }

            a && (b.property.latitude ? c(b.property) : b.property.then && b.property.then(function (a) {
                c(a)
            }), B.map())
        }), d.$on("property:favouriteStateChange", function (a, c) {
            b.property.listing_id === c.listing_id && (b.property.isFavourite = c.isFavourite, D.setIcon(b.getMarkerIcon(c)))
        })
    }])
}(), function () {
    plentific.app.controller("PropertyDetailParentController", ["$scope", "$log", "$stateParams", "PropertyComparisonService", function (a, b, c, d) {
        function e() {
            d.setPropertyToCompare(0, c.propertyId)
        }

        a.properties = [], a.financialScenarios = [
            {title: "Base Case", ltv: 75},
            {title: "Scenario 1", ltv: 60},
            {title: "Scenario 2", ltv: 90}
        ], e()
    }])
}(), function () {
    plentific.app.controller("PropertyModalController", ["$scope", "AffordabilityUtilService", "CaseService", function (a, b, c) {
        a.maxLoanMultiple = b.MAX_LOAN_MULTIPLE, a.propertyFinancials = null, a.travelTimes = {participant1: {workPostcode: "", travelModes: {driving: {distance: null, duration: null, status: null}, walking: {distance: null, duration: null, status: null}, bicycling: {distance: null, duration: null, status: null}, transit: {distance: null, duration: null, status: null}}}, participant2: {workPostcode: "", travelModes: {driving: {distance: null, duration: null, status: null}, walking: {distance: null, duration: null, status: null}, bicycling: {distance: null, duration: null, status: null}, transit: {distance: null, duration: null, status: null}}}}, a.addApplicant = function () {
            a.propertyFinancials.applicants.push(c.getDefaultApplicantData())
        }, a.caseDataPromise.then(function (b) {
            a.propertyFinancials = angular.copy(b)
        })
    }])
}(), function () {
    plentific.app.controller("PropertySearchController", ["$scope", "$log", "$location", "$rootScope", "$state", "$window", "$filter", "$anchorScroll", "AnalyticsService", "CaseService", "DataSavedService", "FavouritesService", "InfiniteLoadingPaginator", "PropertyComparisonService", "Restangular", "UserService", "ZooplaApiService", "ZooplaPropertyImagesService", "ZOOPLA_DEFAULT_VALUE_IDENT", "PostcodeService", function (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t) {
        function u(b) {
            a.caseDataPromise.then(function (a) {
                l.fetch(a.id, b).then(function () {
                    angular.forEach(l.favourites, function (a) {
                        J(a)
                    })
                })
            })
        }

        function v() {
            var e = {boxClass: "property-search__infobox", boxStyle: {display: "block"}, closeBoxURL: "", disableAutoPan: !0, initialSearch: c.search(), pixelOffset: new google.maps.Size(gb.x, gb.y)};
            lb = m(L, {hardLimit: a.SEARCH_MAX_RESULTS, pageSize: a.SEARCH_RESULTS_LIMIT, autoloadPages: !0, numAdditionalPagesToAutoload: 4}), a.propertyLimit = a.SEARCH_RESULTS_LIMIT, a.results.listing = lb.results, fb = new InfoBox(e), fb.setContent($(".property-search__infobox__wrapper").get(0)), fb.setVisible(!1), $(".property-search__infobox__wrapper").on("mousemove", function (a) {
                a.stopPropagation()
            }), a.loc = c, a.search.params = _.extend({}, a.search.defaults, a.search.params, plentific.utils.urlToObj(c.search()).search), x(), mb = a.$watch("loc.search()", function (d, e) {
                b.warn("querystring changed from ", e, " to ", d);
                var f = plentific.utils.urlToObj(d).search || {}, g = plentific.utils.urlToObj(e).search;
                if (a.search.isPristine === !0 || !_.isEmpty(f) && !angular.equals(f, g)) {
                    if (a.search.isPristine = !1, f.order_value = ("_" + a.search.params.order_by + "_" + a.search.params.ordering + "_").toUpperCase(), a.search.params = _.extend({}, a.search.defaults, f), !c.search()["search.minimum_price"] && !c.search()["search.maximum_price"] && c.search()["search.calculated_price"]) {
                        var h, j, k, l, m, n = parseInt(c.search()["search.calculated_price"], 10);
                        m = _.sortedIndex(a.search.prices, n), h = m - 1, j = a.search.prices[h], k = m + 1, l = a.search.prices[k], 0 > h && (h = 0, j = a.search.prices[h]), k > a.search.prices.length - 1 && (k = a.search.prices.length - 1, l = a.search.prices[k]), a.search.params.minimum_price = j, a.search.params.maximum_price = l
                    }
                    i.trackPage(c.url()), b.warn("querystring parsed, loading new results for ", d), lb.reset(), lb.loadInitialPage()
                }
            }, !0), a.$watch("search.params", function (c) {
                var d = [];
                _.each(a.search.filters, function (b) {
                    c[b] !== a.search.defaults[b] && d.push(b)
                }), b.warn("Number active filters " + d.length), a.activeFilters = d.length
            }, !0), d.$on("property:favouriteStateChange", function (b, c) {
                angular.forEach(a.results, function (a) {
                    a.listing_id === c.listing_id && (a.isFavourite = c.isFavourite, a.marker.setIcon(D(a)))
                }), jb.repaint()
            }), x(), u(1)
        }

        function w(b) {
            a.activeSection = b
        }

        function x() {
            var b = c.search(), d = plentific.utils.urlToObj(b), e = z(_.extend({}, a.search.defaults, a.search.params)), f = angular.equals(_.sortBy(_.keys(d.search)), ["area", "calculated_price"]);
            a.search.isPristine && (f || _.isEmpty(e)) || (d.search = e), a.search.isForcedQuarterMileSearch = !1, a.filtersVisible = !1, c.search(plentific.utils.objToUrl(d))
        }

        function y(a, b) {
            l.setFavourite(j.getActiveCaseId(), a, !a.isFavourite), b.stopPropagation(), b.preventDefault()
        }

        function z(b) {
            var c = ["area"], d = ["order_value", "page_size", "page_number"], e = {};
            return _.each(b, function (b, f) {
                var g = !0;
                b === a.search.defaults[f] && (g = !1), _.contains(c, f) && (g = !0), _.contains(d, f) && (g = !1), g && (e[f] = b)
            }), e
        }

        function A(a) {
            var b = {}, c = ["order_value", "calculated_price", "page_size"];
            if (_.isObject(!a))throw new Error("No data was not an object");
            return angular.forEach(a, function (a, d) {
                _.contains(c, d) || a !== s && (b[d] = a)
            }), _.extend(b, H(a)), b
        }

        function B() {
            return lb.getTotalResultsLoaded()
        }

        function C() {
            var a = plentific.utils.urlToObj(c.search()), b = a.search || {}, d = plentific.utils.objToUrl({search: b});
            return"" !== d && (d = "?" + d), d
        }

        function D(a) {
            var b, c, d = f.plentific.CONFIG.STATIC_URL + "images/", e = null, g = d + "pin.png", h = d + "pin--favourite.png";
            return c = "isFavourite"in a && a.isFavourite === !0 ? !0 : !1, b = c ? h : g, e = {size: new google.maps.Size(12, 23), url: b}
        }

        function E(a, b) {
            if (!a)return null;
            var c, a;
            return c = r.getOriginalImageInfo(a), a = r.computeImageUrl(c.filename, c.extension, b)
        }

        function F(a) {
            return"property-comparison" === e.current.name ? n.isPropertyInCompare(a) : !1
        }

        function G(a) {
            return"property-comparison" === e.current.name ? n.findCompareIndex(a) : -1
        }

        function H(a) {
            var b, c, d = a.order_value;
            switch (d) {
                case"_PRICE_DESCENDING_":
                    b = "price", c = "descending";
                    break;
                case"_PRICE_ASCENDING_":
                    b = "price", c = "ascending";
                    break;
                case"_AGE_DESCENDING_":
                    b = "age", c = "descending"
            }
            return{order_by: b, ordering: c}
        }

        function I() {
            a.propertyLimit = a.SEARCH_MAX_RESULTS
        }

        function J(a) {
            a.prettyThumnailUrl = E(a.thumbnail_url, "THUMB"), a.prettyPrice = g("noFractionCurrency")(a.price, "£"), a.prettyPublishDate = g("fromNow")(a.first_published_date)
        }

        function K(b) {
            var c = _.difference(_.toArray(a.search.params), _.toArray(a.search.defaults)), d = b.result_count, e = a.search.params.area, f = t.isValidPostcode(e);
            return 0 === d && f && 1 === c.length && c[0] === e ? !0 : !1
        }

        function L(d, e, f) {
            function g(b) {
                var e = 0 === d;
                if (angular.isUndefined(b.listing) === !1) {
                    if (K(b) === !0)return a.search.params.radius = .25, x(), a.search.isForcedQuarterMileSearch = !0, void 0;
                    a.disambiguationRequired = !1, angular.forEach(b.listing, function (a) {
                        J(a)
                    }), f(b.listing, b.result_count), a.results.result_count = b.result_count, a.loading.listings = !1, lb.hasMorePages() === !1 && (a.showSpinner = !1), e && W(), b.result_count > 0 && db(b.listing)
                } else a.searchedArea = c.search()["search.area"].split("+").join(" "), a.disambiguationAddresses = b.disambiguation, a.disambiguationRequired = !0, a.showSpinner = !1
            }

            function h(c) {
                b.error("Fetch Error: " + c), a.results.result_count = 0, a.showSpinner = !1, W()
            }

            var i;
            return hb.listings = !0, a.showSpinner = !0, a.search.params.page_number = d / lb.getPageSize() + 1, i = a.generateRequestData(a.search.params), q.getPropertyList(i).then(g, h)
        }

        function M(a) {
            ab(a.getMarkers(), a.getCenter())
        }

        function N(a, b) {
            a.stopPropagation(), a.preventDefault(), S(!1), "property-comparison" === e.current.name ? O(b) : c.path("/property-search/property/" + b.listing_id + "/")
        }

        function O(a) {
            var b = n.getFirstNullIndex(), d = plentific.utils.urlToObj(c.search()), e = d.compare || {};
            0 === b ? e.property1 = a.listing_id : e.property2 = a.listing_id, _.isEmpty(e) || (d.compare = e), c.search(plentific.utils.objToUrl(d))
        }

        function P(b, d) {
            S(!0), a.rightClickedProperty = d, a.selectedArea = c.search()["search.area"], a.contextMenuOffsetTop = String(b.screenY - 190) + "px", a.contextMenuOffsetLeft = String(b.screenX) + "px"
        }

        function Q() {
            S(!1), fb && fb.getVisible() && (fb.setVisible(!1), a.map.set("scrollwheel", !0))
        }

        function R() {
            S(!1), ab([this], this.getPosition())
        }

        function S(b) {
            a.$$phase ? a.contextMenuActive = b : a.$apply(function () {
                a.contextMenuActive = b
            })
        }

        function T() {
            $("#fullscreen-scroll-container").show(), b.warn("Property drag started"), a.$apply(function () {
                a.isDragging = !0
            })
        }

        function U() {
            $("#fullscreen-scroll-container").hide(), b.warn("Property drag stopped"), a.$apply(function () {
                a.isDragging = !1
            })
        }

        function V() {
            b.warn("Property Search View - View Scope Destroyed"), mb(), a.search.isPristine = !0, bb(), cb(), fb = null, jb = null
        }

        function W() {
            ib = null, a.clusterMarkers = null, jb ? (bb(), jb.clearMarkers()) : Y()
        }

        function X(b) {
            var c = $(".property-search-modal__scroll-pane .scroll-pane__content"), d = $(".property-details__main-section--" + b + ":visible"), e = d.length ? d.get(0).offsetTop : 0;
            a.activeSection = b || "details", c.animate({scrollTop: e}, {duration: 400})
        }

        function Y() {
            var b = [24, 6];
            a.map.setOptions({maxZoom: eb}), jb = new MarkerClusterer(a.map, [], {calculator: function (a) {
                var b, c = !1, d = a.length.toString(), e = d, f = d + " properties in this area";
                return angular.forEach(a, function (a) {
                    return a.data.property && "isFavourite"in a.data.property && a.data.property.isFavourite ? (c = !0, !1) : void 0
                }), b = c ? 4 : 3, d > 9 && (e = "+"), {text: e, index: b, title: f}
            }, gridSize: 25, imagePath: f.plentific.CONFIG.STATIC_URL + "images/", minimumClusterSize: 2, styles: [
                {anchorIcon: b, url: f.plentific.CONFIG.STATIC_URL + "images/pin.png", fontFamily: "'Source Sans Pro', sans-serif", fontWeight: "bold", height: 24, textColor: "#fff", textSize: 11, width: 12},
                {anchorIcon: b, url: f.plentific.CONFIG.STATIC_URL + "images/pin--favourite.png", fontFamily: "'Source Sans Pro', sans-serif", fontWeight: "bold", height: 24, textColor: "#fff", textSize: 11, width: 12},
                {anchorIcon: b, url: f.plentific.CONFIG.STATIC_URL + "images/pin--cluster.png", fontFamily: "'Source Sans Pro', sans-serif", fontWeight: "bold", height: 24, textColor: "#fff", textSize: 11, width: 12},
                {anchorIcon: b, url: f.plentific.CONFIG.STATIC_URL + "images/pin--cluster--favourite.png", fontFamily: "'Source Sans Pro', sans-serif", fontWeight: "bold", height: 24, textColor: "#fff", textSize: 11, width: 12}
            ], zoomOnClick: !1}), a.markerClusterer = jb, google.maps.event.addListener(jb, "mouseover", M), google.maps.event.addListener(jb, "mousemove", function (a, b) {
                b.stopPropagation()
            })
        }

        function Z() {
            return lb ? lb.willContainAllAvailableResults() : !1
        }

        function ab(b, c) {
            a.$apply(function () {
                a.clusterMarkers = b
            }), fb.setPosition(c), fb.setVisible(!0), fb.open(a.map), a.map.set("scrollwheel", !1), kb || (google.maps.event.addListener(a.map, "mousemove", Q), kb = !0)
        }

        function bb() {
            if (jb) {
                var a = jb.getMarkers();
                angular.forEach(a, function (a) {
                    google.maps.event.clearInstanceListeners(a), delete a.data.property
                })
            }
        }

        function cb() {
            jb && google.maps.event.clearInstanceListeners(jb)
        }

        function db(c) {
            var d = [];
            _.each(c, function (a) {
                var b;
                a.latitude && a.longitude && (b = new google.maps.Marker({data: {property: a}, draggable: !1, icon: D(a), position: new google.maps.LatLng(a.latitude, a.longitude)}, !0), a.marker = b, google.maps.event.addListener(b, "mouseover", R), d.push(b))
            }), jb.addMarkers(d), jb.fitMapToMarkers(), a.map.getZoom() > eb && (b.warn("Setting max zoom to " + eb), a.map.setZoom(eb)), jb.repaint()
        }

        var eb = 17, fb = null, gb = {x: 15, y: -49}, hb = {listings: !1}, ib = null, jb = null, kb = !1, lb = null, mb = null;
        b.log("PropertySearchController: initialising"), a.accordionSections = {description: !0, listing_info: !0, ownership_status: !0, floorplan: !0, location: !0, financials: !0, contact: !0}, a.activeFilters = 0, a.activeSection = "details", a.filtersVisible = !1, a.clusterMarkers = null, a.data = k.data, a.map = null, a.favourites = l.favourites, a.results = {listing: null, result_count: 0}, a.showSpinner = !1, a.contextMenuOffsetTop = 0, a.contextMenuOffsetLeft = 0, a.$on("$destroy", V), a.syncQueryString = x, a.favouriteButtonClick = y, a.isPropertyActive = F, a.findCompareIndex = G, a.generateRequestData = A, a.getMarkerIcon = D, a.getNumLoadedResults = B, a.getQueryStringForSearch = C, a.getSortingParameters = H, a.getPropertyImage = E, a.loading = hb, a.onClusterPropertyClicked = N, a.onClusterPropertyRightClicked = P, a.contextMenuSetVisible = S, a.onLoadMoreClick = I, a.onPropertyDragStart = T, a.onPropertyDragStop = U, a.scrollToSection = X, a.setActiveSection = w, a.shouldShowRefinePrompt = Z, a.fetchFavourites = u, a.userData = p.userData, a.$watch("search.params.order_value", function (b, c) {
            if (b !== c) {
                var d = a.getSortingParameters(a.search.params);
                _.extend(a.search.params, d), x()
            }
        }), v()
    }])
}(), plentific.app.controller("RentVsBuyCalculatorController", ["$scope", function () {
}]), function () {
    plentific.app.controller("ScenarioAnalysisController", ["$scope", "$filter", "AffordabilityUtilService", "CaseService", "PropertyComparisonService", "UtilsService", function (a, b, c, d, e, f) {
        var g = {applicants: [
            {grossAnnualIncome: 0, netMonthlyIncome: 0},
            {grossAnnualIncome: 0, netMonthlyIncome: 0}
        ], householdExpenses: 0, maxLoanMultiple: 0, totalSavings: 0, scenarios: []}, h = {interestRate: 0, ltv: 0, mortgageTerm: 0, purchasePrice: 0, purchasePriceDirty: !1, otherFees: 0}, i = function (b) {
            a.caseDataPromise.then(function (d) {
                a.caseData = d;
                var e = angular.extend({}, g);
                e.propertyData = {price: b.price, customFields: b.customFields}, angular.forEach(a.financialScenarios, function (d, f) {
                    var g = angular.extend({}, h, d);
                    g.purchasePrice = parseFloat(b.customFields.estimatedPrice), g.interestRate = 100 * c.getMortgageRate(d.ltv / 100, a.mortgageData), g.mortgageTerm = c.MORTGAGE_TERM, g.otherFees = a.caseData.overriddenVars.otherFees, e.scenarios[f] = g
                }), e.applicants = a.propertyFinancials.applicants, e.householdExpenses = a.propertyFinancials.monthlyExpenses, e.maxLoanMultiple = c.MAX_LOAN_MULTIPLE, e.totalSavings = a.propertyFinancials.savings, a.financials = e, a.showResetButton = !1
            })
        }, j = function (a) {
            return parseFloat(a.interestRate / 100)
        }, k = function () {
            var b = 0;
            return angular.forEach(a.propertyFinancials.applicants, function (a) {
                b += a.netMonthlyIncome
            }), b
        }, l = function () {
            var b = 0;
            return angular.forEach(a.propertyFinancials.applicants, function (a) {
                b += a.grossAnnualIncomeIncludingBonus
            }), b
        }, m = function (b) {
            var c = 100 - Math.round(100 * (b.purchasePrice / a.financials.propertyData.price));
            return c >= 0 ? c + "%" : "(" + Math.abs(c) + "%)"
        }, n = function (b) {
            return a.financials.propertyData.customFields && null !== a.financials.propertyData.customFields.grossInternalArea && a.financials.propertyData.customFields.grossInternalArea > 0 ? Math.round(b.purchasePrice / a.financials.propertyData.customFields.grossInternalArea) : 0
        }, o = function (a) {
            return Math.round(a.purchasePrice / 100 * a.ltv)
        }, p = function (a) {
            return a.purchasePrice - a.purchasePrice * (a.ltv / 100)
        }, q = function (a) {
            return c.stampDuty(a.purchasePrice) * a.purchasePrice
        }, r = function (a) {
            return a.otherFees
        }, s = function (a) {
            return a.deposit + a.stampDuty + a.otherFees
        }, t = function (a) {
            return-c.PMT(j(a) / 12, 12 * a.mortgageTerm, a.loanAmount, 0, 0)
        }, u = function (a) {
            return"green" === a.mortgageOverIncomeIndicator && "green" === a.mortgageOverDispIncomeIndicator ? "green" : "red" === a.mortgageOverIncomeIndicator || "red" === a.mortgageOverDispIncomeIndicator ? "red" : "amber"
        }, v = function (a) {
            return j(a) / 12 * a.loanAmount
        }, w = function (a) {
            return a.monthlyMortgagePayment - a.interestPerMonth
        }, x = function (b) {
            return a.propertyFinancials.savings - b.totalCashRequired
        }, y = function (b) {
            return a.caseDataPromise.then(function () {
                var c = Math.round(100 * (b.monthlyMortgagePayment / (k() - a.propertyFinancials.totalNonPropertyExpenses)));
                return b.mortgageOverDispIncome = f.zeroIfInfinity(c), b.mortgageOverDispIncome
            })
        }, z = function (a) {
            a.mortgageOverDispIncome.then(function () {
                return a.mortgageOverDispIncomeIndicator = c.disposableIncomeIndicator(a.mortgageOverDispIncome / 100), a.mortgageOverDispIncomeIndicator
            })
        }, A = function (a) {
            var b = l();
            return f.zeroIfInfinity(a.loanAmount / b)
        }, B = function (a) {
            return c.incomeMultipleIndicator(a.incomeMultiple)
        }, C = function (a) {
            var b = Math.round(100 * (a.monthlyMortgagePayment / k()));
            return f.zeroIfInfinity(b)
        }, D = function (a) {
            return c.incomeIndicator(a.mortgageOverIncome / 100)
        }, E = function (b) {
            b.discount = m(b), b.pricePerSqFt = n(b), b.loanAmount = o(b), b.deposit = p(b), b.stampDuty = q(b), b.otherFees = r(b), b.totalCashRequired = s(b), b.monthlyMortgagePayment = t(b), b.monthlyMortgagePaymentIndicator = u(b), b.interestPerMonth = v(b), b.principalRepayment = w(b), b.remainingCash = x(b), b.mortgageOverDispIncome = y(b), b.mortgageOverDispIncomeIndicator = z(b), b.incomeMultiple = A(b), b.incomeMultipleIndicator = B(b), b.mortgageOverIncome = C(b), b.mortgageOverIncomeIndicator = D(b), b.purchasePriceDirty = parseFloat(b.purchasePrice) !== parseFloat(a.financials.propertyData.customFields.estimatedPrice), b.purchasePriceDirty && (a.showResetButton = !0)
        }, F = function () {
            a.financials && angular.forEach(a.financials.scenarios, function (a) {
                E(a)
            })
        };
        a.$watch("property", function (b) {
            b && a.caseDataPromise.then(function (d) {
                a.caseData = d, c.getMortgageRates().then(function (c) {
                    a.mortgageData = c, i(b)
                })
            })
        }), a.$watch("property.customFields.estimatedPrice", function (b) {
            a.financials && angular.forEach(a.financials.scenarios, function (c, d) {
                c.purchasePriceDirty !== !0 && (a.financials.scenarios[d].purchasePrice = b)
            })
        }), a.$watch("financials", function (a, b) {
            a && !angular.equals(a, b) && F()
        }, !0), a.$watch("propertyFinancials", function (a, b) {
            a && !angular.equals(a, b) && F()
        }, !0), a.$watch("caseData.overriddenVars.otherFees", function (b) {
            console.log("OTHER FEES UPDATED TO", b);
            for (var c in a.financials.scenarios)console.log("CHANGING", a.financials.scenarios[c].otherFees, "TO", b), a.financials.scenarios[c].otherFees = b
        }), a.initFinancials = i, a.showResetButton = !1, a.configure = function (b) {
            e.getPropertyToCompare(b) && (a.property = e.getPropertyToCompare(b).data, a.property.then(function (b) {
                a.property = b
            }))
        }
    }])
}(), plentific.app.controller("SidebarController", ["$scope", "$rootScope", "$state", function (a, b, c) {
    a.activeSection = null, b.$on("$stateChangeSuccess", function () {
        c.current.data.sidebar_section !== a.activeSection && (a.activeSection = c.current.data.sidebar_section)
    })
}]), function () {
    plentific.app.directive("plBars", ["UtilsService", function (a) {
        var b, c, d, e, f = [], g = {container: null, featuredElementIndex: 5, width: 798, height: 430, graphHeight: 300, graphStartX: 100, graphStartY: 30, graphEndY: 0, fontSize: "16px", fontWeightBold: 600, fontWeight: 400, borderRadius: 2, gutter: 5, axis: {color: "#ccc", width: 1}, colors: {blueBar: {fillColor: "#eef7fb", color: "#8ac6e5", fontColor: "#74bade"}, greenBar: {fillColor: "#f0faf1", color: "#86d490", fontColor: "#4abf5a"}, redBar: {fillColor: "#fceeee", color: "#faa490", fontColor: "#e25e5b"}, grey: {color: "#fafafa", fontColor: "#aaaaaa"}, red: {color: "#fff0f0", fontcolor: "#aa8888"}}};
        g.graphEndY = g.graphStartY + g.graphHeight;
        var h = function (a, b) {
            f = a.data, $.extend(g, a.settings), g.container = b.get(0);
            var c = b.width();
            c > 0 && (g.width = c), i(), j()
        }, i = function () {
            d = (g.width - g.graphStartX) / f.length, e = d3.max(f, function (a) {
                return a.monthlyPayment
            }) + 100, c = d3.scale.linear().domain([0, e]).range([0, g.graphHeight])
        }, j = function () {
            for (var a = 0; a < f.length; a++) {
                var b = f[a];
                b.startY = e - b.monthlyPayment, b.height = b.monthlyPayment, b.startX = d * a + g.graphStartX, b.width = d - 2 * g.gutter, b.color = g.colors[b.category].color, b.fillColor = g.colors[b.category].fillColor
            }
            k()
        }, k = function () {
            l(), m(), n()
        }, l = function () {
            var c, d, f, h;
            $(g.container).html(""), b = d3.select(g.container).append("svg").attr("class", "bars__graph").attr("width", g.width).attr("height", g.height), c = d3.scale.linear().domain([0, e]).range([g.width, 0]), f = d3.svg.axis().scale(c).ticks(0).orient("bottom"), b.append("g").attr("class", "axis").attr("transform", "translate(" + g.graphStartX + ", " + g.graphEndY + ")").call(f).append("text").attr("class", "caption").attr("y", 80).attr("x", (g.width - g.graphStartX) / 2).style("text-anchor", "middle").text("Interest Rate"), d = d3.scale.linear().domain([0, e]).range([g.graphHeight, 0]), h = d3.svg.axis().scale(d).tickFormat(function (b) {
                return"£" + a.commafy(b)
            }).orient("left"), b.append("g").attr("class", "axis axis--amount").attr("transform", "translate(" + g.graphStartX + ", 40)").call(h).append("text").attr("class", "caption").attr("transform", "rotate(270)").attr("y", -80).attr("x", -(g.graphHeight / 2)).style("text-anchor", "middle").text("Monthly mortgage payment")
        }, m = function () {
            var a = b.selectAll(".barChartRect").data(f).enter().append("rect");
            a.each(function (a, e) {
                if (d3.select(this).attr("class", "waterfallRect").attr("x", a.startX + g.gutter).attr("y", g.graphStartY + c(a.startY)).attr("width", a.width).attr("fill", a.fillColor).attr("stroke", a.color).attr("rx", g.borderRadius).attr("height", c(a.height)), e === g.featuredElementIndex - 1) {
                    var f = b.append("g");
                    f.append("rect").attr("class", "waterfallRect").attr("x", a.startX).attr("y", g.graphStartY).attr("width", a.width + 2 * g.gutter).attr("fill", "#73b2c6").attr("fill-opacity", "0").attr("stroke", "#73b2c6").attr("stroke-dasharray", "4, 4").attr("rx", "8px").attr("height", g.graphHeight + 40), f.append("text").attr("fill", "#666").attr("x", a.startX + d / 2).attr("y", g.graphStartY - 15).style("font-size", g.fontSize).style("font-weight", g.fontWeight).style("text-anchor", "middle").text("Base case")
                }
            })
        }, n = function () {
            var e = b.selectAll(".waterfallLabel").data(f).enter().append("g");
            e.append("text").attr("fill", "#666").attr("x",function (a) {
                return a.startX + d / 2
            }).attr("y",function (a) {
                return c(a.startY) - g.gutter + g.graphStartY
            }).style("font-size", g.fontSize).style("font-weight", g.fontWeight).style("text-anchor", "middle").text(function (b) {
                return"£" + a.commafy(b.monthlyPayment)
            }), e.append("text").attr("fill", "#666").attr("x",function (a) {
                return a.startX + d / 2
            }).attr("y", g.graphEndY + 20).attr("width", d).style("font-size", g.fontSize).style("font-weight", g.fontWeight).style("dominant-baseline", "central").style("text-anchor", "middle").text(function (a) {
                return a.interestRate + "%"
            })
        };
        return{link: function (a, b, c) {
            var d;
            a.$on("barChartDataUpdated", function (a, b) {
                d = b, e()
            });
            var e = _.debounce(function () {
                angular.isUndefined(d) === !1 && h(d, b, c)
            }, 200)
        }}
    }])
}(), function () {
    plentific.app.directive("plBindHtmlUnsafeCompile", ["$compile", function (a) {
        return{replace: !0, link: function (b, c, d) {
            b.$watch(d.plBindHtmlUnsafeCompile, function (d) {
                b.STATIC_URL = plentific.CONFIG.STATIC_URL, c.html(d), a(c.contents())(b)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plDefaultValueHider", [function () {
        return{link: function (a, b, c) {
            b.on("focus", function () {
                var b = $(this);
                a.$apply(function () {
                    b.val() == c.plDefaultValueHider && b.val("")
                })
            }), b.on("blur", function () {
                var b = $(this);
                a.$apply(function () {
                    "" == b.val() && b.val(c.plDefaultValueHider)
                })
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plDonut", ["bem", function () {
        var a = {width: "220", height: "140", donutWidth: 6, colors: {blue: "#74bade", grey: "#f6f6f6", strokeGrey: "#d9dde0", red: "#e25e5b", orange: "#f8ca2f", green: "#7ad085"}, fillColors: {green: "#f0faf1", orange: "#FFFAEA", red: "#fceeee"}}, b = function (a, b) {
            angular.isUndefined(b.plainColor) === !1 && (parseFloat(b.value) > 1 || 0 === parseFloat(b.value)) ? e(a, b) : d(a, b)
        }, c = function (a) {
            a.html("")
        }, d = function (b, c) {
            var d, e, f, g, h, i, j, k = parseFloat(c.value), l = b[0], m = function (b) {
                return 0 === b ? angular.isUndefined(c.color) === !1 ? a.colors[c.color] : a.colors.blue : a.colors.grey
            };
            a.width = b.width(), "multiplyBy100" === c.modifiers && (k = 100 * k), k > 100 && (k = 100), d = [k, 100 - k], e = Math.min(a.width, a.height) / 2, f = [a.width / 2, a.height / 2], h = d3.layout.pie().sort(null), i = d3.svg.arc().innerRadius(e - a.donutWidth).outerRadius(e), g = d3.select(l).append("svg").attr("width", a.width).attr("height", a.height).append("g").attr("transform", "translate(" + f[0] + "," + f[1] + ")"), j = g.selectAll("path").data(h(d)).enter().append("path").attr("fill",function (a, b) {
                return m(b)
            }).attr("d", i)
        }, e = function (b, c) {
            var d, e = b[0], f = Math.min(a.width, a.height) / 2;
            a.width = b.width(), d = d3.select(e).append("svg").attr("width", a.width).attr("height", a.height).append("g").attr("transform", "translate(" + a.width / 2 + "," + a.height / 2 + ")"), d.append("circle").attr("fill", a.fillColors[c.plainColor]).attr("stroke", a.colors[c.plainColor]).attr("r", f)
        };
        return{link: function (a, d, e) {
            var f = d, g = e;
            a.$on("waterfallDataUpdated", function () {
                h()
            });
            var h = _.debounce(function () {
                c(f), i()
            }, 50), i = _.debounce(function () {
                b(f, g)
            }, 200)
        }}
    }])
}(), function () {
    plentific.app.directive("plEditableLabel", [function () {
        return{restrict: "A", scope: {ngModel: "="}, template: '<div class="editable-label__label">{{ngModel | noFractionCurrency:\'£\'}} <i></i></div><div class="editable-label__field"><div ng-transclude></div></div>', transclude: !0, require: "ngModel", link: function (a, b) {
            var c = b.find(".editable-label__field"), d = b.find(".editable-label__label");
            d.click(function () {
                d.hide(), c.show(), c.find("input").focus().select()
            }), c.find("input").blur(function () {
                d.show(), c.hide(), "" === c.find("input").val() && (c.find("input").val(parseInt(1, 10)).select(), a.ngModel = 1)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plFieldMatch", function () {
        return{require: "ngModel", link: function (a, b, c, d) {
            a.$watch(c.plFieldMatch, function (a) {
                d.$setValidity("fieldMatch", !!a)
            })
        }}
    })
}(), function () {
    plentific.app.directive("plFloorplan", ["$compile", function (a) {
        var b = {image: '<a data-ng-href="[[ floorplan ]]" target="_blank"><img class="property-details__floorplan-image" data-ng-src="[[ floorplan ]]"></a>', pdf: '<a class="property-details__floorplan-pdf__link" data-ng-href="[[ floorplan ]]" target="_blank"><span class="property-details__floorplan-pdf__icon"></span><span class="property-details__floorplan-pdf__link-text">Download floorplan (.pdf)</span></a>', link: '<a data-ng-href="[[ floorplan ]]" target="_blank">Click here to see floorplan</a>'};
        return{replace: !0, scope: {floorplan: "=plFloorplan"}, link: function (c, d) {
            var e, f = function (a) {
                if (!a)return null;
                var b, c = null;
                return b = a.split("."), c = b[b.length - 1]
            };
            c.$watch("floorplan", function (a) {
                if (e = f(a), "pdf" === e.toLowerCase())c.floorplanType = "pdf"; else {
                    var b = new Image;
                    b.onload = function () {
                        c.$apply(function () {
                            c.floorplanType = "image"
                        })
                    }, b.onerror = function () {
                        c.$apply(function () {
                            c.floorplanType = "link"
                        })
                    }, b.src = a
                }
            }), c.$watch("floorplanType", function (e) {
                d.html(b[e]).show(), a(d.contents())(c)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("ngFocus", ["$parse", function (a) {
        return function (b, c, d) {
            var e = a(d.ngFocus);
            c.bind("focus", function (a) {
                b.$apply(function () {
                    e(b, {$event: a})
                })
            })
        }
    }]), plentific.app.directive("ngBlur", ["$parse", function (a) {
        return function (b, c, d) {
            var e = a(d.ngBlur);
            c.bind("blur", function (a) {
                b.$apply(function () {
                    e(b, {$event: a})
                })
            })
        }
    }])
}(), function () {
    plentific.app.directive("plGallery", ["$log", "ZOOPLA_PROPERTY_IMAGE_SIZE_THUMBNAIL", "ZOOPLA_PROPERTY_IMAGE_SIZE_UNDOCUMENTED_LARGE", function (a, b, c) {
        return{controller: ["$scope", "$element", "$attrs", function (a, d, e) {
            var f = {page_size: 5};
            a.state = {current_page: 1, options: null, selected_image_index: null, selected_image_url: null, total_pages: null}, a.options = angular.extend(a.state, f, a.$eval(e.plGalleryOptions)), a.getImages = function () {
                a.images.getImages()
            }, a.getImageUrlForImageAtIndex = function (b) {
                return a.images.getImageByIndex(b).getImageUrlForSize(c)
            }, a.getImageUrlForThumbnailAtIndex = function (c) {
                return a.images.getImageByIndex(c).getImageUrlForSize(b)
            }, a.getNumImagesInCurrentPage = function () {
                return a.getPage(a.state.current_page).length
            }, a.getPageCount = function () {
                return Math.ceil(a.images.getImageCount() / a.options.page_size)
            }, a.nextPage = function () {
                a.state.current_page++
            }, a.previousPage = function () {
                a.state.current_page--
            }, a.getPage = function (b) {
                var c = 1 === b ? 0 : (b - 1) * a.options.page_size, d = c + a.options.page_size;
                if (1 > b)throw new Error("Invalid page number specified.");
                return a.images.getImages().slice(c, d)
            }, a.getSelectedImage = function () {
                return a.images[a.state.selected_image_index]
            }, a.selectImageAtIndex = function (b) {
                console.log("Selecting images at index " + b), a.state.selected_image_index = b, a.state.selected_image_url = a.images.getImageByIndex(b).getImageUrlForSize(c)
            }, a.getTotalImages = function () {
                return a.images.getImageCount()
            }, a.isEmpty = function () {
                return 0 === a.getTotalImages() ? !0 : !1
            }, a.relativeToAbsoluteIndex = function (b) {
                return(a.state.current_page - 1) * a.options.page_size + b
            }
        }], scope: {images: "=plGallery", _options: "&plGalleryOptions"}, template: '<div class="gallery"><div class="gallery__main-image" data-ng-switch="isEmpty()"><div class="gallery__main-image__no-images-placeholder" data-ng-switch-when="true">No Images</div><img data-ng-src="[[ state.selected_image_url ]]" data-ng-switch-when="false"></div><div class="gallery__thumbnails" data-ng-switch="isEmpty()"><div class="gallery__thumbnails" data-ng-switch-when="true"><ul class="gallery__thumbnail-list"><li class="gallery__thumbnail gallery__thumbnail--placeholder">No Images</li></ul></div><div class="gallery__thumbnails" data-ng-switch-when="false"><ul class="gallery__thumbnail-list"><li class="gallery__thumbnail" data-ng-repeat="thumb in getPage(state.current_page)" data-ng-class="{ \'is-current\': relativeToAbsoluteIndex($index) == state.selected_image_index }" data-ng-click="selectImageAtIndex(relativeToAbsoluteIndex($index))" data-ng-style="{\'background-image\': \'url(\' + getImageUrlForThumbnailAtIndex(relativeToAbsoluteIndex($index)) + \')\'}"></li></ul></div><div class="gallery__pagination"><button class="gallery__pagination-button gallery__pagination-button--prev-page" data-ng-click="previousPage()" data-ng-disabled="state.current_page == 1" aria-label="Previous page of property images"><span class="i i-pagination-prev gallery__pagination-button-icon"></span></button><span data-ng-switch="isEmpty()"><span class="gallery__pagination-description" data-ng-switch-when="false"><span data-ng-bind="((state.current_page - 1) * options.page_size) + 1"></span> <span> - </span> <span data-ng-bind="((state.current_page - 1) * options.page_size) + getNumImagesInCurrentPage()"></span><span> of </span> <span data-ng-bind="getTotalImages()"></span></span></span><button class="gallery__pagination-button gallery__pagination-button--next-page" data-ng-click="nextPage()" data-ng-disabled="state.current_page == state.total_pages" aria-label="Next page of property images"><span class="i i-pagination-next gallery__pagination-button-icon"></span></button></div></div></div>', link: function (b) {
            b.images && b.images.getImageCount() > 0 && b.selectImageAtIndex(0), b.$watch("images", function (c) {
                c && (c.getImageCount() > 0 ? (a.warn("images changed"), b.state.total_pages = Math.ceil(b.getTotalImages() / b.options.page_size), b.selectImageAtIndex(0)) : 0 === c.getImageCount() && (b.state.total_pages = 1))
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plGoogleMap", ["GoogleMapService", "$log", function (a, b) {
        return{scope: {map: "=plGoogleMap", refreshTrigger: "=refreshTrigger"}, controller: ["$scope", function (a) {
            this.mapId = (new Date).getTime(), a.refresh = function () {
                _.defer(function (a) {
                    google.maps.event.trigger(a.map, "resize")
                }, a)
            }
        }], link: function (c, d, e, f) {
            try {
                c.map = a.getMap(f.mapId)
            } catch (g) {
                if ("MAP_NOT_FOUND" !== g.type)throw g;
                c.map = a.createMap(f.mapId, d)
            }
            c.map && google.maps.event.trigger(c.map, "resize"), d.on("$destroy", function () {
                b.log("plGoogleMap::Element Destroyed"), a.releaseMap(f.mapId)
            }), c.$watch("refreshTrigger", function () {
                b.warn("Refresh Map"), c.refresh()
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plHelpPrompt", [function () {
        return{restrict: "A", scope: {}, template: '<div class="help-prompt"><div class="help-prompt__prompt"></div><div class="help-prompt__tooltip" ng-transclude></div></div>', transclude: !0, link: function (a, b) {
            function c() {
                window.clearTimeout(h), f.fadeIn("fast")
            }

            function d() {
                h = window.setTimeout(function () {
                    f.fadeOut("fast")
                }, 500)
            }

            var e = b.find(".help-prompt__prompt"), f = b.find(".help-prompt__tooltip"), g = !1, h = null;
            e.mouseover(c), e.mouseout(d), f.mouseover(c), f.mouseout(d), e.click(function (a) {
                a.stopPropagation(), g = !0, c(), $("body").bind("click", d)
            })
        }}
    }]), plentific.app.directive("plHelpPromptInline", [function () {
        return{restrict: "A", scope: {}, template: '<span class="tooltip__original-text inline-prompt help-prompt help-prompt-centered"><a href="" ng-transclude></a><div class="help-prompt__tooltip"></div></span>', transclude: !0, replace: !0, link: function (a, b, c) {
            function d() {
                window.clearTimeout(j), g.fadeIn("fast")
            }

            function e() {
                j = window.setTimeout(function () {
                    g.fadeOut("fast")
                }, 500)
            }

            var f = c.title, g = b.find(".help-prompt__tooltip"), h = b.find("a");
            g.html(f), c.extraClass && g.removeClass(c.extraClass).addClass(c.extraClass);
            var i = !1, j = null;
            h.mouseover(d), h.mouseout(e), g.mouseover(d), g.mouseout(e), h.click(function (a) {
                a.stopPropagation(), i = !0, d(), $("body").bind("click", e)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plImageUploader", ["UserService", function (a) {
        return{restrict: "A", scope: {imageUrl: "=plImageUploader", defaultAvatar: "@"}, link: function (b, c) {
            var d, e = b.imageUrl, f = function () {
                return d = angular.element('<input type="file">'), d.hide(), c.append(d), d.on("change", g), d
            }, g = function () {
                if (this.files && this.files[0]) {
                    b.$apply(function () {
                        b.isBusy = !0
                    });
                    var c = a.uploadImage(this.files[0]);
                    c.success(j), c.error(k)
                } else this.remove()
            }, h = function () {
                d = f(), d.trigger("click")
            }, i = function () {
                b.imageUrl = e
            }, j = function (a) {
                var c = new Image;
                c.onload = function () {
                    b.$apply(function () {
                        b.imageUrl = a.avatar_130, b.isBusy = !1
                    })
                }, c.src = a.avatar, d.remove()
            }, k = function (a) {
                404 === a.status ? console.error("Not implemented.") : console.error(a), d.remove(), b.isBusy = !1
            };
            b.selectFile = h, b.clearFile = i, b.isBusy = !1
        }}
    }])
}(), function () {
    plentific.app.directive("plDate", [function () {
        return{restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            var e = function (a) {
                var b = a.split("/"), c = null, d = null, e = null, f = null;
                if (3 === b.length && 4 === b[2].length) {
                    c = b[0], d = b[1], e = b[2];
                    try {
                        return f = new Date(e + "-" + d + "-" + c)
                    } catch (g) {
                        return a
                    }
                }
                return a
            };
            d.$parsers.push(e)
        }}
    }])
}(), function () {
    plentific.app.directive("plFocus", [function () {
        return{link: function (a, b) {
            var c = b.parents(".input"), d = "is-focused";
            b.on("focus", function () {
                c.addClass(d)
            }), b.on("blur", function () {
                c.removeClass(d)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plNumberThreshold", [function () {
        return{restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            var e = function (a) {
                if (angular.isUndefined(a) === !1 && isNaN(a.toString().replace(/[,]/g, "")) === !1) {
                    var d = b.data("thresholdmessage"), e = parseFloat(a.toString().replace(/[,]/g, "")), f = parseFloat(c.min);
                    if (f > e) {
                        b.addClass("ng-invalid"), b.parent().find(".error").remove(), b.parent().find("input").after('<span class="error">' + d + '<i class="error-arrow"></i></span>');
                        var g = b.parent().find(".error"), h = g.height();
                        g.css("top", "-" + (h + 30) + "px"), b.width() < 50 && g.addClass("error-offset")
                    }
                }
                return a
            };
            d.$parsers.push(e)
        }}
    }]), plentific.app.directive("plDataThreshold", [function () {
        return{restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            var e = function (a) {
                if (angular.isUndefined(a) === !1 && isNaN(a.toString().replace(/[,]/g, "")) === !1) {
                    var c = b.data("thresholdmessage"), d = parseFloat(a.toString().replace(/[,]/g, "")), e = b.parent().find(".data-threshold-value").val();
                    if (d >= e) {
                        b.addClass("ng-invalid"), b.parent().find(".error").remove(), b.parent().find("input").after('<span class="error">' + c + '<i class="error-arrow"></i></span>');
                        var f = b.parent().find(".error"), g = f.height();
                        f.css("top", "-" + (g + 30) + "px"), b.width() < 50 && f.addClass("error-offset")
                    }
                }
                return a
            };
            b.focus(function () {
                b.siblings(".error").removeClass("error--hidden")
            }), b.blur(function () {
                b.siblings(".error").addClass("error--hidden")
            }), d.$parsers.push(e)
        }}
    }])
}(), function () {
    plentific.app.directive("plNumber", [function () {
        return{restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            if (Modernizr.touch === !0)return b[0].setAttribute("type", "number"), void 0;
            var e = function (a) {
                if (angular.isUndefined(a) === !1 && null !== a) {
                    var b = a.toString().replace(/[,]/g, "").split(".");
                    b[0].length > 3 && (b[0] = b[0].replace(/(\d)(?=(\d{3})+$)/g, "$1,")), angular.isUndefined(b[1]) === !1 && b[1].length > 2 && (b[1] = b[1].slice(0, 2)), a = b.join(".")
                }
                return a
            }, f = function (a) {
                if (angular.isUndefined(a) === !0)return 0;
                var c = "";
                if (isNaN(a.toString().replace(/[,]/g, "")) === !0 ? c = "isNotANumber" : parseFloat(a) < 0 && (c = "isNegativeNumber"), "" === c) {
                    b.removeClass("ng-invalid-format"), b.parent().find(".error").remove();
                    var d = b[0].selectionStart, f = e(a), g = a.split(",").length - 1, h = f.split(",").length - 1;
                    if (b.val(f), h > g ? d += 1 : g > h && (d -= 1), b[0].setSelectionRange(d, d), "" !== f || isNaN(f) === !1) {
                        var i = parseFloat(a.toString().replace(/[,-]/g, ""));
                        return isNaN(i) === !1 ? i : 0
                    }
                    return 0
                }
                var j = "", k = "";
                "isNotANumber" === c ? j = "Type in a number" : "isNegativeNumber" === c && (j = "Negative numbers are not allowed", k = " error--big"), b.addClass("ng-invalid-format"), b.parent().find(".error").remove(), b.parent().find("input").after('<span class="error' + k + '">' + j + '<i class="error-arrow"></i></span>');
                var l = b.parent().find(".error");
                return b.width() < 50 && l.addClass("error-offset"), 0
            }, g = function (a) {
                return isNaN(a) === !0 && (a = ""), e(a)
            };
            d.$parsers.push(f), d.$formatters.push(g)
        }}
    }])
}(), function () {
    plentific.app.directive("plInterestRateField", [function () {
        return{restrict: "A", require: "ngModel", link: function (a, b, c, d) {
            var e = function (a) {
                return angular.isUndefined(a) === !0 ? 0 : parseFloat(a)
            }, f = function (a) {
                return angular.isUndefined(a) === !0 ? "0" : String(parseFloat(a).toFixed(2))
            };
            d.$parsers.push(e), d.$formatters.push(f), $(b).blur(function () {
                a.$apply(function () {
                    b.val(f(b.val()))
                })
            })
        }}
    }])
}(), $(function () {
    plentific.app.directive("plLines", ["UtilsService", function (a) {
        var b, c, d, e, f, g, h, i = [], j = {container: null, amountChangeFormat: 1e3, blueIndex: -1, redIndex: -1, greenIndex: -1, blueTooltipMessage: "", redTooltipMessage: "", greenTooltipMessage: "", startXFrom: 0, collisionDistance: 60, collisionDistanceBottom: 80, areas: !1, width: 798, height: 480, graphHeight: 380, graphStartX: 60, graphStartY: 30, graphEndY: 0, fontSize: "16px", fontWeightBold: 600, fontWeight: 400, borderRadius: 2, gutter: 10, axis: {color: "#ccc", width: 1}, axisHover: {color: "#999", width: 1}, areaVector: {color: "#999", width: 1}, colors: {greenBar: {fillColor: "#f0faf1", color: "#86d490", fontColor: "#4abf5a"}, redBar: {fillColor: "#fceeee", color: "#faa490", fontColor: "#e25e5b"}, grey: {color: "#fafafa", fontColor: "#aaaaaa"}, red: {color: "#fff0f0", fontcolor: "#aa8888"}, blue: {color: "#73b2c6", fontcolor: "#aa8888"}}};
        j.graphEndY = j.graphStartY + j.graphHeight;
        var k = function (a, b) {
            i = a.data, $.extend(j, a.settings), i.length > 0 && (j[i[0][0].category + "Index"] = 0), i.length > 1 && (j[i[1][0].category + "Index"] = 1), i.length > 2 && (j[i[2][0].category + "Index"] = 2), j.container = b.get(0);
            var c = b.width();
            c > 0 && (j.width = c), l(), m()
        }, l = function () {
            f = (j.width - j.graphStartX) / i[0].length, g = d3.max(i[0], function (a) {
                return a.valueX
            }), h = d3.max([d3.max(i[0], function (a) {
                return a.amount
            }), d3.max(i[1], function (a) {
                return a.amount
            })]), i.length > 2 && (h = d3.max([h, d3.max(i[2], function (a) {
                return a.amount
            })])), h += 5 * h / 100, d = d3.scale.linear().domain([0, g - 1]).range([0, j.width - j.graphStartX - 20]), e = d3.scale.linear().domain([0, h]).range([j.graphHeight, 0])
        }, m = function () {
            for (var a = 0; a < i[0].length; a++) {
                var b = i[0][a];
                b.startY = h - b.amount, b.height = b.amount, b.startX = f * a + j.graphStartX, b.width = f - 2 * j.gutter, b.color = j.colors[b.category].color, b.fillColor = j.colors[b.category].fillColor
            }
            n()
        }, n = function () {
            o(), p(function () {
                var a = Math.abs(parseInt(i[0].length / 3, 10) - 1);
                q(i[0][a], a)
            })
        }, o = function () {
            var f, g;
            $(j.container).html(""), b = d3.select(j.container).append("svg").attr("class", "lines__graph").attr("width", j.width).attr("height", j.height), c = b[0][0], f = d3.svg.axis().scale(d).ticks(i[0].length).tickFormat(function (a) {
                return a + j.startXFrom
            }).orient("bottom"), b.append("g").attr("class", "axis").attr("transform", "translate(" + j.graphStartX + ", " + j.graphEndY + ")").call(f).append("text").attr("class", "caption").attr("y", 50).attr("x", (j.width - j.graphStartX) / 2).style("text-anchor", "middle").text("Years"), g = d3.svg.axis().scale(e).tickFormat(function (b) {
                return"£" + a.commafy(b)
            }).orient("left"), b.append("g").attr("class", "axis axis--amount").attr("transform", "translate(" + j.graphStartX + ", " + j.graphStartY + ")").call(g)
        }, p = function (a) {
            for (var c = 0; c < i.length; c++) {
                var f, g;
                j.areas === !0 && (f = d3.svg.area().x(function (a, b) {
                    return j.graphStartX + d(b)
                }).y0(j.graphStartY + j.graphHeight).y1(function (a) {
                    return j.graphStartY + e(a.amount)
                }), b.append("path").attr("class", "lines-area lines-area--" + i[c][0].category).attr("d", f(i[c]))), g = d3.svg.line().interpolate("monotone").x(function (a, b) {
                    return j.graphStartX + d(b)
                }).y(function (a) {
                    return j.graphStartY + e(a.amount)
                }), b.append("path").attr("class", "lines-chart lines-chart--" + i[c][0].category).attr("d", g(i[c])), 0 === c && (s(i[c], g), t(i[c], g), j.areas === !0 && u(i, c)), b.selectAll(".dot").data(i[c]).enter().append("circle").attr("class",function (a, b) {
                    return"lines-chart__dot lines-chart__dot--" + b
                }).attr("cx", g.x()).attr("cy", g.y()).attr("data-id", i[c][0].category + "-line").attr("r", 5), c === i.length - 1 && b.selectAll(".hidden-axis").data(i[0]).enter().append("line").attr("x1", g.x()).attr("x2", g.x()).attr("class", "hidden-axis").style("stroke", "#FF0000").style("stroke-width", (j.width - j.graphStartX) / i[c].length).attr("stroke-opacity", 0).attr("y1", j.graphStartY - 20).attr("y2", j.graphEndY + 5).attr("data-index",function (a, b) {
                    return b
                }).on("mouseover", q)
            }
            angular.isUndefined(a) === !1 && a()
        }, q = function (b, d) {
            r();
            var f, g, h, k, l, m, n = d, o = $(c).find(".hidden-axis").filter("[data-index=" + String(d) + "]").get(0), p = i[0].length;
            $(".lines-chart__dot--" + n).show(), $(".lines-chart__dashed-axis--" + n).show(), $(".lines__x-axis__year--" + n).show(), $(".lines__x-axis__year-background--" + n).show();
            var q = parseFloat(d3.select(o).attr("x1")), s = "";
            if (parseInt(n, 10) > p / 2 && (q = parseFloat(d3.select(o).attr("x1")) - 122, s = "chart__tooltip--right"), $(".lines-chart__dot--" + n + "[data-id=green-line]").length > 0 && i[j.greenIndex]) {
                f = $(".lines-chart__dot--" + n + "[data-id=green-line]").attr("cy");
                var t;
                l = s, t = a.commafy(i[j.greenIndex][n].amount), $('.chart__tooltip[data-id="green-line"]').find(".chart__tooltip__amount").html(t).end().find(".chart__tooltip__text").html(j.greenTooltipMessage).end().css("left", q + "px").css("top", parseFloat(f) - 16 + "px").removeClass("chart__tooltip--hidden").addClass(l)
            }
            if ($(".lines-chart__dot--" + n + "[data-id=blue-line]").length > 0 && i[j.blueIndex]) {
                g = $(".lines-chart__dot--" + n + "[data-id=blue-line]").attr("cy");
                var t, u = q;
                k = s, angular.isUndefined(f) === !1 && Math.abs(parseFloat(g) - parseFloat(f)) < j.collisionDistance && ("" === k ? (k = "chart__tooltip--right", u = parseFloat(d3.select(o).attr("x1")) - 122) : (k = "", u = parseFloat(d3.select(o).attr("x1")))), t = a.commafy(i[j.blueIndex][n].amount), $('.chart__tooltip[data-id="blue-line"]').find(".chart__tooltip__amount").html(t).end().find(".chart__tooltip__text").html(j.blueTooltipMessage).end().css("left", u + "px").css("top", parseFloat(g) - 16 + "px").removeClass("chart__tooltip--hidden").addClass(k)
            }
            if ($(".lines-chart__dot--" + n + "[data-id=red-line]").length > 0 && i[j.redIndex]) {
                h = $(".lines-chart__dot--" + n + "[data-id=red-line]").attr("cy");
                var t, v = q;
                m = s, angular.isUndefined(g) === !1 && Math.abs(parseFloat(h) - parseFloat(g)) < j.collisionDistance && ("" === m ? (m = "chart__tooltip--right", v = parseFloat(d3.select(o).attr("x1")) - 122) : (m = "", v = parseFloat(d3.select(o).attr("x1")))), angular.isUndefined(f) === !1 && Math.abs(parseFloat(h) - parseFloat(f)) < j.collisionDistance && ("" === m ? (m = "chart__tooltip--right", v = parseFloat(d3.select(o).attr("x1")) - 122) : (m = "", v = parseFloat(d3.select(o).attr("x1")))), t = a.commafy(i[j.redIndex][n].amount), $('.chart__tooltip[data-id="red-line"]').find(".chart__tooltip__amount").html(t).end().find(".chart__tooltip__text").html(j.redTooltipMessage).end().css("left", v + "px").css("top", parseFloat(h) - 16 + "px").removeClass("chart__tooltip--hidden").addClass(m)
            }
            if (j.areas === !0) {
                var w = j.graphStartY + e(j.graphEndY), t = 0, x = q, y = 0;
                l = s, f = parseFloat(g), y = h > f ? (h - f) / 2 : (w - f) / 2, f = f + y - 16, t = i[j.blueIndex][n].amount - i[j.redIndex][n].amount, t = a.commafy(t), Math.abs(parseFloat(g) - parseFloat(f)) < j.collisionDistance && $('.chart__tooltip[data-id="blue-line"]').css("left", parseFloat(q) - 60 + "px").css("top", parseFloat(g) - 68 + "px").removeClass("chart__tooltip--hidden").removeClass(k).addClass("chart__tooltip--bottom"), Math.abs(parseFloat(h) - parseFloat(f)) < j.collisionDistanceBottom && $('.chart__tooltip[data-id="red-line"]').css("left", parseFloat(q) - 60 + "px").css("top", parseFloat(h) + 16 + "px").removeClass("chart__tooltip--hidden").removeClass(m).addClass("chart__tooltip--top"), $('.chart__tooltip[data-id="green-line"]').find(".chart__tooltip__amount").html(t).end().find(".chart__tooltip__text").html(j.greenTooltipMessage).end().css("top", f + "px").css("left", x + "px").removeClass("chart__tooltip--hidden").addClass(l), "" === l ? $(".lines__area-vector--right.lines__area-vector--" + n).show() : $(".lines__area-vector--left.lines__area-vector--" + n).show()
            }
        }, r = function () {
            $(".lines-chart__dot").hide(), $(".lines-chart__dashed-axis").hide(), $(".lines__x-axis__year").hide(), $(".lines__area-vector").hide(), $(".lines__x-axis__year-background").hide(), $(".chart__tooltip").addClass("chart__tooltip--hidden").removeClass("chart__tooltip--bottom").removeClass("chart__tooltip--top").removeClass("chart__tooltip--right")
        }, s = function (a, c) {
            b.selectAll(".secondary-axis").data(a).enter().append("line").attr("x1", c.x()).attr("x2", c.x()).attr("stroke-dasharray", "1, 1, 1, 2").style("stroke", j.axis.color).style("stroke-width", j.axis.width).attr("y1", j.graphStartY - 20).attr("y2", j.graphEndY + 5), b.selectAll(".secondary-axis--on-hover").data(a).enter().append("line").attr("x1", c.x()).attr("x2", c.x()).attr("stroke-dasharray", "6, 3").attr("class",function (a, b) {
                return"lines-chart__dashed-axis lines-chart__dashed-axis--" + b
            }).style("stroke", j.axisHover.color).style("stroke-width", j.axisHover.width).attr("y1", j.graphStartY - 20).attr("y2", j.graphEndY + 5)
        }, t = function (a, c) {
            var d = b.append("g");
            d.selectAll(".year-background").data(a).enter().append("rect").attr("class",function (a, b) {
                return"lines__x-axis__year-background lines__x-axis__year-background--" + b
            }).attr("transform", "translate(-8, 0)").attr("x", c.x()).attr("y", j.graphStartY + j.graphHeight + 5).attr("width", 16).attr("fill", "#fff").attr("stroke", "#fff").attr("height", 20), d.selectAll(".year").data(a).enter().append("text").attr("class",function (a, b) {
                return"lines__x-axis__year lines__x-axis__year--" + b
            }).attr("fill", "#fa7455").attr("x", c.x()).attr("y", j.graphStartY + j.graphHeight + 20).style("font-size", j.fontSize).style("font-weight", j.fontWeightBold).style("text-anchor", "middle").text(function (a) {
                return a.valueX
            })
        }, u = function (a, c) {
            b.selectAll(".area-vector-left").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX - 12 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX - 12 + b / 7
            }).attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--left lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            }), b.selectAll(".area-vector-left__border-1").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX - 12 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX - 12 + b / 7 + 3
            }).attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--left lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }), b.selectAll(".area-vector-left__border-2").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX - 12 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX - 12 + b / 7 + 3
            }).attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--left lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            }), b.selectAll(".area-vector-right").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX + 10 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX + 10 + b / 7
            }).attr("stroke-dasharray", "6, 3").attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--right lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            }), b.selectAll(".area-vector-right__border-1").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX + 10 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX + 10 + b / 7 - 3
            }).attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--right lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[0][c].amount)
            }), b.selectAll(".area-vector-right__border-2").data(a[c]).enter().append("line").attr("x1",function (a, b) {
                return a.startX + 10 + b / 7
            }).attr("x2",function (a, b) {
                return a.startX + 10 + b / 7 - 3
            }).attr("class",function (a, b) {
                return"lines__area-vector lines__area-vector--right lines__area-vector--" + b
            }).style("stroke", j.areaVector.color).style("stroke-width", j.areaVector.width).attr("y1",function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            }).attr("y2", function (b, c) {
                return j.graphStartY + e(a[1][c].amount)
            })
        };
        return{link: function (a, b, c) {
            var d;
            a.$on("linesChartDataUpdated", function (a, b) {
                d = b, e()
            });
            var e = _.debounce(function () {
                angular.isUndefined(d) === !1 && k(d, b, c)
            }, 200)
        }}
    }])
}()), function () {
    plentific.app.directive("plPageSubnav", ["DataSavedService", function (a) {
        return{scope: {}, template: '<div class="page-subnav__wrapper"><ul><li data-ng-repeat="item in items" class="[[getItemClassName(item)]]"><a href="[[ item.url ]]">[[ item.title ]]<span data-ng-show="!item.available" class="badge"><span class="badge-background"></span><span class="badge-label">soon</span></span></a></li></ul><div class="saving-indicator--saving" data-ng-show="!data.saved"><span class="saving-indicator__dot"></span><span class="saving-indicator__dot"></span><span class="saving-indicator__dot"></span><span class="saving-indicator__label">Saving</span></div><div class="saving-indicator--saved" data-ng-show="data.saved"><span class="saving-indicator__tick"></span><span class="saving-indicator__label">Saved</span></div></div>', controller: ["$scope", "$attrs", function (b, c) {
            b.items = [
                {name: "affordability", available: !0, title: "Affordability", url: "/calculators/affordability/"},
                {name: "budget", available: !0, title: "Budget", url: "/calculators/budget/"},
                {name: "net-worth", available: !0, title: "Net Worth", url: "/calculators/net-worth/"}
            ], b.currentTab = _.find(b.items, {name: c.plPageSubnav}), b.getItemClassName = function (a) {
                var c, d, e = [];
                return c = _.findIndex(b.items, function (b) {
                    return b.name === a.name
                }), d = _.findIndex(b.items, function (a) {
                    return a.name === b.currentTab.name
                }), c === d - 1 ? e.push("is-pre-active") : c === d + 1 ? e.push("is-post-active") : c === d && e.push("is-active"), e.join(" ")
            }, b.data = a.data
        }]}
    }])
}(), function () {
    plentific.app.directive("plPlacesSearch", ["$log", "$sanitize", "ZooplaApiService", function (a, b, c) {
        return{scope: !0, controller: ["$scope", "$element", "$attrs", "$transclude", function (b) {
            function d(a, c) {
                if (a === b.$eval(b.watchProperty)) {
                    var d = a.length;
                    b.response = c.data, b.inplaceSuggestion = b.response.suggestions[0] ? a + b.response.suggestions[0].displayValue.slice(d) : ""
                }
            }

            var e = _.bind(d, this);
            this.getSuggestions = function (d) {
                var f = c.getSearchSuggestions(d);
                a.log("Getting suggestions for " + d), f ? f.then(function (a) {
                    e(d, a)
                }) : b.$apply(function () {
                    b.response = null
                })
            }
        }]}
    }]), plentific.app.directive("plPlacesSearchInput", ["$log", "ZooplaApiService", function (a) {
        return{require: "^plPlacesSearch", link: function (b, c, d, e) {
            function f(c) {
                var d = c.which, e = !1, f = null, g = {TAB: 9, ENTER: 13, ESC: 27, LEFT_ARROW: 37, UP_ARROW: 38, RIGHT_ARROW: 39, DOWN_ARROW: 40};
                if (b.response && (f = b.response.suggestions.length), a.warn(d), e = _.find(g, function (a) {
                    return parseInt(a, 10) === d
                }))switch (d) {
                    case g.TAB:
                        null !== f && f > 0 && (c.preventDefault(), b.selectAndClose(b.highlightedIndex));
                        break;
                    case g.ENTER:
                        null !== f && f > 0 && b.selectAndClose(b.highlightedIndex);
                        break;
                    case g.ESC:
                        b.inplaceSuggestion = "", b.response = null, c.preventDefault();
                        break;
                    case g.UP_ARROW:
                        b.highlightedIndex = b.highlightedIndex > 0 ? (b.highlightedIndex - 1) % f : f - 1, b.select(b.highlightedIndex), c.preventDefault();
                        break;
                    case g.DOWN_ARROW:
                        b.highlightedIndex = (b.highlightedIndex + 1) % f, b.select(b.highlightedIndex), c.preventDefault()
                }
            }

            var g = _.debounce(_.bind(e.getSuggestions, e), 250);
            b.watchProperty = d.ngModel, c.on("keydown", function (a) {
                b.$apply(function () {
                    f(a)
                })
            }), b.$watch(b.watchProperty, function (c, d) {
                a.warn("Search Area Changed from " + d + " to " + c), "" === c && (b.inplaceSuggestion = ""), c && c !== d && c.length > 0 && (a.warn(c), c !== b.chosenItem && (b.inplaceSuggestion = "", b.chosenItem = null, g(c)))
            })
        }}
    }]), plentific.app.directive("plPlacesSearchSuggestions", ["$log", "ZooplaApiService", function () {
        return{require: ["ngModel", "^plPlacesSearch"], link: function (a, b, c, d) {
            var e = d[0];
            a.highlightedIndex = 0, a.getModelAtIndex = function (b) {
                return a.response.suggestions[b]
            }, a.select = function (b) {
                var c;
                c = a.response.suggestions[b], e.$setViewValue(c.displayValue), a.chosenItem = c.displayValue, a.inplaceSuggestion = c.displayValue
            }, a.selectAndClose = function (c) {
                a.select(c), a.inplaceSuggestion = "", a.response = null, b[0].focus()
            }, a.suggestSorter = function (a) {
                return"place/area" === a.type ? 1 : 0
            }
        }}
    }]), plentific.app.filter("plPlacesSearchSuggestionHighlighter", ["$log", "$sanitize", function (a, b) {
        var c = '<span class="place-search__match-highlight">', d = "</span>";
        return function (a, e) {
            var f, g, h, i = "", j = "", k = "", l = b(a);
            return g = l.toLowerCase().indexOf(e.toLowerCase()), h = g + e.length, -1 !== g ? (i = l.slice(0, g), j = l.slice(g, h), k = l.slice(h), f = i + c + j + d + k) : f = l, f
        }
    }])
}(), function () {
    plentific.app.directive("plPostcodeInput", ["PostcodeService", function (a) {
        return{require: "ngModel", link: function (b, c, d, e) {
            function f(b) {
                if (null === b || void 0 === b || "" === b)return"";
                var c = null, d = b.toUpperCase();
                return d !== b && (e.$setViewValue(d), e.$render()), c = a.isValidPostcode(d), e.$setValidity("postcode", c), c ? d : void 0
            }

            e.$parsers.push(f), e.$formatters.push(f)
        }}
    }])
}(), function () {
    plentific.app.directive("plRightClick", ["$parse", function (a) {
        return{link: function (b, c, d) {
            var e = a(d.plRightClick);
            c.bind("contextmenu", function (a) {
                b.$apply(function () {
                    a.preventDefault(), e(b, {$event: a})
                })
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plScrollPane", [function () {
        return{replace: !0, scope: {plScrollPane: "="}, transclude: !0, template: '<div class="scroll-pane"><div class="scroll-pane__content" data-ng-transclude data-scroll-spy="plScrollPane" data-target="#navPills" data-scroll-offset="80"></div><div class="scroll-pane__shadow--top"></div></div>', link: function (a, b) {
            b.find(".scroll-pane__content").on("scroll", function (a) {
                var b = a.target.scrollTop, c = .2, d = 100;
                if (b > 0) {
                    if (100 > b)var e = c * (b / d); else var e = c;
                    $(this).next().css("box-shadow", "0px 10px 10px 0px rgba(0, 0, 0, " + e + ")")
                } else $(this).next().css("box-shadow", "0px 0px 0px 0px rgba(0, 0, 0, 0.2)")
            })
        }}
    }])
}(), function () {
    plentific.app.directive("preventDefault", function () {
        return function (a, b) {
            b.bind("click", function (a) {
                a.preventDefault()
            })
        }
    }), plentific.app.directive("scrollSpy", ["$timeout", function (a) {
        return{restrict: "A", link: function (b, c, d) {
            var e = parseInt(d.scrollOffset, 10) || 10, f = d.target, g = {offset: e, target: f};
            c.scrollspy(g), b.$watch(d.scrollSpy, function () {
                console.warn("UPDATING SCROLLSPY"), a(function () {
                    c.scrollspy("refresh", g)
                }, 100)
            }, !0)
        }}
    }])
}(), function () {
    plentific.app.directive("scrollTo", ["$timeout", function () {
        return{restrict: "AC", compile: function () {
            function a(a) {
                a && a.scrollintoview()
            }

            return function (b, c, d) {
                c.bind("click", function (b) {
                    b.preventDefault(), a($(d.scrollTo))
                })
            }
        }}
    }])
}(), function () {
    plentific.app.directive("plShowMore", ["$window", "$timeout", function (a, b) {
        return{template: '<div class="show-more-container"><div class="show-more-content" data-ng-transclude></div><div class="show-more-link"><button class="show-more-button" data-ng-show="truncated" data-ng-click="toggle()"><span data-ng-show="!expanded">Show more</span><span data-ng-show="expanded">Show less</span></button></div></div>', scope: {plShowMoreBind: "=plShowMoreBind"}, replace: !0, transclude: !0, link: function (c, d, e) {
            function f() {
                return p * parseInt(n.css("line-height"), 10) + parseInt(n.css("margin-top"), 10)
            }

            function g() {
                var d = angular.element(a);
                if (q === !0)var e = c.$watch("plShowMoreBind", function (a) {
                    a && b(function () {
                        e(), h()
                    })
                }); else h();
                d.bind("resize", function () {
                    o()
                })
            }

            function h() {
                var a = c.expanded, b = m.outerWidth();
                r !== b && (r = b, s[t] = "none", m.css(s), i = d.outerHeight(!0), k = parseInt(n.css("line-height"), 10), l = f(), j = parseInt(n.css("margin-top"), 10) + i + parseInt(n.css("margin-bottom"), 10), console.warn("contentHeight: " + i), i > l && (c.truncated = !0, c.expanded = !1, m.removeAttr("style"), m.css({height: l + "px", overflow: "hidden"}), a === !0 && c.expand()))
            }

            var i, j, k, l, m = d.find(".show-more-content"), n = m.children().eq(0), o = _.debounce(function () {
                c.$apply(function () {
                    h()
                })
            }, 400), p = parseInt(e.plShowMore, 10) || 5, q = !!e.plShowMoreBind, r = null, s = {height: "auto", overflow: "visible"}, t = Modernizr.prefixed("transition").replace(/([A-Z])/g,function (a, b) {
                return"-" + b.toLowerCase()
            }).replace(/^ms-/, "-ms-");
            c.truncated = !1, c.expanded = !1, c.expand = function () {
                c.expanded = !0, m.css({height: j + "px"})
            }, c.collapse = function () {
                c.expanded = !1, m.css({height: l + "px"})
            }, c.toggle = function () {
                c.expanded ? c.collapse() : c.expand()
            }, g()
        }}
    }])
}(), function () {
    plentific.app.directive("plSidebar", [function () {
        return{scope: {}, replace: !0, templateUrl: "/partials/views/includes/sidebar.html", controller: ["$scope", function (a) {
            this.expand = a.hide, this.collapse = a.show, this.isCollapsed = a.isCollapsed, this.isExpanded = a.isExpanded
        }], link: function (a, b) {
            var c = !1, d = b.find(".app-sidebar__background-cover");
            a.expand = function () {
                c = !0, b.removeClass("is-collapsed"), b.addClass("is-expanded"), d.show()
            }, a.collapse = function () {
                c = !1, b.removeClass("is-expanded"), b.addClass("is-collapsed"), d.hide()
            }, a.toggleExpanded = function () {
                c ? a.collapse() : a.expand()
            }, a.isExpanded = function () {
                return c
            }, b.on("click", "a", function () {
                a.collapse()
            })
        }}
    }])
}(), function () {
    plentific.app.directive("slider", [function () {
        return{restrict: "E", scope: {ngModel: "=", max: "@", onChanged: "&", onSliding: "&"}, replace: !0, template: "<div></div>", require: "ngModel", link: function (a, b, c) {
            a.$watch("ngModel", function (a) {
                void 0 !== a && b.slider("value", parseInt(a, 10))
            }), a.$watch("max", function () {
                b.slider("option", "max", parseInt(a.max, 10)), b.slider("value", parseInt(a.ngModel, 10))
            });
            var d = parseInt(c.min, 10), e = parseInt(c.max, 10), f = parseInt(a.ngModel, 10), g = parseInt(c.step, 10);
            isNaN(e) === !0 && (e = 2 * f), isNaN(g) === !0 && (g = parseInt(e / 100, 10)), b.slider({range: "min", min: d, max: e, value: f, step: g}), b.bind("slide", function (b, c) {
                a.ngModel = c.value, a.$apply()
            }), "onSliding"in c && b.bind("slide", function (b, c) {
                a.onSliding()(c.value)
            }), "onChanged"in c && b.bind("slidechange", function (b, c) {
                var d = 2 * c.value;
                d > 100 && $(this).slider("option", "step", d / 100), a.onChanged()(c.value)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plSpinner", ["SPINNER_CONFIGS", function (a) {
        return{scope: {active: "=plSpinner"}, template: '<div class="spinner__wrapper" data-ng-class="{ \'is-active\': active }"></div>', link: function (b, c, d) {
            var e, f = null, g = d.plSpinnerConfig;
            g in a && (f = a[g]), e = new Spinner(f), b.$watch("active", function (a) {
                a === !0 ? e.spin(c.find(".spinner__wrapper").get(0)) : e.stop()
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plStreetview", ["$log", function (a) {
        return{controller: ["$scope", function (b) {
            a.log("Street View controller fn"), b.refresh = function () {
                b.pano.setVisible(!0)
            }
        }], scope: {options: "=plStreetview", refreshTrigger: "="}, link: function (b, c) {
            var d, e, f = new google.maps.StreetViewService;
            d = {zoom: 1}, e = _.merge(d, b.options), b.pano = new google.maps.StreetViewPanorama(c[0], e), b.pano.setVisible(!0), b.$watch("options", function (c) {
                c && c.position && (a.warn("Streetview: Position changed"), b.pano.setPosition(c.position), f.getPanoramaByLocation(c.position, 50, function (a) {
                    if (null !== a) {
                        var d = b.pano.getPov(), e = google.maps.geometry.spherical.computeHeading(a.location.latLng, c.position);
                        d.heading = e, b.pano.setPov(d)
                    }
                }))
            }, !0), b.$watch("refreshTrigger", function (c, d) {
                c !== d && (a.warn("Streetview: Refreshing"), b.refresh())
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plTabset", ["bem", function (a) {
        return{replace: !0, scope: {callback: "=callback", panes: "=plTabset", validator: "=validator"}, transclude: !0, template: '<div class="{{ blockClassNames }}"><ul class="{{ tabNavClassNames }}"><li class="{{ tabNavItemClassNames }}" data-ng-repeat="pane in panes" data-ng-class="{\'is-active\':pane.selected, \'tabs__tab-header--first\': $first, \'tabs__tab-header--middle\': $middle, \'tabs__tab-header--last\': $last}"><a data-ng-click="select(pane)" data-tab-heading-transclude>{{pane.title}} <span>{{pane.subtitle}}</a></li></ul><div class="{{ tabContentPaneWrapperClassNames }}" data-ng-transclude></div></div>', controller: ["$scope", function (a) {
            var b = a.panes = [];
            a.currentPane = null, this.selectAnimate = a.selectAnimate = function (b) {
                $("body").animate({scrollTop: 0}, {duration: 400}), a.select(b)
            }, this.select = a.select = function (c) {
                (angular.isUndefined(a.validator) !== !1 || angular.isUndefined(c.validator) !== !1 || a.validator(c.validator) !== !1) && (angular.forEach(b, function (a) {
                    a.selected = !1
                }), a.currentPane = c, c.selected = !0)
            }, a.$watch("currentPane", function (b, c) {
                b !== c && angular.isUndefined(a.callback) === !1 && a.callback(b.callback)
            }), this.addPane = function (c) {
                0 === b.length && a.select(c), b.push(c)
            }
        }], link: function (b, c, d) {
            var e = "tabs", f = a.getBlockClassNames(e, d.plCssBlockModifier);
            b.blockClassNames = e + " " + f.join(" "), b.tabNavClassNames = a.getElementClassNames(e, f, "tabs__nav").join(" "), b.tabNavItemClassNames = a.getElementClassNames(e, f, "tabs__tab-header").join(" "), b.tabContentPaneWrapperClassNames = a.getElementClassNames(e, f, "tabs__content-panes").join(" ")
        }}
    }]), plentific.app.directive("plTab", ["bem", function (a) {
        return{replace: !0, require: "^plTabset", scope: {title: "@plTabTitle", subtitle: "@plTabSubtitle", callback: "@plTabCallback", validator: "@plTabValidator"}, template: '<div class="{{ paneClassNames }}" data-ng-class="{\'is-active\': selected}" data-tab-content-transclude></div>', transclude: !0, controller: function () {
        }, compile: function (b, c, d) {
            return function (b, c, e, f) {
                b.select = function () {
                    f.selectAnimate(b)
                }, f.addPane(b);
                var g = "tabs", h = a.getBlockClassNames(g, e.plCssBlockModifier);
                b.paneClassNames = a.getElementClassNames(g, h, "tabs__content-pane").join(" "), d(b.$parent, function (a) {
                    var c, d = [];
                    angular.forEach(a, function (a) {
                        a.tagName && (a.hasAttribute("pl-tab-heading") || a.hasAttribute("data-pl-tab-heading") || "pl-tab-heading" === a.tagName.toLowerCase() || "data-pl-tab-heading" === a.tagName.toLowerCase()) ? c = a : d.push(a)
                    }), c && (b.headingElement = angular.element(c)), b.contentElement = angular.element(d)
                })
            }
        }}
    }]), plentific.app.directive("tabHeadingTransclude", [function () {
        return{require: "^plTabset", link: function (a, b) {
            a.$watch("pane.headingElement", function (a) {
                a && (b.html(""), b.append(a))
            })
        }}
    }]), plentific.app.directive("tabContentTransclude", ["$parse", function (a) {
        return{require: "^plTab", link: function (b, c) {
            b.$watch(a("contentElement"), function (a) {
                c.html(""), a.length && c.append(a)
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plTooltipSidebar", [function () {
        return{scope: {content: "@plTooltipSidebarContent"}, replace: !0, templateUrl: "/partials/directives/tooltip/tooltipSidebar.html"}
    }])
}(), function () {
    plentific.app.directive("plTooltipHtmlUnsafe", ["$log", function () {
        return{priority: 1e3, replace: !0, templateUrl: "/partials/directives/tooltip/tooltipHtmlUnsafe.html", transclude: !0, scope: {content: "@plTooltipContent", title: "@plTooltipTitle"}, compile: function (a, b) {
            var c = $(a);
            return b.plTooltipContentUrl ? c.find(".tooltip__body").attr("data-ng-include", b.plTooltipContentUrl) : c.find(".tooltip__body").attr("data-ng-bind-html", "content"), {post: function (a, b, c) {
                function d() {
                    a.shown = !1
                }

                function e() {
                    a.shown = !0
                }

                function f() {
                    a.$apply(function () {
                        e(), g()
                    })
                }

                function g() {
                    var a, b = i.outerHeight(), c = i.outerWidth(), d = i.position(), e = i.offset(), f = j.height(), g = j.width(), h = (j.position(), $(window).width());
                    e.left > h / 2 ? (a = "left", j.css({left: "auto", right: Math.ceil(c), top: -Math.ceil(f / 2) + Math.floor(b / 2)})) : c > g ? (a = "top", j.css({left: -Math.ceil(g / 2), top: -Math.ceil(f + b / 2)})) : (a = "right", j.css({left: d.left + c, top: -Math.ceil(f / 2) + Math.floor(b / 2)})), j.removeClass("tooltip__wrap--on-" + m), m = a, j.addClass("tooltip__wrap--on-" + m)
                }

                function h() {
                    a.$apply(function () {
                        d()
                    })
                }

                var i = b.find(".tooltip__original-text"), j = b.find(".tooltip__wrap"), k = [], l = [], m = null, n = "is-shown", o = "is-hidden";
                a.shown = !1, c.plTooltipActivation ? Array.push.apply(k, c.plTooltipActivation.split("|")) : k.push("mouseenter"), c.plTooltipDeactivation ? Array.push.apply(l, c.plTooltipDeactivation.split("|")) : l.push("mouseleave"), i.on(k.join(" "), f), i.on(l.join(" "), h), a.$watch("shown", function (a, c) {
                    a !== c && (a === !0 ? (b.addClass(n), b.removeClass(o)) : (b.addClass(o), b.removeClass(n)))
                })
            }}
        }}
    }])
}(), function () {
    plentific.app.directive("plUserInfo", ["$state", "$location", function (a, b) {
        return{link: function (a, c) {
            var d = c.find(".app-header__user-menu"), e = "is-open";
            $("body").click(function () {
                c.hasClass(e) && (c.removeClass(e), d.fadeOut("fast").removeClass(e))
            }), c.click(function (a) {
                a.stopPropagation(), d.hasClass(e) || (c.addClass(e), d.fadeIn("fast").addClass(e))
            }), d.find("a").click(function (f) {
                c.removeClass(e), d.fadeOut("fast").removeClass(e);
                var g = $(f.currentTarget);
                return"_self" !== g.attr("target") ? (a.$apply(function () {
                    b.path(g.attr("href"))
                }), !1) : void 0
            })
        }}
    }])
}(), function () {
    plentific.app.directive("plWaterfall", ["UtilsService", function (a) {
        var b, c, d, e, f, g, h = [], i = {type: "", container: null, width: 798, height: 480, graphHeight: 320, graphStartX: 0, graphStartY: 40, graphEndY: 0, minGraphRectHeight: 6, minGraphRectValue: 10, labelFontSize: "12px", labelLineHeight: 12 * 1.4, labelWordWrapping: 2, fontSize: "16px", fontWeight: 600, borderRadius: 2, gutter: 10, axis: {color: "#ccc", width: 1}, colors: {income: {fillColor: "#f0faf1", color: "#86d490", fontColor: "#4abf5a"}, partial: {fillColor: "#fceeee", color: "#faa490", fontColor: "#e25e5b"}, leftover: {fillColor: "#eef7fb", color: "#8ac6e5", fontColor: "#74bade"}, grey: {color: "#fafafa", fontColor: "#aaaaaa"}, red: {color: "#fff0f0", fontcolor: "#aa8888"}, connectorGrey: {opacity: .1, color: "#e8e8e8", fontColor: "#aaaaaa"}}};
        i.graphEndY = i.graphStartY + i.graphHeight;
        var j = function (a, b, c) {
            h = a, i.container = b.get(0), i.type = angular.isUndefined(c.scaleValues) === !1 ? "type2" : "default";
            var d = b.width();
            switch (d > 0 && (i.width = d), k(), i.type) {
                case"type2":
                    m();
                    break;
                default:
                    l()
            }
        }, k = function () {
            f = "type2" === i.type ? i.width / (h.length + .6) : i.width / h.length;
            var a, b = 0, g = 0;
            for (var j in h)"partial" === h[j].category ? b += h[j].value : "income" === h[j].category && (g += h[j].value);
            a = Math.max(b, g), 100 > a && (a = 100), c = d3.scale.linear().domain([0, a]).range([0, i.graphHeight]), d = d3.scale.linear().domain([0, a]).range([0, 100]), e = d3.scale.linear().domain([0, 100]).range([0, a])
        }, l = function () {
            for (var a = 100, b = 0; b < h.length; b++) {
                var c = h[b];
                "income" === c.category && (a -= c.value, c.startY = a, c.height = 1 / 0 === c.value ? 100 : c.value, c.start = f * b, c.width = f - 2 * i.gutter, c.color = i.colors[c.category].color, c.fillColor = i.colors[c.category].fillColor, c.connector = {x: c.start + i.gutter + c.width, y: a})
            }
            a = 0;
            for (var b = 0; b < h.length; b++) {
                var c = h[b];
                "income" !== c.category && (c.startY = a, c.height = 1 / 0 === c.value ? 100 : c.value, c.start = f * b, c.width = f - 2 * i.gutter, c.color = i.colors[c.category].color, c.fillColor = i.colors[c.category].fillColor, ("partial" === c.category || b === h.length - 1) && (1 / 0 === c.value ? a = 100 : a += c.value), c.connector = {x: c.start + i.gutter + c.width, y: a})
            }
            n()
        }, m = function () {
            for (var a = 0, b = 0, c = [], d = [], e = [], j = 0; j < h.length; j++) {
                var k = h[j];
                k.height = 1 / 0 === k.value ? 100 : k.value, j === h.length - 1 && "type2" === i.type ? (k.start = f * (j + .6), g = k.start - .6 * f / 2) : k.start = f * j, k.width = f - 2 * i.gutter, k.color = i.colors[k.category].color, k.fillColor = i.colors[k.category].fillColor
            }
            for (var j in h) {
                var k = h[j];
                "income" === k.category ? k.height < i.minGraphRectValue ? (a += i.minGraphRectHeight - k.height, k.height = i.minGraphRectHeight) : c.push(k) : k.height < i.minGraphRectValue ? (b += i.minGraphRectHeight - k.height, k.height = i.minGraphRectHeight) : "leftover" !== k.category ? d.push(k) : e.push(k), k.height > 90 && h.length > 2 && "leftover" !== k.category && (k.thunder = !0)
            }
            for (var j in c) {
                var l = c[j];
                l.height -= a / c.length
            }
            for (var j in d) {
                var l = d[j];
                l.height -= b / d.length
            }
            for (var m = 100, j = 0; j < h.length; j++) {
                var k = h[j];
                "income" === k.category && (m -= k.height, k.startY = m, k.connector = {x: k.start + i.gutter + k.width, y: m})
            }
            m = 0;
            for (var j = 0; j < h.length; j++) {
                var k = h[j];
                "income" !== k.category && (k.startY = m, "leftover" === k.category && (k.height = 100 - k.startY), ("partial" === k.category || j === h.length - 1) && (m += k.height), k.connector = {x: k.start + i.gutter + k.width, y: m})
            }
            n()
        }, n = function () {
            o(), p(), q(), r()
        }, o = function () {
            $(i.container).html(""), b = d3.select(i.container).append("svg").attr("class", "waterfall").attr("width", i.width).attr("height", i.height);
            var a = b.selectAll(".gridLine").data(h).enter().append("rect");
            a.each(function (a) {
                "leftover" !== a.category && d3.select(this).attr("x", a.start + i.gutter).attr("y", i.graphStartY).attr("width", f - 2 * i.gutter).attr("height", i.graphHeight).attr("fill", i.colors.grey.color)
            }), b.selectAll(".axis").data([0]).enter().append("line").attr("x1", 0).attr("x2", i.width).style("stroke", i.axis.color).style("stroke-width", i.axis.width).attr("y1", i.graphEndY + 5).attr("y2", i.graphEndY + 5), angular.isUndefined(g) === !1 && "type2" === i.type && b.selectAll(".axis").data([0]).enter().append("line").attr("x1", g).attr("x2", g).style("stroke", i.axis.color).style("stroke-width", i.axis.width).attr("y1", i.graphStartY).attr("y2", i.graphEndY + 5)
        }, p = function () {
            var a = b.selectAll(".waterfallRect").data(h).enter().append("rect");
            a.each(function (a) {
                if (a.thunder) {
                    var b = a.start + i.gutter, d = i.graphStartY + c(a.startY), e = b + .5 * a.width, f = b + .25 * a.width, g = b + .75 * a.width, h = d + c(a.height / 4), j = d + c(a.height / 4 + 2), k = d + c(a.height / 4 + 3), l = d + c(a.height / 4 + 5);
                    d3.select(this.parentElement).append("rect").attr("class", "waterfallRect " + a.slug).attr("x", b).attr("y", i.graphStartY + c(a.startY)).attr("width", a.width).attr("fill", a.fillColor).attr("stroke", a.color).style("stroke-width", 1).attr("rx", i.borderRadius).attr("height", c(a.height / 4)), d3.select(this.parentElement).append("rect").attr("class", "waterfallRect " + a.slug).attr("x", a.start + i.gutter).attr("y", i.graphStartY + c(a.startY) + c(a.height / 4 + 5)).attr("width", a.width).attr("fill", a.fillColor).attr("stroke", a.color).style("stroke-width", 1).attr("rx", i.borderRadius).attr("height", c(3 * (a.height / 4) - 5));
                    var m = [
                        {x: e, y: h},
                        {x: f, y: k},
                        {x: e, y: k},
                        {x: f, y: l},
                        {x: e, y: l},
                        {x: g, y: j},
                        {x: e, y: j},
                        {x: g, y: h}
                    ];
                    d3.select(this.parentElement).append("polygon").attr("points", m.map(function (a) {
                        return a.x + "," + a.y
                    }).join(" ")).attr("fill", a.fillColor).attr("stroke", a.color), d3.select(this.parentElement).append("line").attr("x1", e).attr("x2", g).style("stroke", a.fillColor).style("stroke-width", 1).attr("y1", h).attr("y2", h), d3.select(this.parentElement).append("line").attr("x1", f).attr("x2", e).style("stroke", a.fillColor).style("stroke-width", 1).attr("y1", l).attr("y2", l)
                } else d3.select(this).attr("class", "waterfallRect " + a.slug).attr("x", a.start + i.gutter).attr("y", i.graphStartY + c(a.startY)).attr("width", a.width).attr("fill", a.fillColor).attr("stroke", a.color).attr("rx", i.borderRadius).attr("height", c(a.height))
            })
        }, q = function () {
            var a = h.length - 1;
            "type2" === i.type && (a -= 1);
            var d = b.selectAll(".connectors").data(h).enter().append("line");
            d.each(function (b, d) {
                a > d && d3.select(this).attr("x1", b.connector.x).attr("y1", i.graphStartY + c(b.connector.y)).attr("x2", b.connector.x + 2 * i.gutter).attr("y2", i.graphStartY + c(b.connector.y)).attr("stroke-width", 1).attr("stroke", i.colors.connectorGrey.color)
            })
        }, r = function () {
            var d = b.selectAll(".waterfallLabel").data(h).enter().append("g");
            d.append("text").attr("fill", "#666").attr("x",function (a) {
                return a.start + f / 2
            }).attr("y",function (a) {
                return c(a.startY) - i.gutter + i.graphStartY
            }).style("font-size", i.fontSize).style("font-weight", i.fontWeight).style("text-anchor", "middle").text(function (b) {
                return"£" + a.commafy(b.amount)
            }), d.append("text").attr("fill",function (a) {
                return i.colors[a.category].fontColor
            }).attr("x",function (a) {
                return a.start + f / 2
            }).attr("y",function (a) {
                return c(a.startY) + c(a.height) / 2 + i.graphStartY
            }).attr("width", f).style("font-size", i.fontSize).style("font-weight", i.fontWeight).style("dominant-baseline", "central").style("text-anchor", "middle").text(function (a) {
                return Math.round(a.value) + "%"
            }), d.each(function (a) {
                var b = d3.select(this).append("text"), c = a.label.split(" "), d = plentific.CONFIG.STATIC_URL + "images/";
                c.length > 2 && (c = s(c, 2)), d3.select(this).append("svg:image").attr("xlink:href", d + "results-categories/" + a.slug + ".png").attr("x", a.start + f / 2).attr("y", i.graphEndY + 15).attr("width", "42").attr("height", "28").attr("transform", "translate(-21,0)");
                for (var e = 0; e < c.length; e++) {
                    var g = b.append("tspan").attr("fill", "#888").attr("x",function (a) {
                        return a.start + f / 2
                    }).attr("y", i.graphEndY + 60).style("font-size", i.labelFontSize).style("font-weight", i.fontWeight).style("text-anchor", "middle").text(c[e]);
                    e > 0 && g.attr("dy", e * i.labelLineHeight)
                }
            })
        }, s = function (a, b) {
            var c = _.min(a, function (a) {
                return a.length
            }), d = a.indexOf(c);
            if (0 === d || d === a.length - 1)if (0 === d)a[0] = a[0] + " " + a[1], a.splice(1, 1); else {
                var e = a.length;
                a[e - 2] = a[e - 2] + " " + a[e - 1], a.splice(e - 1, 1)
            } else a[d - 1].length <= a[d + 1].length ? a[d - 1] = a[d - 1] + " " + a[d] : a[d + 1] = a[d] + " " + a[d + 1], a.splice(d, 1);
            return a.length > b && (a = s(a, b)), a
        };
        return{link: function (a, b, c) {
            var d;
            a.$on("waterfallDataUpdated", function (a, b) {
                d = b, e()
            });
            var e = _.debounce(function () {
                angular.isUndefined(d) === !1 && j(d, b, c)
            }, 200)
        }}
    }])
}(), plentific.app.filter("duration", ["$log", function () {
    return function (a, b) {
        return moment.duration(a, b).humanize()
    }
}]), plentific.app.filter("fromNow", ["$log", function () {
    return function (a) {
        return moment(a).fromNow()
    }
}]), function () {
    plentific.app.filter("noFractionCurrency", ["$filter", "$locale", function (a, b) {
        var c = a("currency"), d = b.NUMBER_FORMATS;
        return function (a, b, e) {
            var f = c(a, b), g = f.indexOf(d.DECIMAL_SEP);
            return a = a || 0, e = angular.isUndefined(e) ? !1 : "true" === e ? !0 : !1, 0 === a && e ? "n/a" : a >= 0 ? f.substring(0, g) : f.substring(0, g) + ")"
        }
    }])
}(), function () {
    plentific.app.filter("partition", ["$cacheFactory", function (a) {
        var b = a("partition");
        return function (a, c) {
            if (a) {
                for (var d = [], e = 0; e < a.length; e += c)d.push(a.slice(e, e + c));
                var f, g = JSON.stringify(a);
                return f = b.get(g + c), JSON.stringify(f) === JSON.stringify(d) ? f : (b.put(g + c, d), d)
            }
        }
    }])
}(), function () {
    plentific.app.filter("percentage", [function () {
        return function (a, b) {
            b = b || 0;
            var c = (100 * a).toFixed(b) || "";
            return c + "%"
        }
    }])
}(), function () {
    plentific.app.filter("toArray", function () {
        return function (a) {
            return a instanceof Object ? Object.keys(a).map(function (b) {
                return Object.defineProperty(a[b], "$key", {__proto__: null, value: b})
            }) : a
        }
    })
}(), function () {
    plentific.app.factory("AffordabilityUtilService", ["$log", "Restangular", function ($log, Restangular) {
        var _FEES = {mortage_advisor: {label: "Mortgage Advisor fee", value: 495, plusVAT: !1, dynamic: !1}, conveyancing: {label: "Solicitor fee", value: 594, plusVAT: !0, dynamic: !0}, survey: {label: "Survey fee", value: 660, plusVAT: !0, dynamic: !1}, lender: {label: "Lender fees", value: 1e3, plusVAT: !1, dynamic: !1}, localAuthoritySearches: {label: "Local authority searches", value: 270, plusVAT: !1, dynamic: !1}, landRegistry: {label: "Land registry fee", value: 270, plusVAT: !1, dynamic: !0}, moneyTransfer: {label: "Money transfer fees", value: 25, plusVAT: !1, dynamic: !1}, other: {label: "Other fees", value: 0, plusVAT: !1, dynamic: !1}}, _STAMP_DUTY_BRACKETS = [125e3, 25e4, 5e5, 1e6, 2e6], _LTV_LIMIT = .9, _MAX_LOAN_MULTIPLE = 4.25, _MAX_MORTGAGE_INCOME_RATIO = .35, _MAX_MORTGAGE_DISPOSABLE_INCOME_RATIO = .75, _MAX_ITERATIONS = 5e3, _MAX_ITERATIONS_INNER = 5, _MORTGAGE_RATE = 2.75, _MORTGAGE_TERM = 30, _stampDuty = function (a) {
            return a > 125e3 && 25e4 >= a ? .01 : a > 25e4 && 5e5 >= a ? .03 : a > 5e5 && 1e6 >= a ? .04 : a > 1e6 && 2e6 >= a ? .05 : a > 2e6 ? .07 : 0
        }, _landRegistry = function (a) {
            return 5e4 >= a ? 40 : 8e4 >= a ? 70 : 1e5 >= a ? 120 : 2e5 >= a ? 190 : 5e5 >= a ? 270 : 5e5 >= a ? 540 : 910
        }, _legalFees = function (a) {
            return isNaN(a) === !1 && a > 0 ? 25e4 >= a ? 594 : 5e5 >= a ? 810 : 1e6 >= a ? 954 : 15e5 >= a ? 1194 : 1554 : 0
        }, _pmt = function (a, b, c) {
            return a * c * Math.pow(1 + a, b) / (1 - Math.pow(1 + a, b))
        }, _ipmt = function (a, b, c, d) {
            var e = Math.pow(1 + c, d);
            return 0 - (a * e * c + b * (e - 1))
        }, _ppmt = function (a, b, c, d) {
            if (1 > b || b >= c + 1)return null;
            var e = Math.abs(_pmt(a, c, d)), f = Math.abs(_ipmt(d, e, a, b - 1));
            return e - f
        }, _EFFECT = function (a, b) {
            return isNaN(a) || isNaN(b) ? "#VALUE!" : 0 >= a || 1 > b ? "#NUM!" : (b = parseInt(b, 10), Math.pow(1 + a / b, b) - 1)
        }, _FV = function (rate, periods, payment, value, type) {
            type = "undefined" == typeof type ? 0 : type, rate = eval(rate);
            var result;
            if (0 === rate)result = value + payment * periods; else {
                var term = Math.pow(1 + rate, periods);
                result = 1 === type ? value * term + payment * (1 + rate) * (term - 1) / rate : value * term + payment * (term - 1) / rate
            }
            return-result
        }, _PMT = function (rate, periods, present, future, type) {
            type = "undefined" == typeof type ? 0 : type, rate = eval(rate), periods = eval(periods);
            var result;
            if (0 === rate)result = (present + future) / periods; else {
                var term = Math.pow(1 + rate, periods);
                result = 1 === type ? (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate) : future * rate / (term - 1) + present * rate / (1 - 1 / term)
            }
            return-result
        }, _PPMT = function (a, b, c, d, e, f) {
            return _PMT(a, c, d, e, f) - _IPMT(a, b, c, d, e, f)
        }, _IPMT = function (rate, period, periods, present, future, type) {
            type = "undefined" == typeof type ? 0 : type, rate = eval(rate), periods = eval(periods);
            var payment = _PMT(rate, periods, present, future, type), interest;
            return interest = 1 === period ? 1 === type ? 0 : -present : 1 === type ? _FV(rate, period - 2, payment, present, 1) - payment : _FV(rate, period - 1, payment, present, 0), interest * rate
        }, _maxHousePrice = function (a, b, c, d, e, f, g, h, i) {
            angular.isString(f) && (f = parseFloat(f));
            var j = null;
            g && (j = g);
            var k = a - e, l = !1;
            f || 0 === f ? l = !0 : f = _.min([_MAX_LOAN_MULTIPLE * b, k * _LTV_LIMIT / (1 - _LTV_LIMIT)]);
            for (var m = function (a) {
                return 25e4 !== a ? .01 : .02
            }, n = f + k, o = _MAX_MORTGAGE_INCOME_RATIO + 1, p = _MAX_MORTGAGE_DISPOSABLE_INCOME_RATIO + 1, q = 0, r = 0, s = 0, t = f / n, u = [], v = 0, w = 0, x = 0; _MAX_ITERATIONS > x; x++) {
                r = 10;
                for (var y = 0; _MAX_ITERATIONS > y; y++) {
                    if (u = [], angular.forEach(_STAMP_DUTY_BRACKETS, function (a) {
                        u.push(Math.abs(n - a))
                    }), v = _STAMP_DUTY_BRACKETS[_.indexOf(u, _.min(u))], w = m(v), y > _MAX_ITERATIONS_INNER && Math.abs(Math.round(r)) >= w * n) {
                        n = v, k = n - f, r = a - (k - _stampDuty(n) * n - e), t = f / n;
                        break
                    }
                    if (n += r, k = n - f, q = r, r = a - (k + _stampDuty(n) * n + e), t = f / n, Math.abs(r) < .001 || y > _MAX_ITERATIONS)break
                }
                if (g || (j = _getMortgageRate(t, i)), s = _PMT(j / 12, 12 * h, -f, 0, 0), o = c ? Math.abs(s) / c : 0, p = d ? Math.abs(s) / d : 0, !(o > _MAX_MORTGAGE_INCOME_RATIO || p > _MAX_MORTGAGE_DISPOSABLE_INCOME_RATIO || t > _LTV_LIMIT)) {
                    u = [], angular.forEach(_STAMP_DUTY_BRACKETS, function (a) {
                        u.push(Math.abs(n - a))
                    }), v = _STAMP_DUTY_BRACKETS[_.indexOf(u, _.min(u))];
                    var z = n - v;
                    w = m(v), z > 0 && w * n >= z && (n = v, k = n - f, r = a - k - _stampDuty(n) * n - e, t = f / n);
                    break
                }
                if (l)break;
                f = .995 * f, x >= _MAX_ITERATIONS - 1 && $log.log("Max i count reached")
            }
            var A = {price: Math.round(n), loanSize: f, deposit: k, excessCash: r, mortgageIncomeRatio: o, mortgageDisposableIncomeRatio: p, mortgagePayment: Math.abs(s), ltv: t, stampDuty: _stampDuty(n) * n, stampDutyPercentage: _stampDuty(n), fees: e, mortgageTerm: h, mortgageRate: j, incomeMultiple: b ? f / b : 0};
            return A
        }, _incomeMultipleIndicator = function (a) {
            return 5.5 >= a && a > 4.25 ? "amber" : 4.25 >= a && a >= 0 ? "green" : "red"
        }, _incomeIndicator = function (a) {
            return.5 >= a && a > .35 ? "amber" : .35 >= a && a >= 0 ? "green" : "red"
        }, _disposableIncomeIndicator = function (a) {
            return.75 >= a && a >= 0 ? "green" : "red"
        }, _getMortgageRate = function (a, b) {
            if (b) {
                var c = 100 * a, d = [], e = _.pluck(b, "loanToValue");
                _.forEach(e, function (a) {
                    0 > a - c ? d.push(void 0) : d.push(a - c)
                });
                var f = _.indexOf(d, _.min(d)), g = null;
                return g = -1 === f ? b[_.indexOf(e, _.max(e))] : b[f], g.twoYearFixed / 100
            }
            return 0
        }, _getMortgageRates = function () {
            return Restangular.all("mortgages").getList()
        }, _totalDefaultFees = function () {
            var a = _.reduce(_.pluck(_FEES, "value"), function (a, b) {
                return a + b
            });
            return a
        }, _totalIncome = function (a) {
            var b = _.reduce(_.pluck(a, "netMonthlyIncome"), function (a, b) {
                return a + b
            });
            return b
        }, _totalGrossAnnualIncome = function (a) {
            var b = _.reduce(_.pluck(a, "grossAnnualIncome"), function (a, b) {
                return a + b
            });
            return b
        }, _totalGrossAnnualBonus = function (a) {
            var b = _.reduce(_.pluck(a, "grossAnnualBonus"), function (a, b) {
                return a + b
            });
            return b
        }, _getTotalOtherFees = function (a) {
            var b = _.reduce(_.pluck(a, "value"), function (a, b) {
                return a + b
            });
            return b
        };
        return{MORTGAGE_RATE: _MORTGAGE_RATE, MORTGAGE_TERM: _MORTGAGE_TERM, MAX_LOAN_MULTIPLE: _MAX_LOAN_MULTIPLE, defaultFees: _FEES, getMortgageRate: _getMortgageRate, getMortgageRates: _getMortgageRates, incomeIndicator: _incomeIndicator, disposableIncomeIndicator: _disposableIncomeIndicator, incomeMultipleIndicator: _incomeMultipleIndicator, maxHousePrice: _maxHousePrice, pmt: _pmt, FV: _FV, EFFECT: _EFFECT, PMT: _PMT, IPMT: _IPMT, PPMT: _PPMT, stampDuty: _stampDuty, landRegistry: _landRegistry, legalFees: _legalFees, totalDefaultFees: _totalDefaultFees, totalIncome: _totalIncome, totalGrossAnnualIncome: _totalGrossAnnualIncome, totalGrossAnnualBonus: _totalGrossAnnualBonus, getTotalOtherFees: _getTotalOtherFees}
    }])
}(), function () {
    plentific.app.factory("AnalyticsService", ["$analytics", function (a) {
        var b = {}, c = [], d = null;
        return b.trackPage = function (b) {
            b !== d && (a.pageTrack(b), d = b, c.push(b))
        }, b.trackEvent = function () {
            a.eventTrack(arguments)
        }, b
    }])
}(), function () {
    plentific.app.factory("BudgetCalculatorService", ["$log", "Restangular", function () {
        var a = [], b = [], c = function (a) {
            if (a.frequency) {
                var b;
                switch (a.frequency) {
                    case"daily":
                        b = 365 * parseInt(a.amount, 10) / 12 || 0;
                        break;
                    case"weekly":
                        b = 52 * parseInt(a.amount, 10) / 12 || 0;
                        break;
                    case"quarterly":
                        b = parseInt(a.amount, 10) / 4 || 0;
                        break;
                    case"yearly":
                        b = parseInt(a.amount, 10) / 12 || 0;
                        break;
                    default:
                        b = parseInt(a.amount, 10) || 0
                }
                return a.tax ? Math.round($scope.netAnnualIncome(12 * b, a.tax) / 12) : Math.round(b)
            }
            return!1
        }, d = function () {
            var b = 0;
            return angular.forEach(a, function (a) {
                b += c(a)
            }), b
        }, e = ["mortgage-payment", "mortgage-other", "mortgage-insurance", "rent"], f = function () {
            var a = 0;
            return angular.forEach(b, function (b) {
                b.ongoing !== !0 && e.indexOf(b.slug) > -1 || (a += c(b))
            }), a
        };
        return{monthlyAmount: c, getTotalMonthlyIncome: d, getTotalMonthlyExpense: f, getIncomes: function () {
            return a
        }, setIncomes: function (b) {
            a = b
        }, getExpenses: function () {
            return b
        }, setExpenses: function (a) {
            b = a
        }}
    }])
}(), function () {
    plentific.app.factory("CaseService", ["Restangular", "AffordabilityUtilService", function (a, b) {
        var c = [], d = null, e = {id: null, userId: null, firstName: "", lastName: "", grossAnnualIncome: 0, grossAnnualBonus: 0, grossAnnualIncomeIncludingBonus: 0, netMonthlyIncome: 0, employmentStatus: "employed", age: null}, f = function () {
            return e
        }, g = function (b) {
            return a.one("cases", b).all("applicants").post(e)
        }, h = function () {
            return l(d)
        }, i = function () {
            return d
        }, j = function (b) {
            return a.one("cases", b).getList("applicants")
        }, k = function (b) {
            return a.one("cases", b).getList("assets")
        }, l = function (b) {
            var c = a.one("cases", b).get();
            return c.then(function (a) {
                w(a.fees)
            }), c
        }, m = function (b) {
            return a.one("cases", b).getList("expenses")
        }, n = {landRegistry: b.landRegistry, conveyancing: b.legalFees}, o = function (a) {
            return angular.forEach(c, function (b, d) {
                b.dynamic && (c[d].value = n[d](a)), b.plusVAT && (c[d].fakeValue = c[d].value / 1.2)
            }), c
        }, p = function (b) {
            return a.one("cases", b).getList("incomes")
        }, q = function (b) {
            return a.one("cases", b).getList("liabilities")
        }, r = function (b) {
            return a.one("cases", b).getList("milestones")
        }, s = function (b, c, d, e) {
            var f = a.one("cases", b).one("milestones", c).one("items", d);
            f.completed = e, f.put()
        }, t = function (b, c) {
            return a.one("cases", b).one("applicants", c).remove()
        }, u = function (a) {
            d = a
        }, v = function (b, c) {
            var d = a.restangularizeElement(b, b.applicants[c], "applicants");
            return d.put()
        }, w = function (a) {
            c = a
        };
        return u(plentific.bootstrappedUser.cases[0]), {addApplicant: g, getApplicants: j, getAssets: k, getCase: l, getActiveCase: h, getActiveCaseId: i, getExpenses: m, getFees: o, getIncomes: p, getLiabilities: q, getMilestoneOverview: r, getDefaultApplicantData: f, removeApplicant: t, saveApplicant: v, setActiveCaseId: u, setFees: w, setMilestoneItem: s}
    }])
}(), function () {
    plentific.app.factory("DataSavedService", [function () {
        var a = {saved: !0}, b = function (a, b, c) {
            if (b)for (var d in a)if (_.contains(c, d) && a[d] !== b[d])return!0;
            return!1
        }, c = function (b) {
            a.saved = b
        }, d = function () {
            return a.saved
        };
        return{checkDirty: b, setDataSaved: c, getDataSaved: d, data: a}
    }])
}(), function () {
    plentific.app.factory("DialogService", ["$dialog", function (a) {
        var b = {backdrop: !0, keyboard: !0, backdropClick: !0}, c = {login: {options: {templateUrl: "/partials/views/auth/login.html", controller: "AuthController"}}, signup: {options: {templateUrl: "/partials/views/auth/signup.html", controller: "AuthController"}}, passwordReset: {options: {templateUrl: "/partials/views/auth/passwordReset.html", controller: "AuthController"}}, mortgageAdvisor: {options: {templateUrl: "/partials/popups/dialog-mortgage.html", controller: "ContactDialogController"}}, solicitor: {options: {templateUrl: "/partials/popups/dialog-legal.html", controller: "ContactDialogController"}}, propertyCoach: {options: {templateUrl: "/partials/popups/dialog-property-coach.html", controller: "ContactDialogController"}}, propertyCoachOrientation: {options: {templateUrl: "/partials/popups/dialog-property-coach-orientation.html", controller: "ContactDialogController"}}, propertyCoachUnlimited: {options: {templateUrl: "/partials/popups/dialog-property-coach-unlimited.html", controller: "ContactDialogController"}}}, d = {}, e = function (a) {
            return d[a]
        }, f = function (c, e) {
            return d[c] = a.dialog(angular.extend({}, b, e)), d[c]
        }, g = function (a, b) {
            return angular.extend(a.options, b), a.options
        }, h = function () {
            angular.forEach(c, function (a, b) {
                f(b, a.options)
            })
        };
        return h(), {getDialog: e, addDialog: f, setDialogOptions: g}
    }])
}(), function () {
    plentific.app.factory("EmailService", ["$log", "$http", "PLENTIFIC_API_BASE", function (a, b, c) {
        var d = c + "email/", e = function (c, e) {
            var f, g, h;
            return f = function () {
                a.log("Email queued successfully")
            }, g = function (b) {
                a.log("Email queuing failed with reason:"), a.log(b.data)
            }, h = b.post(d, {type: c, data: e}), h.then(f, g), h
        };
        return{sendMessage: e}
    }])
}(), function () {
    plentific.app.factory("FavouritesService", ["$rootScope", "CaseService", "Restangular", function (a, b, c) {
        function d(b, d, e) {
            function f(a) {
                d.isFavourite = a.isFavourite, e ? (g.splice(0, 0, d), g.meta.count = g.meta.count + 1) : (angular.forEach(g, function (a, b) {
                    return a.listing_id === d.listing_id ? (g.splice(b, 1), !1) : void 0
                }), g.meta.count = g.meta.count - 1)
            }

            function h() {
                d.isFavourite = i
            }

            var i = d.isFavourite;
            return d.isFavourite = e, a.$broadcast("property:favouriteStateChange", d), c.one("cases", b).all("favourites").post({zooplaId: d.listing_id, isFavourite: e}).then(f, h)
        }

        function e(a, b) {
            return c.one("cases", a).getList("favourites", {page: b})
        }

        function f(a, b) {
            return angular.isUndefined(b) && (b = g.meta ? g.meta.page : 1), e(a, b).then(function (a) {
                g.meta = a._meta, angular.forEach(a, function (a) {
                    var b = _.find(g, {listing_id: a.listing_id});
                    angular.isUndefined(b) && g.push(a)
                })
            })
        }

        var g = [];
        return{fetch: f, setFavourite: d, favourites: g}
    }])
}(), function () {
    plentific.app.service("GoogleDirectionsApiService", ["$log", "$q", "$rootScope", function (a, b, c) {
        function d(d) {
            var f = d, g = b.defer();
            return a.log("Performing directions search"), e.route(f, function (b, d) {
                c.$apply(function () {
                    d == google.maps.DirectionsStatus.OK ? (a.log("Distance Matrix Data Retrieved", b), g.resolve(b)) : google.maps.DirectionsStatus.NOT_FOUND ? g.reject("NOT_FOUND") : google.maps.DirectionsStatus.ZERO_RESULTS ? g.reject("ZERO_RESULTS") : google.maps.DirectionsStatus.MAX_WAYPOINTS_EXCEEDED ? g.reject("MAX_WAYPOINTS_EXCEEDED") : google.maps.DirectionsStatus.INVALID_REQUEST ? g.reject("INVALID_REQUEST") : google.maps.DirectionsStatus.OVER_QUERY_LIMIT ? g.reject("OVER_QUERY_LIMIT") : google.maps.DirectionsStatus.REQUEST_DENIED ? g.reject("REQUEST_DENIED") : g.reject("UNKNOWN_ERROR")
                })
            }), g.promise
        }

        var e = new google.maps.DirectionsService;
        return{getDirections: d}
    }])
}(), function () {
    plentific.app.service("GoogleDistanceMatrixApiService", ["$log", "$q", "$rootScope", function (a, b, c) {
        function d(d) {
            var f = d, g = b.defer();
            return a.log("Performing distance matrix search"), e.getDistanceMatrix(f, function (b, d) {
                c.$apply(function () {
                    d == google.maps.DistanceMatrixStatus.OK ? (a.log("Distance Matrix Data Retrieved", b), g.resolve(b)) : google.maps.DistanceMatrixStatus.INVALID_REQUEST ? g.reject("INVALID_REQUEST") : google.maps.DistanceMatrixStatus.MAX_DIMENSIONS_EXCEEDED ? g.reject("MAX_DIMENSIONS_EXCEEDED") : google.maps.DistanceMatrixStatus.OVER_QUERY_LIMIT ? g.reject("OVER_QUERY_LIMIT") : google.maps.DistanceMatrixStatus.REQUEST_DENIED ? g.reject("REQUEST_DENIED") : g.reject("UNKNOWN_ERROR")
                })
            }), g.promise
        }

        var e = new google.maps.DistanceMatrixService;
        return{getDistanceMatrix: d}
    }])
}(), function () {
    plentific.app.service("GoogleMapService", [function () {
        function a(a, b, c) {
            var f, g = {};
            return _.merge(g, c, d), f = new google.maps.Map(b[0], g), e[a] = f, f
        }

        function b(a) {
            var b = e[a];
            if (angular.isUndefined(b))throw new Error('Cannot release map. Map "' + a + '" does not exist');
            google.maps.event.clearInstanceListeners(b), delete e[a]
        }

        function c(a) {
            if (angular.isUndefined(e[a]))throw{type: "MAP_NOT_FOUND", name: "Map not found error", message: 'Map "' + a + '" does not exist', toString: function () {
                return this.name + ": " + this.message
            }};
            return e[a]
        }

        var d = {center: new google.maps.LatLng(51.51402795487032, -.1507094999999481), mapTypeId: google.maps.MapTypeId.ROADMAP, panControl: !1, zoomControlOptions: {style: google.maps.ZoomControlStyle.SMALL}, zoom: 15}, e = {};
        return{createMap: a, getMap: c, releaseMap: b}
    }])
}(), function () {
    plentific.app.service("GooglePlacesApiService", ["$log", "$q", function (a, b) {
        function c(c) {
            function e(a) {
                _.forEach(a, function (a) {
                    a.__plentific = {distance: null}, a.__plentific.distance = google.maps.geometry.spherical.computeDistanceBetween(c.location, a.geometry.location)
                })
            }

            var f = c, g = b.defer();
            return a.log("Performing nearby place search for place", c), d.nearbySearch(f, function (b, c) {
                c == google.maps.places.PlacesServiceStatus.OK ? (e(b), a.log("Place search results", b), g.resolve(b)) : google.maps.places.PlacesServiceStatus.ZERO_RESULTS ? (a.log("No place search results"), g.reject("No results")) : g.reject()
            }), g.promise
        }

        var d = new google.maps.places.PlacesService(document.createElement("div"));
        return{nearbySearch: c}
    }])
}(), function () {
    plentific.app.factory("InfiniteLoadingPaginator", ["$log", "$timeout", function (a, b) {
        return function (c, d) {
            function e() {
                var c, d, e = [], f = m(), g = f * x.pageSize, h = Math.min(B - g, x.hardLimit - g), i = Math.ceil(h / x.pageSize);
                if (!(B <= x.pageSize || 0 >= h)) {
                    c = h <= x.pageSize ? h : h - x.pageSize * (i - 1);
                    for (var j = 0; i > j; j++)j !== i - 1 ? e.push(new Array(x.pageSize)) : e.push(new Array(c));
                    d = new Array((i - 1) * x.pageSize + c), d.unshift(E.length, 0), Array.prototype.splice.apply(E, d), angular.forEach(e, function (c, d) {
                        b(function () {
                            a.warn("Fetching autoload " + d), t(d + 1, !0)
                        }, (d + 1) * x.autoloadDelay)
                    })
                }
            }

            function f(a) {
                return 0 === a ? 0 : Math.ceil(a / x.pageSize) - 1
            }

            function g(a, b) {
                Array.prototype.splice.apply(E, [b, a.length].concat(a))
            }

            function h(b, c) {
                var d = c.items;
                if (d.length, a.warn("onInitialPageLoaded", b, c), B = c.totalItems, C = Math.ceil(_.min([c.totalItems, x.hardLimit]) / x.pageSize), g(d, 0), x.autoloadPages === !0) {
                    if (c.totalItems <= x.pageSize)return;
                    e()
                }
            }

            function i(b, c) {
                var d = c.items;
                d.length, a.warn("onSubsequentPageLoaded", b, c), g(d, b.offset)
            }

            function j() {
                return z.length
            }

            function k() {
                return x.pageSize
            }

            function l(a, b, d, e) {
                var g = f(a);
                return A.push(g), c(a, b, function (c, f) {
                    var h, i = {autoloaded: e, limit: b, offset: a}, j = {items: c, totalItems: f};
                    h = _.findIndex(A, function (a) {
                        return a === g
                    }), A.splice(h, 1), z.push(g), D += c.length, d(i, j)
                })
            }

            function m() {
                var a = null, b = -1, c = -1;
                return z.length > 0 && (b = _.max(z)), A.length > 0 && (c = _.max(A)), a = _.max([b, c]), -1 === a ? 0 : a + 1
            }

            function n() {
                return D
            }

            function o() {
                return z.length < C
            }

            function p(a) {
                return _.contains(z, a)
            }

            function q(a) {
                return _.contains(A, a)
            }

            function r() {
                return y = t(m())
            }

            function s() {
                if (!_.contains(z), 0 || !_.contains(A, 0))throw new Error("InfiniteLoadingPaginator: Cannot load next page, the initial page must be loaded first.");
                y.then(function () {
                    if (o())return t(m());
                    throw"No more pages to load"
                })
            }

            function t(a, b) {
                var c = b === !0 ? !0 : !1, d = a * x.pageSize, e = 0 === a, f = e ? h : i;
                if (p(a) || q(a))throw new Error("Cannot load page " + a + " - It has already been loaded");
                return l(d, x.pageSize, f, c)
            }

            function u() {
                y = null, B = null, C = null, D = 0, z.length = 0, A.length = 0, E.length = 0
            }

            function v() {
                return null !== B ? B <= x.hardLimit ? !1 : !0 : null
            }

            var w, x, y = null, z = [], A = [], B = null, C = null, D = 0, E = [];
            if (!_.isFunction(c))throw new Error("No fetchFunction provided");
            return w = {autoloadDelay: 200, hardLimit: 500, pageSize: 100, autoloadPages: !0, numAdditionalPagesToAutoload: 4}, x = _.merge({}, w, d), {hasMorePages: o, willContainAllAvailableResults: v, getNumPagesLoaded: j, getNextPageNumber: m, getPageSize: k, getTotalResultsLoaded: n, loadInitialPage: r, loadNextPage: s, reset: u, results: E}
        }
    }])
}(), function () {
    plentific.app.factory("NetWorthCalculatorService", ["$log", "Restangular", function () {
        var a = [], b = [], c = [
            {title: "Cash / current accounts", slug: "cash-current-accounts", chartTitle: "Cash / current accounts"},
            {title: "Savings accounts", slug: "savings-accounts", chartTitle: "Savings accounts"},
            {title: "ISA accounts", slug: "isa-accounts", chartTitle: "ISA accounts"},
            {title: "Investment funds", slug: "investment-funds", chartTitle: "Investment funds"},
            {title: "Stocks and bonds", slug: "stocks-and-bonds", chartTitle: "Stocks and bonds"},
            {title: "Property", slug: "property", chartTitle: "Property equity"},
            {title: "Pension funds", slug: "pension-funds", chartTitle: "Pension funds"}
        ], d = function (a, b) {
            return!b && "available" === a.availability || b ? null !== a.owed ? parseFloat(a.amount) - parseFloat(a.owed) : parseFloat(a.amount) || 0 : 0
        }, e = function (b, c) {
            var e = 0, f = _.where(a, {categorySlug: b});
            return _.forEach(f, function (a) {
                e += d(a, c)
            }), e
        }, f = function () {
            var b = 0, c = 0;
            return _.forEach(a, function (a) {
                ("cash-current-accounts" === a.categorySlug || "savings-accounts" === a.categorySlug) && (c += d(a, !0)), b += d(a, !0)
            }), {runningTotal: b, runningCashAndSavings: c}
        }, g = function () {
            var a = 0;
            return _.forEach(b, function (b) {
                a += parseInt(b.amount, 10) || 0
            }), a
        }, h = function () {
            return f().runningTotal - g()
        }, i = function () {
            var b = 0;
            return angular.forEach(a, function (a) {
                "available" === a.availability && (b += null !== a.owed ? a.amount - a.owed : a.amount)
            }), b
        }, j = function (a, b) {
            return i() - a - b
        };
        return{assetStructure: c, setAssets: function (b) {
            return a = b
        }, getAssets: function () {
            return a
        }, setLiabilities: function (a) {
            return b = a
        }, getLiabilities: function () {
            return b
        }, assetTotal: d, assetsTotal: f, assetTotalByCategory: e, liabilitiesTotal: g, netWorth: h, getAccesibleFunds: i, getAvailableFundForHouse: j}
    }])
}(), function () {
    plentific.app.factory("PostcodeService", [function () {
        var a = /^(GIR ?0AA|[A-PR-UWYZ]([0-9]{1,2}|([A-HK-Y][0-9]([0-9ABEHMNPRV-Y])?)|[0-9][A-HJKPS-UW]) ?[0-9][ABD-HJLNP-UW-Z]{2})$/i, b = function (b) {
            return b.toUpperCase().match(a)
        };
        return{isValidPostcode: b}
    }])
}(), function () {
    plentific.app.service("PropertyComparisonService", ["$log", "Restangular", "ZooplaApiService", function (a, b, c) {
        function d() {
            j = []
        }

        function e(a) {
            var b = _.find(j, function (b) {
                return b ? a === b.id : !1
            });
            return"undefined" == typeof b ? !1 : !0
        }

        function f(a) {
            var b = _.findIndex(j, function (b) {
                return null !== b ? b.id === a : !1
            });
            return b
        }

        function g(a) {
            return j[a]
        }

        function h() {
            var a = _.indexOf(j, null);
            return-1 === a ? 1 : a
        }

        function i(a, b) {
            return null === b ? j[a] = null : (j[a] = {id: b, data: null}, j[a].data = c.getProperty(b)), j[a]
        }

        var j = [];
        return{clearAllProperties: d, findCompareIndex: f, getFirstNullIndex: h, getPropertyToCompare: g, isPropertyInCompare: e, setPropertyToCompare: i}
    }])
}(), function () {
    plentific.app.service("TransportApiService", ["$http", "$log", "$q", "$rootScope", "$window", function (a, b, c, d, e) {
        function f(b) {
            var d = e.plentific.CONFIG.API_BASE + "nearest-stations/", f = c.defer(), g = null, h = f.promise;
            return g = a.get(d, {params: b}), g.success(function (a) {
                f.resolve(_.uniq(a, function (a) {
                    return a.station_code
                }))
            }), h
        }

        return{getNearbyStations: f}
    }])
}(), function () {
    plentific.app.service("UnitConverterService", ["$log", function () {
        function a(a) {
            return a * g
        }

        function b(a) {
            return a * e
        }

        function c(a) {
            return a / f
        }

        function d(a) {
            return a * f
        }

        var e = .000621371192, f = 60, g = .09290304;
        return{area: {sqFtToSqM: a}, length: {metersToMiles: b}, time: {hoursToMins: d, minsToHours: c}}
    }])
}(), function () {
    plentific.app.factory("UserService", ["Restangular", "$http", "$rootScope", function (a, b, c) {
        var d = {user: {}}, e = function (a) {
            d.user = a, null !== d.user.birthday && "" !== d.user.birthday && (d.user.birthday = new Date(d.user.birthday))
        }, f = function (b) {
            var c = a.all("user").post(b);
            return c.then(function (a) {
                d.user = a
            }), c
        }, g = function (b) {
            var c = a.all("login").post(b);
            return c.then(function (a) {
                d.user = a
            }), c
        }, h = function (a) {
            var e, f = new FormData, g = {withCredentials: !0, transformRequest: angular.identity, headers: {"Content-Type": void 0}};
            return f.append("avatar", a), e = b.put(plentific.CONFIG.API_BASE + "user/avatar/", f, g).success(function (a) {
                d.user.avatar = a.avatar, c.$broadcast("avatarUpdated", a.avatar_30)
            })
        }, i = function (b, c, f) {
            var g = a.one(c, null);
            angular.isUndefined(f) && (f = "put"), angular.extend(g, b), delete g.id;
            var h = g[f]();
            return h.then(function (a) {
                a && a.originalResponse && e(angular.extend(d.user, a.originalResponse))
            }), h
        }, j = function (a) {
            return angular.isDate(a.birthday) && (a.birthday = a.birthday.toISOString().split("T")[0]), i(a, "user")
        }, k = function (a) {
            return i(a, "user/email")
        }, l = function (a) {
            return i(a, "user/password")
        }, m = function (a) {
            return i(a, "user/deactivate")
        }, n = function (a) {
            return i(a, "password", "post")
        };
        return e(plentific.bootstrappedUser), {userData: d, setUser: e, createUser: f, logIn: g, uploadImage: h, updateUser: j, updateEmail: k, updatePassword: l, deactivateAccount: m, resetPassword: n}
    }])
}(), function () {
    plentific.app.service("UtilsService", [function () {
        var a = function (b, c) {
            if (void 0 === c && (c = 99999), b >= c)return a((b / 1e3).toFixed(0)) + "k";
            var d = b.toString().replace(/[,]/g, "").split(".");
            return d[0].length >= 4 && (d[0] = d[0].replace(/(\d)(?=(\d{3})+$)/g, "$1,")), b = d[0]
        }, b = function (a) {
            return 1 / 0 === a ? 0 : a
        };
        return{commafy: a, zeroIfInfinity: b}
    }])
}(), function () {
    plentific.app.service("ZooplaApiService", ["$log", "$http", "$q", "$cacheFactory", "PLENTIFIC_API_BASE", "Restangular", function (a, b, c, d, e, f) {
        function g(a) {
            var b, c, d;
            return b = {listing_status: "sale", method: "property_listings"}, c = _.merge(b, a), d = f.all("zoopla").getList(c), d.then(function (a) {
                angular.isUndefined(a.listing) === !1 && angular.forEach(a.listing, function (a) {
                    l.put(a.listing_id, a)
                })
            }), d
        }

        function h(a) {
            if (l.get(a)) {
                var b = c.defer();
                return b.resolve(l.get(a)), b.promise
            }
            var d = f.one("properties", a).get();
            return d.then(function (a) {
                l.put(a.listing_id, a)
            }), d
        }

        function i(a) {
            var b = f.restangularizeElement(a, a.customFields, "custom");
            return b.put()
        }

        function j(a) {
            function c(b) {
                var c = b.data, d = /( \[)(.|\n)*(\])/i, e = c.suggestions;
                return c.original_query = a, c.suggestions = [], angular.forEach(e, function (a) {
                    var b, e, f;
                    a.value.match(d) ? (f = a.value.split(" ["), e = f[0], b = f[1].split("]")[0], c.suggestions.push({code: e, displayValue: e, area: b, type: "postcode", value: a.value})) : c.suggestions.push({displayValue: a.value, identifier: a.identifier, type: "place/area", value: a.value})
                }), b
            }

            var d;
            return a ? (d = a.toLowerCase(), b.get(k, {params: {search_term: d, search_type: "listings", method: "geo_autocomplete"}}).then(c)) : null
        }

        var k = e + "zoopla/", l = d("propertyList");
        return{getProperty: h, getPropertyList: g, getSearchSuggestions: j, savePropertyData: i}
    }])
}(), function () {
    plentific.app.service("ZooplaPropertyImagesService", ["$log", "ZOOPLA_PROPERTY_IMAGE_TYPE_MAIN", "ZOOPLA_PROPERTY_IMAGE_TYPE_ADDITIONAL", function (a, b, c) {
        function d(a, b, c) {
            var d = null;
            if (d = h[c], !d)throw new Error("Unknown size request for image " + a + '. \nSupported sizes are "LARGE", "THUMB", "ORIGINAL"');
            return null === d ? i + "/" + a + "." + b : i + "/" + a + "_" + d.width + "_" + d.height + "." + b
        }

        function e() {
            return new k
        }

        function f(a) {
            var d = new k;
            return a.image_url && d.addImage(a.image_url, b), 0 !== a.other_image.length && _.each(a.other_image, function (a) {
                d.addImage(a.url, c)
            }), d
        }

        function g(a) {
            if (!a)return null;
            var b = a.split("/")[3], c = b.split(".")[1], d = b.split("_")[0];
            return{extension: c, filename: d}
        }

        var h = {LARGE: {height: 255, width: 354}, ORIGINAL: null, THUMB: {height: 113, width: 150}, UNDOCUMENTED_LARGE: {height: 430, width: 645}}, i = "https://d123ehp5g7hhkl.cloudfront.net", j = function (b, c) {
            a.log("Image Constructor");
            var e = g(b), f = e.extension, h = e.filename, i = c;
            return this.getFilename = function () {
                return h
            }, this.getExtension = function () {
                return f
            }, this.getType = function () {
                return i
            }, this.getImageUrlForSize = function (a) {
                return d(this.getFilename(), this.getExtension(), a)
            }, this
        }, k = function () {
            var a = [];
            this.addImage = function (b, c) {
                a.push(new j(b, c))
            }, this.getImageByIndex = function (b) {
                return a[b]
            }, this.getImageCount = function () {
                return a.length
            }, this.getImages = function () {
                return a
            }
        };
        return{computeImageUrl: d, createImageCollection: e, createImageCollectionFromApiResponse: f, getOriginalImageInfo: g}
    }])
}(), function () {
    plentific.app.service("bem", [function () {
        function a(a, b) {
            var c = [];
            return angular.isDefined(b) && c.push(a + "--" + b), c
        }

        function b(a, b, c) {
            var d, e = [], f = new RegExp(a + "__");
            return d = c.replace(f, ""), e.push(c), angular.forEach(b, function (a) {
                e.push(a + "__" + d)
            }), e
        }

        return{getBlockClassNames: a, getElementClassNames: b}
    }])
}();
angular.module("plentific.app").run(["$templateCache", function ($templateCache) {
    $templateCache.put("/partials/directives/tooltip/tooltip.html", "<div class=\"tooltip\"><div class=\"tooltip__header\" data-ng-bind=\"title\"></div><div class=\"tooltip__body\" data-ng-bind=\"content\"></div></div>");
    $templateCache.put("/partials/directives/tooltip/tooltipHtmlUnsafe.html", "<span class=\"tooltip\"><span class=\"tooltip__original-text\" data-ng-transclude=\"\"></span><span class=\"tooltip__wrap\" data-ng-class=\"{ 'is-shown': shown, 'is-hidden': !shown }\"><span class=\"tooltip__header\" data-ng-bind=\"title\"></span><span class=\"tooltip__body\" data-ng-bind-html=\"content\"></span></span></span>");
    $templateCache.put("/partials/directives/tooltip/tooltipSidebar.html", "<span class=\"tooltip-sidebar\"><span data-ng-bind=\"content\"></span><span class=\"tooltip-sidebar__triangle\"></span></span>");
    $templateCache.put("/partials/popups/dialog-legal.html", "<div class=\"dialog-content dialog-content--contact\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><div class=\"dialog-content--contact-content\" data-ng-hide=\"sent\"><h3 class=\"dialog-content__heading\">Speak to a Property Solicitor</h3><div class=\"dialog-content__info\"><ol><li class=\"leftarrow\"><i class=\"icon\"><i class=\"pen\"></i></i><i class=\"arrow\"></i><span class=\"text\">Fill in your contact details.</span></li><li class=\"rightarrow\"><i class=\"icon\"><i class=\"partner\"></i></i><i class=\"arrow\"></i><span class=\"text medium\">We will pass your details to our independent partner.</span></li><li><i class=\"icon\"><i class=\"solicitor\"></i></i><span class=\"text large\">Our trusted solicitor partner will contact you to discuss your needs and conveyancing requirements.</span></li></ol><div class=\"dialog-content__info-details\" data-ng-show=\"userData.user.isLazyUser\" data-ng-include=\"'/partials/popups/includes/popup-terms-login.html'\"></div></div><div class=\"dialog-content__form\"><i class=\"i sprite-icon-contact-edge\"></i><form name=\"contactForm\" class=\"submit-on-enter\" data-ng-submit=\"sendSolicitor()\"><div class=\"grid\"><div data-ng-include=\"'/partials/popups/includes/popup-form-user-data.html'\"></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"text\" pl-number=\"\" placeholder=\"Estimated loan amount (optional)\" data-pl-focus=\"\" data-ng-model=\"formData.estimatedLoanAmount\"><span class=\"account-form__error\" data-ng-repeat=\"message in formErrors.estimatedLoanAmount\" data-ng-show=\"showErrors\"><i></i>[[message]]</span></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"text\" pl-number=\"\" placeholder=\"Estimated purchase price (optional)\" data-pl-focus=\"\" data-ng-model=\"formData.estimatedPurchasePrice\"><span class=\"account-form__error\" data-ng-repeat=\"message in formErrors.estimatedPurchasePrice\" data-ng-show=\"showErrors\"><i></i>[[message]]</span></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><textarea placeholder=\"Additional comments or questions\" class=\"grid__item one-whole\"></textarea></div><div class=\"dialog-content__form-field-wrapper\"><p class=\"grid__item one-third\"><button type=\"submit\" class=\"btn dialog-content__button\">Send</button></p></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\" data-ng-include=\"'/partials/popups/includes/popup-submit-terms.html'\"></div></div></form></div></div><div class=\"dialog-content--contact-confirmation\" data-ng-show=\"sent\"><h3 class=\"dialog-content__heading\"><i class=\"i sprite-icon-tick--dialog\"></i><p>We have submitted your request to speak to our legal partner<br>and sent a copy to <a href=\"mailto:[[formData.email]]\">[[formData.email]].</a></p></h3><div class=\"dialog-content__confirmation\"><div class=\"dialog-content__partner-description\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/solicitor-logo.f2562422.png\"><div class=\"text\"><p>....Moving Home is perceived by many as one of the most stressful transactions they will undertake. We understand that time is of the essence as well as delivery of a cost effective service whilst not compromising on quality.</p><p>Stephensons is an award winning firm having twice won The Law Firm Services Conveyancing awards both regionally and overall as well as holding the Conveyancing Quality Mark by the Law Society and being accredited by The Conveyancing Association. We have 10 offices nationally based in ( London, Manchester, Bolton, Wigan, St Helens, Altrincham and Leigh) and we serve clients nationwide.</p><p>We pride ourselves on offering transparent pricing. Our team also has extensive experience of The Help to Buy scheme, Shared Ownership and Shared Equity schemes as well as an in depth knowledge of the NewBuy Scheme.</p><p>We have been carrying out Conveyancing work for over 30 years and as a result we have expertise in a number of specialist areas....</p></div></div><div class=\"dialog-content__partner-info\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><img class=\"photo\" data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/solicitor-photo.12613dca.png\"><p class=\"name\"><span>Tom Bridge</span> - Managing Partner</p><p class=\"job\">(Conveyancing &amp; Probate)</p><p class=\"credentials\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/solicitor-awards.7166b160.png\"></p></div></div></div></div></div></div></div></div>");
    $templateCache.put("/partials/popups/dialog-mortgage.html", "<div class=\"dialog-content dialog-content--contact\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><div class=\"dialog-content--contact-content\" data-ng-hide=\"sent\"><h3 class=\"dialog-content__heading\">Speak To An Independent Mortgage Advisor</h3><div class=\"dialog-content__info\"><ol><li class=\"leftarrow\"><i class=\"icon\"><i class=\"pen\"></i></i><i class=\"arrow\"></i><span class=\"text\">Fill in your contact details.</span></li><li class=\"rightarrow\"><i class=\"icon\"><i class=\"partner\"></i></i><i class=\"arrow\"></i><span class=\"text medium\">We will pass your details to our mortgage advisor.</span></li><li><i class=\"icon\"><i class=\"advice\"></i></i><span class=\"text medium\">An Advisor will contact you to discuss your mortgage requirements.</span></li></ol><div class=\"dialog-content__info-details\" data-ng-show=\"userData.user.isLazyUser\" data-ng-include=\"'/partials/popups/includes/popup-terms-login.html'\"></div></div><div class=\"dialog-content__form\"><i class=\"i sprite-icon-contact-edge\"></i><form name=\"contactForm\" class=\"submit-on-enter\" data-ng-submit=\"sendMortgage()\"><div class=\"grid\"><div data-ng-include=\"'/partials/popups/includes/popup-form-user-data.html'\"></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"text\" pl-number=\"\" placeholder=\"Estimated loan amount (optional)\" data-pl-focus=\"\" data-ng-model=\"formData.estimatedLoanAmount\"></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"text\" pl-number=\"\" placeholder=\"Estimated purchase price (optional)\" data-pl-focus=\"\" data-ng-model=\"formData.estimatedPurchasePrice\"></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><textarea placeholder=\"Additional comments or questions\" class=\"grid__item one-whole\"></textarea></div><div class=\"dialog-content__form-field-wrapper\"><p class=\"grid__item one-third\"><button type=\"submit\" class=\"btn dialog-content__button\">Send</button></p></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><p class=\"dialog-content__smallprint\">Declaration: I have read the section above and understand that by submitting my details you will hold my personal data on your database. An adviser may then be in touch by telephone or email to discuss my potential requirements.</p></div></div></form></div></div><div class=\"dialog-content--contact-confirmation\" data-ng-show=\"sent\"><h3 class=\"dialog-content__heading\"><i class=\"i sprite-icon-tick--dialog\"></i><p>We have submitted your request to speak to a mortgage advisor<br>and sent a copy to <a href=\"mailto:[[formData.email]]\">[[formData.email]].</a></p></h3><div class=\"dialog-content__confirmation\"><div class=\"dialog-content__partner-description\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/mortgage-advisor-logo.81b3ba57.png\"><div class=\"text\"><p>\"At Coreco, we understand the unique UK property market. As the leading, London-based provider of independent mortgage and financial advice, we live and breathe it every day.</p><p>Not only do we specialise in all types of mortgages and are experts in First Time Buyer loans, complex specialist facilities and Large Mortgage Loans, we work hard to ensure a smooth process tailored to your needs so you have one less thing to worry about in the buying process.</p><p>We pride ourselves on taking the time to fully understand your requirements, however complex, concentrating on professional and genuinely independent advice.</p><p>Coreco - helping you to own and protect your home.\"</p><p>Your home may be repossessed if you do not keep up repayments on your mortgage.</p><p>A fee of up to 1% of the mortgage amount may be charged depending on individual circumstances. A typical fee is £495.</p></div></div><div class=\"dialog-content__partner-info\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><img class=\"photo\" data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/mortgage-advisor-photo.22e7a28a.png\"><p class=\"name\"><span>Andrew Montlake</span> - Financial Adviser &amp; Director</p><p class=\"job\">(Coreco)</p><p class=\"credentials\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/mortgage-advisor-awards.09f52ef2.png\"></p></div></div></div></div></div></div></div></div>");
    $templateCache.put("/partials/popups/dialog-property-coach-orientation.html", "<div class=\"dialog-content dialog-content--contact\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"dialog-content__wrapper\"><div class=\"dialog-content--contact-content\"><div class=\"property-coach__dialog-content property-coach__dialog--orientation\"><aside class=\"property-coach__dialog-content__aside\"><h2>The Rental</h2><h3>The Rental is for anyone requiring professional advice and high quality service to find the most suitable rental property, either as a private individual or as a corporate client.</h3><button class=\"contact-button contact-button--property-coach-dialog\" data-ng-click=\"close(); openDialog('propertyCoach')\">Speak to a Property Coach</button></aside><div class=\"property-coach__dialog-content__description\"><p>With the Rental package you get:</p><ol><li><h4>A no-obligation meeting</h4><p>Discuss all of your requirements and get advice on the current market.</p></li><li><h4>A comprehensive property brief</h4><p>This is where you describe your ideal property. Your Property Coach will need to know everything from style and condition to size and location to conduct the most informed search.</p></li><li><h4>Property searches</h4><p>Your Property Coach uses her/his contacts to source the most suitable properties, sometimes even before they're put out on the market. Having conducted a structured and thorough search process to find a range of suitable properties, she/he will then preview properties to assess their suitability.</p></li><li><h4>Viewings with you</h4><p>You can view properties together with your Property Coach.</p></li><li><h4>Negotiation</h4><p>Once you've found the right property, it's up to your coach to negotiate the best price for you.</p></li><li><h4>Settling in</h4><p>Your coach will provide you an individually tailored to-do list of the organisations which need to be notified during and after your move. Coaches can help with the administrative side for you at an additional cost.</p></li></ol></div></div></div></div></div>");
    $templateCache.put("/partials/popups/dialog-property-coach-unlimited.html", "<div class=\"dialog-content dialog-content--contact\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"dialog-content__wrapper\"><div class=\"dialog-content--contact-content\"><div class=\"property-coach__dialog-content property-coach__dialog--unlimited\"><aside class=\"property-coach__dialog-content__aside\"><h2>The Unlimited</h2><h3>The Unlimited package is ideal for people without the time to spend making sure they get the right property. If you live abroad, have a particularly demanding career or just want to make sure you’re making the right choice, this package is for you.</h3><button class=\"contact-button contact-button--property-coach-dialog\" data-ng-click=\"close(); openDialog('propertyCoach')\">Speak to a Property Coach</button></aside><div class=\"property-coach__dialog-content__description\"><p>A more comprehensive package that covers the entire homebuying journey, the Unlimited Package offers:</p><ol><li><h4>A no-obligation meeting</h4><p>Your Property Coach will come to meet you wherever and whenever is convenient to talk about what’s going on in the market and what your requirements are. This is completely free of charge.</p></li><li><h4>A comprehensive property brief</h4><p>This is where you describe your perfect property. A Property Coach will need to know everything from style and condition to size and location to make sure they’re on the same page. You can also arrange orientation tours and get a better picture of how much house your budget allows for.</p></li><li><h4>Property searches</h4><p>Your Property Coach uses their contacts to get the latest properties before they’re put out on the market, as well as conducting structured, thorough checks of the entire market in the areas you’re looking at. Having found a range of suitable properties, they will then conduct previews to get a better idea of the property’s suitability.</p></li><li><h4>Scouting reports</h4><p>Instead of wasting time viewing properties that have some sizable flaw or don’t fit your criteria, a Property Coach will give you a full report on each property. They combine the facts with their assessment of a property’s ‘X’ factor to give you short list of properties you’ll love.</p></li><li><h4>Viewings with you</h4><p>Having a Property Coach with you on viewings makes life easy for you. They will allow you to organise more convenient times to view, as well as giving you the benefit of truly impartial advice and a full post-mortem, should you want one. This process continues until you find that perfect place, so the cost of the Unlimited package practically guarantees you your dream property.</p></li><li><h4>Negotiation</h4><p>This is where Property Coaches can really pay for themselves. Once you’ve found the right property, it’s up to them to negotiate the best price for you. The real advantage of having a Property Coach negotiate for you is that they have all the right contacts to ensure they know exactly what’s happening with bidding at all times. What’s more, a property coach can also make you look more attractive to sellers and agents, who know that you’re serious and ready to go for a clean, quick completion.</p></li><li><h4>Process management</h4><p>Once you’ve agreed on the best price, your Property Coach can act as a single point of contact between you and all the agents involved in the process, from mortgage brokers to conveyancers and estate agents. This means you can enjoy a hassle-free homebuying journey.</p></li><li><h4>Settling in</h4><p>Between exchange and completion, your Property Coach will provide you with a tailored contact sheet for all the people you need to contact about your move. They can even provide a complete settling in service to make your move a seamless and completely stress-free one for a small additional cost.</p></li></ol><p>The Unlimited package usually pays for itself in the long run. Combing the ease of a single point of contact with powerful negotiation skills, a Property Coach can make your dream home a reality in record time.</p></div></div></div></div></div>");
    $templateCache.put("/partials/popups/dialog-property-coach.html", "<div class=\"dialog-content dialog-content--contact\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><div class=\"dialog-content--contact-content\" data-ng-hide=\"sent\"><h3 class=\"dialog-content__heading\">Speak To A Property Coach</h3><div class=\"dialog-content__info\"><ol><li class=\"leftarrow\"><i class=\"icon\"><i class=\"pen\"></i></i><i class=\"arrow\"></i><span class=\"text\">Fill in your contact details.</span></li><li class=\"rightarrow\"><i class=\"icon\"><i class=\"partner\"></i></i><i class=\"arrow\"></i><span class=\"text medium\">We will pass your details to our independent partner.</span></li><li><i class=\"icon\"><i class=\"coach\"></i></i><span class=\"text large\">Our trusted property coach partner will contact you to discuss your rental or buying requirements.</span></li></ol><div class=\"dialog-content__info-details\" data-ng-show=\"userData.user.isLazyUser\" data-ng-include=\"'/partials/popups/includes/popup-terms-login.html'\"></div></div><div class=\"dialog-content__form\"><i class=\"i sprite-icon-contact-edge\"></i><form name=\"contactForm\" class=\"submit-on-enter\" data-ng-submit=\"sendPropertyCoach()\"><div class=\"grid\"><div data-ng-include=\"'/partials/popups/includes/popup-form-user-data.html'\"></div><div class=\"dialog-content__form-coach-details\"><div class=\"dialog-content__form-field-wrapper grid__item one-half\">Interested in:<select data-ui-select2=\"dropdownOptions\" data-ng-model=\"formData.interested\" class=\"select2-hide\"><option value=\"The Rental\">The Rental</option><option value=\"The Purchase\">The Purchase</option></select></div><div class=\"dialog-content__form-field-wrapper grid__item one-half\">Searching in:<select data-ui-select2=\"dropdownOptions\" data-ng-model=\"formData.searching\" class=\"select2-hide\"><option value=\"London\">London</option><option value=\"Outside of London\">Outside of London</option></select></div></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><textarea placeholder=\"Comments\" class=\"grid__item one-whole\"></textarea></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\">If you are outside the areas we cover, may we ask one of our partners in that area to contact you instead.</div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><p><button type=\"submit\" class=\"btn dialog-content__button\">Send</button></p></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\" data-ng-include=\"'/partials/popups/includes/popup-submit-terms.html'\"></div></div></form></div></div><div class=\"dialog-content--contact-confirmation\" data-ng-show=\"sent\"><div data-ng-show=\"formData.searching == 'London'\"><h3 class=\"dialog-content__heading\"><i class=\"i sprite-icon-tick--dialog\"></i><p>We have submitted your request to speak to our property coach partner<br>and sent a copy to <a href=\"mailto:[[formData.email]]\">[[formData.email]]</a></p></h3><div class=\"dialog-content__confirmation\"><div class=\"dialog-content__partner-description\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/property-coach-london-logo.96c77a28.png\"><div class=\"text\"><p>Sourcing Property is an award winning property finder and relocation company. We represent buyers across all budgets to ensure access to the best properties, and negotiate the lowest possible price. We also work with companies relocating staff to the UK, as well as individuals and families relocating themselves.</p><p>We search for property on your behalf, according to your specified criteria, saving you both time and money. We use our expert property market knowledge and negotiating power to make sure that you get the best deal possible.</p></div></div><div class=\"dialog-content__partner-info\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><img class=\"photo\" data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/property-coach-london-photo.badb8ba3.png\"><p class=\"name\"><span>Jo Eccles</span> - Managing Director</p><p class=\"credentials\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/property-coach-london-awards.ad11dcc5.png\"></p></div></div></div></div></div></div><div data-ng-hide=\"formData.searching == 'London'\"><h3 class=\"dialog-content__heading\"><p>We have submitted your request to speak to our property coach partner<br>and sent a copy to <a href=\"mailto:[[formData.email]]\">[[formData.email]]</a></p></h3><div class=\"dialog-content__confirmation\"><div class=\"dialog-content__partner-description\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/property-coach-outside-london-logo.5edc9f0a.png\"><div class=\"text\"><p>Nigel Sellers and his team are an independent company that provide a comprehensive ‘start to finish’ property search and acquisition service. Premier Property Search is an acknowledged market leader in the business of advising buyers. We have been in business for nearly 23 years doing only one thing - finding the best properties in all price ranges and then making sure that our clients buy at the right price.</p><p>We are not estate agents, we are leading experts in the acquisition of residential property from country houses and estates to village houses and city living. We are retained by private buyers, investors, developers and corporate companies relocating their employees.</p></div></div><div class=\"dialog-content__partner-info\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><div class=\"dialog-content__partner-info-content\"><img class=\"photo\" data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/property-coach-outside-london-photo.ceb8b2b2.png\"><p class=\"name\"><span>Nigel Sellers</span> - Managing Director</p></div></div></div></div></div></div></div></div></div>");
    $templateCache.put("/partials/popups/includes/popup-form-user-data.html", "<div class=\"dialog-content__form-field-wrapper grid\"><div class=\"dialog-content__form-field-wrapper grid__item one-third\" data-ng-class=\"{'ng-invalid': formErrors.title}\" data-ng-focus=\"formData.showErrors.title=true\" data-ng-blur=\"formData.showErrors.title=false\"><select data-ui-select2=\"dropdownOptions\" data-ng-model=\"formData.title\" class=\"select2-hide\" data-ng-class=\"{'ng-invalid': formErrors.title}\"><option value=\"\">Title</option><option value=\"Mr\">Mr</option><option value=\"Mrs\">Mrs</option><option value=\"Miss\">Miss</option><option value=\"Ms\">Ms</option><option value=\"Dr\">Dr</option></select><span class=\"account-form__error\" data-ng-show=\"formData.showErrors.title\" data-ng-repeat=\"message in formErrors.title\"><i></i>[[message]]</span></div><div class=\"dialog-content__form-field-wrapper grid__item one-third\"><input name=\"firstName\" class=\"input__field\" type=\"text\" data-ng-class=\"{'ng-invalid': formErrors.firstName}\" data-ng-focus=\"formData.showErrors.firstName=true\" data-ng-blur=\"formData.showErrors.firstName=false\" placeholder=\"First name\" data-pl-focus=\"\" data-ng-model=\"formData.firstName\"><span class=\"account-form__error\" data-ng-show=\"formData.showErrors.firstName\" data-ng-repeat=\"message in formErrors.firstName\"><i></i>[[message]]</span></div><div class=\"dialog-content__form-field-wrapper grid__item one-third\"><input class=\"input__field\" type=\"text\" data-ng-class=\"{'ng-invalid': formErrors.lastName}\" data-ng-focus=\"formData.showErrors.lastName=true\" data-ng-blur=\"formData.showErrors.lastName=false\" placeholder=\"Last name\" data-pl-focus=\"\" data-ng-model=\"formData.lastName\"><span class=\"account-form__error\" data-ng-show=\"formData.showErrors.lastName\" data-ng-repeat=\"message in formErrors.lastName\"><i></i>[[message]]</span></div></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"text\" data-ng-class=\"{'ng-invalid': formErrors.phoneNumber}\" data-ng-focus=\"formData.showErrors.phoneNumber=true\" data-ng-blur=\"formData.showErrors.phoneNumber=false\" placeholder=\"Telephone number\" data-pl-focus=\"\" data-ng-model=\"formData.phoneNumber\"><span class=\"account-form__error\" data-ng-show=\"formData.showErrors.phoneNumber\" data-ng-repeat=\"message in formErrors.phoneNumber\"><i></i>[[message]]</span></div><div class=\"dialog-content__form-field-wrapper grid__item one-whole\"><input class=\"input__field grid__item one-whole\" type=\"email\" data-ng-class=\"{'ng-invalid': formErrors.email}\" data-ng-focus=\"formData.showErrors.email=true\" data-ng-blur=\"formData.showErrors.email=false\" placeholder=\"Email address\" data-pl-focus=\"\" data-ng-model=\"formData.email\"><span class=\"account-form__error\" data-ng-show=\"formData.showErrors.email\" data-ng-repeat=\"message in formErrors.email\"><i></i>[[message]]</span></div>");
    $templateCache.put("/partials/popups/includes/popup-submit-terms.html", "<p class=\"dialog-content__smallprint\">By submitting this form, you accept our <a href=\"http://plentific.com/terms\">Terms of Use</a></p>");
    $templateCache.put("/partials/popups/includes/popup-terms-login.html", "<div><p>If you are already a Plentific customer then you just need to <button class=\"btn--link\" type=\"button\" data-ng-click=\"close(); openDialog('login')\">log in</button> and complete a few extra details.</p><p>Don't have an account? <button class=\"btn--link\" type=\"button\" data-ng-click=\"close(); openDialog('signup')\">Sign up</button>.</p></div>");
    $templateCache.put("/partials/views/auth/login.html", "<div class=\"dialog-content dialog-content--auth dialog-content--login\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><div class=\"grid__item one-half\"><div class=\"dialog-content__section dialog-content__section--left dialog-content__section--white\"><form name=\"loginForm\" id=\"loginForm\" class=\"auth-form auth-form--login submit-on-enter\" data-ng-submit=\"logIn()\" novalidate=\"\"><h2 class=\"dialog-content__section__header\">Login</h2><div class=\"auth-form__row\"><span class=\"account-form__error\" data-ng-show=\"loginForm.$error.serverError\"><i></i>[[ loginForm.$error.serverError ]]</span><input placeholder=\"Email\" type=\"email\" name=\"email\" data-ng-model=\"login.email\" class=\"auth-form__input auth-form__input--email\" data-ng-class=\"{'ng-invalid': loginForm.email.$error.serverMessages.length}\" data-ng-focus=\"loginForm.email.showErrors=true\" data-ng-blur=\"loginForm.email.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in loginForm.email.$error.serverMessages\" data-ng-show=\"loginForm.email.showErrors\"><i></i>[[message]]</span><i class=\"i sprite-icon-login-email-icon input-icon\"></i></div><div class=\"auth-form__row\"><input placeholder=\"Password\" type=\"password\" name=\"password\" data-ng-model=\"login.password\" class=\"auth-form__input auth-form__input--password\" data-ng-class=\"{'ng-invalid': loginForm.password.$error.serverMessages.length}\" data-ng-focus=\"loginForm.password.showErrors=true\" data-ng-blur=\"loginForm.password.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in loginForm.password.$error.serverMessages\" data-ng-show=\"loginForm.password.showErrors\"><i></i>[[message]]</span><i class=\"i sprite-icon-login-password-icon input-icon\"></i></div><div class=\"auth-form__row auth-form__row--buttons\"><span class=\"checkbox-input\"><label class=\"auth-form__input-label checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"login.rememberMe\" checked=\"checked\">Remember me<span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span><button class=\"btn--blue btn--large right\">Login</button></div><p><a data-ng-click=\"openPasswordResetDialog()\">Forgot password?</a></p></form></div></div><div class=\"grid__item one-half\"><div class=\"dialog-content__section dialog-content__section--right dialog-content__section--grey\"><h2 class=\"dialog-content__section__header\">Using your account</h2><ul class=\"auth-options\"><li class=\"auth-options__option auth-options__option--google\"><a class=\"auth-options__link\" target=\"_self\" href=\"/login/google-oauth2/\"><span class=\"auth-options__link-icon\"><i class=\"i sprite-icon-auth-options-google\"></i></span>Connect using Google</a></li><li class=\"auth-options__option auth-options__option--facebook\"><a class=\"auth-options__link\" target=\"_self\" href=\"/login/facebook/\"><span class=\"auth-options__link-icon\"><i class=\"i sprite-icon-auth-options-facebook\"></i></span>Connect using Facebook</a></li></ul><p>Don't have an account yet? <a data-ng-click=\"openSignupDialog()\">Sign up</a>.</p></div></div><div class=\"dialog-content__separator\"><span class=\"dialog-content__or\">or</span></div></div></div>");
    $templateCache.put("/partials/views/auth/myaccount.html", "<div class=\"page-content page-content--myaccount\"><div class=\"grid\"><div class=\"grid__item one-half\"><section class=\"content-box\"><form name=\"accountForm\" class=\"account-form\" novalidate=\"\" data-ng-submit=\"updateUser(myAccount.user, accountForm)\"><h2 class=\"content-box__header\">My Profile</h2><div class=\"content-box__content\"><div class=\"grid account-form__row\" pl-image-uploader=\"myAccount.user.avatar_130\" data-default-avatar=\"[[defaultAvatar]]\"><div class=\"grid__item one-third\"><img class=\"profile-picture\" alt=\"User Avatar Image\" data-ng-src=\"[[defaultAvatar]]\" data-ng-hide=\"imageUrl\"><img class=\"profile-picture\" alt=\"User Avatar Image\" data-ng-src=\"[[imageUrl]]\" data-ng-show=\"imageUrl\"></div><div class=\"grid__item two-thirds\"><div class=\"saving-indicator--saving\" data-ng-show=\"isBusy\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Uploading</span></div><button type=\"button\" class=\"upload-trigger btn--gradient\" data-ng-click=\"selectFile()\" data-ng-hide=\"isBusy\">Upload new profile image</button></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">First name:</label><div class=\"grid__item two-thirds\"><input type=\"text\" name=\"firstName\" data-ng-model=\"myAccount.user.firstName\" class=\"account-form__input one-whole\"></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Last name:</label><div class=\"grid__item two-thirds\"><input type=\"text\" name=\"lastName\" data-ng-model=\"myAccount.user.lastName\" class=\"account-form__input one-whole\"></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Telephone:</label><div class=\"grid__item two-thirds\"><input name=\"telephone\" type=\"text\" data-ng-model=\"myAccount.user.telephone\" class=\"account-form__input grid__item seven-twelfths\"><select name=\"telephoneType\" data-ng-model=\"myAccount.user.telephoneType\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" class=\"grid__item five-twelfths select2-hide\"><option value=\"mobile\">Mobile</option><option value=\"Home\">Home</option></select></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Country:</label><div class=\"grid__item two-thirds\"><select name=\"country\" data-ng-model=\"myAccount.user.country\" data-ui-select2=\"\" class=\"one-whole select2-hide\"><option value=\"\"></option><option data-ng-repeat=\"country in countries\" value=\"[[country.code]]\" data-ng-bind=\"country.name\"></option></select></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Gender:</label><div class=\"grid__item two-thirds\"><select name=\"gender\" data-ng-model=\"myAccount.user.gender\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" class=\"one-half select2-hide\"><option value=\"male\">Male</option><option value=\"female\">Female</option></select></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Birthday:</label><div class=\"grid__item two-thirds datepicker\"><input datepicker-popup=\"dd/MM/yyyy\" show-weeks=\"false\" pl-date=\"\" name=\"birthday\" type=\"text\" data-ng-model=\"myAccount.user.birthday\" class=\"account-form__input one-whole\" placeholder=\"dd/mm/yyyy\" data-ng-focus=\"accountForm.email.showErrors=true\" data-ng-blur=\"accountForm.email.showErrors=false\"><i class=\"i sprite-icon-datepicker input-icon\"></i><span class=\"account-form__error\" data-ng-repeat=\"message in accountForm.birthday.$error.serverMessages\" data-ng-show=\"accountForm.email.showErrors\"><i></i>[[message]]</span></div></div></div><div class=\"content-box__content\"><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-whole\"><strong>Home</strong></label></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Address:</label><div class=\"grid__item two-thirds\"><input name=\"homeAddress\" type=\"text\" data-ng-model=\"myAccount.user.homeAddress\" class=\"account-form__input one-whole\"></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Postcode:</label><div class=\"grid__item two-thirds account-form__field-wrapper\"><input name=\"homePostcode\" type=\"text\" data-ng-model=\"myAccount.user.homePostcode\" class=\"account-form__input one-whole\" pl-postcode-input=\"\"><span class=\"account-form__error\" data-ng-show=\"accountForm.homePostcode.$error.postcode\"><i></i>Please enter a valid UK postcode</span></div></div></div><div class=\"content-box__content\"><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-whole\"><strong>Work</strong></label></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Address:</label><div class=\"grid__item two-thirds\"><input name=\"workAddress\" type=\"text\" data-ng-model=\"myAccount.user.workAddress\" class=\"account-form__input one-whole\"></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-third\">Postcode:</label><div class=\"grid__item two-thirds account-form__field-wrapper\"><input name=\"workPostcode\" type=\"text\" data-ng-model=\"myAccount.user.workPostcode\" class=\"account-form__input one-whole\" pl-postcode-input=\"\"><span class=\"account-form__error\" data-ng-show=\"accountForm.workPostcode.$error.postcode\"><i></i>Please enter a valid UK postcode</span></div></div></div><div class=\"content-box__content\"><span class=\"checkbox-input\"><label class=\"account-form__checkboxlabel checkbox-input__label\"><input name=\"emailOptIn\" type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"myAccount.user.emailOptIn\" checked=\"checked\"><span class=\"grid__item two-thirds\">Plentific can contact me with relevant properties, offers and news</span><span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span></div><div class=\"content-box__content\"><div class=\"grid grid--center account-form__row\"><div class=\"saving-indicator--saving\" data-ng-show=\"accountForm.$dirty && accountForm.isSaving\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Saving</span></div><button data-ng-hide=\"accountForm.isSaving\" data-ng-disabled=\"accountForm.$pristine\" type=\"submit\" class=\"grid__item btn btn--gradient\"><i class=\"saving-indicator__tick\" data-ng-show=\"accountForm.$pristine && accountForm.isSaved\"></i><span data-ng-show=\"accountForm.$pristine && accountForm.isSaved\">Saved</span><span data-ng-show=\"!accountForm.$pristine || !accountForm.isSaved\">Save Changes</span></button></div></div></form></section></div><div class=\"grid__item one-half\"><section class=\"content-box\" data-ng-hide=\"myAccount.user.isSocial\"><form name=\"passwordChangeForm\" class=\"password-form\" novalidate=\"\" data-ng-submit=\"updatePassword(myAccount.passwordForm, passwordChangeForm)\"><h2 class=\"content-box__header\">Change Password</h2><div class=\"content-box__content\"><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">Current password:</label><div class=\"grid__item one-half\"><input type=\"password\" name=\"oldPassword\" data-ng-model=\"myAccount.passwordForm.oldPassword\" class=\"account-form__input one-whole\" data-ng-focus=\"passwordChangeForm.oldPassword.showErrors=true\" data-ng-blur=\"passwordChangeForm.oldPassword.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in passwordChangeForm.oldPassword.$error.serverMessages\" data-ng-show=\"passwordChangeForm.oldPassword.showErrors\"><i></i>[[message]]</span></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">New password:</label><div class=\"grid__item one-half\"><input name=\"newPassword\" type=\"password\" class=\"account-form__input one-whole\" data-ng-model=\"myAccount.passwordForm.newPassword\" data-ng-focus=\"passwordChangeForm.newPassword.showErrors=true\" data-ng-blur=\"passwordChangeForm.newPassword.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in passwordChangeForm.newPassword.$error.serverMessages\" data-ng-show=\"passwordChangeForm.newPassword.showErrors\"><i></i>[[message]]</span></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">Confirm new password:</label><div class=\"grid__item one-half\"><input type=\"password\" name=\"newPassword2\" class=\"account-form__input one-whole\" data-ng-model=\"myAccount.passwordForm.newPassword2\" data-ng-focus=\"passwordChangeForm.newPassword2.showErrors=true\" data-ng-blur=\"passwordChangeForm.newPassword2.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in passwordChangeForm.newPassword2.$error.serverMessages\" data-ng-show=\"passwordChangeForm.newPassword2.showErrors\"><i></i>[[message]]</span></div></div><div class=\"account-form__row account-form__row--centre\"><div class=\"saving-indicator--saving\" data-ng-show=\"passwordChangeForm.$dirty && passwordChangeForm.isSaving\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Saving</span></div><button data-ng-hide=\"passwordChangeForm.isSaving\" data-ng-disabled=\"passwordChangeForm.$pristine\" type=\"submit\" class=\"grid__item btn btn--gradient\"><i class=\"saving-indicator__tick\" data-ng-show=\"passwordChangeForm.$pristine && passwordChangeForm.isSaved\"></i><span data-ng-show=\"passwordChangeForm.$pristine && passwordChangeForm.isSaved\">Saved</span><span data-ng-show=\"!passwordChangeForm.$pristine || !passwordChangeForm.isSaved\">Save Changes</span></button></div></div></form></section><section class=\"content-box\"><form name=\"emailChangeForm\" class=\"email-form\" novalidate=\"\" data-ng-submit=\"updateEmail(myAccount.emailForm, emailChangeForm)\"><h2 class=\"content-box__header\">Change Email</h2><div class=\"content-box__content\"><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">Current email:</label><div class=\"account-form__label grid__item one-half\">[[ userData.user.email ]]</div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">New email:</label><div class=\"grid__item one-half\"><input name=\"email\" type=\"email\" class=\"account-form__input one-whole\" data-ng-model=\"myAccount.emailForm.email\" data-ng-class=\"{'ng-invalid': emailChangeForm.email.$error.serverMessages.length}\" data-ng-focus=\"emailChangeForm.email.showErrors=true\" data-ng-blur=\"emailChangeForm.email.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in emailChangeForm.email.$error.serverMessages\" data-ng-show=\"emailChangeForm.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-half\">Confirm new email:</label><div class=\"grid__item one-half\"><input name=\"email2\" type=\"email\" class=\"account-form__input one-whole\" data-ng-model=\"myAccount.emailForm.email2\" data-ng-class=\"{'ng-invalid': emailChangeForm.email2.$error.serverMessages.length}\" data-ng-focus=\"emailChangeForm.email2.showErrors=true\" data-ng-blur=\"emailChangeForm.email2.showErrors=false\" novalidate=\"\"><span class=\"account-form__error\" data-ng-repeat=\"message in emailChangeForm.email2.$error.serverMessages\" data-ng-show=\"emailChangeForm.email2.showErrors\"><i></i>[[message]]</span></div></div><div class=\"grid account-form__row\" data-ng-hide=\"myAccount.user.isSocial\"><label class=\"account-form__label grid__item one-half\">Password:</label><div class=\"grid__item one-half\"><input name=\"emailPassword\" type=\"password\" data-ng-model=\"myAccount.emailForm.password\" class=\"account-form__input one-whole\" data-ng-focus=\"emailChangeForm.emailPassword.showErrors=true\" data-ng-blur=\"emailChangeForm.emailPassword.showErrors=false\" novalidate=\"\"><span class=\"account-form__error\" data-ng-repeat=\"message in emailChangeForm.emailPassword.$error.serverMessages\" data-ng-show=\"emailChangeForm.emailPassword.showErrors\"><i></i>[[message]]</span></div></div><div class=\"account-form__row account-form__row--centre\"><div class=\"saving-indicator--saving\" data-ng-show=\"emailChangeForm.$dirty && emailChangeForm.isSaving\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Saving</span></div><button data-ng-hide=\"emailChangeForm.isSaving\" data-ng-disabled=\"emailChangeForm.$pristine\" type=\"submit\" class=\"grid__item btn btn--gradient\"><i class=\"saving-indicator__tick\" data-ng-show=\"emailChangeForm.$pristine && emailChangeForm.isSaved\"></i><span data-ng-show=\"emailChangeForm.$pristine && emailChangeForm.isSaved\">Saved</span><span data-ng-show=\"!emailChangeForm.$pristine || !emailChangeForm.isSaved\">Save Changes</span></button></div></div></form></section><section class=\"content-box\"><form name=\"deactivateForm\" class=\"deactivate-form\" data-ng-class=\"{'is-social': myAccount.user.isSocial}\" novalidate=\"\" data-ng-submit=\"deactivateAccount(myAccount.deactivateForm, deactivateForm)\"><h2 class=\"content-box__header\">Deactivate Account</h2><div class=\"content-box__content\" data-ng-hide=\"deactivateForm.submiAttempted\"><div class=\"grid account-form__row\"><label class=\"account-form__label grid__item one-whole\"><span data-ng-hide=\"myAccount.user.isSocial\">Please confirm your password for [[ userData.user.email ]] to close your Plentific account.</span><span data-ng-show=\"myAccount.user.isSocial\">Click the button below to close your Plentific account.</span><span>Note that you will lose all your saved data.</span></label></div><div class=\"grid grid--center account-form__row\"><label class=\"account-form__label grid__item one-quarter\" data-ng-hide=\"myAccount.user.isSocial\">Password:</label><div class=\"grid__item five-twelfths\" data-ng-hide=\"myAccount.user.isSocial\"><input name=\"password\" type=\"password\" class=\"account-form__input one-whole\" data-ng-class=\"{'ng-invalid': deactivateForm.password.$error.serverMessages.length}\" data-ng-model=\"myAccount.deactivateForm.password\" data-ng-focus=\"deactivateForm.password.showErrors=true\" data-ng-blur=\"deactivateForm.password.showErrors=false\" novalidate=\"\"><span class=\"account-form__error\" data-ng-repeat=\"message in deactivateForm.password.$error.serverMessages\" data-ng-show=\"deactivateForm.password.showErrors\"><i></i>[[message]]</span></div><div class=\"grid__item\" data-ng-class=\"{'one-half': myAccount.user.isSocial, 'one-third': !myAccount.user.isSocial}\"><button type=\"button\" class=\"grid__item one-whole btn--deactivate\" data-ng-click=\"deactivateForm.submiAttempted = true\"><i></i>Deactivate</button></div></div></div><div class=\"content-box__content deactivate-form__confirmation\" data-ng-show=\"deactivateForm.submiAttempted\"><div class=\"grid account-form__row\" data-ng-hide=\"deactivateForm.isSaving || deactivateForm.isSaved\"><p>Are you sure?</p></div><div class=\"account-form__row deactivate-form__buttons\"><div class=\"saving-indicator--saving\" data-ng-show=\"deactivateForm.isSaving || deactivateForm.isSaved\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Please wait</span></div><button data-ng-hide=\"deactivateForm.isSaving || deactivateForm.isSaved\" type=\"submit\" class=\"btn--primary deactivate-form__submit\">Yes, deactivate</button><button data-ng-hide=\"deactivateForm.isSaving || deactivateForm.isSaved\" type=\"button\" class=\"btn--blue\" data-ng-click=\"changedMind()\">No, I want to keep it</button></div></div></form></section></div></div></div>");
    $templateCache.put("/partials/views/auth/passwordReset.html", "<div class=\"dialog-content dialog-content--auth dialog-content--password-reset\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><div class=\"dialog-content__section dialog-content__section--full dialog-content__section--white\" data-ng-hide=\"passwordResetForm.isSaving || passwordResetSuccess\"><form name=\"passwordResetForm\" class=\"auth-form auth-form--login\" data-ng-submit=\"passwordResetForm.submitAttempted = true\" novalidate=\"\"><h2 class=\"dialog-content__section__header\">Forgot password</h2><p>Enter your email address, and we'll email you instructions to reset your password.</p><p class=\"error\" data-ng-show=\"passwordResetForm.$error.serverError\">[[ passwordResetForm.$error.serverError ]]</p><div class=\"auth-form__row\"><input placeholder=\"Email\" type=\"email\" name=\"email\" data-ng-model=\"passwordReset.email\" class=\"auth-form__input auth-form__input--email\" data-ng-class=\"{'ng-invalid': passwordResetForm.email.$error.serverMessages.length}\" data-ng-focus=\"passwordResetForm.email.showErrors=true\" data-ng-blur=\"passwordResetForm.email.showErrors=false\"><i class=\"i sprite-icon-login-email-icon input-icon\"></i><span class=\"account-form__error\" data-ng-repeat=\"message in passwordResetForm.email.$error.serverMessages\" data-ng-show=\"passwordResetForm.email.showErrors\"><i></i>[[message]]</span></div><div class=\"auth-form__row auth-form__row--buttons\"><button class=\"btn--blue btn--large\" data-ng-click=\"resetPassword()\">Send</button></div></form></div><div class=\"dialog-content__section dialog-content__section--full dialog-content__section--white\" data-ng-show=\"passwordResetForm.isSaving\"><h2 class=\"dialog-content__section__header\">Forgot password</h2><p class=\"saving-indicator--saving\"><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><i class=\"saving-indicator__dot\"></i><span class=\"saving-indicator__label\">Please wait</span></p></div><div class=\"dialog-content__section dialog-content__section--full dialog-content__section--white\" data-ng-show=\"!passwordResetForm.isSaving && passwordResetSuccess\"><h2 class=\"dialog-content__section__header\">Password sent!</h2><p>Thanks. Your request has been received. We've sent you an email with instructions, but it may take a few moments to arrive in your inbox.</p></div><div class=\"dialog-content__footer\"><div class=\"dialog-content__section\"><p>Still having trouble? Contact support at <a href=\"mailto:support@plentific.com\">support@plentific.com</a> and we'll help.</p></div></div></div></div>");
    $templateCache.put("/partials/views/auth/signup.html", "<div class=\"dialog-content dialog-content--auth dialog-content--signup\"><button class=\"dialog-content__close-button\" data-ng-click=\"close(result)\"></button><div class=\"grid grid--full dialog-content__wrapper\"><i class=\"sprite-icon-contact-edge\"></i><div class=\"grid__item one-half\"><div class=\"dialog-content__section dialog-content__section--left dialog-content__section--gray\"><h2 class=\"dialog-content__section__header--smaller\">Why Sign Up?</h2><p>Our mission is to help you make smarter financial decisions. Our tips and tools will put you in control & simplify your life.</p><p><img class=\"dialog-content__section__image\" data-ng-src=\"[[ STATIC_URL ]]images/mary-and-dan.c6b0b2b8.jpg\" alt=\"\"></p><p>Mary &amp; Dan</p><p><em>Great site. Made it really easy to focus on the right properties that we could afford together.</em></p></div></div><div class=\"grid__item one-half\"><div class=\"dialog-content__section dialog-content__section--right dialog-content__section--white\"><form name=\"signupForm\" class=\"auth-form auth-form--signup submit-on-enter\" data-ng-submit=\"signUp()\" novalidate=\"\"><h2 class=\"dialog-content__section__header--smaller\">Sign Up For Free</h2><ul class=\"auth-options\"><li class=\"auth-options__option auth-options__option--google\"><a class=\"auth-options__link\" target=\"_self\" href=\"/login/google-oauth2/\"><span class=\"auth-options__link-icon\"><i class=\"i sprite-icon-auth-options-google\"></i></span>Connect with Google</a></li><li class=\"auth-options__option auth-options__option--facebook\"><a class=\"auth-options__link\" target=\"_self\" href=\"/login/facebook/\"><span class=\"auth-options__link-icon\"><i class=\"i sprite-icon-auth-options-facebook\"></i></span>Connect with Facebook</a></li></ul><h2 class=\"dialog-content__section__header--smaller\"><div class=\"dialog-content__section__header--separator\"><span>or</span></div></h2><p class=\"error\" data-ng-show=\"signupForm.$error.serverError\">[[ signupForm.$error.serverError ]]</p><div class=\"auth-form__row\"><input name=\"email\" class=\"auth-form__input auth-form__input--email\" placeholder=\"Email\" type=\"text\" data-ng-model=\"user.email\" data-ng-class=\"{'ng-invalid': signupForm.email.$error.serverMessages.length}\" data-ng-focus=\"signupForm.email.showErrors=true\" data-ng-blur=\"signupForm.email.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in signupForm.email.$error.serverMessages\" data-ng-show=\"signupForm.email.showErrors\"><i></i>[[message]]</span><i class=\"i sprite-icon-login-email-icon input-icon\"></i></div><div class=\"auth-form__row\"><input name=\"password\" class=\"auth-form__input auth-form__input--password\" placeholder=\"Password\" type=\"password\" data-ng-model=\"user.password\" data-ng-class=\"{'ng-invalid': signupForm.password.$error.serverMessages.length}\" data-ng-focus=\"signupForm.password.showErrors=true\" data-ng-blur=\"signupForm.password.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in signupForm.password.$error.serverMessages\" data-ng-show=\"signupForm.password.showErrors\"><i></i>[[message]]</span><i class=\"i sprite-icon-login-password-icon input-icon\"></i></div><div class=\"auth-form__row\"><input name=\"password2\" class=\"auth-form__input auth-form__input--password\" placeholder=\"Re-type Password\" type=\"password\" data-ng-model=\"user.password2\" data-ng-class=\"{'ng-invalid': signupForm.password2.$error.serverMessages.length}\" data-ng-focus=\"signupForm.password2.showErrors=true\" data-ng-blur=\"signupForm.password2.showErrors=false\"><span class=\"account-form__error\" data-ng-repeat=\"message in signupForm.password2.$error.serverMessages\" data-ng-show=\"signupForm.password2.showErrors\"><i></i>[[message]]</span><i class=\"i sprite-icon-login-password-icon input-icon\"></i></div><div class=\"auth-form__row\"><span class=\"checkbox-input\"><label class=\"account-form__checkboxlabel checkbox-input__label\"><input name=\"emailOptIn\" type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"emailOptIn\" checked=\"checked\"><span>I do not want Plentific to contact me with relevant properties, offers and news.</span><span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span></div><div class=\"auth-form__row grid\"><div class=\"grid__item one-half\"><button class=\"btn--blue btn--large\">Sign up</button></div><div class=\"grid__item one-half\">Already have an account?<br><a data-ng-click=\"openLoginDialog()\">Log in</a>.</div></div><div class=\"auth-form__row\">By clicking Sign Up, I agree to the <a href=\"http://plentific.com/terms\" target=\"_blank\">Terms of Use</a> and <a href=\"http://plentific.com/privacy\" target=\"_blank\">Privacy &amp; Security</a>.</div></form></div></div><div class=\"dialog-content__separator\"></div></div></div>");
    $templateCache.put("/partials/views/calculators/affordability.html", "<nav data-pl-page-subnav=\"affordability\" class=\"page-subnav\"></nav><div class=\"page-content page-content--calculators\"><h1 class=\"intro-heading\">How much house can I afford?</h1><section id=\"content-pane\" class=\"content-pane\"><h2>Calculate Affordability</h2><div class=\"content-pane__inset\"><div data-pl-tabset=\"affordabilitySubTabs\" data-pl-css-block-modifier=\"main\" data-callback=\"drawAffordabilityChart\" data-validator=\"validateTab\"><div data-pl-tab=\"\" data-pl-tab-title=\"Inputs\"><div class=\"calc-summary-panel\"><div class=\"calc-summary-panel__section calc-summary-panel__section--positive\"><span class=\"calc-summary-panel__section-title\">Income <span class=\"sub-title\">(after tax)</span></span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"totalIncome() | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--negative\"><span class=\"calc-summary-panel__section-title\">Expenses<span data-pl-help-prompt=\"\" class=\"help-prompt help-prompt--left help-prompt--bottom\">This represents all of your ongoing expenses. I.e. if you're a first-time-buyer, rent shouldn't be a part of this figure since we're trying to find your ability to pay a mortgage. If you're buying a second residence, then you should include your current mortgage (if you own your primary residence) since the new mortgage will come on top of the existing.</span></span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"caseData.monthlyExpenses | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--result negative-[[isDisposableIncomeNegative()]]\"><span class=\"calc-summary-panel__section-title\">Amount for mortgage payment<span data-pl-help-prompt=\"\" class=\"help-prompt help-prompt--left help-prompt--bottom\">The 50% of this amount will be added to your gross annual income for several calculations in the Results tab.</span></span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"disposableIncome() | noFractionCurrency:'£'\">0</span></span></div></div><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/tab-input.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Results\" data-pl-tab-validator=\"inputs-valid\"><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/tab-results.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Charts\" data-pl-tab-callback=\"allCharts\" data-pl-tab-validator=\"inputs-valid\"><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/tab-sensitivities.html'\"></div></div></div></div><div class=\"calculators__spinner\" data-pl-spinner=\"showSpinner\" data-pl-spinner-config=\"DEFAULT\"></div></section></div>");
    $templateCache.put("/partials/views/calculators/affordability/charts/equity-growth.html", "<div class=\"lines__header\"><div class=\"affordability-charts__estimated-annual-house-price-increase\"><span class=\"affordability-charts__label\">Estimated annual house price increase:</span><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"number\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"caseData.overriddenVars.estimatedAnnualHousePriceIncrease\" data-ng-change=\"housePriceIncreaseChanged()\" required=\"\"><span class=\"input__add-on\">%</span></div></div><div class=\"lines__legend\"><div class=\"lines__legend__section lines__legend__section--blue\"><span>Estimated house price</span><i></i></div><div class=\"lines__legend__section lines__legend__section--red\"><span>Outstanding mortgage</span><i></i></div></div></div><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/charts/lines-tooltips.html'\"></div><div id=\"equity-growth-chart\" class=\"pl-chart\" data-pl-lines=\"\"><div class=\"tabs--results__waterfall-placeholder\"></div></div><div class=\"lines__footer\"><div class=\"lines__tip charts__analysis\"><i class=\"i lines__tip__icon charts__analysis-info-icon\"></i><p>This chart shows the amount of equity you build up as a function of an assumed appreciation in the value of your property. For example, in year 5, assuming a <strong>[[ caseData.overriddenVars.estimatedAnnualHousePriceIncrease]]%</strong> appreciation in the value of the property, the price becomes <strong>[[ estimatedPriceFiveYears | noFractionCurrency:'£' ]]</strong> and since you would have paid (assuming to prepayments) <strong>[[ mortgagePaidFiveYears | noFractionCurrency:'£' ]]</strong> of your original mortgage of <strong>[[ caseData.overriddenVars.mortgageValue | noFractionCurrency:'£' ]]</strong>, your then outstanding mortgage amount becomes <strong>[[ outstandingMortgageFiveYears | noFractionCurrency:'£' ]]</strong>, resulting in an equity amount of <strong>[[ equityAmountFiveYears | noFractionCurrency:'£' ]]</strong>. This is a <strong>[[ percentageReturn ]]%</strong> return on your original investment of <strong>[[ caseData.overriddenVars.savings | noFractionCurrency:'£' ]]</strong> which includes your original deposit, stamp duty and other buying expenses.</p></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/charts/interest-rate.html", "<div id=\"interest-rate-chart\" class=\"pl-chart\" data-pl-bars=\"\"><div class=\"tabs--results__waterfall-placeholder\"></div></div><div class=\"lines__footer\"><div class=\"lines__tip charts__analysis\"><i class=\"i lines__tip__icon charts__analysis-info-icon\"></i><p>The chart above shows you how changes in interest rates would impact your monthly mortgage payments. The Base Case of <strong>[[ caseData.overriddenVars.interestRate ]]%</strong> is the rate used in the the Affordability calculator and results in monthly mortgage repayments of <strong>[[ housePriceData.mortgagePayment | noFractionCurrency:'£' ]]</strong>. Even if you get a fixed mortgage, the interest rate will only be constant until the fixed period ends, after when it will start to vary. So when you’re analysing your budget and deciding on the size of the mortgage, make sure to take into account potential future rate rises.</p></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/charts/lines-tooltips.html", "<div class=\"chart__tooltip-wrapper\"><div class=\"chart__tooltip chart__tooltip--hidden\" data-id=\"green-line\"><p><span class=\"chart__tooltip__text\"></span></p><p>£<span class=\"chart__tooltip__amount\"></span></p></div><div class=\"chart__tooltip chart__tooltip--hidden\" data-id=\"blue-line\"><p><span class=\"chart__tooltip__text\"></span></p><p>£<span class=\"chart__tooltip__amount\"></span></p></div><div class=\"chart__tooltip chart__tooltip--hidden\" data-id=\"red-line\"><p><span class=\"chart__tooltip__text\"></span></p><p>£<span class=\"chart__tooltip__amount\"></span></p></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/charts/monthly-payment.html", "<div class=\"lines__header\"><div class=\"lines__legend\"><div class=\"lines__legend__section lines__legend__section--green\"><span>Monthly mortgage payment</span><i></i></div><div class=\"lines__legend__section lines__legend__section--blue\"><span>Principal</span><i></i></div><div class=\"lines__legend__section lines__legend__section--red\"><span>Interest</span><i></i></div></div></div><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/charts/lines-tooltips.html'\"></div><div id=\"monthly-mortgage-chart\" class=\"pl-chart\" data-pl-lines=\"\"><div class=\"tabs--results__waterfall-placeholder\"></div></div><div class=\"lines__footer\"><div class=\"lines__tip charts__analysis\"><i class=\"i lines__tip__icon charts__analysis-info-icon\"></i><p>This chart shows monthly mortgage payments over the life of the mortgage assuming the interest rate stays constant over that term (as if you have a fixed-for-life interest rate). As you can see, you always pay the same monthly mortgage amount from year to year, however if we breakdown the monthly payment to its components, i.e. the interest and the principal repayment, you’ll notice that you pay more interest in early years. This is because the outstanding loan amount is higher in early years. As the size of the loan shrinks, so does the interest component, resulting in a higher percentage of your monthly payments paying back the loan.</p></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/dialog-conveyancing-quote.html", "<div class=\"dialog-content--conveyancing\"><button class=\"dialog-content__close-button\" data-ng-click=\"close()\"></button><div class=\"dialog-content__wrapper\"><h3>Your Legal Fees</h3><p class=\"dialog-content__intro\">Full breakdown of fees based on <strong>[[ conveyancing.buyingPropertyType ]]</strong> purchase of <strong data-ng-bind=\"conveyancing.purchasePrice | noFractionCurrency:'£'\"></strong>.</p><table><thead><tr><th></th><th>Fee</th><th>VAT</th></tr></thead><tbody><tr><td>Solicitor's fees</td><td data-ng-bind=\"conveyancing.fees.legalFees | currency:'£'\"></td><td data-ng-bind=\"conveyancing.fees.legalFees * 0.2 | currency:'£'\"></td></tr><tr data-ng-show=\"conveyancing.isFirstTimeBuyer\"><td>10% First Time Buyer Discount</td><td data-ng-bind=\"conveyancing.discount | currency:'£'\"></td><td data-ng-bind=\"conveyancing.discount * 0.2 | currency:'£'\"></td></tr><tr><td>Bank transfer fee (per transfer)</td><td data-ng-bind=\"conveyancing.fees.bankTransfer | currency:'£'\"></td><td data-ng-bind=\"conveyancing.fees.bankTransfer * 0.2 | currency:'£'\"></td></tr><tr><td>HMRC Completion Search Fees</td><td data-ng-bind=\"conveyancing.fees.hmrcCompletion | currency:'£'\"></td><td data-ng-bind=\"conveyancing.fees.hmrcCompletion * 0.2 | currency:'£'\"></td></tr><tr class=\"highlight\"><td>Our Fees To You</td><td data-ng-bind=\"conveyancing.priceGroup1Total | currency:'£'\"></td><td data-ng-bind=\"conveyancing.priceGroup1VAT | currency:'£'\"></td></tr></tbody><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>Stamp duty</td><td data-ng-bind=\"conveyancing.fees.stampDuty | noFractionCurrency:'£'\"></td><td>-</td></tr><tr><td>Land Registry fee</td><td data-ng-bind=\"conveyancing.fees.landRegistry | noFractionCurrency:'£'\"></td><td>-</td></tr><tr><td>Search Fees</td><td data-ng-bind=\"conveyancing.fees.search | noFractionCurrency:'£'\"></td><td data-ng-bind=\"conveyancing.fees.search * 0.2 | noFractionCurrency:'£'\"></td></tr><tr class=\"highlight\"><td>Total Disbursements</td><td data-ng-bind=\"conveyancing.priceGroup2Total | noFractionCurrency:'£'\"></td><td data-ng-bind=\"conveyancing.priceGroup2VAT | noFractionCurrency:'£'\"></td></tr><tr><td colspan=\"3\"></td></tr><tr class=\"highlight--blue\"><td>Grand Total inc. VAT</td><td data-ng-bind=\"conveyancing.grandTotal | noFractionCurrency:'£'\"></td><td></td></tr><tr><td colspan=\"3\"></td></tr><tr><td colspan=\"3\"><strong>Other Costs - Where Applicable</strong></td></tr><tr><td>New Build/Plot Purchase</td><td>£100.00</td></tr><tr><td>Buy to Let</td><td>£100.00</td></tr><tr><td>Shared Ownership</td><td>£100.00</td></tr></tbody></table><div class=\"dialog-content__buttons\"><button class=\"contact-button--solicitor--orange\" data-ng-click=\"this.close(); openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Solicitor</span> now</button></div></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/dialog-fees.html", "<div class=\"dialog-arrow\"></div><div class=\"dialog-content\" data-ng-controller=\"FeesDialogController\"><p class=\"dialog-content__intro\">You can change the estimated values provided below.</p><form><div class=\"dialog-content__fields\"><div class=\"inline-fieldset\" data-ng-repeat=\"fee in fees | toArray | orderBy:'displayIndex'\" data-ng-switch=\"fee.plusVAT\"><div class=\"inline-fieldset__label\"><div class=\"inline-fieldset__label-wrapper\">[[ fee.label ]] <span data-ng-show=\"fee.plusVAT\">([[ fee.fakeValue | noFractionCurrency:'£' ]] + VAT)</span></div></div><div class=\"input input--prepend inline-fieldset__field push--one-quarter\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-ng-model=\"fee.value\" required=\"\"></div></div><button class=\"dialog-content__close-button\" data-ng-click=\"close()\"></button></div><div class=\"dialog-content__buttons\"><button type=\"button\" class=\"btn--link\" data-ng-click=\"resetAllFees()\">Reset to default values</button></div><div class=\"dialog-content__total\">Total (incl. VAT): <span class=\"dialog-content__total-value\" data-ng-bind=\"totalFees | noFractionCurrency:'£'\"></span></div><div class=\"dialog-content__buttons\"><button class=\"btn--primary dialog-content__save-button\" data-ng-click=\"close(fees)\">Save</button><button class=\"btn dialog-content__cancel-button\" data-ng-click=\"close()\">Cancel</button></div></form></div>");
    $templateCache.put("/partials/views/calculators/affordability/includes/affordability-carousel.html", "<carousel interval=\"-1\"><slide class=\"grid grid--full\"><div class=\"carousel-heading\"><h3>Why to hire Advisors early on when purchasing a home</h3></div><div class=\"carousel-slide-left grid__item one-third\"><i class=\"i sprite-icon-affordability-solicitor-coach-mortgage-combo\"></i></div><div class=\"carousel-slide-right grid__item two-thirds\"><ul class=\"carousel-slide__list\"><li>Expert knowledge giving you confidence and <strong>peace of mind</strong></li><li>Advisers are <strong>unbiased</strong> and provide an independent service in your best interest</li><li>They have seen it all. Can help with standard and non-standard cases</li><li>Regulated and highly qualified adviserts - they have to justify their advice</li><li>Can leave you better off and <strong>save you time</strong></li><li>Advisers deal with all the admin and <strong>reduce stress</strong> and hassle</li><li>Access the best mortgage prducts and deals in the market</li><li>Hiring advisers early on can give you the edge in a competetive market</li></ul></div></slide><slide class=\"grid grid--full\"><div class=\"carousel-heading\"><h3>Get award winning, independent &amp; impartial mortgage advice, helping you to select the right mortgage for your dream home</h3></div><div class=\"carousel-slide-left grid__item one-sixth\"><i class=\"i sprite-icon-green-pound\"></i></div><div class=\"carousel-slide-right grid grid__item five-sixths\"><div class=\"grid__item two-thirds\"><p>Whether you're buying your first home, remortgaging or moving home, you should talk to an expert mortgage adviser.</p><ul class=\"carousel-slide__list\"><li>A dedicated mortgage adviser to help you through the process.</li><li>Whole of the market access to thousands of mortgage deals.</li><li>Someone who handles all the paperwork and liaises direct with your lender, saving you time &amp; work.</li><li>Regular updates about your application every step of the way.</li><li>Explaining the pros and cons of each producy in simple, jargon free manner.</li><li>Extensive knowledge of the market.</li><li>A mortgage for life</li></ul></div><div class=\"grid__item one-third\"><div class=\"yellow-box\"><h4>You need to know</h4><p>Your home may be repossessed if you do not keep up repayments on your mortgage.</p><p>A fee of up to 1% of the mortgage amount may be charged depending on individual circumstances. A typical fee is £495.</p><button class=\"contact-button--mortgage-advisor--green\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a<br><span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div></div></div></slide><slide class=\"grid grid--full\"><div class=\"carousel-heading\"><h3>The UK's best property lawyers - working with you every step of the way</h3></div><div class=\"carousel-slide-left grid__item one-sixth\"><i class=\"i sprite-icon-solicitor--big\"></i></div><div class=\"carousel-slide-right grid grid__item five-sixths\"><div class=\"grid__item two-thirds\"><ul class=\"carousel-slide__list\"><li>Accredited member of the Law Society's Conveyancing Quality Scheme</li><li>Pledge to the Conveyancing Association (CA), designed to make the process of buying a house smoother and more efficient</li><li>Transparency &amp; certainty</li><li>10% discount to First Time Buyers</li><li>No hidden costs</li><li>No success, no fee promise</li><li>Free first advice</li></ul></div><div class=\"grid__item one-third\"><div class=\"yellow-box\"><h4>Get a conveyancing quote</h4><form class=\"form\" data-ng-controller=\"ConveyancingFormController\"><div data-ng-hide=\"conveyancing.type=='selling'\"><div class=\"form__row grid\"><label class=\"form__label grid__item one-half\">Purchase price:</label><div class=\"input input--prepend inline-fieldset__field grid__item one-half\"><span class=\"input__add-on\">£</span><input type=\"text\" class=\"form__input input__field\" data-pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-ng-model=\"conveyancing.purchasePrice\" data-ng-change=\"onPurchasePriceChanged()\"></div></div><div class=\"form__row\"><span class=\"radio-input\"><label class=\"radio-input__label\"><input name=\"buying-property-type\" type=\"radio\" class=\"radio-input__field\" value=\"freehold\" data-ng-model=\"conveyancing.buyingPropertyType\">Freehold<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span><span class=\"radio-input\"><label class=\"radio-input__label\"><input name=\"buying-property-type\" type=\"radio\" class=\"radio-input__field\" value=\"leasehold\" data-ng-model=\"conveyancing.buyingPropertyType\">Leasehold<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span></div></div><div class=\"form__section\"><div class=\"form__row grid\"><label class=\"form__label grid__item two-thirds\">Legal fees ex VAT:</label><span class=\"form__fixed-value form__align-right\"><strong data=\"\" ng-hide=\"conveyancing.legalFeesOnRequest\" data-ng-bind=\"conveyancing.fees.legalFees | noFractionCurrency:'£'\"></strong><strong data=\"\" ng-show=\"conveyancing.legalFeesOnRequest\">On request</strong></span></div><div class=\"form__row\" data-ng-hide=\"conveyancing.type=='selling'\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"conveyancing.isFirstTimeBuyer\" data-ng-change=\"onPurchasePriceChanged()\">Are you a first time buyer?<span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span></div><div class=\"form__row\"><button type=\"button\" class=\"btn--link\" data-ng-click=\"openDialog('conveyancingQuote')\">See full quote</button></div></div></form><button class=\"contact-button--solicitor--orange\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Solicitor</span></button></div></div></div></slide><slide class=\"grid grid--full\"><div class=\"carousel-heading\"><h3>Need help finding the right property?<br>Our Property Coach Partners can help you answer your questions and find the most suitable property for your requirements.</h3></div><div class=\"carousel-slide--full\"><div class=\"property-coach__packages--small grid grid__item two-thirds\"><div class=\"property-coach__packages__coach-icon-overlay\"><i class=\"i sprite-icon-property-coach--blue--big\"></i></div><div class=\"property-coach__package--orientation grid__item one-half\"><h3>Not ready to buy yet?</h3><div class=\"property-coach__package-content\"><h4 class=\"property-coach__package-description\">The Rental <span>Stress free rental search</span></h4><ul class=\"property-coach__package-costs\"><li class=\"property-coach__package-cost\"><div class=\"property-coach__package-cost-amount\"><span>£</span>495</div><div class=\"property-coach__package-cost-type\">Retainer fee</div></li><li class=\"property-coach__package-cost\"><div class=\"property-coach__package-cost-amount\"><span>1 month rent</span></div><div class=\"property-coach__package-cost-type\">Success fee</div></li></ul></div></div><div class=\"property-coach__package--unlimited grid__item one-half\"><h3>Ready to buy a property</h3><div class=\"property-coach__package-content\"><h4 class=\"property-coach__package-description\">The Purchase <span>3 months, unlimited properties</span></h4><ul class=\"property-coach__package-costs\"><li class=\"property-coach__package-cost\"><div class=\"property-coach__package-cost-amount\"><span>£</span>495</div><div class=\"property-coach__package-cost-type\">Retainer fee</div></li><li class=\"property-coach__package-cost\"><div class=\"property-coach__package-cost-amount\">1.5<span>%</span></div><div class=\"property-coach__package-cost-type\">Success fee</div></li></ul></div></div></div><div class=\"grid__item one-third\"><p><strong>Every Property Coach is</strong></p><ul class=\"carousel-slide__list carousel-slide__list--property-coach\"><li>An expert in property buying</li><li>Master of negotiation</li><li>Someone you can trust and actually talk to</li></ul><p><strong>Our commitment to You</strong></p><ul class=\"carousel-slide__list carousel-slide__list--property-coach\"><li>Stress Free. Guaranteed</li><li>Unlimited access</li><li>White glove treatment</li><li>No conflicts</li></ul></div></div></slide></carousel>");
    $templateCache.put("/partials/views/calculators/affordability/includes/our-customer-feedback.html", "<div class=\"affordability-results__feedback\"><div class=\"affordability-results__feedback-heading\"><h3>Our customer feedback</h3></div><carousel interval=\"-1\"><slide class=\"grid\"><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]images/affordability-laptop.8a2d6c62.png\"></div><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]images/affordability-laptop.8a2d6c62.png\"></div><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]images/affordability-laptop.8a2d6c62.png\"></div></slide><slide class=\"grid\"><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]images/affordability-laptop.8a2d6c62.png\"></div><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]{% versioned_image 'images/affordability-laptop.png'\"></div><div class=\"affordability-results__feedback-item\"><div class=\"feedback\"><p class=\"feedback-text\">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p><div class=\"feedback-author\"><span class=\"name\">Harry Khan</span><span class=\"job-title\">Architect</span></div></div><img width=\"90\" height=\"90\" ng-src=\"[[ STATIC_URL ]]images/affordability-laptop.8a2d6c62.png\"></div></slide></carousel></div>");
    $templateCache.put("/partials/views/calculators/affordability/includes/what-we-promise.html", "<div class=\"affordability-results__promise\"><div class=\"affordability-results__promise-heading\"><h3>What we promise</h3></div><div class=\"affordability-results__promise-item--expert\"><i class=\"sprite-affordability-expert\"></i><h4>Expert Recommendations</h4><p>Topics include: Savings, debt, credit, real estate, retirement, insurance, estate planning. Available as a printable document.</p></div><div class=\"affordability-results__promise-item--phone\"><i class=\"sprite-affordability-phone\"></i><h4>Unlimited Phone Consultations</h4><p>Topics include: Savings, debt, credit, real estate, retirement, insurance, estate planning. Available as a printable document.</p></div><div class=\"affordability-results__promise-item--email\"><i class=\"sprite-affordability-email\"></i><h4>Unlimited Email Access</h4><p>Topics include: Savings, debt, credit, real estate, retirement, insurance, estate planning. Available as a printable document.</p></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/tab-input.html", "<form class=\"affordability-input\" data-ng-show=\"caseData\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Our affordability calculator is designed to help you determine how much house you could potentially afford. The calculator provides an illustration only and does not contain all of the details you need to choose a mortgage. Calculations results should not be considered as a quote.</p><div class=\"affordability-input__applicants\"><div data-ng-repeat=\"applicant in caseData.applicants\" class=\"affordability-input__applicant\"><h3 data-ng-bind=\"applicantName($index)\"></h3><button aria-label=\"Delete\" class=\"icon-button icon-button--inline icon-button--delete\" data-ng-show=\"canDeleteApplicant($index)\" data-ng-click=\"deleteApplicant($index)\"></button><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><span class=\"inline-fieldset__label-text\">Annual income (before tax)</span><div data-pl-help-prompt=\"\" class=\"help-prompt help-prompt--wide\"><p>For Self Employed use the lower of your income from the last 12 months, or the average of the last 2 years accounts.</p><p>Typical income used:<br>- Sole Trader / Partnership – net profit<br>- Ltd. Company Director – Director’s remuneration and share of dividends</p><p>Directors with a shareholding of 20-25% or less are usually treated as employed applicants.</p></div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"annual-income\" step=\"any\" class=\"input__field\" data-ng-model=\"applicant.grossAnnualIncome\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-class=\"{'ng-invalid': affordabilityForm.grossAnnualIncome.invalid}\" data-ng-blur=\"affordabilityForm.grossAnnualIncome.showErrors=false\" data-ng-focus=\"affordabilityForm.grossAnnualIncome.showErrors=true\"><span class=\"account-form__error\" data-ng-show=\"affordabilityForm.grossAnnualIncome.showErrors && affordabilityForm.grossAnnualIncome.invalid\"><i></i><span data-ng-bind=\"affordabilityForm.grossAnnualIncome.errorMessage\"></span></span></div><select data-ui-select2=\"employmentStatusDropdownOptions\" name=\"ibe-period\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"applicant.employmentStatus\"><option data-ng-repeat=\"o in employmentStatuses\" value=\"[[o.value]]\">[[o.label]]</option></select></div></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><span class=\"inline-fieldset__label-text\">Annual bonus &amp; other (before tax)</span><div data-pl-help-prompt=\"\" class=\"help-prompt\">The 50% of this amount will be added to your gross annual income for several calculations in the Results tab.</div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"annual-bonus\" step=\"any\" class=\"input__field\" data-ng-model=\"applicant.grossAnnualBonus\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></div></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><span class=\"inline-fieldset__label-text\">Monthly income (after tax)</span><div data-pl-help-prompt=\"\" class=\"help-prompt\">Everyone's tax circumstances are different. So we ask here how much your monthly take home pay is. If you're employed, you can find it in your pay slips or bank statements.</div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"monthly-income\" step=\"any\" class=\"input__field\" data-ng-model=\"applicant.netMonthlyIncome\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-class=\"{'ng-invalid': affordabilityForm.netMonthlyIncome.invalid}\" data-ng-blur=\"affordabilityForm.netMonthlyIncome.showErrors=false\" data-ng-focus=\"affordabilityForm.netMonthlyIncome.showErrors=true\"><span class=\"account-form__error\" data-ng-show=\"affordabilityForm.netMonthlyIncome.showErrors && affordabilityForm.netMonthlyIncome.invalid\"><i></i><span data-ng-bind=\"affordabilityForm.netMonthlyIncome.errorMessage\"></span></span></div></div><button class=\"btn--link\" type=\"button\" data-ng-show=\"totalMonthlyIncome != 0 && applicant.netMonthlyIncome != totalMonthlyIncome\" data-ng-click=\"applicant.netMonthlyIncome = totalMonthlyIncome\"><span class=\"affordability-input__cross-link\">Reset with <span data-ng-bind=\"totalMonthlyIncome | noFractionCurrency:'£'\"></span> from Budget Planner?</span></button><a href=\"/calculators/budget/\" class=\"affordability-input__cross-link\" data-ng-show=\"totalMonthlyIncome == 0 || applicant.netMonthlyIncome == totalMonthlyIncome\">Refine using Budget Planner</a></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><span class=\"inline-fieldset__label-text\">Age</span><div data-pl-help-prompt=\"\" class=\"help-prompt\">You'll need to be at least 18 years old to apply for a mortgage.</div></div><div class=\"inline-fieldset__field-row\"><input type=\"number\" name=\"age\" step=\"any\" class=\"input__field affordability-input__applicant-age\" data-ng-model=\"applicant.age\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-class=\"{'ng-invalid': affordabilityForm.age[$index].invalid}\" data-ng-blur=\"affordabilityForm.age[$index].showErrors=false\" data-ng-focus=\"affordabilityForm.age[$index].showErrors=true\"><span class=\"account-form__error\" data-ng-show=\"affordabilityForm.age[$index].showErrors && affordabilityForm.age[$index].invalid\"><i></i><span data-ng-bind=\"affordabilityForm.age[$index].errorMessage\"></span></span></div></fieldset></div><button class=\"btn btn--new-item\" data-ng-click=\"addApplicant()\" data-ng-show=\"canAddApplicant()\">+ Add another applicant</button></div><fieldset class=\"inline-fieldset\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Enter your monthly expenses below. If you're a first time buyer or you're a home mover, exclude your current rent or mortgage expenses as we'll use this figure to calculate how much mortgage you can afford. If you're buying a second property, you can include your current mortgage as the new mortgage will come on top.</p><div class=\"inline-fieldset__label inline-fieldset__label-monthy-expenses\"><span class=\"inline-fieldset__label-text\">Monthly expenses<span class=\"inline-fieldset__label-subtext\" data-ng-show=\"caseData.monthlyExpenses == totalMonthlyExpense\"><span data-ng-show=\"!mortgagePaymentExpense.ongoing && !rentExpense.ongoing\"><span data-ng-show=\"mortgagePaymentExpense.amount > 0 && rentExpense.amount > 0\">excl. <span data-ng-bind=\"mortgagePaymentExpense.amount | noFractionCurrency:'£'\"></span> of current mortgage and <span data-ng-bind=\"rentExpense.amount | noFractionCurrency:'£'\"></span> rent</span><span data-ng-show=\"mortgagePaymentExpense.amount > 0 && rentExpense.amount == 0\">excl. <span data-ng-bind=\"mortgagePaymentExpense.amount | noFractionCurrency:'£'\"></span> of current mortgage</span><span data-ng-show=\"mortgagePaymentExpense.amount == 0 && rentExpense.amount > 0\">excl. <span data-ng-bind=\"rentExpense.amount | noFractionCurrency:'£'\"></span> of current rent</span></span><span data-ng-show=\"(mortgagePaymentExpense.ongoing || rentExpense.ongoing) && mortgagePaymentExpense.amount > 0\">incl. <span data-ng-bind=\"mortgagePaymentExpense.amount | noFractionCurrency:'£'\"></span> of current mortgage</span></span></span><span data-pl-help-prompt=\"\" class=\"help-prompt\">Enter monthly expenses excluding your current housing expense if this will be replaced when you buy a property.</span></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" pl-data-threshold=\"\" data-thresholdmessage=\"Your current monthly expenses are too high compared to your indicated monthly income. To access the affordability results, you can reduce your stated expenses or increase your income.\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field input__field--threshold\" data-ng-model=\"caseData.monthlyExpenses\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"><input type=\"hidden\" class=\"data-threshold-value\" value=\"[[ totalIncome() ]]\"></div></div><button class=\"btn--link\" type=\"button\" data-ng-show=\"totalMonthlyExpense != 0 && caseData.monthlyExpenses != totalMonthlyExpense\" data-ng-click=\"caseData.monthlyExpenses = totalMonthlyExpense\"><span class=\"affordability-input__cross-link\">Reset with <span data-ng-bind=\"totalMonthlyExpense | noFractionCurrency:'£'\"></span> from Budget Planner?</span></button><a href=\"/calculators/budget/\" class=\"affordability-input__cross-link\" data-ng-show=\"totalMonthlyExpense == 0 || caseData.monthlyExpenses == totalMonthlyExpense\">Refine using Budget Planner</a></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><span class=\"inline-fieldset__label-text\">Savings for deposit</span></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"savings\" step=\"any\" min=\"5000\" class=\"input__field\" data-ng-model=\"caseData.savings\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-class=\"{'ng-invalid': affordabilityForm.savings.invalid}\" data-ng-blur=\"affordabilityForm.savings.showErrors=false\" data-ng-focus=\"affordabilityForm.savings.showErrors=true\"><span class=\"account-form__error\" data-ng-show=\"affordabilityForm.savings.showErrors && affordabilityForm.savings.invalid\"><i></i><span data-ng-bind=\"affordabilityForm.savings.errorMessage\"></span></span></div></div><button class=\"btn--link\" type=\"button\" data-ng-show=\"realNetWorth > 0 && caseData.savings != realNetWorth\" data-ng-click=\"caseData.savings = realNetWorth\"><span class=\"affordability-input__cross-link\">Reset with <span data-ng-bind=\"realNetWorth | noFractionCurrency:'£'\"></span> from Net Worth Planner?</span></button><a href=\"/calculators/net-worth/\" class=\"affordability-input__cross-link\" data-ng-show=\"realNetWorth <= 0 || caseData.savings == realNetWorth\">Refine using Net Worth Planner</a></fieldset></form><footer><p><a data-ng-click=\"showResults()\" class=\"btn t-btn-next btn--icon-right\">Next <i class=\"i i-next\"></i></a></p></footer>");
    $templateCache.put("/partials/views/calculators/affordability/tab-results.html", "<button class=\"btn--optimise affordability-results__optimise-btn\" data-ng-click=\"optimise()\" data-ng-disabled=\"isOptimised()\"><i></i>Optimise</button><div class=\"grid\"><div class=\"affordability-results__results-section--left\"><div class=\"affordability-results__results-section-wrapper\"><h3 class=\"affordability-results__results-section-heading\">Deposit</h3><div class=\"affordability-results__results-section-col--left\"><div class=\"affordability-results__indicator-currency\"><div class=\"editable-label\" data-pl-editable-label=\"\" data-ng-model=\"caseData.overriddenVars.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"caseData.overriddenVars.savings\" data-ng-change=\"savingsValueChanged()\"></div></div></div><div class=\"affordability-results__slider\"><span class=\"minus\">-</span><slider data-ng-model=\"caseData.overriddenVars.savings\" on-changed=\"savingsValueChanged\" max=\"[[savingsSliderMaxValue]]\" min=\"0\"></slider><span class=\"plus\">+</span></div></div><div class=\"affordability-results__results-section-col--right\"><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Total savings:</span><span class=\"affordability-results__result-value\" data-ng-bind=\"caseData.overriddenVars.savings | noFractionCurrency:'£'\"></span></div><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Stamp duty:<div data-pl-help-prompt=\"\" class=\"help-prompt help-prompt__data\">What Stamp Duty rate will I pay?<table><tr><th>Purchase price</th><th>Stamp duty rate</th></tr><tr><td>Up to £125,000</td><td>0%</td></tr><tr><td>£125,000.01 - £250,000</td><td>1%</td></tr><tr><td>£250,000.01 - £500,000</td><td>3%</td></tr><tr><td>£500,000.01 - £1,000,000</td><td>4%</td></tr><tr><td>£1,000,000.01 - £2,000,000</td><td>5%</td></tr><tr><td>£2,000,000.01 +</td><td>7%</td></tr></table><span class=\"help-prompt__subtext\">Correct at July 2013</span></div></span><span class=\"affordability-results__result-value\" data-ng-bind=\"housePriceData.stampDuty | noFractionCurrency:'£'\"></span></div><div class=\"affordability-results__result--other-fees\"><span class=\"affordability-results__result-label\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button></span><span class=\"affordability-results__result-value\" data-ng-bind=\"caseData.overriddenVars.otherFees | noFractionCurrency:'£'\"></span><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></div><div class=\"affordability-results__result--total\"><span class=\"affordability-results__result-label\">Deposit:<div data-pl-help-prompt=\"\" class=\"help-prompt\">Money used as a down payment on a house.</div></span><span class=\"affordability-results__result-value affordability-results__indicator-currency--[[depositIndicator()]]\" data-ng-bind=\"housePriceData.deposit | noFractionCurrency:'£'\"></span></div><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Excess cash:<div data-pl-help-prompt=\"\" class=\"help-prompt help-prompt__compact\">In situations where using all your savings would take you ever so slightly above the next stamp duty threshold, our algorithm suggests that you make an offer right on the stamp duty level. This saves you some money and we call that amount excess cash. For example, by offering £500,000 instead of £502,000, you can save £5,080 on taxes. So it doesn't make sense to offer £2,000 more which would end up costing you £7,080.</div></span><span class=\"affordability-results__result-value affordability-results__indicator-currency--[[affordabilityIndicator()]]\" data-ng-bind=\"housePriceData.excessCash | noFractionCurrency:'£'\"></span></div></div></div></div><div class=\"affordability-results__results-section--right\"><div class=\"affordability-results__results-section-wrapper--house-price [[affordabilityIndicator()]]\"><div class=\"affordability-results__results-section-wrapper--house-price__wrapper\"><span>House Price:</span> <span class=\"price\" data-ng-bind=\"housePriceData.price | noFractionCurrency:'£'\"></span></div><div class=\"affordability-results__results-section-wrapper--house-price__infotext\">For illustration purposes only. Results should not be considered as financial advice or mortgage quote.</div></div><div class=\"affordability-results__results-section-wrapper--search\"><div class=\"place-search\" data-pl-places-search=\"\"><p>Where do you want to search?:</p><div class=\"place-search__query-container\"><input type=\"text\" class=\"input place-search__suggestion-input\" data-ng-model=\"inplaceSuggestion\"><input type=\"text\" class=\"input place-search__query-input\" data-pl-places-search-input=\"\" autocomplete=\"off\" data-ng-model=\"searchLocation\" placeholder=\"e.g. Oxford or NW3\"></div><a data-ng-href=\"/property-search/?search.area=[[searchLocation]]&amp;search.calculated_price=[[housePriceData.price]]\" class=\"btn--search\"><span><i></i></span>Search</a><div data-pl-places-search-suggestions=\"\" class=\"place-search__results\" data-ng-model=\"searchLocation\" data-ng-show=\"response.suggestions\"><ul class=\"place-search__results__list place-search__results__list--places\"><li class=\"place-search__results__list-item\" data-ng-repeat=\"suggestion in response.suggestions\" data-ng-class=\"{ 'is-highlighted': $index == highlightedIndex }\" data-ng-click=\"selectAndClose($index)\"><span data-ng-switch=\"suggestion.type\"><span data-ng-switch-when=\"place/area\"><span data-ng-bind-html=\"suggestion.value | plPlacesSearchSuggestionHighlighter:response.original_query\"></span></span><span data-ng-switch-when=\"postcode\"><span class=\"place-search__results__list-item__postcode\" data-ng-bind-html=\"suggestion.code | plPlacesSearchSuggestionHighlighter:response.original_query\"></span> <span class=\"place-search__results__list-item__postcode-area\" data-ng-bind-html=\"suggestion.area\"></span></span></span></li></ul></div></div></div></div></div><div class=\"grid\"><div class=\"affordability-results__results-section--left\"><div class=\"affordability-results__results-section-wrapper\"><h3 class=\"affordability-results__results-section-heading\">Mortgage Value</h3><div class=\"affordability-results__results-section-col--left\"><div class=\"affordability-results__indicator-currency--[[affordabilityIndicator()]]\"><div class=\"editable-label\" data-pl-editable-label=\"\" data-ng-model=\"caseData.overriddenVars.mortgageValue\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" required=\"\" data-ng-model=\"caseData.overriddenVars.mortgageValue\" data-ng-change=\"mortgageValueChanged()\"></div></div></div><div class=\"affordability-results__slider\"><span class=\"minus\">-</span><slider class=\"affordability-results__slider\" data-ng-model=\"caseData.overriddenVars.mortgageValue\" max=\"[[mortgageSliderMaxValue]]\" min=\"0\" on-sliding=\"mortgageValueChanged\"></slider><span class=\"plus\">+</span></div></div><div class=\"affordability-results__results-section-col--right\"><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label affordability-results__result-label--ltv\">LTV:<div data-pl-help-prompt=\"\" class=\"help-prompt help-prompt__compact\">Loan-to-value: the measure of how much of a property's value you are borrowing</div></span><span class=\"affordability-results__result-value affordability-results__result-value--ltv\"><span data-ng-bind=\"housePriceData.ltv | percentage\"></span><i class=\"indicator--medium indicator--[[loanToValueColor()]]\"></i></span></div><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Mortgage term:</span><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"caseData.overriddenVars.mortgageTerm\" required=\"\" data-ng-change=\"mortgageTermChanged()\"><span class=\"input__add-on\">y</span></div></div><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Interest rate: <button class=\"btn--link\" type=\"button\" data-ng-click=\"caseData.overriddenVars.interestRateIsOverridden = false; caseData.overriddenVars.interestRate = caseData.overriddenVars.defaultInterestRate\" data-ng-show=\"caseData.overriddenVars.interestRateIsOverridden\">Reset</button></span><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" data-pl-focus=\"\" data-ng-model=\"caseData.overriddenVars.interestRate\" data-ng-change=\"interestRateChanged()\" required=\"\"><span class=\"input__add-on\">%</span></div></div><div class=\"affordability-results__result\"><span class=\"affordability-results__result-label\">Monthly payment:<div data-pl-help-prompt=\"\" class=\"help-prompt\">The repayment amount that you would have to pay each month over the entire mortgage term.</div></span><span class=\"affordability-results__result-value\" data-ng-bind=\"housePriceData.mortgagePayment | noFractionCurrency:'£'\"></span></div></div><h3 class=\"affordability-results__results-section-heading--indicators\">Indicators</h3><div class=\"affordability-results__indicators\" data-pl-tabset=\"indicatorsTabset\" data-pl-css-block-modifier=\"affordability-results__indicators-tabs\"><div data-pl-tab=\"\"><div data-pl-tab-heading=\"\"><span class=\"affordability-results__indicators-heading\"><i class=\"indicator--medium indicator--[[mortgageMultiplierIndicator()]]\"></i><span class=\"heading\">Annual Salary Multiple for Mortgage Amount</span><span class=\"subheading\"><span data-ng-bind=\"housePriceData.incomeMultiple | number:2\"></span>x</span></span></div><div class=\"affordability-results__indicator__content\"><p>The average loan that a lender would extend to you is around 3.5-4.5x your gross annual income. Individuals with a strong credit history and a good mortgage broker may be able to borrow up to 5.0-6.0x their annual income. We use 4.25x and 5.5x as average thresholds.</p></div></div><div data-pl-tab=\"\"><div data-pl-tab-heading=\"\"><span class=\"affordability-results__indicators-heading\"><i class=\"indicator--medium indicator--[[incomeIndicator()]]\"></i><span class=\"heading\">% of Income Used for Mortgage Payment</span><span class=\"subheading\" data-ng-bind=\"housePriceData.mortgageIncomeRatio | percentage\"></span></span></div><div class=\"affordability-results__indicator__content\"><p>While you may find lenders willing to lend you more, we strongly recommend keeping total fixed monthly payments to less than 35% of your monthly net income.</p></div></div><div data-pl-tab=\"\"><div data-pl-tab-heading=\"\"><span class=\"affordability-results__indicators-heading\"><i class=\"indicator--medium indicator--[[disposableIncomeIndicator()]]\"></i><span class=\"heading\">% of Disposable Income Used for Mortgage Payment</span><span class=\"subheading\" data-ng-bind=\"housePriceData.mortgageDisposableIncomeRatio | percentage\"></span></span></div><div class=\"affordability-results__indicator__content\"><p>While you may find lenders willing to lend you more, we strongly recommend keeping total fixed monthly payments to less than 75% of your <a data-pl-help-prompt-inline=\"\" href=\"\" title=\"net income minus all monthly expenses except for current accommodation expenses such as rent or mortgage\">monthly disposable income</a>.</p></div></div></div></div></div><div class=\"affordability-results__results-section--right\"><div class=\"affordability-results__results-section-wrapper\"><div class=\"affordability-results__advice\"><p>We recommend you look at homes priced at <strong data-ng-bind=\"optimisedHousePriceData.price | noFractionCurrency:'£'\"></strong> or less.</p><p>Given your annual income of <strong><span data-ng-bind=\"totalGrossAnnualIncome() | noFractionCurrency:'£'\"></span></strong>, savings of <strong><span data-ng-bind=\"caseData.savings | noFractionCurrency:'£'\"></span></strong>, monthly disposable income of <strong><span data-ng-bind=\"disposableIncome() | noFractionCurrency:'£'\"></span></strong> and assuming you have good credit, you might qualify for a <strong><span data-ng-bind=\"optimisedHousePriceData.loanSize | noFractionCurrency:'£'\"></span></strong> loan. With a <strong><span data-ng-bind=\"optimisedMortgageTerm()\"></span> year</strong> mortgage term and an approximate rate of <strong data-ng-bind=\"optimisedHousePriceData.mortgageRate | percentage:2\"></strong> based on <strong><span data-ng-bind=\"optimisedHousePriceData.ltv | percentage\"></span> LTV</strong>, your mortgage payments would be <strong><span data-ng-bind=\"optimisedHousePriceData.mortgagePayment | noFractionCurrency:'£'\"></span> per month.</strong></p></div><div class=\"affordability-results__advisors\"><h4>Speak to a trusted advisor</h4><ul class=\"advisor-list\"><li class=\"mortgage\"><a data-ng-click=\"openDialog('mortgageAdvisor')\"><span><i></i></span>Mortgage</a></li><li class=\"solicitor\"><a data-ng-click=\"openDialog('solicitor')\"><span><i></i></span>Solicitor</a></li><li class=\"property-coach\"><a data-ng-click=\"openDialog('propertyCoach')\"><span><i></i></span>Property Coach</a></li></ul></div></div><div class=\"affordability-results__results-section-wrapper affordability-results__credit-score\"><a href=\"http://www.creditexpert.co.uk/index.aspx\" target=\"_blank\"><h4>Get your credit score</h4><div>A free 30-days trial of CreditExpert</div><a href=\"http://www.dpbolvw.net/click-7261416-10468794\" target=\"_blank\"><img src=\"http://www.lduhtrp.net/image-7261416-10468794\" width=\"1\" height=\"1\" border=\"0\"><img ng-src=\"[[ STATIC_URL ]]images/experian.39538328.jpg\" alt=\"Experian CreditExpert logo\"></a></a></div></div></div><div class=\"affordability-results__carousel\" data-ng-include=\"'/partials/views/calculators/affordability/includes/affordability-carousel.html'\"></div><div class=\"affordability-results__small-print\"><div class=\"affordability-results__small-print-heading\"><h3>Assumption / Disclaimers</h3></div><div class=\"affordability-results__small-print-body\"><dl><dt>Maximum home price</dt><dd>The maximum home price of <strong class=\"price\" data-ng-bind=\"housePriceData.price | noFractionCurrency:'£'\"></strong> is calculated taking into account your savings, stamp duty levels and the maximum mortgage loan amount you might qualify for.</dd><dt>Stamp Duty</dt><dd>If you buy a property in the UK, you have to pay Stamp Duty Land Tax (SDLT). This is charged on all purchases of houses, flats and other land and buildings. The maximum home price of <strong class=\"price\" data-ng-bind=\"housePriceData.price | noFractionCurrency:'£'\"></strong> falls within the <strong data-ng-bind=\"housePriceData.stampDutyPercentage | percentage\"></strong> stamp duty bracket, resulting in a <strong data-ng-bind=\"housePriceData.stampDuty | noFractionCurrency:'£'\"></strong> tax expense that you would need to pay at completion.</dd><dt>Other fees</dt><dd>Approximate other fees you have to pay during the buying process for the property will be around <strong data-ng-bind=\"caseData.overriddenVars.otherFees | noFractionCurrency:'£'\"></strong>. This figure is made up of solicitor fees, mortgage related fees, land registry and local authority searches, and any other miscellaneous fees arising during the process.</dd><dt>Mortgage loan amount</dt><dd>Calculated using your financial information and an approximation of lenders’ underwriting criteria. When you press “Optimize”, our calculator finds the maximum mortgage loan amount which satisfies all criteria thereby making all indicators green. According to our calculations, you may qualify for a <strong data-ng-bind=\"caseData.overriddenVars.mortgageValue | noFractionCurrency:'£'\"></strong> loan which is <strong><span data-ng-bind=\"housePriceData.incomeMultiple | number:2\"></span>x</strong> of your gross annual income. Given your savings of <strong data-ng-bind=\"caseData.overriddenVars.savings | noFractionCurrency:'£'\"></strong> and taking into account stamp duty and other expenses, you can use <strong data-ng-bind=\"housePriceData.deposit | noFractionCurrency:'£'\"></strong> towards a mortgage deposit, resulting in <strong data-ng-bind=\"housePriceData.ltv | percentage\">loan-to-value (LTV)</strong>. Note that we assume you have a good credit score.</dd><dt>Excess cash</dt><dd>In situations where using all your savings would take you ever so slightly above the next stamp duty threshold, our algorithm suggests that you make an offer right on the stamp duty level. This saves you some money and we call that amount excess cash. For example, by offering £500,000 instead of £502,000, you can save £5,080 on taxes. So it doesn't make sense to offer £2,000 more which would end up costing you £7,080.</dd><dt>Mortgage Rate</dt><dd>We use an approximate average tracker mortgage rate that varies with the LTV and we update our rates table regularly to reflect current market conditions. You may or may not qualify for this rate depending on your specific circumstances.</dd><dt>LTV</dt><dd>The loan-to-value (LTV) ratio is a financial term used by lenders to express the ratio of a loan to the value of an asset purchased.</dd><dt>Monthly mortgage payment</dt><dd>Using a <strong><span data-ng-bind=\"caseData.overriddenVars.mortgageTerm\"></span> year</strong> mortgage term and an interest rate of <strong><span data-ng-bind=\"caseData.overriddenVars.interestRate.toFixed(2)\"></span>%</strong> your mortgage payments would be <strong><span data-ng-bind=\"housePriceData.mortgagePayment | noFractionCurrency:'£'\"></span> per month.</strong></dd><dt>Important Note</dt><dd><strong>Your home may be repossessed if you do not keep up repayments on a mortgage or any debt secured upon it.</strong></dd></dl></div></div>");
    $templateCache.put("/partials/views/calculators/affordability/tab-sensitivities.html", "<p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Information line about how the chart below works.</p><ul class=\"results-summary\"><li class=\"results-summary__item results-summary__item--first\"><span class=\"results-summary__title\">Estimated house price</span><span class=\"results-summary__amount results-summary__amount--green\" data-ng-bind=\"housePriceData.price | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item results-summary__item--small\"><span class=\"results-summary__title\">Mortgage amount</span><span class=\"results-summary__amount\" data-ng-bind=\"caseData.overriddenVars.mortgageValue | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item results-summary__item--small\"><span class=\"results-summary__title\">Deposit</span><span class=\"results-summary__amount\" data-ng-bind=\"housePriceData.deposit | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Interest rate</span><span class=\"results-summary__amount results-summary__amount--percentage\" data-ng-bind=\"caseData.overriddenVars.interestRate | number:2\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Mortgage term</span><span class=\"results-summary__amount\" data-ng-bind=\"caseData.overriddenVars.mortgageTerm\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Mortgage payment</span><span class=\"results-summary__amount\" data-ng-bind=\"housePriceData.mortgagePayment | noFractionCurrency:'£'\"></span></li></ul><div data-pl-tabset=\"sensitivitiesSubTabs\" data-pl-css-block-modifier=\"buttons\" callback=\"drawAffordabilityChart\"><div data-pl-tab=\"\" data-pl-tab-title=\"Interest Rate Sensitivity\" data-pl-tab-callback=\"interestRate\"><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/charts/interest-rate.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Monthly Mortgage Payment\" data-pl-tab-callback=\"monthlyMortgage\"><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/charts/monthly-payment.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Equity Growth\" data-pl-tab-callback=\"equityGrowth\"><div ng-include=\"\" src=\"'/partials/views/calculators/affordability/charts/equity-growth.html'\"></div></div></div>");
    $templateCache.put("/partials/views/calculators/budget.html", "<nav data-pl-page-subnav=\"budget\" class=\"page-subnav\"></nav><div class=\"page-content page-content--calculators\"><h1 class=\"intro-heading\">Estimate your monthly budget</h1><p>It's essential to have a good understanding of all your income, your expenses and their breakdown, and the remaining sum after you’ve deducted your expenses from your income. The outcome of this exercise lets you see where your money is being spent, and helps you to find areas for cutting down on expenses.</p><section id=\"content-pane\" class=\"content-pane\"><h2>Calculate Budget</h2><div class=\"calc-summary-panel\"><div class=\"calc-summary-panel__section calc-summary-panel__section--positive\"><span class=\"calc-summary-panel__section-title\">Income <span class=\"sub-title\">(after tax)</span></span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"totalIncome | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--negative\"><span class=\"calc-summary-panel__section-title\">Expenses</span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"totalExpenses() | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--result negative-[[isDisposableIncomeNegative()]]\"><span class=\"calc-summary-panel__section-title\">Remainder</span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"cachedValues.disposableIncome | noFractionCurrency:'£'\">0</span></span></div></div><div class=\"content-pane__inset\"><div data-pl-tabset=\"budgetTabset\" data-pl-css-block-modifier=\"main\" callback=\"drawWaterfall\"><div data-pl-tab=\"\" data-pl-tab-title=\"Income\"><div ng-include=\"\" src=\"'/partials/views/calculators/budget/tab-income.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Expenses\" data-pl-tab-selected=\"tabChanged\"><div ng-include=\"\" src=\"'/partials/views/calculators/budget/tab-expenses.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Result\"><div ng-include=\"\" src=\"'/partials/views/calculators/budget/tab-results.html'\"></div></div></div></div><div class=\"calculators__spinner\" data-pl-spinner=\"showSpinner\" data-pl-spinner-config=\"DEFAULT\"></div></section></div>");
    $templateCache.put("/partials/views/calculators/budget/tab-expenses.html", "<form><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Please enter your expense details for each category below.</p><div data-pl-tabset=\"expensesTabset\" data-pl-css-block-modifier=\"wizard\" data-pl-tabset-callback=\"tabChanged()\"><div data-ng-repeat=\"expenseCategory in expensesStructure\" class=\"expensecategory-[[$index]] expensecategory-[[expenseCategory.slug]]\"><div data-pl-tab=\"\"><span data-pl-tab-heading=\"\" class=\"tabs--wizard__tab-header__wrap tabs--wizard__tab-header__wrap--[[expenseCategory.slug]]\"><i class=\"i tabs--wizard__tab-header__icon\"></i><span class=\"tabs--wizard__tab-header__label\" data-ng-bind=\"expenseCategory.title\"></span><span class=\"tabs--wizard__tab-header__summary\"><span class=\"tabs--wizard__tab-header__summary-value\" data-ng-bind=\"expensesCategoryTotal(expenseCategory) | noFractionCurrency:'£'\"></span> /mth</span></span><ol class=\"expense-tree\"><li data-ng-repeat=\"categoryItem in expenseCategory.items\" data-ng-switch=\"isObject(categoryItem.items)\" class=\"expense-tree__entry\"><div class=\"expense-tree__entry-item--group expense-row\" data-ng-switch-when=\"true\"><div class=\"expense-tree__group-header\"><div class=\"expense-tree__group-header__title\"><span class=\"t-item-title\" data-ng-bind=\"categoryItem.title\"></span></div><div class=\"expense-tree__group-header__total\"><span class=\"expense-tree__total\" data-ng-bind=\"expensesGroupTotalBySlug(categoryItem.items, expenseCategory.slug) | noFractionCurrency:'£'\"></span></div><div data-ng-show=\"canBeOngoing(categoryItem)\" class=\"inline-fieldset__is-ongoing expense-row__expense--is-ongoing\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"categoryItem.ongoing\" data-ng-change=\"ongoingItemChanged(categoryItem)\" data-ng-checked=\"isOngoing(categoryItem)\"><a data-ng-hide=\"categoryItem.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're moving home, keep this unticked as this expense will be replaced with your new mortgage. If you're buying a buyt-to-let property, tick this box.\"><span class=\"checkbox-input__label__text\">Ongoing after purchase?</span></a><a data-ng-show=\"categoryItem.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're moving home, keep this unticked as this expense will be replaced with your new mortgage. If you're buying a buyt-to-let property, tick this box.\"><span class=\"checkbox-input__label__text\">This is ongoing after purchase</span></a><span class=\"checkbox-input__background--blue\"></span><span class=\"checkbox-input__active-icon--blue\"></span></label></span></div></div><div class=\"expense-tree__row\" data-ng-repeat=\"item in categoryItem.items\"><fieldset class=\"inline-fieldset\" data-ng-repeat=\"expense in expensesInCategoryBySlug(item, expenseCategory.slug)\"><div class=\"inline-fieldset__label\"><div class=\"inline-fieldset__label-wrapper\"><span class=\"t-item-title expense-tree__item-subtitle\" data-ng-bind=\"expense.title\"></span></div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"expense.amount\"></div><select data-ui-select2=\"frequencyDropdownOptions\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"expense.frequency\"><option data-ng-repeat=\"o in frequencies\" value=\"[[o.value]]\">[[o.label]]</option></select><span class=\"inline-fieldset__result-wrap\"><span class=\"inline-fieldset__result-equals\">&#61;</span><span class=\"inline-fieldset__result\">£<span data-ng-bind=\"monthlyAmount(expense) | number:0\"></span></span></span></div><div data-ng-show=\"canBeOngoing(expense)\" class=\"inline-fieldset__is-ongoing expense-row__expense--is-ongoing\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"expense.ongoing\" data-ng-change=\"ongoingItemChanged(expense)\"><a data-ng-hide=\"expense.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're moving home, keep this unticked as this expense will be replaced with your new mortgage. If you're buying a buyt-to-let property, tick this box.\"><span class=\"checkbox-input__label__text\">Ongoing after purchase?</span></a><a data-ng-show=\"expense.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're moving home, keep this unticked as this expense will be replaced with your new mortgage. If you're buying a buyt-to-let property, tick this box.\"><span class=\"checkbox-input__label__text\">This is ongoing after purchase</span></a><span class=\"checkbox-input__background--blue\"></span><span class=\"checkbox-input__active-icon--blue\"></span></label></span></div></fieldset></div></div><div data-ng-switch-default=\"\" class=\"expense-tree__entry-item--single\"><div class=\"inline-fieldset expense-row\" data-ng-repeat=\"expense in expensesInCategoryBySlug(categoryItem, expenseCategory.slug)\"><div class=\"inline-fieldset__label\"><div class=\"inline-fieldset__label-wrapper\"><span class=\"t-item-title expense-tree__item-title\" data-ng-bind=\"expense.title\"></span></div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"expense.amount\"></div><select data-ui-select2=\"frequencyDropdownOptions\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"expense.frequency\"><option data-ng-repeat=\"o in frequencies\" value=\"[[o.value]]\">[[o.label]]</option></select><span class=\"inline-fieldset__result-wrap\"><span class=\"inline-fieldset__result-equals\">&#61;</span><span class=\"inline-fieldset__result\">£<span data-ng-bind=\"monthlyAmount(expense) | number:0\"></span></span></span></div><div data-ng-show=\"canBeOngoing(expense)\" class=\"inline-fieldset__is-ongoing expense-row__expense--is-ongoing\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"expense.ongoing\" data-ng-change=\"ongoingItemChanged(expense)\"><a data-ng-hide=\"expense.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're a first-time buyer leave this unticked as you won't incur rent expense when you buy a property. If you're currently renting and considering a buy-to-let purchase, rent will be an ongoing expense for you, so tick this box.\"><span class=\"checkbox-input__label__text\">Ongoing after purchase?</span></a><a data-ng-show=\"expense.ongoing\" data-pl-help-prompt-inline=\"\" href=\"\" data-extra-class=\"help-prompt__tooltip--expenses\" title=\"If you're a first-time buyer leave this unticked as you won't incur rent expense when you buy a property. If you're currently renting and considering a buy-to-let purchase, rent will be an ongoing expense for you, so tick this box.\"><span class=\"checkbox-input__label__text\">This is ongoing after purchase</span></a><span class=\"checkbox-input__background--blue\"></span><span class=\"checkbox-input__active-icon--blue\"></span></label></span></div></div></div></li><li data-ng-repeat=\"expense in userGeneratedExpensesByCategory(expenseCategory.slug)\" class=\"expense-tree__entry\"><div class=\"expense-tree__entry-item--single\"><div class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><div data-ng-switch=\"expense.editableTitle\" class=\"inline-fieldset__label-wrapper\"><div class=\"expense-tree__editable-item-wrapper\" data-ng-switch-when=\"true\"><input class=\"expense-tree__item-title expense-tree__item-title--editable inline-input\" type=\"text\" placeholder=\"Expense name\" data-ng-model=\"expense.title\" data-pl-default-value-hider=\"New expense\" required=\"\"></div><span class=\"t-item-title expense-tree__item-title\" data-ng-switch-default=\"\" data-ng-bind=\"expense.title\">[[ expense.title ]]</span></div></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"expense.amount\"></div><select data-ui-select2=\"frequencyDropdownOptions\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"expense.frequency\"><option data-ng-repeat=\"o in frequencies\" value=\"[[o.value]]\">[[o.label]]</option></select><span class=\"inline-fieldset__result-wrap\"><span class=\"inline-fieldset__result-equals\">&#61;</span><span class=\"inline-fieldset__result\">£<span data-ng-bind=\"monthlyAmount(expense) | number:0\"></span></span></span><button aria-label=\"Delete\" class=\"icon-button icon-button--inline icon-button--delete\" data-ng-show=\"expense.deletable\" data-ng-click=\"deleteExpense(expense)\"></button></div></div></div></li></ol><button class=\"btn btn--new-item\" data-ng-click=\"addExpense(expenseCategory.slug)\">+ Add new</button><footer><div><h4 class=\"h__budget\">Suggestions:</h4><ul class=\"expense-tree__suggestions\"><li data-ng-repeat=\"suggestion in expenseCategory.suggestions\"><a data-ng-click=\"addExpense(expenseCategory.slug, suggestion)\">+ [[suggestion]]</a></li></ul></div><p class=\"p__budget\"><span class=\"t-summary-label\">Monthly <span data-ng-bind=\"expenseCategory.title\"></span> Expenses:</span><span class=\"t-summary-value\"><span data-ng-bind=\"expensesCategoryTotal(expenseCategory) | noFractionCurrency:'£'\"></span></span><span class=\"t-summary-period\"></span></p><p class=\"p__budget\"><a data-ng-show=\"$index + 1 < expensesTabset.length\" data-ng-click=\"expensesTabset[$index + 1].select()\" class=\"btn t-btn-next btn--icon-right\">Next <i class=\"i i-next\"></i></a><a data-ng-hide=\"$index + 1 < expensesTabset.length\" data-ng-click=\"budgetTabset[2].select()\" class=\"btn t-btn-next btn--icon-right\">Result <i class=\"i i-next\"></i></a></p></footer></div></div></div></form>");
    $templateCache.put("/partials/views/calculators/budget/tab-income.html", "<form novalidate=\"\" data-ng-show=\"incomes\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Please enter your take-home income (after tax and National Insurance) from your salary, self-employment income and bonuses. Note that, like most lenders do, we will take into account <strong>50%</strong> of your average bonus in the last two years.</p><div data-ng-model=\"incomes\"><fieldset class=\"inline-fieldset income-tree__entry\" data-ng-repeat=\"income in incomes\"><div class=\"inline-fieldset__label\"><legend data-ng-switch=\"income.editableTitle\"><input class=\"inline-input\" type=\"text\" placeholder=\"Income name\" data-ng-switch-when=\"true\" data-ng-model=\"income.title\" data-pl-default-value-hider=\"New income\" required=\"\"><span class=\"t-item-title\" data-ng-switch-default=\"\" data-ng-bind=\"income.title\"></span><span class=\"income-tree__help-prompt\" data-ng-show=\"incomeHasHelp(income)\"><span data-pl-help-prompt=\"\" class=\"help-prompt\">[[income.help]]</span></span></legend></div><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"income.amount\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div><select data-ui-select2=\"frequencyDropdownOptions\" id=\"budget-income-before-employment-period\" name=\"ibe-period\" class=\"inline-fieldset__field select2-hide select2\" data-ng-model=\"income.frequency\"><option data-ng-repeat=\"o in frequencies\" value=\"[[o.value]]\">[[o.label]]</option></select><span class=\"inline-fieldset__result-wrap\"><span class=\"inline-fieldset__result-equals\">&#61;</span><span class=\"inline-fieldset__result\"><span data-ng-bind=\"monthlyAmount(income) | noFractionCurrency:'£'\">0</span></span></span><button aria-label=\"Delete\" class=\"icon-button icon-button--inline icon-button--delete\" data-ng-show=\"income.deletable\" data-ng-click=\"deleteIncome(income)\"></button></div></fieldset></div><button class=\"btn btn--new-item\" data-ng-click=\"addIncome()\">+ Add new</button></form><footer><p class=\"one-whole p__budget\"><span class=\"t-summary-label\">Your net income:</span><span class=\"t-summary-value\"><span data-ng-bind=\"totalIncome | noFractionCurrency:'£'\">0</span></span><span class=\"t-summary-period\">/mth</span></p><p class=\"one-whole p__budget\"><a data-ng-click=\"budgetTabset[1].select()\" class=\"btn t-btn-next btn--icon-right\">Next <i class=\"i i-next\"></i></a></p></footer>");
    $templateCache.put("/partials/views/calculators/budget/tab-results.html", "<header class=\"tabs--results__header\"><div class=\"tabs--results__tab-tip tabs--results__tab-tip--[[disposableClass()]]\"><i class=\"i tabs--results__tab-tip__icon\"></i><p data-ng-show=\"insufficientBudgetData()\">The charts in this section can give you useful insights, please take the time to complete the income and expense categories.</p><p data-ng-show=\"positiveBalance() && !insufficientBudgetData()\">Well done. Your budget balances which means that your income covers all your outgoings. You even have <strong>£[[disposableIncome() | number:0]]</strong> remaining to add to your savings and increase your overall wealth. Find out below the breakdown of your expenses and where you might be able to save even more.</p><p data-ng-show=\"negativeBalance() && !insufficientBudgetData()\">Please review the expenses tab and make sure everything is filled in correctly. Currently, your budget doesn't balance which means you are spending <strong>£[[Math.abs(disposableIncome()) | number:0]]</strong> more compared to what you earn. Don't panic but try to avoid getting into debt just to maintain your spending each month.</p></div></header><section data-ng-show=\"!insufficientBudgetData() && !negativeBalance()\" class=\"tabs--results__content\"><header class=\"tabs--results__header\"><h1 class=\"tabs--results__heading\">Budget waterfall</h1><div class=\"tabs--results__legend\"><div class=\"tabs--results__legend__section tabs--results__legend__section--income\"><span>Income</span><i></i></div><div class=\"tabs--results__legend__section tabs--results__legend__section--expense\"><span>Expense</span><i></i></div><div class=\"tabs--results__legend__section tabs--results__legend__section--leftover\"><span>Leftover</span><i></i></div></div></header><div data-pl-waterfall=\"\"><div class=\"tabs--results__waterfall-placeholder\"></div></div><ul class=\"results-summary--budget\"><li class=\"results-summary__item\"><span class=\"results-summary__title\">Monthly household income <span class=\"results-summary__subtitle\">(after tax)</span></span><span class=\"results-summary__amount\" data-ng-bind=\"totalIncome | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Monthly expenses</span><span class=\"results-summary__amount\" data-ng-bind=\"totalExpenses() | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Current mortgage/rent</span><span class=\"results-summary__amount\" data-ng-bind=\"totalMortgageRentExpenses() | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item results-summary__item--wide\"><div class=\"results-summary__title\">Disposable income to pay mortgage<div data-pl-help-prompt=\"\" class=\"help-prompt help-prompt--inverted results-summary__title-tooltip\">This is the amount of money you have left to pay the mortgage if you buy a property</div></div><span class=\"results-summary__amount results-summary__amount--green\" data-ng-bind=\"disposableIncomeToPayMortgage() | noFractionCurrency:'£'\"></span></li></ul><div class=\"tabs--results__balance table-display\"><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered\"><h2 class=\"grey-header-box__header__heading\">Total expenses as % of your net income</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-slider\"><div class=\"graph-slider__value\"><div class=\"graph-slider__value__span-wrapper\" data-ng-style=\"{'width': percentageBox1 + '%'}\"><span class=\"graph-slider__value__span\" data-ng-bind=\"calculateBox1() | number:0\">0</span></div></div><div class=\"graph-slider__slide\"><div data-ng-style=\"{'width': percentageBox1 + '%'}\" class=\"graph-slider__slide__content graph-slider__slide__content--[[box1Class()]]\"><div class=\"graph-slider__slide__content__termination\"></div></div></div><span class=\"graph-slider__label graph-slider__label--left graph-slider__label--green\">Low</span><span class=\"graph-slider__label graph-slider__label--right graph-slider__label--red\">High</span></div><p>You’re spending <strong><span data-ng-bind=\"totalExpenses() | noFractionCurrency:'£'\"></span> ([[calculateBox1() | number:0]]%)</strong> of your net monthly income on expenses, leaving you <strong><span data-ng-bind=\"disposableIncome() | noFractionCurrency:'£'\"></span></strong> to save at the end of the month.</p></div></div><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered\"><h2 class=\"grey-header-box__header__heading\">Housing expense as % of income</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-slider\"><div class=\"graph-slider__value\"><div class=\"graph-slider__value__span-wrapper\" data-ng-style=\"{'width': percentageBox2 + '%'}\"><span class=\"graph-slider__value__span\" data-ng-bind=\"calculateBox2() | number:0\">0</span></div></div><div class=\"graph-slider__slide\"><div data-ng-style=\"{'width': percentageBox2 + '%'}\" class=\"graph-slider__slide__content graph-slider__slide__content--[[box2Class()]]\"><div class=\"graph-slider__slide__content__termination\"></div></div></div><span class=\"graph-slider__label graph-slider__label--left graph-slider__label--green\">Low</span><span class=\"graph-slider__label graph-slider__label--right graph-slider__label--red\">High</span></div><p>You’re spending <strong data-ng-bind=\"totalHouseholdExpenses() | noFractionCurrency:'£'\"></strong> for your current housing needs, which is <strong>[[percentageBox2 | number:0]]%</strong> of your monthly net income of <strong>[[totalIncome | noFractionCurrency:'£']]</strong>. A general guidance is to keep this percentage below <strong>35%</strong>.</p></div></div><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered\"><h2 class=\"grey-header-box__header__heading\">Housing expense as % of disposable income</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-slider\"><div class=\"graph-slider__value\"><div class=\"graph-slider__value__span-wrapper\" data-ng-style=\"{'width': percentageBox3 + '%'}\"><span class=\"graph-slider__value__span\" data-ng-bind=\"calculateBox3() | number:0\">0</span></div></div><div class=\"graph-slider__slide\"><div data-ng-style=\"{'width': percentageBox3 + '%'}\" class=\"graph-slider__slide__content graph-slider__slide__content--[[box3Class()]]\"><div class=\"graph-slider__slide__content__termination\"></div></div></div><span class=\"graph-slider__label graph-slider__label--left graph-slider__label--green\">Low</span><span class=\"graph-slider__label graph-slider__label--right graph-slider__label--red\">High</span></div><p>You’re spending <strong data-ng-bind=\"totalHouseholdExpenses() | noFractionCurrency:'£'\"></strong> for your current housing needs, which is <strong><span data-ng-bind=\"percentageBox3 | number:0\"></span>%</strong> of the amount that is available for housing expenses. A general guidance is to keep this percentage below <strong>75%</strong>.</p></div></div></div><div class=\"tabs--results__breakdown\"><h2 class=\"tabs--results__breakdown__heading\">Breakdown of expenses</h2><div class=\"table-display table-display--custom-spacing\" ng-repeat=\"tableElements in categoriesWithExpenses | partition:2\" data-ng-style=\"{'width': rowHasTwoElements(tableElements) + '%' }\"><div data-ng-repeat=\"category in tableElements\" class=\"table-display__cell table-display__cell--1-2 grey-header-box tabs--results__breakdown__category tabs--results__breakdown__category--[[category.slug]]\"><header class=\"grey-header-box__header\"><i class=\"i grey-header-box__header__icon tabs--results__breakdown__category__icon\"></i><h2 class=\"grey-header-box__header__heading tabs--results__breakdown__category__heading\">[[category.title]]</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-bars\"><div class=\"graph-bars__row\" data-ng-repeat=\"expense in expensesInCategory(category.slug)\" data-ng-show=\"expenseHasExpenses(expense)\"><span class=\"graph-bars__row__el graph-bars__row__el--label\">[[expense.title]]</span><div class=\"graph-bars__row__el graph-bars__row__el--bar-wrapper\"><div data-ng-style=\"{'width': expenseOverCategory(expense, category) + '%' }\" class=\"graph-bars__row__el--bar-wrapper__bar tabs--results__breakdown__category__bar\"><div class=\"graph-bars__row__el--bar-wrapper__value\"><span data-ng-bind=\"monthlyAmount(expense) | noFractionCurrency:'£'\">0</span></div></div></div></div></div></div></div></div></div></section>");
    $templateCache.put("/partials/views/calculators/net-worth.html", "<nav data-pl-page-subnav=\"net-worth\" class=\"page-subnav\"></nav><div class=\"page-content page-content--calculators\"><h1 class=\"intro-heading\">What's your net worth?</h1><p class=\"intro-para\">Net worth is equal to the current value of your assets minus our outstanding debts. It may not be prudent to spend your entire savings when buying a home. Life is full of surprises and being prepared for hardship is comforting. We would recommend that you set aside 3 to 6 months worth of your current income as a rainy day fund.</p><section class=\"content-pane\"><h2>Calculate Net Worth</h2><div class=\"calc-summary-panel\"><div class=\"calc-summary-panel__section calc-summary-panel__section--positive\"><span class=\"calc-summary-panel__section-title\">Assets</span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"assetsTotal(true) | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--negative\"><span class=\"calc-summary-panel__section-title\">Liabilities</span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"liabilitiesTotal() | noFractionCurrency:'£'\">0</span></span></div><div class=\"calc-summary-panel__section calc-summary-panel__section--result negative-[[isNetWorthNegative()]]\"><span class=\"calc-summary-panel__section-title\">Net Worth</span><span class=\"calc-summary-panel__section-result\"><span data-ng-bind=\"netWorth() | noFractionCurrency:'£'\">0</span></span></div></div><div class=\"content-pane__inset\"><div data-pl-tabset=\"netWorthTabset\" data-pl-css-block-modifier=\"main\" callback=\"drawWaterfall\"><div data-pl-tab=\"\" data-pl-tab-title=\"Assets\"><div ng-include=\"\" src=\"'/partials/views/calculators/net-worth/tab-assets.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Liabilities\"><div ng-include=\"\" src=\"'/partials/views/calculators/net-worth/tab-liabilities.html'\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Result\"><div ng-include=\"\" src=\"'/partials/views/calculators/net-worth/tab-results.html'\"></div></div></div></div><div class=\"calculators__spinner\" data-pl-spinner=\"showSpinner\" data-pl-spinner-config=\"DEFAULT\"></div></section></div>");
    $templateCache.put("/partials/views/calculators/net-worth/tab-assets.html", "<form novalidate=\"\" data-ng-show=\"assets\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Please enter your assets below. You can add more detail by adding additional items by pressing <em>Add new</em>. Using the drop-down fields you can indicate whether you would like to use an asset for your home purchase or not.</p><ol class=\"asset-tree\"><li data-ng-repeat=\"assetCategory in assetStructure\" class=\"asset-tree__group asset-tree__group--[[assetCategory.slug]] active-[[assetCategoryIsActive(assetCategory.slug)]]\"><i class=\"asset-tree__icon\"></i><span class=\"asset-tree__group-title\">[[assetCategory.title]]</span><div class=\"asset-tree__item asset-tree__item--last-[[$last]]\" data-ng-repeat=\"asset in assets | filter:{categorySlug:assetCategory.slug}\"><fieldset class=\"inline-fieldset\"><input class=\"asset-tree__item-title\" type=\"text\" placeholder=\"Name\" data-pl-default-value-hider=\"New asset\" data-ng-model=\"asset.title\" required=\"\"><div class=\"input input--prepend inline-fieldset__field\" data-ng-switch=\"\" on=\"asset.categorySlug\"><span class=\"input__add-on input__add-on--prepend\">£</span><input data-ng-switch-when=\"property\" class=\"asset-tree__item-amount input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"Current Price\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"asset.amount\" required=\"\"><input data-ng-switch-default=\"\" class=\"asset-tree__item-amount input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"asset.amount\" required=\"\"></div><input class=\"asset-tree__item-amount asset-tree__item-amount-owed input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"Outstanding Mortgage\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"asset.owed\" data-ng-show=\"asset.categorySlug == 'property'\" required=\"\"><select data-ui-select2=\"availabilityDropdownOptions\" placeholder=\"Accessible?\" data-ng-model=\"asset.availability\" class=\"select2-hide\"><option data-ng-repeat=\"o in availabilityOptions\" value=\"[[o.value]]\">[[o.label]]</option></select><span class=\"asset-tree__item-text\">for Down Payment</span><button aria-label=\"Delete\" data-ng-show=\"assetDeletable(asset, $first)\" class=\"icon-button icon-button--inline icon-button--delete\" data-ng-click=\"deleteAsset(asset)\"></button></fieldset></div><button class=\"asset-tree__group-new-item btn btn--new-item\" data-ng-click=\"addAsset(assetCategory.slug)\">+ Add new</button></li></ol></form><footer><p><a data-ng-click=\"netWorthTabset[1].select()\" class=\"btn t-btn-next btn--icon-right\">Next <i class=\"i i-next\"></i></a></p></footer>");
    $templateCache.put("/partials/views/calculators/net-worth/tab-liabilities.html", "<form novalidate=\"\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>Please enter your current outstanding debts below. You can add more detail by adding additional items by pressing <em>Add new</em>.</p><ul class=\"liability-list\"><li data-ng-repeat=\"liability in liabilities\" class=\"liability-list__item\"><fieldset class=\"inline-fieldset\"><div class=\"liability-list__item-wrapper\" data-ng-switch=\"liability.editableTitle\"><input class=\"liability-list__item-title\" placeholder=\"Name\" data-ng-switch-when=\"true\" data-pl-default-value-hider=\"New liability\" data-ng-model=\"liability.title\" required=\"\"><div class=\"liability-list__item-title\" data-ng-switch-default=\"\"><span class=\"t-item-title\" data-ng-bind=\"liability.title\"></span><div data-pl-help-prompt=\"\" class=\"help-prompt\">Some help text goes here. Some help text goes here. Some help text goes here.</div></div></div><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"liability.amount\" required=\"\"></div><button aria-label=\"Delete\" class=\"icon-button icon-button--inline icon-button--delete\" data-ng-show=\"liability.deletable\" data-ng-click=\"deleteLiability(liability)\"></button></fieldset></li></ul><button class=\"liability-list__new-item btn btn--new-item\" data-ng-click=\"addLiability()\">+ Add new</button></form><footer><p><a data-ng-click=\"netWorthTabset[2].select()\" class=\"btn t-btn-next btn--icon-right\">Next <i class=\"i i-next\"></i></a></p></footer>");
    $templateCache.put("/partials/views/calculators/net-worth/tab-results.html", "<header class=\"tabs--results__header\"><div class=\"tabs--results__tab-tip\" data-ng-class=\"{'tabs--results__tab-tip--positive': (!isNetWorthNegative() && !isNetWorthLow() && !insufficientNetWorthData()), 'tabs--results__tab-tip--negative': (isNetWorthNegative() || isNetWorthLow() || insufficientNetWorthData())}\"><i class=\"i tabs--results__tab-tip__icon\"></i><p data-ng-show=\"insufficientNetWorthData()\">The charts in this section can give you useful insights, please take the time to complete the fields in the assets and liabilities tabs.</p><p data-ng-show=\"isNetWorthLow()\">You have a positive net worth of <strong data-ng-bind=\"netWorth() | noFractionCurrency:'£'\">0</strong> which suggests us that you would need to save up a little more as most lenders would require a minimum of <strong>£5,000</strong> of savings.</p><p data-ng-show=\"isNetWorthAboveThreshold()\">Great, your have more assets than liabilities resulting in a net worth of <strong data-ng-bind=\"netWorth() | noFractionCurrency:'£'\">0</strong>. You have also indicated that you can access <strong data-ng-bind=\"calculateAccessibleFunds() | noFractionCurrency:'£'\"></strong> (<strong>[[ calculateAccessibility() | number:0 ]]%</strong>) of your net worth to buy a new property.</p><p data-ng-show=\"isNetWorthNegative()\">Please review the assets and liabilities tabs and make sure everything is filled in correctly. Currently, your liabilities exceed your assets by <strong data-ng-bind=\"netLiabilities() | noFractionCurrency:'£'\">0</strong>. We suggest you cut down your expenses and reduce your debts.</p></div></header><section data-ng-show=\"!insufficientNetWorthData() && !isNetWorthNegative() && !isNetWorthLow()\" class=\"tabs--results__content\"><header class=\"tabs--results__header\"><h1 class=\"tabs--results__heading\">Breakdown Net Worth</h1><div class=\"tabs--results__legend\"><div class=\"tabs--results__legend__section tabs--results__legend__section--income\"><span>Assets</span><i></i></div><div class=\"tabs--results__legend__section tabs--results__legend__section--expense\"><span>Liabilities</span><i></i></div></div></header><div data-pl-waterfall=\"\" data-scale-values=\"\"><div class=\"tabs--results__waterfall-placeholder\"></div></div><ul class=\"results-summary--net-worth\"><li class=\"results-summary__item\"><span class=\"results-summary__title\">Accessible funds</span><span class=\"results-summary__amount\" data-ng-bind=\"calculateAccessibleFunds() | noFractionCurrency:'£'\"></span></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Payback some debt<div data-pl-help-prompt=\"\" class=\"help-prompt\">Do you want to pay some of your debt back immediately?</div></span><div class=\"results-summary__amount-input--prepend input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"results-summary__amount results-summary__amount-input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"caseData.overriddenVars.payback\"></div></li><li class=\"results-summary__item\"><span class=\"results-summary__title\">Put some in rainy day fund?<div data-pl-help-prompt=\"\" class=\"help-prompt\">We would recommend that you set aside 3 to 6 months worth of your current income as a rainy day fund.</div></span><div class=\"results-summary__amount-input--prepend input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"results-summary__amount results-summary__amount-input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"caseData.rainyDay\"></div></li><li class=\"results-summary__item results-summary__item--wider\"><span class=\"results-summary__title\">Amount left for deposit</span><span class=\"results-summary__amount results-summary__amount--[[availableFundForHouseColor]]\" data-ng-bind=\"availableFundForHouse | noFractionCurrency:'£'\"></span></li></ul><div class=\"tabs--results__balance table-display\"><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered tabs--results__balance__header\"><h2 class=\"grey-header-box__header__heading\">How accessible are your assets?</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-donut\"><div class=\"graph-donut__val-container\"><span class=\"graph-donut__val-container__value graph-donut__val-container__value--percentage graph-donut__val-container__value--blue\" data-ng-bind=\"calculateAccessibility()  | number:0\">0</span></div><div data-pl-donut=\"\" data-value=\"[[calculateAccessibility() | number:0]]\"></div></div><p>Out of your assets of <strong data-ng-bind=\"assetsTotal(true) | noFractionCurrency:'£'\"></strong>, you have indicated <strong data-ng-bind=\"calculateAccessibleFunds() | noFractionCurrency:'£'\"></strong> (<strong><span data-ng-bind=\"calculateAccessibility() | number:0\"></span>%</strong>) to be accessible when buying a property. Now make sure to put some aside as a rainy day fund.</p></div></div><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered tabs--results__balance__header\"><h2 class=\"grey-header-box__header__heading\">How leveraged are you?</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-donut\"><div class=\"graph-donut__val-container\"><span class=\"graph-donut__val-container__value graph-donut__val-container__value--percentage graph-donut__val-container__value--[[leverageColor()]]\" data-ng-bind=\"calculateLeverage() | number:0\">0</span></div><div data-pl-donut=\"\" data-value=\"[[leverage]]\" data-color=\"[[leverageColor()]]\"></div></div><p>Your outstanding non-mortgage debts of <strong data-ng-bind=\"liabilitiesTotal() | noFractionCurrency:'£'\"></strong> represents <strong><span data-ng-bind=\"leverage | number:0\"></span>%</strong> of your total assets. In order to minimize interest charges, try to keep your unsecured debts to a minimum.</p></div></div><div class=\"grey-header-box table-display__cell table-display__cell--1-3\"><header class=\"grey-header-box__header grey-header-box__header--text-centered tabs--results__balance__header\"><h2 class=\"grey-header-box__header__heading\">How much debt can you repay?</h2></header><div class=\"grey-header-box__content\"><div class=\"graph-donut\"><div class=\"graph-donut__val-container\"><span class=\"graph-donut__val-container__value graph-donut__val-container__value--[[debtFormat()]] graph-donut__val-container__value--[[debtColor()]]\" data-ng-bind=\"calculateDebt() | number:1\" data-ng-show=\"positiveNumber(debt)\">0</span></div><div data-pl-donut=\"\" data-plain-color=\"[[debtColor()]]\" data-value=\"[[debt]]\" data-color=\"[[debtColor()]]\" data-modifiers=\"multiplyBy100\"></div></div><p>Theoretically, you can use <strong data-ng-bind=\"cachedValues.cashAndSavings | noFractionCurrency:'£'\"></strong> in your cash &amp; savings accounts to repay <strong data-ng-bind=\"liabilitiesTotal() | noFractionCurrency:'£'\"></strong> of your debts.</p></div></div></div></section>");
    $templateCache.put("/partials/views/dashboard/dashboard.html", "<div class=\"page-content page-content--dashboard\"><h2>Dashboard</h2></div>");
    $templateCache.put("/partials/views/includes/footer.html", "<div class=\"app-footer__links\"><ul class=\"site-links\"><li><a href=\"http://plentific.com/about\">About Us</a></li><li><a href=\"http://plentific.com/blog\">Blog</a></li><li><a href=\"http://plentific.com/jobs\">Jobs</a></li><li><a href=\"http://plentific.com/faq\">FAQ</a></li><li><a href=\"http://plentific.com/press\">Press</a></li><li><a href=\"http://plentific.com/contact\">Contact Us</a></li><li><a href=\"http://plentific.com/privacy\">Privacy &amp; Security</a></li><li><a href=\"http://plentific.com/terms\">Terms of Use</a></li></ul><ul class=\"social-links\"><li><a href=\"//twitter.com/plentific/\" target=\"_blank\"><span class=\"social-link-icon social-link-icon--twitter\"></span></a></li><li><a href=\"//www.facebook.com/plentific/\" target=\"_blank\"><span class=\"social-link-icon social-link-icon--facebook\"></span></a></li><li><a href=\"//www.linkedin.com/company/2792265?trk=tyah/\" target=\"_blank\"><span class=\"social-link-icon social-link-icon--linkedin\"></span></a></li><li><a href=\"//plus.google.com/112778374049033888906/posts/\" target=\"_blank\"><span class=\"social-link-icon social-link-icon--google-plus\"></span></a></li></ul></div>");
    $templateCache.put("/partials/views/includes/header-links.html", "<div class=\"butter-bar\" data-ng-hide=\"hideCookieMsg == 'true'\"><p>To offer the best experience, this website uses cookies. <a href=\"http://www.ico.org.uk/for_the_public/topic_specific_guides/online/cookies\" target=\"_blank\">Find out more</a> about cookies.</p><button class=\"close\" data-ng-click=\"doHideCookieMsg()\" aria-label=\"Dismiss\"><i class=\"i i-butter-bar-dismiss\"></i></button></div><div class=\"app-header__wrapper\"><a href=\"/milestone-tracking/\" class=\"app-header__logo-link\"><i class=\"app-header__logo-link__image\"></i></a><div class=\"app-header__title-wrapper\"><h1 class=\"app-header__title\" data-ng-bind=\"screenTitle\"></h1></div><nav class=\"app-header__nav-wrapper\"><ul class=\"app-header__nav\"><li><a href=\"/milestone-tracking/\" class=\"milestone-tracking__overview-btn--grey light\"><i></i>Overview</a></li><li class=\"app-header__user\" data-pl-user-info=\"\" data-ng-hide=\"userData.user.isLazyUser\"><span class=\"app-header__user-avatar\"><img alt=\"User Avatar Image\" data-ng-src=\"[[ STATIC_URL]]images/avatar.74a9fd3d.png\" data-ng-hide=\"userData.user.avatar\"><img alt=\"User Avatar Image\" data-ng-src=\"[[ userData.user.avatar_30 ]]\" data-ng-show=\"userData.user.avatar\"></span><span class=\"app-header__user-name\" data-ng-hide=\"userData.user.isLazyUser\"><i class=\"i\"></i><span data-ng-bind=\"userData.user.firstName\"></span></span><ul class=\"app-header__user-menu\"><li class=\"app-header__user-menu-item\"><a class=\"settings\" href=\"/my-account/\"><i class=\"i sprite-icon-settings\"></i><span class=\"app-header__user-menu-item__title\">Settings</span></a></li><li class=\"app-header__user-menu-item\"><a class=\"logout\" href=\"/logout/\" target=\"_self\"><i class=\"i sprite-icon-logout\"></i><span class=\"app-header__user-menu-item__title\">Logout</span></a></li></ul></li><li><span class=\"app-header__user-name\" data-ng-show=\"userData.user.isLazyUser\"><button type=\"button\" class=\"btn app-header__login light\" data-ng-click=\"openLoginDialog()\">Log In</button><button type=\"button\" class=\"btn app-header__signup light\" data-ng-click=\"openSignupDialog()\">Sign Up</button></span></li></ul></nav></div>");
    $templateCache.put("/partials/views/includes/price-options.html", "<option value=\"_DEFAULT_\">No min</option><option value=\"10000\">£10,000</option><option value=\"20000\">£20,000</option><option value=\"30000\">£30,000</option><option value=\"40000\">£40,000</option><option value=\"50000\">£50,000</option><option value=\"60000\">£60,000</option><option value=\"70000\">£70,000</option><option value=\"80000\">£80,000</option><option value=\"90000\">£90,000</option><option value=\"100000\">£100,000</option><option value=\"110000\">£110,000</option><option value=\"120000\">£120,000</option><option value=\"130000\">£130,000</option><option value=\"140000\">£140,000</option><option value=\"150000\">£150,000</option><option value=\"160000\">£160,000</option><option value=\"170000\">£170,000</option><option value=\"180000\">£180,000</option><option value=\"190000\">£190,000</option><option value=\"200000\">£200,000</option><option value=\"210000\">£210,000</option><option value=\"220000\">£220,000</option><option value=\"230000\">£230,000</option><option value=\"240000\">£240,000</option><option value=\"250000\">£250,000</option><option value=\"275000\">£275,000</option><option value=\"300000\">£300,000</option><option value=\"325000\">£325,000</option><option value=\"350000\">£350,000</option><option value=\"375000\">£375,000</option><option value=\"400000\">£400,000</option><option value=\"425000\">£425,000</option><option value=\"450000\">£450,000</option><option value=\"475000\">£475,000</option><option value=\"500000\">£500,000</option><option value=\"550000\">£550,000</option><option value=\"600000\">£600,000</option><option value=\"650000\">£650,000</option><option value=\"700000\">£700,000</option><option value=\"750000\">£750,000</option><option value=\"800000\">£800,000</option><option value=\"850000\">£850,000</option><option value=\"900000\">£900,000</option><option value=\"950000\">£950,000</option><option value=\"1000000\">£1,000,000</option><option value=\"1100000\">£1,100,000</option><option value=\"1200000\">£1,200,000</option><option value=\"1300000\">£1,300,000</option><option value=\"1400000\">£1,400,000</option><option value=\"1500000\">£1,500,000</option><option value=\"1600000\">£1,600,000</option><option value=\"1700000\">£1,700,000</option><option value=\"1800000\">£1,800,000</option><option value=\"1900000\">£1,900,000</option><option value=\"2000000\">£2,000,000</option><option value=\"2100000\">£2,100,000</option><option value=\"2200000\">£2,200,000</option><option value=\"2300000\">£2,300,000</option><option value=\"2400000\">£2,400,000</option><option value=\"2500000\">£2,500,000</option><option value=\"2750000\">£2,750,000</option><option value=\"3000000\">£3,000,000</option><option value=\"3500000\">£3,500,000</option><option value=\"3750000\">£3,750,000</option><option value=\"4000000\">£4,000,000</option><option value=\"4250000\">£4,250,000</option><option value=\"4500000\">£4,500,000</option><option value=\"4750000\">£4,750,000</option><option value=\"5000000\">£5,000,000</option><option value=\"5500000\">£5,500,000</option><option value=\"6000000\">£6,000,000</option><option value=\"6500000\">£6,500,000</option><option value=\"7000000\">£7,000,000</option><option value=\"7500000\">£7,500,000</option><option value=\"8000000\">£8,000,000</option><option value=\"8500000\">£8,500,000</option><option value=\"9000000\">£9,000,000</option><option value=\"9500000\">£9,500,000</option><option value=\"10000000\">£10,000,000</option><option value=\"12500000\">£12,500,000</option><option value=\"15000000\">£15,000,000</option>");
    $templateCache.put("/partials/views/includes/sidebar.html", "<nav class=\"app-sidebar\" data-ng-class=\"{ 'is-expanded': expanded, 'is-collapsed': !expanded }\" data-ng-controller=\"SidebarController\"><div class=\"app-sidebar__wrapper\"><button class=\"app-sidebar__toggle-button\" aria-label=\"Toggle Menu\" data-ng-click=\"toggleExpanded()\"><i class=\"app-sidebar__icon app-sidebar__icon--menu\"></i></button><ul class=\"app-sidebar__nav\"><li data-ng-class=\"{ 'is-active': activeSection == 'dashboard' }\"><a href=\"\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--dashboard\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Dashboard</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Dashboard\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'milestone-tracking' }\"><a href=\"/milestone-tracking/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--milestone-tracking\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Milestone Tracking</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Milestone Tracking\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'calculators' }\"><a href=\"/calculators/affordability/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--calculators\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Calculators</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Calculators\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'property-search' }\"><a href=\"/property-search/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--property-search\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Property Search</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Property Search\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'mortgage-advice' }\"><a href=\"/mortgage-advice/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--mortgage-advice\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Mortgage Advice</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Mortgage Advice\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'legal-advice' }\"><a href=\"/legal-advice/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--legal-advice\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Legal Advice</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Legal Advice\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'property-coach' }\"><a href=\"/property-coach/\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--property-coach\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">Property Coach</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"Property Coach\"></div></a></li><li data-ng-class=\"{ 'is-active': activeSection == 'documents' }\"><a href=\"\"><span class=\"app-sidebar__item-wrapper\"><span class=\"app-sidebar__icon-wrapper\"><i class=\"app-sidebar__icon app-sidebar__icon--documents\"></i></span><span class=\"app-sidebar__label-wrapper\"><span class=\"app-sidebar__label\">My Documents</span></span></span><div pl-tooltip-sidebar=\"\" data-pl-tooltip-sidebar-content=\"My Documents\"></div></a></li></ul></div><div class=\"app-sidebar__background-cover\" data-ng-click=\"collapse()\"></div></nav>");
    $templateCache.put("/partials/views/legal-advice/legal-advice.html", "<div class=\"page-content page-content--legal-advice\"><div class=\"advice-section advice-section--intro\"><div class=\"advice-section__inner\"><h1>Legal Advice</h1><p>We know buying or selling a property can be one of the most stressful times in your life. Fear not though, as we’re ready and waiting to help you through the process. From start to finish, we’ll make sure your homebuying journey is as smooth as possible.</p></div></div><accordion class=\"advice__sections\" data-close-others=\"false\"><div class=\"advice-section\"><div class=\"advice-section__inner\"><div class=\"advice__section\"><div class=\"accordion-heading\"><h3>What is conveyancing?</h3></div><div class=\"accordion-body\"><div class=\"accordion-inner\"><p>Conveyancing is a legal service provided by licensed practitioners that deals with the buying and selling of land and property titles. The main reason for conveyancing is to ensure that the buyer is purchasing a marketable title and knows the extent and restrictions of the deeds.</p></div></div></div></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[0]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Why do I need legal advice?</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item two-thirds\"><p>While it is actually possible to do the conveyancing yourself as long as you’re not taking out a loan on the property, it is a complicated and involved process that requires special legal training and experience. We would always recommend a certified conveyancer to take the hassle out of the process.</p></div><div class=\"grid__item one-third\"><p><button class=\"contact-button--solicitor\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Legal Advisor</span></button></p></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[1]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Who does the conveyancing?</h3><i></i></accordion-heading><div class=\"advice__comparison-panels compare-three\"><div class=\"advice__comp-panel comp-panel\"><h4 class=\"comp-panel-heading comp-panel-heading--blue\">You</h4><div class=\"comp-panel-body\"><p>Unless you are yourself a solicitor, it’s almost always not worth your time. The conveyancing process is one of the more antiquated in English law and hold ups could cost you your dream property.</p></div></div><div class=\"advice__comp-panel-vs-div advice__comp-panel-vs-div--blue-green\"></div><div class=\"advice__comp-panel comp-panel\"><h4 class=\"comp-panel-heading comp-panel-heading--green\">Licenced Conveyancer</h4><div class=\"comp-panel-body\"><p>Licensed conveyancers are specialists in the field and usually have more time to deal with property issues. While they can perform conveyancing-related tasks, they can only guide and assist with other property-specific legal issues. They are regulated by the Council of Licensed Conveyancers.</p></div></div><div class=\"advice__comp-panel-vs-div advice__comp-panel-vs-div--green-red\"></div><div class=\"advice__comp-panel comp-panel\"><h4 class=\"comp-panel-heading comp-panel-heading--red\">Solicitor</h4><div class=\"comp-panel-body\"><p>A fully trained solicitor will have knowledge and advice to give you regarding your whole homebuying journey. However, you may find that they have less time to deal with conveyancing issues, as they work in a variety of fields. Solicitors are regulated by the Solicitor’s Regulation Authority.</p></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[2]\" class=\"advice__section advice__section-process\"><div class=\"advice__process-inner-padding\"><accordion-heading class=\"advice__section-heading\"><h3>Timing and process</h3><i></i></accordion-heading><p>On average the property buying process takes around 8 to 12 weeks from the time you hire a conveyancer. However, this can be decreased if you pay cash or everyone involved is outside of a chain. Ultimately, the conveyancing process can only move as fast as it is allowed by other issues. Mortgage applications and arrangements can add a significant amount of time to the process, as can other, less organised, buyers or conveyancers.</p><div class=\"advice__process\"><p class=\"advice__process-start\"><span>Offer Accepted</span></p><ol><li class=\"item item1\"><span class=\"number\">1</span><div class=\"content content--align-top\"><span>Instruct your conveyancer</span><div class=\"content-popup\"><ul><li>Make sure you choose a top conveyancer</li><li>Get a quote</li><li>Having a conveyancer ready early puts you in a much stronger bargaining position</li></ul></div></div></li><li class=\"item item2\"><span class=\"number\">2</span><div class=\"content content--align-top\"><span>Receive notification of sale</span><div class=\"content-popup\"><ul><li>Sometimes called a memorandum of sale or sales particulars</li><li>Sets out the terms of the sale and has everyone’s particulars setting out any special conditions, such as a complete-by date</li><li>Your solicitor will request local property search packages at this stage</li></ul></div></div></li><li class=\"item item3\"><span class=\"number\">3</span><div class=\"content content--align-top\"><span>Solicitor receives draft contract &amp; title deeds</span><div class=\"content-popup\"><ul><li>Contains all the essential details of the contract and sales details</li><li>Your solicitor checks the documents and negotiates it with the seller’s solicitor</li></ul></div></div></li><li class=\"item item4\"><span class=\"number\">4</span><div class=\"content content--align-top\"><span>Raise enquiries</span><div class=\"content-popup\"><ul><li>Once your solicitor has received the contract, they will return a list of enquiries</li><li>The vendor’s solicitor will provide replies to the enquiries</li></ul></div></div></li><li class=\"item item5\"><span class=\"number\">5</span><div class=\"content\"><span>Receive contract &amp; full report from solicitor</span><div class=\"content-popup\"><ul><li>Full report on contract, enquiries, searches and mortgage offer</li><li>Contains professional analysis and review of the details of the property, as well as pointing out any potential issues</li></ul></div></div></li><li class=\"item item6\"><span class=\"number\">6</span><div class=\"content\"><span>Check fittings &amp; fixtures</span><div class=\"content-popup\"><p>Summary of fixtures and fittings outlining what is included and excluded in the purchase</p></div></div></li><li class=\"item item7\"><span class=\"number\">7</span><div class=\"content\"><span>Mortgage offer received by solicitor</span><div class=\"content-popup\"><ul><li>Your lender has finished their checks and underwritten the mortgage, they will issue you and your solicitor with a full mortgage offer</li></ul></div></div></li><li class=\"item item8\"><span class=\"number\">8</span><div class=\"content\"><span>Sign the mortgage offer document</span> </div></li><li class=\"item item9 item--line-overlay\"><span class=\"number\">9</span><div class=\"content\"><span>Sign the contract</span><div class=\"content-popup\"><ul><li>Read, sign and return the contract to your solicitor</li><li>You should receive an identical copy signed by the seller</li></ul></div></div></li><li class=\"item item10\"><span class=\"number\">10</span><div class=\"content\"><span>Transfer deposit for exchange</span><div class=\"content-popup\"><ul><li>Typically a 10% deposit when you exchange contracts</li><li>Amount must be cleared in your solicitor’s client account before the exchange can happen</li></ul></div></div></li><li class=\"item item11\"><span class=\"number\">11</span><div class=\"content\"><span>Agree completion date</span><div class=\"content-popup\"><ul><li>Set a completion date (date from which the house will be vacated) before exchanging contracts</li><li>If you or the seller has a chain, you may need to arrange a date that fits in with that chain</li></ul></div></div></li><li class=\"item item12\"><span class=\"number\">12</span><div class=\"content\"><span>Exchange contracts</span><div class=\"content-popup\"><ul><li>Once you have finalised the mortgage and paid the deposit, you and your solicitor are ready to exchange contracts</li><li>After exchange of contracts, legally binding agreement</li></ul></div></div></li><li class=\"item item13\"><span class=\"number\">13</span><div class=\"content\"><span>Solicitor requests mortgage funds</span><div class=\"content-popup\"><ul><li>Solicitor’s job to ensure that all monies are ready on the day of completion</li><li>Mortgage provider will be informed when to transfer the mortgage amount</li></ul></div></div></li><li class=\"item item14 item--line-overlay\"><span class=\"number\">14</span><div class=\"content\"><span>Transfer residual funds</span><div class=\"content-popup\"><ul><li>Solicitor will confirm the residual amount to be transferred</li><li>Needs to have cleared funds in his client account to be able to complete</li></ul></div></div></li><li class=\"item item15\"><span class=\"number\">15</span><div class=\"content\"><span>Final check by solicitor</span><div class=\"content-popup\"><p>Solicitor reviews entire case before preparing for completion</p></div></div></li><li class=\"item item16\"><span class=\"number\">16</span><div class=\"content\"><span>Complete purchase</span><div class=\"content-popup\"><ul><li>Solicitor will release the funds to the seller’s solicitor</li><li>Land Registry fees and stamp duty payable now</li><li>Receive the deeds to the property</li><li>Solicitor will notify the mortgage lender, freeholder (if appropriate) and insurance companies of the completed sale.</li><li>Solicitor will send statement of completion and the invoice</li></ul></div></div></li></ol><span class=\"line line--hori line--1\"></span><span class=\"line line--vert line--2\"></span><span class=\"line line--hori line--3\"></span><span class=\"line line--vert line--4\"></span><span class=\"line line--hori line--5\"></span><span class=\"line line--vert line--6\"></span><span class=\"line line--hori line--7\"></span><p class=\"advice__process-finish\"><span>Ready to move in</span></p></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[3]\" class=\"advice__fees advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Four key steps in the process</h3><i></i></accordion-heading><p>While every step of the buying process is vital, there are four key areas that you need to know about and understand, because they involve you.</p><div data-pl-tabset=\"buyingProcessTabset\" data-pl-css-block-modifier=\"main\"><div data-pl-tab=\"\" data-pl-tab-title=\"Contract\"><p>A contract is a legally binding document between you and the vendor. Once the offer has been accepted, the seller’s solicitor creates a contract to be sent to your solicitor. Your solicitor will then review the contract and submit additional information about the property to you in the form of a contract pack. Once you’ve reviewed the contents of the pack and queried anything you’re not sure about with your solicitor, you can sign it to complete the agreement process.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Mortgage Offer\"><p>While the contract process is happening, you can get on with the business of arranging a mortgage with your selected lender. After a property valuation, your lender will draft a mortgage offer, which you will need to send to your solicitor. As well as the obligatory mortgage valuation of the property, it’s a good idea to have one of a number of different types of survey competed on the property. While not compulsory, these will save you grief in the long run, as more comprehensive surveys can reveal issues that may reduce the value of your home or increase the cost of maintenance and repairs.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Exchange of Contracts\"><p>In exchanging contracts you are entering into a legal agreement that binds both parties to the sale. It can be both exciting and nerve-racking. Before this happens, both the buyer’s and seller’s solicitors gather together all of the remaining paperwork to make sure there are no gaps in the documentation. It is standard for you to pay 10% (this is usually negotiable) of the purchase price as a deposit on exchange of contracts. Once that’s all sorted, you’re free to continue with your homebuying journey. This might include things such as notifying utilities providers, and arranging completion and moving-in dates.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Completion\"><p>Completion is when the property becomes legally yours. After this landmark date, all you have to deal with is the moving process and finding a nice bottle of bubbly to celebrate with.</p></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[4]\" class=\"advice__fees advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>The fees</h3><i></i></accordion-heading><p>Obviously, it’s important for you to make sure you understand all the fees involved in hiring a conveyancer. We’ve listed them here, so you know what you’ll have to pay for and when.</p><div class=\"grid advice__fees__content\"><div class=\"grid__item two-fifths advice__fees-left\"><div class=\"advice__fees-content-row advice__fees-content-row--pound\"><i class=\"i sprite-icon-blue-pound\"></i><h4>Initial Payment</h4><p>The initial payment usually covers both the admin associated with opening dealings with your conveyancer, as well as survey fees.</p></div><div class=\"advice__fees-content-row advice__fees-content-row--percent\"><i class=\"i sprite-icon-percent\"></i><h4>Conveyancing fee</h4><p>The actual fee for conveyancing usually depends on the price of the property and the complexity of the purchase. Be sure to check out our <a href=\"/calculators/affordability/\">Fee Calculator</a> to get a clearer idea of exactly how much yours will be.</p></div></div><div class=\"grid__item three-fifths advice__fees-right\"><div data-pl-tabset=\"feesTabset\" data-pl-css-block-modifier=\"vertical\"><div data-pl-tab=\"\" data-pl-tab-title=\"Title Indemnity Insurance\"><p>This is a type of insurance your lender may require that is related to problems with the property, such as building regulation issues or land disputes. This protects you against legal action arising from these issues.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Bank transfer fee\"><p>Due to the large sums of money involved in buying a property, and the costs associated with moving that money around, banks will often charge buyers fees for transferring monies in one go. On occasion, buyers may have some funds due to be returned and this is usually done by cheque. Buyers can have the money deposited directly into an account. In each transfer you may incur a fee of around &pound;30 plus VAT.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Search packages\"><p>Search packages dig up all the information about the history and condition of the property as is possible. A search package can include a local authority search, a water authority search, a drainage search and a bankruptcy search. This is so the lender can be sure that you’re buying proper, marketable deeds to the property and there is no problem that would prevent you from taking a mortgage out on it. The cost for this comes in at &pound;270 including VAT.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Stamp duty\"><p>This is a tax based on a percentage of your property’s value to be paid directly to the government.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"ID checks\"><p>You may have to pay for ID checks if you are involved in a property transaction.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Land registry fee\"><p>Land Registary fees are to pay for the accurate record keeping that allows you to conduct searches. The costs change as a function of to the value of your property. You can find the exact fees for your specific property here.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Acting for mortgage lender\"><p>This fee is the cost of drafting the contract for the mortgage agreement, which outlines the terms of your loan. Your solicitor will be able to clear up any queries you may have about this document.</p></div></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[5]\" class=\"advice__pledges advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Conveyancing association pledges</h3><i></i></accordion-heading><p>As a member of the Conveyancing Association (CA)*, our partners are proud to support and uphold the CA Pledges which are designed to make the process of buying a house smoother and more efficient for our clients and partners elsewhere in the transaction.</p><p>The Pledges, which were launched in December 2012, are the conveyancing industry’s first ever set of customer service commitments that go above and beyond existing regulations and accreditation schemes. e that home-buyers should expect when making one of the biggest decisions of their lives.</p><ol class=\"advice__pledge-list grid\"><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">1</span><h4>Quality of service</h4><p>Members will provide a first rate conveyancing service to all clients, regardless of the value of the instructions</p></li><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">2</span><h4>Client Satisfaction</h4><p>Members will ensure that its clients are satisfied with their service by requesting and acting on client feedback</p></li><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">3</span><h4>Efficient process</h4><p>Members will work to cut out delays in the conveyancing process and take steps to ensure that transactions run as smoothly as possible</p></li><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">4</span><h4>Title &amp; Registration</h4><p>Members will ensure that property is acquired with a good and marketable title and promptly registered at the Land Registry</p></li><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">5</span><h4>Combating fraud</h4><p>Members will take pro-active steps to protect mortgage funds and combat mortgage and property fraud</p></li><li class=\"pledge-item grid__item one-sixth\"><span class=\"number\">6</span><h4>Mutual support &amp; trusted community</h4><p>Members will work towards a trusted community of conveyancers through mutual support and information sharing between members</p></li></ol><p>*<a href=\"http://www.theconveyancingassociation.co.uk/pdfs/Conveyancing%20Association%20Pledges.pdf\" target=\"_blank\">The Conveyancing Association</a></p></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[6]\" class=\"advice__pledges advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>The UK's best property lawyers - working with you every step of the way!</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item two-thirds\"><ul><li>Accredited member of the Law Society’s Conveyancing Quality Scheme</li><li>Pledge to the Conveyancing Association (CA), designed to make the process of buying a house smoother and more efficient</li><li>Homebuyers Plus with every transaction</li><li>Transparency &amp; Certainty</li><li>Free online Will writing</li><li>10% discount for First Time Buyers</li><li>No hidden costs</li><li>No success, no fee promise</li><li>Free first advice, no obligation and complete confidence</li></ul></div><div class=\"grid__item one-third\"><div class=\"yellow-box\"><h4>Get a conveyancing quote</h4><form class=\"form\" data-ng-controller=\"ConveyancingFormController\"><div data-ng-hide=\"conveyancing.type=='selling'\"><div class=\"form__row grid\"><label class=\"form__label grid__item one-half\">Purchase price:</label><div class=\"input input--prepend inline-fieldset__field grid__item one-half\"><span class=\"input__add-on\">£</span><input type=\"text\" class=\"form__input input__field\" data-pl-number=\"\" data-pl-default-value-hider=\"0\" step=\"any\" min=\"0\" placeholder=\"0\" data-ng-model=\"conveyancing.purchasePrice\" data-ng-change=\"onPurchasePriceChanged()\"></div></div><div class=\"form__row\"><span class=\"radio-input\"><label class=\"radio-input__label\"><input name=\"buying-property-type\" type=\"radio\" class=\"radio-input__field\" value=\"freehold\" data-ng-model=\"conveyancing.buyingPropertyType\">Freehold<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span><span class=\"radio-input\"><label class=\"radio-input__label\"><input name=\"buying-property-type\" type=\"radio\" class=\"radio-input__field\" value=\"leasehold\" data-ng-model=\"conveyancing.buyingPropertyType\">Leasehold<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span></div></div><div class=\"form__section\"><div class=\"form__row grid\"><label class=\"form__label grid__item two-thirds\">Legal fees ex VAT:</label><span class=\"form__fixed-value form__align-right\"><strong data=\"\" ng-hide=\"conveyancing.legalFeesOnRequest\" data-ng-bind=\"conveyancing.fees.legalFees | noFractionCurrency:'£'\"></strong><strong data=\"\" ng-show=\"conveyancing.legalFeesOnRequest\">On request</strong></span></div><div class=\"form__row\" data-ng-hide=\"conveyancing.type=='selling'\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"conveyancing.isFirstTimeBuyer\" data-ng-change=\"onPurchasePriceChanged()\">Are you a first time buyer?<span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span></div><div class=\"form__row\"><button type=\"button\" class=\"btn--link\" data-ng-click=\"openDialog('conveyancingQuote')\">See full quote</button></div></div></form></div></div></div></accordion-group></div></div></accordion><div class=\"advice-section advice-section--complete\"><div class=\"advice-section__inner\"><div class=\"line line--hori\"></div><button class=\"contact-button contact-button--solicitor--grey\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a Legal Advisor</button></div></div></div>");
    $templateCache.put("/partials/views/milestone-tracking/milestone-tracking.html", "<div class=\"page-content page-content--milestone-tracking\"><div class=\"milestone-tracking__overview-wrapper\" data-ng-show=\"overviewReady\" id=\"milestoneOverview\"><a href=\"/milestone-tracking/\" class=\"milestone-tracking__overview-btn\"><i></i>Overview</a><div class=\"milestone-tracking__overview\" data-ng-class=\"{'active': !currentMilestone}\"><ul class=\"milestone-tracking__overview-groups\"><li data-ng-repeat=\"group in milestoneGroups\" class=\"[[group]]\" data-ng-style=\"{width: groupWidthPercentage(group) + '%'}\"><span class=\"milestone-tracking__overview-group-heading\"><span><i></i>[[group]]</span></span></li></ul><ul class=\"milestone-tracking__milestones\"><li data-ng-repeat=\"milestone in milestones\" class=\"[[milestone.group]] completed-[[isMilestoneCompleted(milestone)]] active-[[currentMilestone == milestone.number]]\"><span class=\"milestone-tracking__overview-number\"><span>[[milestone.number]]</span></span><div class=\"milestone-tracking__overview-content\"><div class=\"milestone-tracking__overview-heading\"><a class=\"milestone-tracking__overview-title\" href=\"?milestonetracking.milestone=[[milestone.number]]\">[[milestone.title]]</a><ul class=\"milestone-tracking__overview-indicators [[milestone.group]]\"><li data-ng-repeat=\"item in milestone.items\" class=\"completed-[[item.completed]]\"></li></ul></div><ul class=\"milestone-tracking__overview-items [[milestone.group]]\"><li data-ng-repeat=\"item in milestone.items\" class=\"completed-[[item.completed]]\"><a href=\"?milestonetracking.milestone=[[milestone.number]]&amp;milestonetracking.item=[[item.number]]\"><span class=\"milestone-tracking__item-number\">[[milestone.number]].[[item.number]]</span>&nbsp;<span class=\"milestone-tracking__item-title\">[[item.title]]</span></a></li></ul></div></li></ul></div><div class=\"milestone-tracking__detail [[milestone.group]] milestone-[[milestone.number]]\" data-ng-repeat=\"milestone in milestones\" data-ng-show=\"currentMilestone == milestone.number\"><div class=\"milestone-tracking__detail-wrapper [[milestone.group]]\"><div class=\"milestone-tracking__detail-milestone-header\"><button data-ng-class=\"{'milestone-tracking__detail-expand': !allItemsExpanded, 'milestone-tracking__detail-collapse': allItemsExpanded}\" data-ng-click=\"allItemsExpanded = !allItemsExpanded\"><span data-ng-show=\"!allItemsExpanded\">Expand all</span><span data-ng-show=\"allItemsExpanded\">Collapse all</span><i></i></button><h2 class=\"milestone-tracking__detail-milestone-heading\">[[milestone.number]]. [[milestone.title]]</h2></div><accordion class=\"milestone-tracking__detail-items\" data-close-others=\"false\" id=\"milestone-[[milestone.number]]\"><accordion-group id=\"item-[[milestone.number]]-[[item.number]]\" data-ng-repeat=\"item in milestone.items\" is-open=\"item.number == currentItem || allItemsExpanded\" data-ng-class=\"{'active': isOpen}\" class=\"milestone-tracking__detail-item\"><accordion-heading class=\"milestone-tracking__detail-item-header\"><h3 class=\"milestone-tracking__detail-item-heading completed-[[item.completed]]\">[[milestone.number]].[[item.number]] [[item.title]] <i></i></h3></accordion-heading><div class=\"milestone-tracking__detail-checkbox\"><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"item.completed\" data-ng-change=\"itemChanged(milestone.number, item)\"><span data-ng-hide=\"item.completed\">Step completed?</span><span data-ng-show=\"item.completed\">Thanks, well done!</span><span class=\"checkbox-input__background--blue\"></span><span class=\"checkbox-input__active-icon--blue\"></span></label></span></div><div class=\"milestone-tracking__detail-content\"><div class=\"milestone-tracking__detail-text\" data-pl-bind-html-unsafe-compile=\"item.text\" id=\"milestone-[[milestone.number]]-[[item.number]]\"></div><div class=\"milestone-tracking__detail-tips\"><h4>Useful tips</h4><ul><li data-ng-repeat=\"tip in item.tips\" data-pl-bind-html-unsafe-compile=\"tip\"></li></ul></div></div></accordion-group></accordion></div><div class=\"milestone-tracking__detail-nav\"><a class=\"milestone-tracking__detail-nav-next\" href=\"?milestonetracking.milestone=[[milestones[$index+1].number]]\" data-ng-show=\"milestones[$index+1]\">[[milestones[$index+1].title]] <i></i></a><a class=\"milestone-tracking__detail-nav-prev\" href=\"?milestonetracking.milestone=[[milestones[$index-1].number]]\" data-ng-show=\"milestones[$index-1]\"><i></i> [[milestones[$index-1].title]]</a></div></div></div><div class=\"milestone-tracking__spinner\" data-pl-spinner=\"showSpinner\" data-pl-spinner-config=\"DEFAULT\"></div></div>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/agreement-in-principle.html", "<p>A provisional lending decision offered by a specific mortgage lender. The lender will confirm how much it might be prepared to lend even before you find a property. An agreement in principle is not legally binding, so don’t rely on this until you have a full credit offer.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/block-insurance-policies.html", "<p>This is essential cover for landlords to protect their buildings against damage against a range of unexpected incidents, including fire, storms, flooding, escape of water, subsidence, theft and property owners liability.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/budget.html", "<p>A finance plan that allocates personal income towards expenses, savings and debt repayment. Past spending and personal debt are considered when creating a personal budget.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/building-regulations.html", "<p>Most new buildings, alterations, extensions and changes of the use of existing buildings are subject to building regulations. These are approved by Parliament and apply throughout England and Wales.</p><p>They define 'building work' and explain the procedures to ensure that work meets the required standards.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/building-surveys.html", "<p>Sometimes referred to as a structural survey, this is an in-depth structural analysis of the inside and outside of a property that should reveal any hidden faults. This is carried out by a chartered surveyor who writes an extensive report outlining any defects. Structural surveys tend to be carried out on older properties, those that have been poorly maintained or where there are subsidence concerns.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/buyers-market.html", "<p>The buyer has the advantage, as there are more people needing to sell than looking to buy. Since homes can stay on the market for months, sellers may be more willing to consider below-asking-price offers and make concessions like helping you pay closing costs, or fixing both major and minor repairs.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/certified-id.html", "<p>Confirmation of identification comes in two parts – your name and your address. The most common way to confirm your name is your passport and for your address it’s usual to provide a utility bill showing your name and address. Both these documents must be originals.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/chain.html", "<p>The often protracted situation whereby a buyer is waiting on the completion of the sale of an existing property in order to complete on the purchase of a new property.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/complete-by-date.html", "<p>The day when ownership of the property is passed to you and all conditions of the mortgage come into effect. The balance of the purchase price is paid and the seller hands over the deeds. The seller must move out on this date and you can move in. Your completion date is agreed when contracts are exchanged.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/completion.html", "<p>The completion date is the date that your solicitor forwards the money from your lender to the seller’s solicitor. In short, it’s the date that you become the legal owner of your new property.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/contents-insurance.html", "<p>Covers your household possessions against loss, damage or theft. Items covered by a typical contents policy include electrical goods, furniture, carpets, clothes, ornaments and paintings.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/conveyancer.html", "<p>A specialist lawyer who specialises in the legal aspects of buying and selling real property, or conveyancing. A conveyancer can also be a solicitor, a licensed conveyancer or a fellow of the Institute of Legal Executives.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/credit-rating.html", "<p>Normally based on a person’s credit history. This is an assessment of whether or not they will be able to keep up repayments on a loan.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/deeds.html", "<p>The legal documents that prove ownership of a property. Deeds are usually held by the lender.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/direct-debit.html", "<p>An instruction from you to your bank or building society. This authorises the organisation you want to pay to collect varying amounts from your account, but only if you’ve been given advance notice of the amounts and dates of collection. Once you have agreed those, the money is deducted automatically.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/disposable-income.html", "<p>The amount of money available for spending and saving after income taxes and other expenses have been accounted for. For example, if your income is £4,000 and you spend £2,200 on all your expenses, your disposable income is £1,800.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/enquiries.html", "<p>A collection of detailed questions from either party regarding various aspects of the prospective property for purchase. The seller or their solicitor must answer these fully before any contracts may be signed.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/equity.html", "<p>The amount of value in a property that isn’t covered by a mortgage. To work it out, simply subtract the amount of the mortgage from the valuation of the property. For example, if your house value is £500,000 and your current mortgage is £350,000, your equity would be £150,000.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/exchange-of-contracts.html", "<p>The point at which the buyer signs the contract for sale and sends it to the seller who also signs it. Both buyer and seller are then legally bound to complete the transfer. Once the contract has been signed, the contract becomes legally binding, meaning that if the buyer or seller pulls out prior to completion, they may have to pay compensation.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/fixed-rate.html", "<p>The interest rate set at an agreed rate for an agreed period, often two or five years. It is especially favoured by people who want to know exactly what they are paying each month as it is not vulnerable to changes in the base rate.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/fixtures-and-fittings.html", "<p>There is no legal definition of what constitutes fixtures and what constitutes fittings. However, it is generally considered that fixtures are items that are secured or bolted to the walls or floor and fittings are free-standing items.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/freehold.html", "<p>If you own your property’s freehold, you not only own the property itself but also the land that it is on.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/gazumping.html", "<p>This is when the person selling a property accepts an initial offer and then accepts a second, higher, offer from a different buyer prior to the exchange of contracts. This tends to happen in strong housing markets.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/gross-income.html", "<p>An individual's total personal income before taking taxes or deductions into account.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/higher-lending-charges.html", "<p>A charge made by mortgage lenders when the loan-to-value ratio of a mortgage is higher than they are prepared to accept at standard rates. Typically applied to loans in excess of 90% of the property value.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/home-buyers-report.html", "<p>A property survey or report. This is halfway between a mortgage valuation and a full survey, and is intended to satisfy the buyer that the property they are purchasing is in good condition.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/home-insurance.html", "<p>Home insurance can be split into two cover types – buildings insurance and contents insurance. Buildings insurance covers any damage to the structure of the building itself. Contents insurance covers damage to, or loss of, any personal possessions in the property. These can be bought separately, although most insurance providers also bundle both together.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/indemnity-fees.html", "<p>An insurance policy designed to protect the lender against loss in the event of you defaulting and ceasing to repay your mortgage. The policy may be insisted on by the lender at the start of the loan, but it\"s usually the borrower who pays the premium.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/independent-mortgage-advisor.html", "<p>To be able to call themselves independent, advisers must be able to offer advice on the full range of mortgage products and providers, make a fair and comprehensive analysis and recommend a suitable one for you in the light of your circumstances. They must also be free from any influence that could stop them recommending the best product for you.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/insurance-premiums.html", "<p>The amount of money charged by a company for active insurance coverage. The sum a person pays in premiums, also referred to as the rate, is determined by several factors, including age, health and the area a person lives in.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/interest-rate.html", "<p>Interest is what lenders charge people for borrowing money. Exactly how much interest is charged depends upon many factors, including the loan’s duration and the deemed credit risk.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/interest-rates.html", "<p>The amount charged, expressed as a percentage of the principal, by a lender to a borrower for the use of assets. Interest rates are typically noted on an annual basis, known as the annual percentage rate (APR).</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/key-facts-illustration.html", "<p>Explains the key features of your mortgage and tells you what your initial monthly payments would be, based on the information you provided during your quote.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/land-registry-fees.html", "<p>The fee paid to the Land Registry to register the ownership of a specific area of land.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/land-registry.html", "<p>An executive agency of the Government of the United Kingdom that registers the ownership of land and property in England and Wales. It is one of the largest property databases in Europe.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/lender.html", "<p>Any institution or individual who loans a borrower money. There are a number of types of lending organisations, including educational, commercial, lenders of last resort and mutual organisations. The most traditional type is a commercial lender, which is often a banking institution, though it may also be a private financial group.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/life-cover.html", "<p>Life assurance policies pay out either a lump sum or a series of payments when a person dies during the term of a policy, usually to his or her dependants. In most instances, these payments – known as the ‘sum assured’ – are tax-free.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/ltv.html", "<p>A mortgage term describing the amount of money a bank or building society will lend you as a percentage of your property’s value. 95% is a common LTV although in some cases they will lend the full value of the property, or 100% LTV.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/mortgage-deed.html", "<p>This is a deed that formally secures money against the property. It is drawn up by your mortgage lender to be signed before completion. Your conveyancer sends it to the Land Registry after completion.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/mortgage-offer.html", "<p>A written offer to lend money on a property. The mortgage offer will contain all the terms of the loan and the conditions upon which the money is lent to the borrower.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/mortgages.html", "<p>A loan where the mortgaged property acts as security for the lender until the loan is repaid in full — often after 25 years.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/net-worth.html", "<p>Refers to an individual's net economic position. It is calculated using the value of all assets (long term assets) minus the value of all liabilities. For example, if you have assets of £350,000 and liabilities of £150,000, your net worth is £200,000.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/neutral-market.html", "<p>Neither the buyer nor seller has an advantage, as the number of buyers looking for homes balances the number of homes for sale. Buyer and seller are on equal footing in negotiations, and most homes sell within a couple of days.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/non-refundable-admin-charge.html", "<p>A charge levied by the lender to cover the costs of processing your mortgage application. If you do not complete your application, the fee may not be refunded. The administration fee is also sometimes known as an application fee.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/notification-of-sale.html", "<p>This is another name for the Memorandum of Sale. It is a non-legally binding letter setting out the terms of the sale, including the details of the legal firms acting for each party.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/off-the-market.html", "<p>This typically means that the property is not available anymore and the seller has told their estate agents not to show it to other potential buyers.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/p60.html", "<p>A statement issued to taxpayers at the end of a tax year. It is important a taxpayer does not destroy the P60 forms issued to them, as they form a vital part of the proof that tax has been paid.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/planning-permission.html", "<p>Construction of new buildings and extensive changes to existing buildings usually requires consent from the local planning authority. This planning system is designed to control inappropriate development.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/rainy-day-fund.html", "<p>A reserved amount of money to be used when your regular income is disrupted or decreased in order for typical expenses to continue. We recommended having at least 3 months of your net salary put aside as a rainy-day or emergency fund.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/reinstatement-value.html", "<p>Refers not to the market value of the property, but what it would cost to rebuild using similar materials and methods of construction. This could apply to anything from sourcing a specific building stone or roof tiles, to recovering historic fireplaces.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/repayments.html", "<p>Requires borrowers to repay on a monthly basis not just the interest on the loan but also a slice of the capital borrowed. This kind of mortgage is usually favoured by more conservative homeowners who want to guarantee that at the end of the mortgage term, the property will belong to them.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/report-on-title.html", "<p>Provided by a solicitor, it comments on the extent to which the property title is good and marketable.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/search.html", "<p>A search is comprised of the checks carried out during the conveyancing process before the offer of a loan. They are made with local authorities and other organisations and reveal any planning proposals that could adversely affect the value of a property in the future.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/sellers-market.html", "<p>The seller has the advantage, as more buyers are homehunting than there are homes to buy. Prices often rise as more buyers compete for fewer homes, and many homes sell within a couple of days.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/shared-freehold.html", "<p>This means you will own a portion of the freehold and the freehold will be divided equally between all owners. For example, if there are 4 freehold flats in a block, each flat will own 25% of the freehold.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/stamp-duty.html", "<p>A tax levied on property purchases applied on a sliding scale according to the price of a property, as shown here:</p><p>Below £125,000 – free from stamp duty</p><p>£125,000 to £250,000 – 1%</p><p>£250,000 to £500,000 – 3%</p><p>£500,000 to £1m – 4%</p><p>£1m to £2m are charged at 5%.</p><p>£2m or more – 7% (15% if held in corporate accounts)</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/standard-variable-rate.html", "<p>A type of interest rate on a mortgage that often moves in line with the Bank of England base rate. However, unlike a tracker mortgage, changes are ultimately at the lender’s discretion.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/statement-of-completion.html", "<p>Sent by the seller's conveyancer to the buyer's conveyancer on the sale of freehold or leasehold properties. This document sets out exactly what amount is payable by the buyer on completion.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/subject-to-contract.html", "<p>The term ‘sold subject to contract’ has no legal standing but is a phrase used as a provisional agreement before contracts have been exchanged. At this point either party may still withdraw from the transaction. Often seen on estate agent boards.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/survey.html", "<p>A health check on a property telling you its exact current structural state, which is usually performed when the property is about to be sold. Surveys can often save the buyer money if there are any major structural problems, as they can bring about a change in the sale price.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/transactional-charges.html", "<p>Conveyancing costs are broadly split between the fees charged by the professional and are often associated with the transaction, such as searching the local authority database, and registering the property once the transfer has been undertaken.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/under-offer.html", "<p>A property is said to be under offer when a seller has accepted an offer from a buyer but the exchange of contracts has not yet been reached.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/underwriting.html", "<p>The process a lender uses to determine if the risk (especially the risk that the borrower will default) of offering a mortgage loan to a particular borrower is acceptable. Most of the risks and terms that underwriters consider fall under the three C’s of underwriting: capacity, collateral and character.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/valuation-fee.html", "<p>A fee charged by your mortgage lender for commissioning a mortgage valuation. A mortgage valuation is a basic inspection of your property, and its purpose is limited to establishing whether your home is suitable security to lend on.</p>");
    $templateCache.put("/partials/views/milestone-tracking/tooltips/variable-rate-mortgage.html", "<p>On a variable rate mortgage the interest rate charged by the lender goes up and down according to base rate movements, and your mortgage repayments change accordingly. The variable rate will always be slightly above the Bank of England base rate.</p>");
    $templateCache.put("/partials/views/mortgage-advice/mortgage-advice.html", "<div class=\"page-content page-content--mortgage-advice\"><div class=\"advice-section advice-section--intro\"><div class=\"advice-section__inner\"><h1>Mortgage Advice</h1><p>For most buyers, a mortgage is the largest debt load they’ll take on. However, most homeowners don’t fully understand how mortgages work and the process of getting one. We’re here to help you make sense of the ins and outs of mortgages, so read on to get the full picture.</p></div></div><accordion class=\"advice__sections\" data-close-others=\"false\"><div class=\"advice-section\"><div class=\"advice-section__inner\"><div class=\"advice__section\"><div class=\"accordion-heading\"><h3>What is mortgage?</h3></div><div class=\"accordion-body\"><div class=\"accordion-inner\"><p>Buying a new property will usually require you to get a loan. This type of loan is called a mortgage. In essence, rather than being a simple loan to be paid back at high interest rates over a short space of time, a mortgage is a loan secured on your property. This means that should you default on your mortgage, your bank may repossess your home. The standard term for mortgages is 25 years, although this can vary depending on your circumstances.</p></div></div></div></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[0]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Timing and progress</h3><i></i></accordion-heading><p>The time it takes you to arrange a mortgage depends on many factors. The main ones are the complexity of the deal and how busy the lender is. If you’re trying to work out timings, leave around 4-6 weeks to complete the whole deal. However, this is an average figure. Good mortgage advisors know which lender can process your application faster, and they can make product recommendations taking into account not only costs but also timing.</p><div class=\"advice__process\"><p class=\"advice__process-start\"><span>Start of Mortgage Process</span></p><ol><li class=\"item item1\"><span class=\"number\">1</span><div class=\"content content--align-top\"><span>Check your credit rating</span><div class=\"content-popup\"><ul><li>all lenders want to make sure they are lending money to someone who is likely to pay it back</li><li>Check your credit record \"online\" (link to Experian)</li><li>Simple things like paying all your credit cards on time and making sure you are on the voters roll at your current address will help</li><li>In general, the higher your credit score, the better your mortgage interest rates you can qualify for</li></ul></div></div></li><li class=\"item item2\"><span class=\"number\">2</span><div class=\"content content--align-top\"><span>Get mortgage advice</span><div class=\"content-popup\"><ul><li>Research the different ways of finding a mortgage lender yourself</li><li>Check online comparison websites</li><li>Get advice from an independent mortgage advicer - not only will they choose the best deal for you but they will also do the work for you!</li></ul></div></div></li><li class=\"item item3\"><span class=\"number\">3</span><div class=\"content content--align-top\"><span>Choose lender &amp; mortgage product</span><div class=\"content-popup\"><ul><li>Credit and affordability check by lender</li><li>Lender to confirm potential loan size</li></ul></div></div></li><li class=\"item item4\"><span class=\"number\">4</span><div class=\"content content--align-top\"><span>Get your documentation in order</span><div class=\"content-popup\"><ul><li>Lenders usually request detail of last three years address history (no gaps), last three months payslips and last P60 or three years accounts, your last three months bank statements and full details of any loans or credit cards you have</li><li>Providing this information on day one can speed up the process at the end</li></ul></div></div></li><li class=\"item item5\"><span class=\"number\">5</span><div class=\"content\"><span>Obtain a mortgage agreement in principle</span><div class=\"content-popup\"><ul><li>We suggest that you secure a mortgage agreement in principle before making an offer. This will ensure you know exactly what you can afford and also puts you in stronger position compare to competitors without an agreement in place</li><li>This will confirm in writing how much a lender will be prepared to lend you, subject to full mortgage application and underwriting</li><li>Confirms to vendor that you are creditworthy and a serious buyer</li></ul></div></div></li><li class=\"item item6\"><span class=\"number\">6</span><div class=\"content\"><span>Submit mortgage application</span><div class=\"content-popup\"><ul><li>Can be the most time consuming part and some lender's applications can be very detailed</li><li>Lenders will want full details of your employment or business, your existing loans or credit cards, bank account details and full details of the property</li><li>First stage that any money is actually spend, as some lenders will also take a non-refundable administration fee at this stage</li><li>Valuation fee is also typical at this stage</li></ul></div></div></li><li class=\"item item7\"><span class=\"number\">7</span><div class=\"content\"><span>Underwriting - Lender feedback on application</span><div class=\"content-popup\"><ul><li>Most frustrating part as the timing of this varies from lender to lender</li><li>First, lender will check all the documentation you have sent</li><li>Might require more information they want clarification on. If your application has been right however, this stage can be very quick</li></ul></div></div></li><li class=\"item item8\"><span class=\"number\">8</span><div class=\"content\"><span>Instruct valuation</span><div class=\"content-popup\"><ul><li>Second, lender will need to carry their own valuation on the property (which you have paid for)</li><li>This will show the overall condition and marketability of the property and then produce a valuation figure</li><li>Buyer can choose to upgrade to a Homebuyers or Structural survey which the same valuation officer can undertake</li></ul></div></div></li><li class=\"item item9 item--line-overlay\"><span class=\"number\">9</span><div class=\"content\"><span>Mortgage offer received</span><div class=\"content-popup\"><ul><li>Once underwriting has been successfully completed, finances checked and assuming the valuation figure is acceptable, the lender will produce a full Mortgage Offer</li><li>Will be sent to you and your solicitor which will detail the loan amount, the monthly repayments, details of the mortgage product and terms of the loan</li><li>Will also detail any special conditions that need to be met by you and/or your solicitor</li><li>Life cover should be considered and written in trust where appropriate to protect you and your family if you are not able to meet your mortgage payments due to unforeseen circumstances</li><li>Also need to arrange buildings and contents insurance to protect the property and your possessions ready for exchange</li></ul></div></div></li><li class=\"item item10\"><span class=\"number\">10</span><div class=\"content\"><span>Finalise mortgage - Solicitor</span><div class=\"content-popup\"><ul><li>Once the solicitor receives the full mortgage offer they will complete a \"Report on Title\"</li><li>This will include looking at Local Authority Reports, checking that the lease is all in order for leasehold properties and answering any specific questions the lender may have raised</li><li>Once complete this is then sent to the lender to review</li></ul></div></div></li><li class=\"item item11\"><span class=\"number\">11</span><div class=\"content\"><span>Exchange of contracts</span><div class=\"content-popup\"><ul><li>Once all parties, lender, solicitor and vendor, are happy an exchange and completion date is set</li><li>Exchange is the first date after which neither the buyer or seller can pull out of the transaction without large financial costs</li><li>A deposit of typically 10% of the purchase price is transferred to the vendors solicitor</li></ul></div></div></li><li class=\"item item12\"><span class=\"number\">12</span><div class=\"content\"><span>Complete purchase</span><div class=\"content-popup\"><ul><li>Your solicitor draws the remaining funds from you and your lender to complete on the purchase at the agreed date</li><li>Congratulations, you have purchased your home and can pick up the keys now</li></ul></div></div></li></ol><span class=\"line line--hori line--1\"></span><span class=\"line line--vert line--2\"></span><span class=\"line line--hori line--3\"></span><span class=\"line line--vert line--4\"></span><span class=\"line line--hori line--5\"></span><p class=\"advice__process-finish\"><span>Ready to move in</span></p></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[1]\" class=\"advice__section advice__money\"><accordion-heading class=\"advice__section-heading\"><h3>The money</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item three-fifths advice__money-screengrab\"><img ng-src=\"[[ STATIC_URL ]]images/advice-sections/mortgage-advice-widgets.ef9d016f.png\" alt=\"\"></div><div class=\"grid__item two-fifths advice__money-text\"><div class=\"advice__money-text-deposit\"><h4><i class=\"i sprite-icon-savings--blue\"></i>The Deposit</h4><p>Usually when you buy a property, you’ll need to put down a deposit. This amount depends on your financial situation, but to get the best mortgage deals, we’d recommend aiming for 20-25% of the full price of the property. Our Affordability Calculator takes into account all the costs involved in buying a property, including stamp duty and other associated costs.</p></div><div class=\"advice__money-text-mortgage\"><h4><i class=\"i sprite-icon-bag--green\"></i>The Mortgage</h4><p>The mortgage amount is the amount of cash you’ll actually be borrowing. Aside from interest on the loan, this is the total amount you will be paying back to the bank over the mortgage term. Our Affordability Calculator will show you not only your mortgage amount, but also your monthly repayments, calculated using a standard interest rate over the lifetime of the mortgage.</p></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[2]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Lenders' affordability criteria</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item one-half\"><p>When you're buying a home, mortgage lenders don't just look at your income, your assets and the down payment you're able to make. Your liabilities, monthly expenses and other obligations are important considerations as well. These may include car loans, credit card debts, child support payments, potential stamp duty and insurance premiums, as well as your overall credit rating. Our Affordability Calculator allows you to get a good idea how much of a mortgage you may be able to obtain. You can get a clear idea of your affordability with the three typical financial indicators, which the calculator assesses using a red-amber-green system.</p></div><div class=\"grid__item one-half\"><p><img ng-src=\"[[ STATIC_URL ]]images/advice-sections/mortgage-advice-indicators.831acfb1.png\" alt=\"\"></p></div></div><div class=\"grid advice__lenders-criteria__key\"><div class=\"grid__item one-third\"><div class=\"advice__lenders-criteria__key__item\"><i class=\"advice__lenders-criteria__key__icon key-icon__green\"></i><div class=\"advice__lenders-criteria__key__text\"><p>This area of your finances is fine. You shouldn’t have any trouble getting a mortgage based on this criteria, as long as your credit file is in good shape. However, every situation is different, so be sure to check with a Mortgage Advisor.</p></div></div></div><div class=\"grid__item one-third\"><div class=\"advice__lenders-criteria__key__item\"><i class=\"advice__lenders-criteria__key__icon key-icon__yellow\"></i><div class=\"advice__lenders-criteria__key__text\"><p>You may have a little trouble finding a mortgage lender that will lend you the required amount on the right terms. However, a good Mortgage Advisor may be able to help you find a suitable mortgage.</p></div></div></div><div class=\"grid__item one-third\"><div class=\"advice__lenders-criteria__key__item\"><i class=\"advice__lenders-criteria__key__icon key-icon__red\"></i><div class=\"advice__lenders-criteria__key__text\"><p>This criteria breaches most lender’s requirements, and as a result it may be difficult for you to find a loan for the required amount and term.</p></div></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[3]\" class=\"advice__section advice__fees\"><accordion-heading class=\"advice__section-heading\"><h3>The fees</h3><i></i></accordion-heading><p>This is one of the most important and confusing areas of getting a mortgage. Understanding the costs of a mortgage is key to being able to accurately determine your purchasing power and choose the best product.</p><div class=\"grid advice__fees__content\"><div class=\"grid__item two-fifths advice__fees-left\"><div class=\"advice__fees-content-row advice__fees-content-row--pound\"><i class=\"i sprite-icon-blue-pound\"></i><h4>Annual Percentage (APR)</h4><p>APR, or annual percentage rate, is a single percentage value that allows you to compare the cost of a mortgage product. It takes into account not only the amount of interest, but also any other fees charged by the lender, such as arrangement fees for setting up a loan. Put simply, the lower the APR the better.</p></div><div class=\"advice__fees-content-row advice__fees-content-row--percent\"><i class=\"i sprite-icon-percent\"></i><h4>Interest</h4><p>Interest is the amount your lender charges you for borrowing money. This is based on the amount and the type of loan, as well as your credit risk as a borrower.</p></div></div><div class=\"grid__item three-fifths advice__fees-right\"><div data-pl-tabset=\"feesTabset\" data-pl-css-block-modifier=\"vertical\"><div data-pl-tab=\"\" data-pl-tab-title=\"Mortgage arrangement fee\"><p>A fee that can be bundled into the mortgage amount or paid separately. This is a basic admin charge factoring in the costs of your loan over the full term. These are usually only applicable to special-rate or discounted-rate mortgages.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Valuation fee\"><p>The lender needs to know that the property is worth lending against, which means they have to commission a professional valuation. The borrower usually foots the bill for this.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Mortgage account fee\"><p>This is a charge made by lenders to cover the costs of providing, maintaining and closing a mortgage.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Higher lending charge\"><p>This is usually only applicable to those looking for a mortgage for a high percentage of the property’s full price. This fee is often used by lenders to take out insurance on repayments, so they don’t lose out if you default.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Remittance fee\"><p>This is the transfer fee charged by lenders for sending monies to your solicitor at completion.</p></div><div data-pl-tab=\"\" data-pl-tab-title=\"Early redemption fee\"><p>While there are lenders with mortgage products that do not charge this fee, in most cases you incur penalties for paying off your mortgage early. This will often come into play if you’re moving mortgages or want to make one-off repayments. This usually applies to fixed-rate and discounted mortgages only.</p></div></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[4]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Repayment options</h3><i></i></accordion-heading><div class=\"advice__comparison-panels compare-two\"><div class=\"advice__comp-panel comp-panel\"><h4 class=\"comp-panel-heading comp-panel-heading--blue\">Repayment mortgages</h4><div class=\"comp-panel-body\"><p>These are often called capital and interest mortgages. This is the most common type of mortgage, where the monthly payments are made up of interest and the principle. These payments are constant from month-to-month, as long as the rate on your mortgage stays the same. Repayment mortgages are lower-risk options that ensure that by the end of the mortgage term, you will have paid off the entire mortgage, and the property will be fully yours.</p></div></div><div class=\"advice__comp-panel-vs-div advice__comp-panel-vs-div--blue-green\"></div><div class=\"advice__comp-panel comp-panel\"><h4 class=\"comp-panel-heading comp-panel-heading--green\">Interest-only mortgages</h4><div class=\"comp-panel-body\"><p>Interest-only mortgages allow borrowers to pay off just the interest on the amount borrowed. This means that you will eventually need to repay the money you originally borrowed. While it might be advantageous in low-interest rate environments, it is a high-risk option, usually taken by speculative property buyers.</p></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[5]\" class=\"advice__section advice__types\"><accordion-heading class=\"advice__section-heading\"><h3>Types of mortgages</h3><i></i></accordion-heading><div data-pl-tabset=\"mortgageTypesTabset\" data-pl-css-block-modifier=\"main\"><div data-pl-tab=\"\" data-pl-tab-title=\"Fixed Rate\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-fixed-rate\"></i></div><div class=\"advice__types__text\"><p>A fixed-rate mortgage offers a fixed interest rate for between 2 and 5 years. At the end of this introductory rate, your lender’s standard variable rate is used.</p><h4>Consider this type of loan</h4><ol><li>If you find a low fixed rate mortgage in comparison to the tracker mortgages</li><li>If you’re averse to risk and feel more comfortable with unchanging payments</li><li>You believe that interest rates are more likely to go up than down in the future</li></ol><h4>What to ask your advisor</h4><ol><li>If interest rates drop significantly, how would I refinance this loan and what are the associated costs?</li><li>What is the risk of not remortgaging after the fixed term expires?</li></ol></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Tracker\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-tracker\"></i></div><div class=\"advice__types__text\"><p>Tracker mortgages usually follow the Bank of England’s base rate. Therefore, if interest rates increase by 1%, your mortgage rate will too.</p><h4>Consider this type of loan</h4><ol><li>If you can secure a very low rate of interest</li><li>If you believe that Bank of England’s base rate is not likely to increase in the near future</li><li>If you prefer the idea of a more stable rate of interest, not subject to your lender’s SVR</li></ol><h4>What to ask your advisor</h4><ol><li>If the base rate rises significantly, how would I refinance this loan and what are the associated costs?</li><li>Is this the right mortgage if I am on a tight budget and need to know exactly how much my monthly mortgage repayments will be?</li></ol></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Standard Variable\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-standard-variable\"></i></div><div class=\"advice__types__text\"><p>With a standard variable-rate mortgage, your payments change based on the lender’s standard variable rate (SVR). In most cases, rather than buying a SVR product, you find yourself in this kind of deal after the introductory term on your fixed-rate product runs out.</p><h4>Consider this type of loan</h4><ol><li>If you find it very difficult to remortgage to another product due to changes in your financial situation</li><li>If your previous mortgage deal has come to an end and you have been transferred onto a low SVR. While it’s not very common, your current lender might offer an attractive SVR in order not to lose business to competitors</li></ol><h4>What to ask your advisor</h4><ol><li>How do SVRs compare to tracker mortgages?</li><li>Will the lender always pass on changes in the Bank of England base rate to me, even if rates go down?</li><li>Can the lender increase the SVR, even if the Bank of England does not increase rates?</li><li>I am on a SVR currently. Should I remortgage now?</li></ol></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Capped Rate\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-capped-rate\"></i></div><div class=\"advice__types__text\"><p>With capped-rate mortgages, you will be on the lender’s SVR unless it hits your cap. Any further increase in the interest rate after this point won’t affect your mortgage rate. This type of mortgage usually has a specified period of capping.</p><h4>Consider this type of loan</h4><ol><li>If you want the security of an upper limit to your interest rates.</li><li>If you think interest rates are set to skyrocket.</li></ol><h4>What to ask your advisor</h4><ol><li>What will happen to the rate after the specified period?</li><li>Can I get a longer capping period?</li><li>Why don’t I see more of these capped-rate mortgage products around?</li></ol></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Discount Rate\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-discount-rate\"></i></div><div class=\"advice__types__text\"><p>In most cases discount-rate mortgages are just fixed-rate mortgages with attractive initial rates. Think of them as special offers from lenders to win new business. The discount period usually lasts 2 to 5 years and will then revert to the SVR.</p><h4>Consider this type of loan</h4><ol><li>If you’re a bargain hunter looking for a good deal.</li><li>If you know you’re going to remember to remortgage once the discount term expires.</li></ol><h4>What to ask your advisor</h4><ol><li>Even with the low initial rate, is this the best overall mortgage for me?</li><li>Is the discount fixed or linked to a SVR? How high can my discount rate go?</li><li>What are my remortgaging options once this deal runs out?</li></ol></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Offset\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-mortgage-advice-type-offset\"></i></div><div class=\"advice__types__text\"><p>Offset loans consider all your finances, including current accounts, savings accounts and other personal loans. Your lender calculates your net worth on a daily basis and offsets your assets against your loans, which includes your mortgage.</p><h4>Consider this type of mortgage</h4><ol><li>If you have additional money sitting in a savings account.</li><li>If you pay a high rate of tax. With offset mortgages, you don’t pay tax on savings.</li></ol><h4>What to ask your advisor</h4><ol><li>How much more interest am I likely to be paying over the full term, compared to other types of mortgage?</li><li>Are there variable and fixed options? How do they stack up against other deals?</li><li>What kind of sum do I need saved to make an offset mortgage worthwhile?</li></ol></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[6]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>Get award winning, independent &amp; impartial mortgage advice</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item two-thirds\"><ul><li>A dedicated mortgage advisor to help you through the process.</li><li>Whole of the market access to thousands of mortgage deals.</li><li>Someone who handles all the paperwork and liaises direct with your lender, saving you time &amp; work.</li><li>Regular updates about your application every step of the way.</li><li>Explaining the pros and cons of each product in a simple, jargon free manner.</li><li>Extensive knowledge of the market.</li></ul></div><div class=\"grid__item one-third\"><img data-ng-src=\"[[ STATIC_URL ]]images/partner-assets/mortgage-advisor-logo.81b3ba57.png\" class=\"advice-section__image\"><div class=\"yellow-box\"><p>Your home may be repossessed if you do not keep up repayments on your mortgage.</p><p>A fee of up to 1% of the mortgage amount may be charged depending on individual circumstances. A typical fee is &pound;495.</p></div><p><small class=\"smaller\">MAB 4884</small></p></div></div></accordion-group></div></div></accordion><div class=\"advice-section advice-section--complete\"><div class=\"advice-section__inner\"><div class=\"line line--hori\"></div><button class=\"contact-button contact-button--mortgage-advisor--grey\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a Mortgage Advisor</button></div></div></div>");
    $templateCache.put("/partials/views/my-documents/my-documents.html", "<div class=\"page-content page-content--documents\"><h2>My Documents</h2></div>");
    $templateCache.put("/partials/views/property-coach/property-coach.html", "<div class=\"page-content page-content--property-coach\"><div class=\"advice-section advice-section--intro\"><div class=\"advice-section__inner\"><h1>Property Coach</h1><p>Having a Property Coach on your side for some or all of your homebuying journey can help you feel more confident about your decisions. They’ll be there to answer your questions and save you time, stress and money. Read on to find out more about what they can do for you.</p></div></div><accordion class=\"advice__sections\" data-close-others=\"false\"><div class=\"advice-section\"><div class=\"advice-section__inner\"><div class=\"advice__section\"><div class=\"accordion-body\"><div class=\"grid\"><div class=\"grid__item three-fifths\"><div class=\"accordion-heading\"><h3>What is a Property Coach?</h3></div><div class=\"accordion-inner\"><p>Property Coaches are experts dedicated to finding and securing your perfect property. You can hire them for any part of the rental and homebuying journey and they can advise you on anything from sourcing properties to writing an offer letter and negotiating a price. The great thing about Property Coaches is that they’re 100 per cent there for you. Unlike estate agents, they offer completely impartial advice saving you time and money.</p></div></div><div class=\"grid__item two-fifths\"><img ng-src=\"[[ STATIC_URL ]]images/advice-sections/property-coach-photos.7e044a54.jpg\" alt=\"\"></div></div></div></div></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[0]\" class=\"advice__section\"><accordion-heading class=\"advice__section-heading\"><h3>What is the process using a Property Coach?</h3><i></i></accordion-heading><div class=\"advice__process\"><p class=\"advice__process-start\"><span>Start of Property Coach Process</span></p><ol><li class=\"item item1\"><span class=\"number\">1</span><div class=\"content content--align-top\"><span>Free, no obligation meeting or call</span><div class=\"content-popup\"></div></div></li><li class=\"item item2\"><span class=\"number\">2</span><div class=\"content content--align-top\"><span>Comprehensive buyer and property brief</span><div class=\"content-popup\"></div></div></li><li class=\"item item3\"><span class=\"number\">3</span><div class=\"content content--align-top\"><span>Orientation tour of selected areas</span><div class=\"content-popup\"></div></div></li><li class=\"item item4\"><span class=\"number\">4</span><div class=\"content\"><span>Property search by Property Coach</span><div class=\"content-popup\"></div></div></li><li class=\"item item5\"><span class=\"number\">5</span><div class=\"content\"><span>Report to your shortlist</span><div class=\"content-popup\"></div></div></li><li class=\"item item6\"><span class=\"number\">6</span><div class=\"content\"><span>Arrange viewings with you</span><div class=\"content-popup\"></div></div></li><li class=\"item item7 item--line-overlay\"><span class=\"number\">7</span><div class=\"content\"><span>Negotiate on your behalf</span><div class=\"content-popup\"></div></div></li><li class=\"item item8\"><span class=\"number\">8</span><div class=\"content\"><span>Manage legal process</span><div class=\"content-popup\"></div></div></li><li class=\"item item9\"><span class=\"number\">9</span><div class=\"content\"><span>Help to settle in</span><div class=\"content-popup\"></div></div></li></ol><span class=\"line line--hori line--1\"></span><span class=\"line line--vert line--2\"></span><span class=\"line line--hori line--3\"></span><span class=\"line line--vert line--4\"></span><span class=\"line line--hori line--5\"></span><p class=\"advice__process-finish\"><span>Ready to move in</span></p></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[1]\" class=\"advice__section advice__types\"><accordion-heading class=\"advice__section-heading\"><h3>How can a Property Coach help me?</h3><i></i></accordion-heading><div data-pl-tabset=\"propertyCoachHelp\" data-pl-css-block-modifier=\"main\"><div data-pl-tab=\"\" data-pl-tab-title=\"Expert in property buying\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-property-coach-type-expert\"></i></div><div class=\"advice__types__text\"><p>Property coaches are true experts in the property market and know everything there is to know about locations, prices and the buying process. What’s more they take the time to get to know your situation, which allows them to identify areas and properties based on your criteria, such as commuting distance and proximity to schools.</p><p>Property Coaches have a large network of estate agents and regularly get access to properties that are coming to market before they’re made available to the general public. If you’re looking for development opportunities, they can not only source targets, but also help you find an appropriate architect, builder and other tradesmen for the task.</p><p>For a smooth homebuying journey and peace of mind, a Property Coach is probably the best way to go. They’ll not only shortlist and preview potential properties for you, but they’ll also give you a clear evaluation of things like security, local planning policies, transport links and buildings reports.</p></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Master of negotiation\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-property-coach-type-master\"></i></div><div class=\"advice__types__text\"><p>Coming up with a fair price estimate is more art than science. If your offer and negotiation process is not managed well, the price may end up far away from the fair value of the property.</p><p>Property coaches also give you the upper hand in negotiations. have built a sense of prices They do all the information gathering and background checks on properties, so you don’t have to. They’ll also handle the negotiations for you. This can save you a fortune if you’re not someone who’s particularly confident with money matters.</p><p>Simply having a Property Coach can speed up the process, as sellers and agents know from experience that buyers with Property Coaches are serious and are not going to be bullied or out-negotiated. In fact, in most cases hiring a Property Coach saves you money over the course of your homebuying journey, so it’s always worth looking into.</p></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Someone you can trust &amp; actually talk to\"><div class=\"advice__types__icon\"><i class=\"sprite-icon-property-coach-type-trust\"></i></div><div class=\"advice__types__text\"><p>Being able to trust someone that’s solely looking out for your interests can often make the difference between a smooth homebuying journey and a tumultuous nightmare. Having someone there that’s got concrete answers to your questions makes it easier for you to feel confident in your decisions.</p><p>A Property Coach acts as a single point of contact and gives you a completely bespoke service. They know that every buyer is different, so they take the time to get to know you before helping you through the process, from dealing with complex paperwork to settling in to your new community.</p></div></div></div></accordion-group></div></div><div class=\"advice-section\"><div class=\"advice-section__inner\"><accordion-group data-ng-class=\"{true:'active', false:''}[isOpen]\" data-is-open=\"accordionStates[2]\" class=\"advice__section advice__property-coach-get-started\"><accordion-heading class=\"advice__section-heading\"><h3>How can I get started?</h3><i></i></accordion-heading><div class=\"grid\"><div class=\"grid__item two-thirds\"><div class=\"property-coach-get-started__option-panels\"><div class=\"property-coach-get-started__panel property-coach-get-started__panel--orientation\"><h4 class=\"property-coach-get-started__panel__header\">Not ready to buy yet?</h4><div class=\"property-coach-get-started__panel__body\"><h3>The Rental</h3><p>Stress free rental search</p><div class=\"property-coach-get-started__panel__num-wrap\"><div class=\"number\"><span>&pound;</span>495</div><span class=\"number-label\">Retainer fee</span></div><div class=\"property-coach-get-started__panel__num-wrap\"><div class=\"number number-text\">1 month rent</div><span class=\"number-label\">Success fee</span></div></div><div class=\"property-coach-get-started__panel__footer\"><a href=\"#\" data-ng-click=\"openDialog('propertyCoachOrientation')\">Get more info</a></div></div><div class=\"property-coach-get-started__panel-div\"><div class=\"property-coach-get-started__panel-div__icon-wrap\"><i></i></div></div><div class=\"property-coach-get-started__panel property-coach-get-started__panel--unlimited\"><h4 class=\"property-coach-get-started__panel__header\">Ready to buy a property!</h4><div class=\"property-coach-get-started__panel__body\"><h3>The Purchase</h3><p>3 months, unlimited properties</p><div class=\"property-coach-get-started__panel__num-wrap\"><div class=\"number\"><span>&pound;</span>495</div><span class=\"number-label\">Retainer fee</span></div><div class=\"property-coach-get-started__panel__num-wrap\"><div class=\"number\">1.5%</div><span class=\"number-label\">Success fee</span></div></div><div class=\"property-coach-get-started__panel__footer\"><a href=\"#\" data-ng-click=\"openDialog('propertyCoachUnlimited')\">Get more info</a></div></div></div></div><div class=\"grid__item one-third property-coach-get-started__aside-info\"><h4>Every Property Coach is</h4><ul><li>An expert in property buying</li><li>Master of negotiation</li><li>Someone you can trust and actually talk to</li></ul><h4>Our Commintment to You</h4><ul><li>Stress Free. Guaranteed</li><li>Unlimited access</li><li>White glove treatment</li><li>No conflicts</li></ul></div></div></accordion-group></div></div></accordion><div class=\"advice-section advice-section--complete\"><div class=\"advice-section__inner\"><div class=\"line line--hori\"></div><h2>Our Property Coach will Find Your Dream Home</h2><button class=\"contact-button contact-button--property-coach\" data-ng-click=\"openDialog('propertyCoach')\"><span class=\"i\"></span>Speak to a Property Coach</button></div></div></div>");
    $templateCache.put("/partials/views/property-search/compare.html", "<div class=\"property-search-modal property-search-modal--compare\" data-ng-controller=\"PropertyModalController\"><div class=\"property-search-modal__outer-wrap\"><section class=\"property-search-modal__inner-wrap\"><div class=\"property-search-modal__content\"><a class=\"property-details__close-button\" data-ng-href=\"/property-search/[[getQueryStringForSearch()]]\"></a><header class=\"property-search-modal__header\"><nav class=\"property-search-modal__navigation\" id=\"navPills\"><ul class=\"nav\"><li class=\"active\"><a class=\"property-search-modal__navigation-link\" href=\"#overview\" data-scroll-to=\"#overview\">Property Details</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#floorplan\" data-scroll-to=\"#floorplan\">Floor Plan</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#location\" data-scroll-to=\"#location\">Location</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#financials\" data-scroll-to=\"#financials\">Financials</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#contact\" data-scroll-to=\"#contact\">Contact</a></li></ul></nav></header><div class=\"property-search-modal__scroll-pane scroll-pane--fvsb\" data-pl-scroll-pane=\"numProperties\"><div class=\"property-compare\"><div class=\"property-compare__side-by-side-container\" data-ng-class=\"{ 'is-empty': numProperties < 1 }\"><div class=\"property-compare__column\" data-ng-class=\"{ 'property-compare__column--left': $index == 0, 'property-compare__column--right': $index == 1, 'property-compare__column--empty': !prop }\" data-ng-repeat=\"prop in properties\"><div id=\"overview\" class=\"property-compare__column__content\" data-ng-controller=\"PropertyDetailController\" data-ng-init=\"configure([[$index]])\"><div class=\"property-compare__dropzone\" data-ng-hide=\"!isDragging && prop\" data-dropzone-id=\"[[$index]]\" data-pl-droppable=\"{ callbacks: { drop: onPropertyDropped }, jquiOptions: { accept: '.property-search-result__link', hoverClass: 'is-hovered', tolerance: 'pointer' } }\"><span class=\"i i-property-dropzone\"></span><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><div class=\"property-compare__property-container\" data-ng-show=\"prop\"><a class=\"property-compare__remove-property-button\" data-ng-click=\"removeProperty($index)\"></a><span class=\"selected-property-number--[[$index + 1]]\"></span><div class=\"property-details__header__details\"><h1 class=\"property-details__address\">[[ property.displayable_address ]]</h1><span data-ng-switch=\"property.price_modifier\" data-ng-class=\"{'property-details__overview-panel-item--price--with-modifier': property.price_modifier, 'property-details__overview-panel-item--price': !property.price_modifier, 'property-details__overview-panel-item--price--modifier-only': property.price_modifier == 'price_on_request' }\"><span data-ng-switch-when=\"offers_over\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Offers over</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"poa\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Price on application</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"fixed_price\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Fixed price</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"from\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">From</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"offers_in_region_of\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Offers in region of</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"part_buy_part_rent\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Part buy part rent</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"price_on_request\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Price on request</span></span><span data-ng-switch-when=\"shared_equity\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Shared equity</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"shared_ownership\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Shared ownership</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"guide_price\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Guide price</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"sale_by_tender\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Sale by tender</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-default=\"\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span></span><span class=\"property-details__overview-panel-item--bedrooms\"><i class=\"i i-bedroom--compare\"></i>[[ property.num_bedrooms ]]</span><span class=\"property-details__overview-panel-item--bathrooms\" data-ng-show=\"property.num_bathrooms > 0\"><i class=\"i i-bathroom--compare\"></i>[[ property.num_bathrooms ]]</span></div><div data-pl-tabset=\"compareTabset\" data-pl-css-block-modifier=\"main\" id=\"details\" callback=\"tabChanged\"><div data-pl-tab=\"\" data-pl-tab-title=\"Photos\"><div class=\"property-details__gallery-container\"><div data-pl-gallery=\"refs.images\" data-pl-gallery-options=\"{ page_size: 4 }\"></div></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Street View\"><div class=\"property-details__streetview\" data-pl-streetview=\"streetviewOptions\" data-refresh-trigger=\"refreshTriggers.sv\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Map\"><div class=\"property-details__map\" data-pl-google-map=\"refs.property_map\" data-refresh-trigger=\"refreshTriggers.map\"></div></div></div><section class=\"property-details__main-section property-details__main-section--first property-details__main-section--details\"><div class=\"property-details__main-section__content\" data-accordion=\"\" data-close-others=\"false\"><section class=\"property-details__subsection property-details__subsection--description\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.description\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Property Description</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><div data-pl-show-more=\"2\" data-pl-show-more-bind=\"property.description\"><p class=\"property-details__description\" data-ng-bind=\"property.description\"></p></div></div></section><section class=\"property-details__subsection property-details__subsection--listing-info\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.listing_info\"><div data-pl-accordion-sync2=\"accordionSections.listing_info\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Listing Info</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content property-details__subsection__content--listing-info\"><div class=\"property-affordability-card property-affordability-card--[[affordabilityColour]]\"><div class=\"property-affordability-card__header\"><div data-ng-show=\"affordabilityColour == 'green'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'amber'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'red'\">This property may exceed your budget</div><div data-ng-show=\"affordabilityColour == 'grey'\">Visit our <a data-ng-href=\"/calculators/affordability/\">calculators</a> to check affordability</div></div><div class=\"property-affordability-card__body\"><span class=\"property-affordability-card__price-modifier\">Asking price</span><span class=\"property-affordability-card__price\" data-ng-bind=\"property.price | noFractionCurrency:'£'\"></span></div><div class=\"property-affordability-card__footer\"><span class=\"property-affordability-card__room-count--bedrooms\"><i class=\"i i-bedroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bedrooms\"></span></span><span class=\"property-affordability-card__room-count--bathrooms\" data-ng-show=\"property.num_bathrooms > 0\"><i class=\"i i-bathroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bathrooms\"></span></span></div></div><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can edit the fields below. Your changes will be saved to your account.</p><div class=\"property-details__custom-user-listing-data\"><form name=\"custom-listing-data\" class=\"property-details__custom-data-form\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"estimated-purchase-price-input\">Estimated purchase price:</label><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" id=\"estimated-purchase-price-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" pl-number=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.estimatedPrice\"></div></div></fieldset><fieldset class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Gross internal area:</div><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">sq ft</span><input type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.grossInternalArea\"></div><div class=\"input inline-fieldset__field inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">sqm</span><input disabled=\"disabled\" type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"computedFields.grossInternalAreaSqM\"></div></div></fieldset><div class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Price per sq ft:</div><span class=\"property-details__price-per-square-ft\" data-ng-hide=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\" data-ng-bind=\"computedFields.pricePerSqFt | noFractionCurrency:'£'\">0</span><span class=\"property-details__price-per-square-ft\" data-ng-show=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\">n/a</span></div></div><div class=\"property-details__custom-user-listing-data__right-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden:</div><span class=\"radio-input\"><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"yes\" data-ng-model=\"property.customFields.garden\">Yes<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"no\" data-ng-model=\"property.customFields.garden\">No<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden facing:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.gardenFacing\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"north\">North</option><option value=\"east\">East</option><option value=\"south\">South</option><option value=\"west\">West</option><option value=\"northwest\">North West</option><option value=\"northeast\">North East</option><option value=\"southwest\">South West</option><option value=\"southeast\">South East</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Floors:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.floors\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"basement\">Basement</option><option value=\"ground\">Ground floor</option><option value=\"first\">1st floor</option><option value=\"second\">2nd floor</option><option value=\"third\">3rd floor</option><option value=\"higher\">Higher up</option><option value=\"mixed\">Mixed levels</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Is the seller in a chain?</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.sellerChain\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"yes\">Yes</option><option value=\"no\">No</option></select></fieldset></div></form></div></div></div></section><section class=\"property-details__subsection property-details__subsection--ownership-status\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.ownership_status\"><div data-pl-accordion-sync2=\"accordionSections.ownership_status\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Ownership Status</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><form name=\"custom-ownership-data\" class=\"property-details__custom-data-form property-details__custom-data-form--ownership\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Leasehold/Freehold:</div><div class=\"inline-fieldset__field-row\"><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.ownershipType\"><option value=\"freehold\">Freehold</option><option value=\"freehold-share\">Share of freehold</option><option value=\"leasehold\">Leasehold</option></select></div></fieldset><fieldset class=\"inline-fieldset\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><label class=\"inline-fieldset__label\" for=\"leashold-period-input\">Leasehold period:</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field\"><input type=\"number\" name=\"leashold-period\" id=\"leashold-period-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.leasholdPeriod\"></div></div></fieldset></div><div class=\"property-details__custom-user-listing-data__right-column\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"ground-rent-monthly-input\">Ground rent?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">Monthly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-monthly\" id=\"ground-rent-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.groundRentMonthly\" data-ng-change=\"groundRentMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">Yearly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-annually\" id=\"ground-rent-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.groundRentAnnually\" disabled=\"disabled\"></div></div></fieldset><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"management-fee-monthly-input\">Management fee?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-monthly\" id=\"management-fee-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.managementFeeMonthly\" data-ng-change=\"managementFeeMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-annually\" id=\"management-fee-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.managementFeeAnnually\" disabled=\"disabled\"></div></div></fieldset></div></form><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">If you are unsure what this means, it may make sense to hire your solicitor earlier.</p><button class=\"contact-button--solicitor\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Solicitor</span></button></div></div></div></section></div></section><div data-accordion=\"\" data-close-others=\"false\"><div id=\"floorplan\"><section class=\"property-details__main-section property-details__main-section--floor-plan\" id=\"floorplan\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.floorplan\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Floor Plan</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><span data-ng-show=\"!property.floor_plan\">Floorplan not available</span><div data-ng-show=\"property.floor_plan\"><ul class=\"property-details__floorplan-indicator-list\"><li class=\"property-details__floorplan-indicator\" data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-class=\"{ 'is-active': $index == refs.floorplanIndex}\" data-ng-click=\"refs.floorplanIndex = $index\"><span></span></li></ul><ul class=\"property-details__floorplan-list\"><li data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-show=\"$index == refs.floorplanIndex\"><div data-ng-switch=\"getFloorplanFiletype($index)\" pl-floorplan=\"floorplan\"></div></li></ul></div></div></section></div><div id=\"location\"><section class=\"property-details__main-section property-details__main-section--location\" id=\"location\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.location\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Location and Neighbourhood</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__subsection-box--nearby-stations\"><div class=\"property-details__subsection-box__header\">Nearby Stations</div><div class=\"property-details__subsection-box__content\"><ul class=\"property-details__station-list\"><li class=\"property-details__station-list-item\" data-ng-repeat=\"station in nearbyStations | limitTo:3\"><span class=\"property-details__station-list-item__icon i\" data-ng-class=\"{'i-nearby-station--national-rail': station.mode == 'train', 'i-nearby-station--tube': station.mode == 'tube'}\"></span><span class=\"property-details__station-list-item__name\" data-ng-bind=\"station.name\"></span><span class=\"property-details__station-list-item__travel-info\"><span class=\"property-details__station-list-item__travel-distance\" data-ng-bind=\"station.__plentific__computed.distanceInMiles | number:2\"></span> mi<span class=\"property-details__station-list-item__travel-mode-icon i i-travel-mode--walk\"></span><span class=\"property-details__station-list-item__travel-duration\" data-ng-bind=\"station.__plentific__computed.estimatedWalkingDuration | duration:'hours'\"></span></span><span class=\"property-details__station-list-item__travel-time-bar property-details__station-list-item__travel-time-bar--[[station.__plentific__computed.walkingBarColor]]\"><span class=\"property-details__station-list-item__travel-time-bar__container\"><span class=\"property-details__station-list-item__travel-time-bar__fill\" data-ng-style=\"{ 'width': station.__plentific__computed.walkingBarLength + '%'}\"><span class=\"property-details__station-list-item__travel-time-bar__label\">Walking</span></span></span></span></li></ul></div></div><div class=\"property-details__subsection-box--travel-times\"><div class=\"property-details__subsection-box__header\">Travel Time to Work<span class=\"i-powerd-by-google-light-bg\">Powered by Google</span></div><div class=\"property-details__subsection-box__content\"><div class=\"property-details__travel-time-partipants\"><div class=\"property-details__travel-time-partipant--1\"><form name=\"travelTimeP1Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[0].firstName || \"You\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[0].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant1.workPostcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant1.workPostcode\">Enter your work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP1Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'car')\" data-ng-href=\"[[ getDirectionsUrl(1, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(1, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(1, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(1, 'transit') ]]\" target=\"_blank\">(Get Directions)</a></li></ul></div></form></div><div class=\"property-details__travel-time-partipant--2\"><form name=\"travelTimeP2Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[1].firstName || \"Partner\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[1].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant2.workPostcode\" data-ng-init=\"travelTimes.participant2.workPostcode=caseData.applicants[1].work_postcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant2.workPostcode\">Enter your partner's work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP2Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'car')\" data-ng-href=\"[[ getDirectionsUrl(2, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(2, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(2, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(2, 'transit') ]]\" target=\"_blank\"><span data-ng-show=\"travelTimes.participant2.travelModes.transit.status == 'ERROR'\">(</span>Get Directions)</a></li></ul></div></form></div></div></div></div></div></section></div></div></div></div></div></div><div data-accordion=\"\" data-close-others=\"false\"><div id=\"financials\" data-ng-show=\"properties[0] || properties[1]\"><section class=\"property-details__main-section property-details__main-section--financials property-details__main-section--shared\" id=\"financials\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.financials\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section--financials__content-wrapper\"><div class=\"property-details__main-section--item-wrapper\"><div class=\"property-details__subsection-box-financials-salary\"><div class=\"property-details__subsection-box__header\">Salary</div><div class=\"property-details__subsection-box__content\"><table><thead><tr><th></th><th>Gross annual income</th><th>Net monthly income</th></tr></thead><tbody data-ng-switch=\"propertyFinancials.applicants.length\"><tr data-ng-repeat=\"applicant in propertyFinancials.applicants\"><td class=\"property-details__subsection-box-financials-salary__avatar\"><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ applicant.avatar_48 ]]\"></td><td class=\"property-details__subsection-box-financials-salary__gross\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"></div></div></td><td class=\"property-details__subsection-box-financials-salary__net\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.netMonthlyIncome\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.netMonthlyIncome\"></div></div></td></tr><tr data-ng-switch-when=\"1\"><td colspan=\"3\" class=\"add-applicant-row\"><button class=\"property-details__add-applicant-button\" data-ng-click=\"addApplicant()\"><i class=\"i i-add-applicant\"></i>Add applicant</button></td></tr></tbody></table></div></div></div><div class=\"property-details__main-section--item-wrapper--savings-and-expenses\"><div class=\"property-details__subsection-box-financials-savings\"><div class=\"property-details__subsection-box__header\">Savings</div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--positive editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.savings\"></div></div></div></div><div class=\"property-details__subsection-box-financials-expenses\"><div class=\"property-details__subsection-box__header\">Household expenses <span>(excl. accommodation)</span></div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--negative editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"></div></div></div></div></div></div><section class=\"property-details__subsection property-details__subsection--scenario-analysis\"><div class=\"property-details__subsection__content\"><h1 class=\"property-details__subsection__heading\">Scenario Analysis</h1><div class=\"property-compare__side-by-side-container\" data-ng-class=\"{ 'is-empty': numProperties < 1 }\"><div class=\"property-compare__column\" data-ng-class=\"{ 'property-compare__column--left': $index == 0, 'property-compare__column--right': $index == 1, 'property-compare__column--empty': !prop }\" data-ng-repeat=\"prop in properties\"><div class=\"property-compare__column__content\"><div class=\"property-compare__dropzone\" data-ng-hide=\"prop\" data-dropzone-id=\"[[$index]]\" data-pl-droppable=\"{ callbacks: { drop: onPropertyDropped }, jquiOptions: { accept: '.property-search-result__link', hoverClass: 'is-hovered', tolerance: 'pointer' } }\"><span class=\"i i-property-dropzone\"></span><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><div class=\"property-details__scenario-analysis-table-outer-wrapper\" data-ng-show=\"prop\"><div class=\"property-details__scenario-analysis-table-inner-wrapper\"><div data-ng-controller=\"ScenarioAnalysisController\" data-ng-init=\"configure([[$index]])\"><button type=\"button\" class=\"btn--link property-details__scenario-analysis__reset-button\" data-ng-click=\"initFinancials(property)\" data-ng-show=\"showResetButton\">Reset to default values</button><table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table><div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div></div><a class=\"property-details__help-prompt__button--view-all-details\" data-ng-href=\"/property-search/property/[[ prop.listing_id ]]/\"><span class=\"i\"></span>View all details</a></div></div></div></div></div><div class=\"property-details__scenario-indicators-legend\"><ul><li><span class=\"indicator indicator--green\"></span>Green means most likely achievable</li><li><span class=\"indicator indicator--amber\"></span>Amber means hard to achieve or slightly above budget</li><li><span class=\"indicator indicator--red\"></span>Red means very hard to achieve or above budget</li></ul></div><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">Need help with you mortgage? Speak to one of our Mortgage Advisors.</p><button class=\"contact-button--mortgage-advisor\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div></div></section></div></section></div><div id=\"contact\" data-ng-show=\"properties[0] || properties[1]\"><section class=\"property-details__main-section property-details__main-section--agent\" id=\"contact\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.contact\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Contact the Agent</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section__body\"><div class=\"property-details--compare__main-section--agents property-compare__side-by-side-container\"><form name=\"frm_agent_select\"><div class=\"property-details--compare__main-section--agent-column-wrap\" data-ng-repeat=\"property in properties\"><div class=\"property-compare__dropzone\" data-ng-hide=\"property\" data-dropzone-id=\"[[$index]]\" data-pl-droppable=\"{ callbacks: { drop: onPropertyDropped }, jquiOptions: { accept: '.property-search-result__link', hoverClass: 'is-hovered', tolerance: 'pointer' } }\"><span class=\"i i-property-dropzone\"></span><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><span data-ng-show=\"property\" class=\"radio-input property-details--compare__main-section--agent-address\"><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"property_index\" data-ng-model=\"forms.agent_choice.agentIndex\" value=\"[[$index]]\"><span data-ng-bind=\"property.street_name\"></span>, <span data-ng-bind=\"property.post_town\"></span> <span data-ng-bind=\"property.outcode\"></span><span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span><div data-ng-show=\"property\" class=\"property-details--compare__main-section--agent-column-inner\"><p class=\"property-details__main-section--agent__agent-details\"><img class=\"property-details__main-section--agent__agent-logo\" data-ng-src=\"[[ property.agent_logo ]]\" height=\"40\"><span data-ng-bind=\"property.agent_name\"></span>, <span data-ng-bind=\"property.agent_address\"></span>, <span class=\"property-details__main-section--agent__agent-details__postcode\" data-ng-bind=\"property.agent_postcode\"></span><br>Call on <span class=\"property-details__main-section--agent__agent-details__phone\" data-ng-bind=\"property.agent_phone\"></span></p></div></div></form></div><div class=\"property-details__main-section--agent__agent-details-body\"><div ng-switch=\"messages.agent.prompt.type\" data-ng-show=\"messages.agent.prompt.visible\"><div ng-switch-when=\"sending\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">Sending your enquiry...</div></div><div ng-switch-when=\"success\"><div class=\"property-details__main-section--agent__contact-form-submission-message\"><span class=\"i i-contacted-tick\"></span>Thank you. Your enquiry has been sent to <span data-ng-bind=\"properties[messages.agent.prompt.agent_index].agent_name\"></span><span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Send another enquiry</a></span></div></div><div ng-switch-when=\"failure\" data-ng-show=\"messages.agent.prompt.visible\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">There was a problem sending your message, please try again later.<span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Try again</a></span></div></div></div><form class=\"property-details__main-section--agent__contact-form submit-on-enter\" data-ng-hide=\"messages.agent.prompt.visible\" data-ng-submit=\"sendMessage('agent', agent)\" name=\"agent\" id=\"frm-agent\" novalidate=\"\"><div class=\"property-details__main-section--agent__contact-form__wrap\"><div class=\"property-details__main-section--agent__contact-form__left\"><p class=\"property-details__main-section--agent__contact-form__prompt\">Inquire about this property</p><div class=\"property-details__main-section--agent__contact-row property-details__main-section--agent__contact-row--dual\"><label class=\"property-details__main-section--agent__contact-form__first-name-label\">First:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.firstName\" type=\"text\" name=\"firstName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.firstName=userData.user.firstName\" data-ng-focus=\"agent.firstName.showErrors=true\" data-ng-blur=\"agent.firstName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.firstName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.firstName.$error.serverMessages\" data-ng-show=\"agent.firstName.showErrors\"><i></i>[[message]]</span></div><label class=\"property-details__main-section--agent__contact-form__last-name-label\">Last:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.lastName\" type=\"text\" name=\"lastName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.lastName=userData.user.lastName\" data-ng-focus=\"agent.lastName.showErrors=true\" data-ng-blur=\"agent.lastName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.lastName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.lastName.$error.serverMessages\" data-ng-show=\"agent.lastName.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__email-label\">Email:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.email\" type=\"email\" name=\"email\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.email=userData.user.email\" data-ng-focus=\"agent.email.showErrors=true\" data-ng-blur=\"agent.email.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.email.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.email.$error.serverMessages\" data-ng-show=\"agent.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__phone-label\">Phone:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><div class=\"grid\"><div class=\"property-details__main-section--agent__contact-form__input--phone\"><input data-ng-model=\"forms.agent.phoneNumber\" type=\"text\" name=\"phoneNumber\" data-ng-init=\"forms.agent.phoneNumber=userData.user.telephone\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-focus=\"agent.phoneNumber.showErrors=true\" data-ng-blur=\"agent.phoneNumber.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.phoneNumber.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.phoneNumber.$error.serverMessages\" data-ng-show=\"agent.phoneNumber.showErrors\"><i></i>[[message]]</span></div><div class=\"property-details__main-section--agent__contact-form__input--phone-type\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.phoneType\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"phoneType\" data-ng-init=\"forms.agent.phoneType=userData.user.telephoneType\"><option value=\"home\" selected=\"selected\">Home</option><option value=\"mobile\">Mobile</option><option value=\"work\">Work</option></select></div></div></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__call-time-label\">Best time to call:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.timeToCall\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"timeToCall\"><option value=\"anytime\" selected=\"selected\">Anytime</option><option value=\"morning\">Morning</option><option value=\"afternoon\">Afternoon</option><option value=\"evening\">Evening</option></select></div></div></div><div class=\"property-details__main-section--agent__contact-form__right\"><p class=\"property-details__main-section--agent__contact-form__terms\">By submitting this form you accept our <a href=\"//plentific.com/terms\" target=\"_blank\">Terms of Use</a>.</p><textarea name=\"message\" placeholder=\"Message (optional)\" data-ng-model=\"forms.agent.message\"></textarea><button type=\"submit\" aria-label=\"Send inquiry\" class=\"btn--blue\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div></form></div></div></div></section></div></div></div></div></div></section></div></div>");
    $templateCache.put("/partials/views/property-search/detail.html", "<div class=\"property-search-modal property-search-modal--details\" data-ng-controller=\"PropertyModalController\" data-ng-hide=\"disambiguationRequired\"><div class=\"property-search-modal__outer-wrap\"><section class=\"property-search-modal__inner-wrap\"><div class=\"property-search-modal__content\" data-ng-controller=\"PropertyDetailController\" data-ng-init=\"configure(0)\"><header class=\"property-search-modal__header\"><div class=\"property-details__header__details\"><span class=\"property-details__image\" data-ng-style=\"{'background-image': 'url(' + property.thumbnail_url + ')'}\" data-ng-show=\"property.thumbnail_url\"></span><h1 class=\"property-details__address\">[[ property.displayable_address ]]</h1><a class=\"property-details__close-button\" data-ng-href=\"/property-search/[[getQueryStringForSearch()]]\"></a><div class=\"property-details__overview-panel\"><span data-ng-switch=\"property.price_modifier\" data-ng-class=\"{'property-details__overview-panel-item--price--with-modifier': property.price_modifier, 'property-details__overview-panel-item--price': !property.price_modifier, 'property-details__overview-panel-item--price--modifier-only': property.price_modifier == 'price_on_request' }\"><span data-ng-switch-when=\"offers_over\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Offers over</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"poa\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Price on application</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"fixed_price\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Fixed price</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"from\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">From</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"offers_in_region_of\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Offers in region of</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"part_buy_part_rent\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Part buy part rent</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"price_on_request\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Price on request</span></span><span data-ng-switch-when=\"shared_equity\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Shared equity</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"shared_ownership\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Shared ownership</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"guide_price\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Guide price</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-when=\"sale_by_tender\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__modifier\">Sale by tender</span><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span><span data-ng-switch-default=\"\" class=\"property-details__overview-panel-item--price__wrap\"><span class=\"property-details__overview-panel-item--price__value\" data-ng-bind=\"property.price | noFractionCurrency: '£'\"></span></span></span><span class=\"property-details__overview-panel-item--bedrooms\"><i class=\"i i-bedroom\"></i>[[ property.num_bedrooms ]]</span><span class=\"property-details__overview-panel-item--bathrooms\" data-ng-show=\"property.num_bathrooms > 0\"><i class=\"i i-bathroom\"></i>[[ property.num_bathrooms ]]</span><button class=\"property-details__overview-panel-item--favourite-button\" aria-label=\"Favourite\" data-ng-class=\"{ 'is-active': property.isFavourite}\" data-ng-click=\"favouriteButtonClick(property, $event)\"><i class=\"i\"></i></button><button class=\"property-details__overview-panel-item--email\" data-ng-click=\"sharePopoverVisible = !sharePopoverVisible\" aria-label=\"Share property details via e-mail\"><i class=\"i\"></i></button><div class=\"property-details__email-popover\" data-ng-show=\"sharePopoverVisible\"><form class=\"property-details__email-popover__form submit-on-enter\" id=\"frm-share\" name=\"share\" data-ng-submit=\"sendMessage('share', share)\" novalidate=\"\"><div class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><label for=\"form__share-property__user-email\">Your email:</label></div><div class=\"inline-fieldset__field\"><input name=\"userEmail\" data-ng-model=\"forms.share.userEmail\" id=\"form__share-property__user-email\" type=\"email\" data-ng-focus=\"share.userEmail.showErrors=true\" data-ng-blur=\"share.userEmail.showErrors=false\" data-ng-class=\"{'ng-invalid': share.userEmail.$error.serverMessages.length}\" data-ng-init=\"forms.share.userEmail=userData.user.email\"><span class=\"account-form__error\" data-ng-repeat=\"message in share.userEmail.$error.serverMessages\" data-ng-show=\"share.userEmail.showErrors\"><i></i>[[message]]</span></div></div><div class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><label for=\"form__share-property__friend-email\">Friend's email:</label></div><div class=\"inline-fieldset__field\"><input name=\"friendsEmail\" data-ng-model=\"forms.share.friendsEmail\" id=\"form__share-property__friend-email\" type=\"email\" data-ng-focus=\"share.friendsEmail.showErrors=true\" data-ng-blur=\"share.friendsEmail.showErrors=false\" data-ng-class=\"{'ng-invalid': share.friendsEmail.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in share.friendsEmail.$error.serverMessages\" data-ng-show=\"share.friendsEmail.showErrors\"><i></i>[[message]]</span></div></div><div class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><label for=\"form__share-property__subject\">Subject:</label></div><div class=\"inline-fieldset__field\"><input data-ng-model=\"forms.share.subject\" id=\"form__share-property__subject\" type=\"text\"></div></div><div class=\"inline-fieldset\"><div class=\"inline-fieldset__label\"><label for=\"form__share-property__body\">Message:</label></div><div class=\"inline-fieldset__field\"><textarea class=\"property-details__email-popover__message-input\" data-ng-model=\"forms.share.message\" id=\"form__share-property__body\" type=\"text\">I thought you might want to take a look at this property.</textarea><button class=\"property-details__email-popover__send-button btn--blue\" type=\"submit\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div></form><div ng-switch=\"messages.share.prompt.type\" data-ng-show=\"messages.share.prompt.visible\" class=\"property-details__email-popover__overlay\"><div ng-switch-when=\"success\"><div class=\"property-details__email-popover__overlay__message--success\">Thank you. We've e-mailed the details of this property to <span data-ng-bind=\"forms.share.friendsEmail\"></span>.<a class=\"property-details__email-popover__overlay__message__close-link\" href=\"\" data-ng-click=\"dismissShareOverlay()\">Close</a></div></div><div ng-switch-when=\"failure\"><div class=\"property-details__email-popover__overlay__message--failure\">There was a problem sending your message, please try again later.<a class=\"property-details__email-popover__overlay__message__close-link\" href=\"\">Close</a></div></div><div ng-switch-when=\"sending\"><div class=\"property-details__email-popover__overlay__message--success\">Sending...</div></div></div></div></div></div><nav class=\"property-search-modal__navigation\" id=\"navPills\"><ul class=\"nav\"><li class=\"active\"><a class=\"property-search-modal__navigation-link\" href=\"#overview\" data-scroll-to=\"#overview\">Property Details</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#floorplan\" data-scroll-to=\"#floorplan\">Floor Plan</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#location\" data-scroll-to=\"#location\">Location</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#financials\" data-scroll-to=\"#financials\">Financials</a></li><li><a class=\"property-search-modal__navigation-link\" href=\"#contact\" data-scroll-to=\"#contact\">Contact</a></li></ul></nav></header><div class=\"property-search-modal__scroll-pane\" data-pl-scroll-pane=\"property.listing_id\"><div id=\"overview\"><div data-pl-tabset=\"detailTabset\" data-pl-css-block-modifier=\"main\" id=\"details\" callback=\"tabChanged\"><p class=\"property-search-modal__credit-score-link\"><a href=\"http://www.dpbolvw.net/click-7261416-10468794\" target=\"_blank\">Experian credit report</a><img src=\"http://www.lduhtrp.net/image-7261416-10468794\" width=\"1\" height=\"1\" border=\"0\"></p><div data-pl-tab=\"\" data-pl-tab-title=\"Photos\"><div class=\"property-details__gallery-container\"><div data-pl-gallery=\"refs.images\" data-pl-gallery-options=\"{ page_size: 5 }\"></div></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Street View\"><div class=\"property-details__streetview\" data-pl-streetview=\"streetviewOptions\" data-refresh-trigger=\"refreshTriggers.sv\"></div></div><div data-pl-tab=\"\" data-pl-tab-title=\"Map\"><div class=\"property-details__map\" data-pl-google-map=\"refs.property_map\" data-refresh-trigger=\"refreshTriggers.map\"></div></div></div><section class=\"property-details__main-section property-details__main-section--first property-details__main-section--details\"><div class=\"property-details__main-section__content\" data-accordion=\"\" data-close-others=\"false\"><section class=\"property-details__subsection property-details__subsection--description\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.description\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Property Description</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><div data-pl-show-more=\"2\" data-pl-show-more-bind=\"property.description\"><p class=\"property-details__description\" data-ng-bind=\"property.description\"></p></div></div></section><section class=\"property-details__subsection property-details__subsection--listing-info\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.listing_info\"><div data-pl-accordion-sync2=\"accordionSections.listing_info\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Listing Info</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content property-details__subsection__content--listing-info\"><div class=\"property-affordability-card property-affordability-card--[[affordabilityColour]]\"><div class=\"property-affordability-card__header\"><div data-ng-show=\"affordabilityColour == 'green'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'amber'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'red'\">This property may exceed your budget</div><div data-ng-show=\"affordabilityColour == 'grey'\">Visit our <a data-ng-href=\"/calculators/affordability/\">calculators</a> to check affordability</div></div><div class=\"property-affordability-card__body\"><span class=\"property-affordability-card__price-modifier\">Asking price</span><span class=\"property-affordability-card__price\" data-ng-bind=\"property.price | noFractionCurrency:'£'\"></span></div><div class=\"property-affordability-card__footer\"><span class=\"property-affordability-card__room-count--bedrooms\"><i class=\"i i-bedroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bedrooms\"></span></span><span class=\"property-affordability-card__room-count--bathrooms\" data-ng-show=\"property.num_bathrooms > 0\"><i class=\"i i-bathroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bathrooms\"></span></span></div></div><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can edit the fields below. Your changes will be saved to your account.</p><div class=\"property-details__custom-user-listing-data\"><form name=\"custom-listing-data\" class=\"property-details__custom-data-form\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"estimated-purchase-price-input\">Estimated purchase price:</label><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" id=\"estimated-purchase-price-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" pl-number=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.estimatedPrice\"></div></div></fieldset><fieldset class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Gross internal area:</div><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">sq ft</span><input type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.grossInternalArea\"></div><div class=\"input inline-fieldset__field inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">sqm</span><input disabled=\"disabled\" type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"computedFields.grossInternalAreaSqM\"></div></div></fieldset><div class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Price per sq ft:</div><span class=\"property-details__price-per-square-ft\" data-ng-hide=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\" data-ng-bind=\"computedFields.pricePerSqFt | noFractionCurrency:'£'\">0</span><span class=\"property-details__price-per-square-ft\" data-ng-show=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\">n/a</span></div></div><div class=\"property-details__custom-user-listing-data__right-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden:</div><span class=\"radio-input\"><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"yes\" data-ng-model=\"property.customFields.garden\">Yes<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"no\" data-ng-model=\"property.customFields.garden\">No<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden facing:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.gardenFacing\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"north\">North</option><option value=\"east\">East</option><option value=\"south\">South</option><option value=\"west\">West</option><option value=\"northwest\">North West</option><option value=\"northeast\">North East</option><option value=\"southwest\">South West</option><option value=\"southeast\">South East</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Floors:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.floors\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"basement\">Basement</option><option value=\"ground\">Ground floor</option><option value=\"first\">1st floor</option><option value=\"second\">2nd floor</option><option value=\"third\">3rd floor</option><option value=\"higher\">Higher up</option><option value=\"mixed\">Mixed levels</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Is the seller in a chain?</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.sellerChain\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"yes\">Yes</option><option value=\"no\">No</option></select></fieldset></div></form></div></div></div></section><section class=\"property-details__subsection property-details__subsection--ownership-status\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.ownership_status\"><div data-pl-accordion-sync2=\"accordionSections.ownership_status\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Ownership Status</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><form name=\"custom-ownership-data\" class=\"property-details__custom-data-form property-details__custom-data-form--ownership\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Leasehold/Freehold:</div><div class=\"inline-fieldset__field-row\"><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.ownershipType\"><option value=\"freehold\">Freehold</option><option value=\"freehold-share\">Share of freehold</option><option value=\"leasehold\">Leasehold</option></select></div></fieldset><fieldset class=\"inline-fieldset\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><label class=\"inline-fieldset__label\" for=\"leashold-period-input\">Leasehold period:</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field\"><input type=\"number\" name=\"leashold-period\" id=\"leashold-period-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.leasholdPeriod\"></div></div></fieldset></div><div class=\"property-details__custom-user-listing-data__right-column\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"ground-rent-monthly-input\">Ground rent?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">Monthly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-monthly\" id=\"ground-rent-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.groundRentMonthly\" data-ng-change=\"groundRentMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">Yearly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-annually\" id=\"ground-rent-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.groundRentAnnually\" disabled=\"disabled\"></div></div></fieldset><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"management-fee-monthly-input\">Management fee?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-monthly\" id=\"management-fee-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.managementFeeMonthly\" data-ng-change=\"managementFeeMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-annually\" id=\"management-fee-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.managementFeeAnnually\" disabled=\"disabled\"></div></div></fieldset></div></form><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">If you are unsure what this means, it may make sense to hire your solicitor earlier.</p><button class=\"contact-button--solicitor\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Solicitor</span></button></div></div></div></section></div></section></div><div data-accordion=\"\" data-close-others=\"false\"><div id=\"floorplan\"><section class=\"property-details__main-section property-details__main-section--floor-plan\" id=\"floorplan\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.floorplan\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Floor Plan</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><span data-ng-show=\"!property.floor_plan\">Floorplan not available</span><div data-ng-show=\"property.floor_plan\"><ul class=\"property-details__floorplan-indicator-list\"><li class=\"property-details__floorplan-indicator\" data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-class=\"{ 'is-active': $index == refs.floorplanIndex}\" data-ng-click=\"refs.floorplanIndex = $index\"><span></span></li></ul><ul class=\"property-details__floorplan-list\"><li data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-show=\"$index == refs.floorplanIndex\"><div data-ng-switch=\"getFloorplanFiletype($index)\" pl-floorplan=\"floorplan\"></div></li></ul></div></div></section></div><div id=\"location\"><section class=\"property-details__main-section property-details__main-section--location\" id=\"location\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.location\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Location and Neighbourhood</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__subsection-box--nearby-stations\"><div class=\"property-details__subsection-box__header\">Nearby Stations</div><div class=\"property-details__subsection-box__content\"><ul class=\"property-details__station-list\"><li class=\"property-details__station-list-item\" data-ng-repeat=\"station in nearbyStations | limitTo:3\"><span class=\"property-details__station-list-item__icon i\" data-ng-class=\"{'i-nearby-station--national-rail': station.mode == 'train', 'i-nearby-station--tube': station.mode == 'tube'}\"></span><span class=\"property-details__station-list-item__name\" data-ng-bind=\"station.name\"></span><span class=\"property-details__station-list-item__travel-info\"><span class=\"property-details__station-list-item__travel-distance\" data-ng-bind=\"station.__plentific__computed.distanceInMiles | number:2\"></span> mi<span class=\"property-details__station-list-item__travel-mode-icon i i-travel-mode--walk\"></span><span class=\"property-details__station-list-item__travel-duration\" data-ng-bind=\"station.__plentific__computed.estimatedWalkingDuration | duration:'hours'\"></span></span><span class=\"property-details__station-list-item__travel-time-bar property-details__station-list-item__travel-time-bar--[[station.__plentific__computed.walkingBarColor]]\"><span class=\"property-details__station-list-item__travel-time-bar__container\"><span class=\"property-details__station-list-item__travel-time-bar__fill\" data-ng-style=\"{ 'width': station.__plentific__computed.walkingBarLength + '%'}\"><span class=\"property-details__station-list-item__travel-time-bar__label\">Walking</span></span></span></span></li></ul></div></div><div class=\"property-details__subsection-box--travel-times\"><div class=\"property-details__subsection-box__header\">Travel Time to Work<span class=\"i-powerd-by-google-light-bg\">Powered by Google</span></div><div class=\"property-details__subsection-box__content\"><div class=\"property-details__travel-time-partipants\"><div class=\"property-details__travel-time-partipant--1\"><form name=\"travelTimeP1Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[0].firstName || \"You\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[0].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant1.workPostcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant1.workPostcode\">Enter your work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP1Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'car')\" data-ng-href=\"[[ getDirectionsUrl(1, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(1, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(1, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(1, 'transit') ]]\" target=\"_blank\">(Get Directions)</a></li></ul></div></form></div><div class=\"property-details__travel-time-partipant--2\"><form name=\"travelTimeP2Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[1].firstName || \"Partner\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[1].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant2.workPostcode\" data-ng-init=\"travelTimes.participant2.workPostcode=caseData.applicants[1].work_postcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant2.workPostcode\">Enter your partner's work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP2Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'car')\" data-ng-href=\"[[ getDirectionsUrl(2, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(2, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(2, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(2, 'transit') ]]\" target=\"_blank\"><span data-ng-show=\"travelTimes.participant2.travelModes.transit.status == 'ERROR'\">(</span>Get Directions)</a></li></ul></div></form></div></div></div></div></div></section></div><div id=\"financials\"><section class=\"property-details__main-section property-details__main-section--financials\" id=\"financials\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.financials\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can change the editable form fields below to run various financial scenarios.</p><div class=\"property-details__main-section--financials__content-wrapper\"><div class=\"property-details__main-section--item-wrapper\"><div class=\"property-details__subsection-box-financials-salary\"><div class=\"property-details__subsection-box__header\">Salary</div><div class=\"property-details__subsection-box__content\"><table><thead><tr><th></th><th>Gross annual income</th><th>Net monthly income</th></tr></thead><tbody data-ng-switch=\"propertyFinancials.applicants.length\"><tr data-ng-repeat=\"applicant in propertyFinancials.applicants\"><td class=\"property-details__subsection-box-financials-salary__avatar\"><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ applicant.avatar_48 ]]\"></td><td class=\"property-details__subsection-box-financials-salary__gross\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"></div></div></td><td class=\"property-details__subsection-box-financials-salary__net\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.netMonthlyIncome\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.netMonthlyIncome\"></div></div></td></tr><tr data-ng-switch-when=\"1\"><td colspan=\"3\" class=\"add-applicant-row\"><button class=\"property-details__add-applicant-button\" data-ng-click=\"addApplicant()\"><i class=\"i i-add-applicant\"></i>Add applicant</button></td></tr></tbody></table></div></div></div><div class=\"property-details__main-section--item-wrapper--savings-and-expenses\"><div class=\"property-details__subsection-box-financials-savings\"><div class=\"property-details__subsection-box__header\">Savings</div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--positive editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.savings\"></div></div></div></div><div class=\"property-details__subsection-box-financials-expenses\"><div class=\"property-details__subsection-box__header\">Household expenses <span>(excl. accommodation)</span></div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--negative editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"></div></div></div></div></div><div class=\"property-details__main-section--item-wrapper--financial-results\"><div class=\"property-details__financials-results\"><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Potential loan size:</span><span class=\"property-details__financials-results__value\"><span data-ng-bind=\"maxLoanMultiple\"></span>x</span></div><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Estimated mortgage loan amount:</span><span class=\"property-details__financials-results__value\" data-ng-bind=\"totalGrossAnnualIncome * maxLoanMultiple | noFractionCurrency:'£'\"></span></div><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Estimated purchase price:</span><span class=\"property-details__financials-results__value\" data-ng-bind=\"property.customFields.estimatedPrice | noFractionCurrency:'£'\"></span></div></div></div></div><section class=\"property-details__subsection property-details__subsection--scenario-analysis\"><div class=\"property-details__subsection__content\"><h1 class=\"property-details__subsection__heading\">Scenario Analysis</h1><div class=\"property-details__scenario-analysis-table-outer-wrapper\"><div class=\"property-details__scenario-analysis-table-inner-wrapper\"><div data-ng-controller=\"ScenarioAnalysisController\" data-ng-init=\"configure([[$index]])\"><button type=\"button\" class=\"btn--link property-details__scenario-analysis__reset-button\" data-ng-click=\"initFinancials(property)\" data-ng-show=\"showResetButton\">Reset to default values</button><table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table><div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div></div></div></div><div class=\"property-details__scenario-indicators-legend\"><ul><li><span class=\"indicator indicator--green\"></span>Green means most likely achievable</li><li><span class=\"indicator indicator--amber\"></span>Amber means hard to achieve or slightly above budget</li><li><span class=\"indicator indicator--red\"></span>Red means very hard to achieve or above budget</li></ul></div><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">Need help with you mortgage? Speak to one of our Mortgage Advisors.</p><button class=\"contact-button--mortgage-advisor\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div></div></section></div></section></div><div id=\"contact\"><section class=\"property-details__main-section property-details__main-section--agent\" id=\"contact\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.contact\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Contact the Agent</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section__body\"><div class=\"property-details__main-section--agent__agent-details\"><div class=\"property-details__main-section--agent__agent-details__wrap\"><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--logo\"><img class=\"property-details__main-section--agent__agent-logo\" data-ng-src=\"[[ property.agent_logo ]]\" height=\"40\"></div><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--address\"><span data-ng-bind=\"property.agent_name\"></span>, <span data-ng-bind=\"property.agent_address\"></span>, <span class=\"property-details__main-section--agent__agent-details__postcode\" data-ng-bind=\"property.agent_postcode\"></span></div><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--call-prompt\">Call on <span class=\"property-details__main-section--agent__agent-details__phone\" data-ng-bind=\"property.agent_phone\"></span></div></div></div><div class=\"property-details__main-section--agent__agent-details-body\"><div ng-switch=\"messages.agent.prompt.type\" data-ng-show=\"messages.agent.prompt.visible\"><div ng-switch-when=\"sending\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">Sending your enquiry...</div></div><div ng-switch-when=\"success\"><div class=\"property-details__main-section--agent__contact-form-submission-message\"><span class=\"i i-contacted-tick\"></span>Thank you. Your enquiry has been sent to <span data-ng-bind=\"property.agent_name\"></span></div></div><div ng-switch-when=\"failure\" data-ng-show=\"messages.agent.prompt.visible\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">There was a problem sending your message, please try again later.<span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Try again</a></span></div></div></div><form class=\"property-details__main-section--agent__contact-form submit-on-enter\" data-ng-hide=\"messages.agent.prompt.visible\" data-ng-submit=\"sendMessage('agent', agent)\" name=\"agent\" id=\"frm-agent\" novalidate=\"\"><div class=\"property-details__main-section--agent__contact-form__wrap\"><div class=\"property-details__main-section--agent__contact-form__left\"><p class=\"property-details__main-section--agent__contact-form__prompt\">Inquire about this property</p><div class=\"property-details__main-section--agent__contact-row property-details__main-section--agent__contact-row--dual\"><label class=\"property-details__main-section--agent__contact-form__first-name-label\">First:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.firstName\" type=\"text\" name=\"firstName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.firstName=userData.user.firstName\" data-ng-focus=\"agent.firstName.showErrors=true\" data-ng-blur=\"agent.firstName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.firstName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.firstName.$error.serverMessages\" data-ng-show=\"agent.firstName.showErrors\"><i></i>[[message]]</span></div><label class=\"property-details__main-section--agent__contact-form__last-name-label\">Last:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.lastName\" type=\"text\" name=\"lastName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.lastName=userData.user.lastName\" data-ng-focus=\"agent.lastName.showErrors=true\" data-ng-blur=\"agent.lastName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.lastName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.lastName.$error.serverMessages\" data-ng-show=\"agent.lastName.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__email-label\">Email:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.email\" type=\"email\" name=\"email\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.email=userData.user.email\" data-ng-focus=\"agent.email.showErrors=true\" data-ng-blur=\"agent.email.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.email.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.email.$error.serverMessages\" data-ng-show=\"agent.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__phone-label\">Phone:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><div class=\"grid\"><div class=\"property-details__main-section--agent__contact-form__input--phone\"><input data-ng-model=\"forms.agent.phoneNumber\" type=\"text\" name=\"phoneNumber\" data-ng-init=\"forms.agent.phoneNumber=userData.user.telephone\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-focus=\"agent.phoneNumber.showErrors=true\" data-ng-blur=\"agent.phoneNumber.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.phoneNumber.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.phoneNumber.$error.serverMessages\" data-ng-show=\"agent.phoneNumber.showErrors\"><i></i>[[message]]</span></div><div class=\"property-details__main-section--agent__contact-form__input--phone-type\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.phoneType\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"phoneType\" data-ng-init=\"forms.agent.phoneType=userData.user.telephoneType\"><option value=\"home\" selected=\"selected\">Home</option><option value=\"mobile\">Mobile</option><option value=\"work\">Work</option></select></div></div></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__call-time-label\">Best time to call:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.timeToCall\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"timeToCall\"><option value=\"anytime\" selected=\"selected\">Anytime</option><option value=\"morning\">Morning</option><option value=\"afternoon\">Afternoon</option><option value=\"evening\">Evening</option></select></div></div></div><div class=\"property-details__main-section--agent__contact-form__right\"><p class=\"property-details__main-section--agent__contact-form__terms\">By submitting this form you accept our <a href=\"//plentific.com/terms\" target=\"_blank\">Terms of Use</a>.</p><textarea name=\"message\" placeholder=\"Message (optional)\" data-ng-model=\"forms.agent.message\"></textarea><button type=\"submit\" aria-label=\"Send inquiry\" class=\"btn--blue\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div></form></div></div></div></section></div></div></div></div></section></div></div>");
    $templateCache.put("/partials/views/property-search/entry.html", "<div data-ng-show=\"!property\"><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><div data-ng-show=\"property\"><h1 data-ng-bind=\"property.price\"></h1></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/accordion-header.html", "<div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/edit-prompt.html", "<p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can change the editable form fields below to run various financial scenarios.</p>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/help-prompt.html", "<div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">Need help with you mortgage? Speak to one of our Mortgage Advisors.</p><button class=\"contact-button--mortgage-advisor\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/results-estimated-loan-amount.html", "<span class=\"property-details__financials-results__value\" data-ng-bind=\"totalGrossAnnualIncome * maxLoanMultiple | noFractionCurrency:'£'\"></span>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/results-estimated-pruchase-price.html", "<span class=\"property-details__financials-results__value\" data-ng-bind=\"property.customFields.estimatedPrice | noFractionCurrency:'£'\"></span>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/results-potential-loan-size.html", "<span class=\"property-details__financials-results__value\"><span data-ng-bind=\"maxLoanMultiple\"></span>x</span>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/salary-box.html", "<div class=\"property-details__main-section--item-wrapper\"><div class=\"property-details__subsection-box-financials-salary\"><div class=\"property-details__subsection-box__header\">Salary</div><div class=\"property-details__subsection-box__content\"><table><thead><tr><th></th><th>Gross annual income</th><th>Net monthly income</th></tr></thead><tbody data-ng-switch=\"propertyFinancials.applicants.length\"><tr data-ng-repeat=\"applicant in propertyFinancials.applicants\"><td class=\"property-details__subsection-box-financials-salary__avatar\"><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ applicant.avatar_48 ]]\"></td><td class=\"property-details__subsection-box-financials-salary__gross\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"></div></div></td><td class=\"property-details__subsection-box-financials-salary__net\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.netMonthlyIncome\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.netMonthlyIncome\"></div></div></td></tr><tr data-ng-switch-when=\"1\"><td colspan=\"3\" class=\"add-applicant-row\"><button class=\"property-details__add-applicant-button\" data-ng-click=\"addApplicant()\"><i class=\"i i-add-applicant\"></i>Add applicant</button></td></tr></tbody></table></div></div></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/savings-and-expenses-box.html", "<div class=\"property-details__main-section--item-wrapper--savings-and-expenses\"><div class=\"property-details__subsection-box-financials-savings\"><div class=\"property-details__subsection-box__header\">Savings</div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--positive editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.savings\"></div></div></div></div><div class=\"property-details__subsection-box-financials-expenses\"><div class=\"property-details__subsection-box__header\">Household expenses <span>(excl. accommodation)</span></div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--negative editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"></div></div></div></div></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/scenario-analysis.html", "<div data-ng-controller=\"ScenarioAnalysisController\" data-ng-init=\"configure([[$index]])\"><button type=\"button\" class=\"btn--link property-details__scenario-analysis__reset-button\" data-ng-click=\"initFinancials(property)\" data-ng-show=\"showResetButton\">Reset to default values</button><table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table><div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/scenario-indicators-legend.html", "<div class=\"property-details__scenario-indicators-legend\"><ul><li><span class=\"indicator indicator--green\"></span>Green means most likely achievable</li><li><span class=\"indicator indicator--amber\"></span>Amber means hard to achieve or slightly above budget</li><li><span class=\"indicator indicator--red\"></span>Red means very hard to achieve or above budget</li></ul></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/scenario-indicators-overview.html", "<div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div>");
    $templateCache.put("/partials/views/property-search/includes/common/financials/scenario-table.html", "<table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table>");
    $templateCache.put("/partials/views/property-search/includes/common/main-section-financials.html", "<section class=\"property-details__main-section property-details__main-section--financials\" id=\"financials\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.financials\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\" data-ng-controller=\"ScenarioAnalysisController\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can change the editable form fields below to run various financial scenarios.</p></div></section>");
    $templateCache.put("/partials/views/property-search/includes/common/main-section-floorplan.html", "<section class=\"property-details__main-section property-details__main-section--floor-plan\" id=\"floorplan\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.floorplan\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Floor Plan</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><span data-ng-show=\"!property.floor_plan\">Floorplan not available</span><div data-ng-show=\"property.floor_plan\"><ul class=\"property-details__floorplan-indicator-list\"><li class=\"property-details__floorplan-indicator\" data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-class=\"{ 'is-active': $index == refs.floorplanIndex}\" data-ng-click=\"refs.floorplanIndex = $index\"><span></span></li></ul><ul class=\"property-details__floorplan-list\"><li data-ng-repeat=\"floorplan in property.floor_plan\" data-ng-show=\"$index == refs.floorplanIndex\"><div data-ng-switch=\"getFloorplanFiletype($index)\" pl-floorplan=\"floorplan\"></div></li></ul></div></div></section>");
    $templateCache.put("/partials/views/property-search/includes/common/main-section-location.html", "<section class=\"property-details__main-section property-details__main-section--location\" id=\"location\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.location\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Location and Neighbourhood</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__subsection-box--nearby-stations\"><div class=\"property-details__subsection-box__header\">Nearby Stations</div><div class=\"property-details__subsection-box__content\"><ul class=\"property-details__station-list\"><li class=\"property-details__station-list-item\" data-ng-repeat=\"station in nearbyStations | limitTo:3\"><span class=\"property-details__station-list-item__icon i\" data-ng-class=\"{'i-nearby-station--national-rail': station.mode == 'train', 'i-nearby-station--tube': station.mode == 'tube'}\"></span><span class=\"property-details__station-list-item__name\" data-ng-bind=\"station.name\"></span><span class=\"property-details__station-list-item__travel-info\"><span class=\"property-details__station-list-item__travel-distance\" data-ng-bind=\"station.__plentific__computed.distanceInMiles | number:2\"></span> mi<span class=\"property-details__station-list-item__travel-mode-icon i i-travel-mode--walk\"></span><span class=\"property-details__station-list-item__travel-duration\" data-ng-bind=\"station.__plentific__computed.estimatedWalkingDuration | duration:'hours'\"></span></span><span class=\"property-details__station-list-item__travel-time-bar property-details__station-list-item__travel-time-bar--[[station.__plentific__computed.walkingBarColor]]\"><span class=\"property-details__station-list-item__travel-time-bar__container\"><span class=\"property-details__station-list-item__travel-time-bar__fill\" data-ng-style=\"{ 'width': station.__plentific__computed.walkingBarLength + '%'}\"><span class=\"property-details__station-list-item__travel-time-bar__label\">Walking</span></span></span></span></li></ul></div></div><div class=\"property-details__subsection-box--travel-times\"><div class=\"property-details__subsection-box__header\">Travel Time to Work<span class=\"i-powerd-by-google-light-bg\">Powered by Google</span></div><div class=\"property-details__subsection-box__content\"><div class=\"property-details__travel-time-partipants\"><div class=\"property-details__travel-time-partipant--1\"><form name=\"travelTimeP1Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[0].firstName || \"You\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[0].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant1.workPostcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant1.workPostcode\">Enter your work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP1Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'car')\" data-ng-href=\"[[ getDirectionsUrl(1, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(1, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(1, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant1.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(1, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(1, 'transit') ]]\" target=\"_blank\">(Get Directions)</a></li></ul></div></form></div><div class=\"property-details__travel-time-partipant--2\"><form name=\"travelTimeP2Form\"><span class=\"property-details__travel-time-partipant__name\">[[ caseData.applicants[1].firstName || \"Partner\" ]]</span><div class=\"property-details__travel-time-partipant__home\"><span class=\"i i-travel-time-home\"></span><span class=\"property-details__participant-travel-time-home-annotation\" data-ng-bind=\"property.outcode\"></span></div><div class=\"property-details__travel-time-partipant__avatar\"><i class=\"i sprite-icon-travel-time-dashes\"></i><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ caseData.applicants[1].avatar_48 ]]\"></div><div class=\"property-details__travel-time-partipant__work\"><span class=\"i i-travel-time-work\"></span><span class=\"property-details__participant-travel-time-work-annotation\"><input class=\"property-details__participant-travel-time-work-input\" type=\"text\" name=\"postcode\" data-ng-model=\"travelTimes.participant2.workPostcode\" data-ng-init=\"travelTimes.participant2.workPostcode=caseData.applicants[1].work_postcode\" pl-postcode-input=\"\"></span></div><div class=\"property-details__travel-times-wrapper\"><div class=\"property-details__travel-times-prompt\" data-ng-hide=\"travelTimes.participant2.workPostcode\">Enter your partner's work postcode above to see estimated journey times</div><div class=\"property-details__travel-times-prompt property-details__travel-times-prompt--invalid\" data-ng-show=\"travelTimeP2Form.postcode.$error.postcode\">Please enter a valid UK postcode</div><ul class=\"property-details__travel-times\"><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--car\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.driving.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Car</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'car')\" data-ng-href=\"[[ getDirectionsUrl(2, 'car') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--walk\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.walking.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Walk</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'walk')\" data-ng-href=\"[[ getDirectionsUrl(2, 'walk') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--cycle\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.bicycling.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Bike</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'cycle')\" data-ng-href=\"[[ getDirectionsUrl(2, 'cycle') ]]\" target=\"_blank\">(Get Directions)</a></li><li class=\"property-details__travel-time\"><span class=\"property-details__travel-time__icon i i-travel-mode--transit\"></span><span class=\"property-details__travel-time__travel-time\" data-ng-bind=\"travelTimes.participant2.travelModes.transit.duration\"></span><span class=\"property-details__travel-time__travel-mode\">Public Transport</span><a class=\"property-details__travel-time__directions-link\" href=\"#\" data-ng-show=\"getDirectionsUrl(2, 'transit')\" data-ng-href=\"[[ getDirectionsUrl(2, 'transit') ]]\" target=\"_blank\"><span data-ng-show=\"travelTimes.participant2.travelModes.transit.status == 'ERROR'\">(</span>Get Directions)</a></li></ul></div></form></div></div></div></div></div></section>");
    $templateCache.put("/partials/views/property-search/includes/common/main-section-overview.html", "<section class=\"property-details__main-section property-details__main-section--first property-details__main-section--details\"><div class=\"property-details__main-section__content\" data-accordion=\"\" data-close-others=\"false\"><section class=\"property-details__subsection property-details__subsection--description\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.description\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Property Description</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><div data-pl-show-more=\"2\" data-pl-show-more-bind=\"property.description\"><p class=\"property-details__description\" data-ng-bind=\"property.description\"></p></div></div></section><section class=\"property-details__subsection property-details__subsection--listing-info\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.listing_info\"><div data-pl-accordion-sync2=\"accordionSections.listing_info\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Listing Info</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content property-details__subsection__content--listing-info\"><div class=\"property-affordability-card property-affordability-card--[[affordabilityColour]]\"><div class=\"property-affordability-card__header\"><div data-ng-show=\"affordabilityColour == 'green'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'amber'\">This property may fit your budget</div><div data-ng-show=\"affordabilityColour == 'red'\">This property may exceed your budget</div><div data-ng-show=\"affordabilityColour == 'grey'\">Visit our <a data-ng-href=\"/calculators/affordability/\">calculators</a> to check affordability</div></div><div class=\"property-affordability-card__body\"><span class=\"property-affordability-card__price-modifier\">Asking price</span><span class=\"property-affordability-card__price\" data-ng-bind=\"property.price | noFractionCurrency:'£'\"></span></div><div class=\"property-affordability-card__footer\"><span class=\"property-affordability-card__room-count--bedrooms\"><i class=\"i i-bedroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bedrooms\"></span></span><span class=\"property-affordability-card__room-count--bathrooms\" data-ng-show=\"property.num_bathrooms > 0\"><i class=\"i i-bathroom\"></i><span class=\"property-affordability-card__room-count__value\" data-ng-bind=\"property.num_bathrooms\"></span></span></div></div><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can edit the fields below. Your changes will be saved to your account.</p><div class=\"property-details__custom-user-listing-data\"><form name=\"custom-listing-data\" class=\"property-details__custom-data-form\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"estimated-purchase-price-input\">Estimated purchase price:</label><div class=\"inline-fieldset__field-row\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" id=\"estimated-purchase-price-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" pl-number=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.estimatedPrice\"></div></div></fieldset><fieldset class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Gross internal area:</div><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">sq ft</span><input type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.grossInternalArea\"></div><div class=\"input inline-fieldset__field inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">sqm</span><input disabled=\"disabled\" type=\"number\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"computedFields.grossInternalAreaSqM\"></div></div></fieldset><div class=\"inline-fieldset inline-fieldset--less-margin-bottom\"><div class=\"inline-fieldset__label\">Price per sq ft:</div><span class=\"property-details__price-per-square-ft\" data-ng-hide=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\" data-ng-bind=\"computedFields.pricePerSqFt | noFractionCurrency:'£'\">0</span><span class=\"property-details__price-per-square-ft\" data-ng-show=\"property.customFields.grossInternalArea == null || property.customFields.grossInternalArea == 0\">n/a</span></div></div><div class=\"property-details__custom-user-listing-data__right-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden:</div><span class=\"radio-input\"><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"yes\" data-ng-model=\"property.customFields.garden\">Yes<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"garden\" value=\"no\" data-ng-model=\"property.customFields.garden\">No<span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Garden facing:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.gardenFacing\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"north\">North</option><option value=\"east\">East</option><option value=\"south\">South</option><option value=\"west\">West</option><option value=\"northwest\">North West</option><option value=\"northeast\">North East</option><option value=\"southwest\">South West</option><option value=\"southeast\">South East</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Floors:</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.floors\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"basement\">Basement</option><option value=\"ground\">Ground floor</option><option value=\"first\">1st floor</option><option value=\"second\">2nd floor</option><option value=\"third\">3rd floor</option><option value=\"higher\">Higher up</option><option value=\"mixed\">Mixed levels</option></select></fieldset><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Is the seller in a chain?</div><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.sellerChain\"><option value=\"unknown\" selected=\"selected\">Unknown</option><option value=\"yes\">Yes</option><option value=\"no\">No</option></select></fieldset></div></form></div></div></div></section><section class=\"property-details__subsection property-details__subsection--ownership-status\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.ownership_status\"><div data-pl-accordion-sync2=\"accordionSections.ownership_status\"><div data-accordion-heading=\"\"><h1 class=\"property-details__subsection__heading\">Ownership Status</h1><span class=\"property-details__subsection__toggle-button\"><i class=\"i\"></i></span></div><div class=\"property-details__subsection__content\"><form name=\"custom-ownership-data\" class=\"property-details__custom-data-form property-details__custom-data-form--ownership\"><div class=\"property-details__custom-user-listing-data__left-column\"><fieldset class=\"inline-fieldset\"><div class=\"inline-fieldset__label\">Leasehold/Freehold:</div><div class=\"inline-fieldset__field-row\"><select data-ui-select2=\"{ minimumResultsForSearch: -1 }\" class=\"inline-fieldset__field select2-hide\" data-ng-model=\"property.customFields.ownershipType\"><option value=\"freehold\">Freehold</option><option value=\"freehold-share\">Share of freehold</option><option value=\"leasehold\">Leasehold</option></select></div></fieldset><fieldset class=\"inline-fieldset\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><label class=\"inline-fieldset__label\" for=\"leashold-period-input\">Leasehold period:</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field\"><input type=\"number\" name=\"leashold-period\" id=\"leashold-period-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.leasholdPeriod\"></div></div></fieldset></div><div class=\"property-details__custom-user-listing-data__right-column\" data-ng-class=\"{ 'invisible': property.customFields.ownershipType == 'freehold' }\"><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"ground-rent-monthly-input\">Ground rent?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"inline-fieldset__units-above\">Monthly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-monthly\" id=\"ground-rent-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.groundRentMonthly\" data-ng-change=\"groundRentMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"inline-fieldset__units-above\">Yearly</span><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ground-rent-annually\" id=\"ground-rent-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.groundRentAnnually\" disabled=\"disabled\"></div></div></fieldset><fieldset class=\"inline-fieldset\"><label class=\"inline-fieldset__label\" for=\"management-fee-monthly-input\">Management fee?</label><div class=\"inline-fieldset__field-row\"><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-monthly\" id=\"management-fee-monthly-input\" step=\"any\" min=\"0\" class=\"input__field\" placeholder=\"0\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\" data-ng-model=\"property.customFields.managementFeeMonthly\" data-ng-change=\"managementFeeMonthlyChanged()\"></div><div class=\"input inline-fieldset__field input--prepend inline-fieldset__field--half inline-fieldset__field--ajoined\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"management-fee-annually\" id=\"management-fee-annually-input\" class=\"input__field\" data-ng-model=\"property.customFields.managementFeeAnnually\" disabled=\"disabled\"></div></div></fieldset></div></form><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">If you are unsure what this means, it may make sense to hire your solicitor earlier.</p><button class=\"contact-button--solicitor\" data-ng-click=\"openDialog('solicitor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Solicitor</span></button></div></div></div></section></div></section>");
    $templateCache.put("/partials/views/property-search/includes/common/sub-section-contact-form.html", "<div class=\"property-details__main-section--agent__contact-form__wrap\"><div class=\"property-details__main-section--agent__contact-form__left\"><p class=\"property-details__main-section--agent__contact-form__prompt\">Inquire about this property</p><div class=\"property-details__main-section--agent__contact-row property-details__main-section--agent__contact-row--dual\"><label class=\"property-details__main-section--agent__contact-form__first-name-label\">First:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.firstName\" type=\"text\" name=\"firstName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.firstName=userData.user.firstName\" data-ng-focus=\"agent.firstName.showErrors=true\" data-ng-blur=\"agent.firstName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.firstName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.firstName.$error.serverMessages\" data-ng-show=\"agent.firstName.showErrors\"><i></i>[[message]]</span></div><label class=\"property-details__main-section--agent__contact-form__last-name-label\">Last:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.lastName\" type=\"text\" name=\"lastName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.lastName=userData.user.lastName\" data-ng-focus=\"agent.lastName.showErrors=true\" data-ng-blur=\"agent.lastName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.lastName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.lastName.$error.serverMessages\" data-ng-show=\"agent.lastName.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__email-label\">Email:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.email\" type=\"email\" name=\"email\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.email=userData.user.email\" data-ng-focus=\"agent.email.showErrors=true\" data-ng-blur=\"agent.email.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.email.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.email.$error.serverMessages\" data-ng-show=\"agent.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__phone-label\">Phone:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><div class=\"grid\"><div class=\"property-details__main-section--agent__contact-form__input--phone\"><input data-ng-model=\"forms.agent.phoneNumber\" type=\"text\" name=\"phoneNumber\" data-ng-init=\"forms.agent.phoneNumber=userData.user.telephone\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-focus=\"agent.phoneNumber.showErrors=true\" data-ng-blur=\"agent.phoneNumber.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.phoneNumber.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.phoneNumber.$error.serverMessages\" data-ng-show=\"agent.phoneNumber.showErrors\"><i></i>[[message]]</span></div><div class=\"property-details__main-section--agent__contact-form__input--phone-type\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.phoneType\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"phoneType\" data-ng-init=\"forms.agent.phoneType=userData.user.telephoneType\"><option value=\"home\" selected=\"selected\">Home</option><option value=\"mobile\">Mobile</option><option value=\"work\">Work</option></select></div></div></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__call-time-label\">Best time to call:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.timeToCall\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"timeToCall\"><option value=\"anytime\" selected=\"selected\">Anytime</option><option value=\"morning\">Morning</option><option value=\"afternoon\">Afternoon</option><option value=\"evening\">Evening</option></select></div></div></div><div class=\"property-details__main-section--agent__contact-form__right\"><p class=\"property-details__main-section--agent__contact-form__terms\">By submitting this form you accept our <a href=\"//plentific.com/terms\" target=\"_blank\">Terms of Use</a>.</p><textarea name=\"message\" placeholder=\"Message (optional)\" data-ng-model=\"forms.agent.message\"></textarea><button type=\"submit\" aria-label=\"Send inquiry\" class=\"btn--blue\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div>");
    $templateCache.put("/partials/views/property-search/includes/compare/main-section-contact.html", "<section class=\"property-details__main-section property-details__main-section--agent\" id=\"contact\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.contact\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Contact the Agent</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section__body\"><div class=\"property-details--compare__main-section--agents property-compare__side-by-side-container\"><form name=\"frm_agent_select\"><div class=\"property-details--compare__main-section--agent-column-wrap\" data-ng-repeat=\"property in properties\"><div class=\"property-compare__dropzone\" data-ng-hide=\"property\" data-dropzone-id=\"[[$index]]\" data-pl-droppable=\"{ callbacks: { drop: onPropertyDropped }, jquiOptions: { accept: '.property-search-result__link', hoverClass: 'is-hovered', tolerance: 'pointer' } }\"><span class=\"i i-property-dropzone\"></span><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><span data-ng-show=\"property\" class=\"radio-input property-details--compare__main-section--agent-address\"><label class=\"radio-input__label\"><input type=\"radio\" class=\"radio-input__field\" name=\"property_index\" data-ng-model=\"forms.agent_choice.agentIndex\" value=\"[[$index]]\"><span data-ng-bind=\"property.street_name\"></span>, <span data-ng-bind=\"property.post_town\"></span> <span data-ng-bind=\"property.outcode\"></span><span class=\"radio-input__background\"></span><span class=\"radio-input__active-icon\"></span></label></span><div data-ng-show=\"property\" class=\"property-details--compare__main-section--agent-column-inner\"><p class=\"property-details__main-section--agent__agent-details\"><img class=\"property-details__main-section--agent__agent-logo\" data-ng-src=\"[[ property.agent_logo ]]\" height=\"40\"><span data-ng-bind=\"property.agent_name\"></span>, <span data-ng-bind=\"property.agent_address\"></span>, <span class=\"property-details__main-section--agent__agent-details__postcode\" data-ng-bind=\"property.agent_postcode\"></span><br>Call on <span class=\"property-details__main-section--agent__agent-details__phone\" data-ng-bind=\"property.agent_phone\"></span></p></div></div></form></div><div class=\"property-details__main-section--agent__agent-details-body\"><div ng-switch=\"messages.agent.prompt.type\" data-ng-show=\"messages.agent.prompt.visible\"><div ng-switch-when=\"sending\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">Sending your enquiry...</div></div><div ng-switch-when=\"success\"><div class=\"property-details__main-section--agent__contact-form-submission-message\"><span class=\"i i-contacted-tick\"></span>Thank you. Your enquiry has been sent to <span data-ng-bind=\"properties[messages.agent.prompt.agent_index].agent_name\"></span><span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Send another enquiry</a></span></div></div><div ng-switch-when=\"failure\" data-ng-show=\"messages.agent.prompt.visible\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">There was a problem sending your message, please try again later.<span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Try again</a></span></div></div></div><form class=\"property-details__main-section--agent__contact-form submit-on-enter\" data-ng-hide=\"messages.agent.prompt.visible\" data-ng-submit=\"sendMessage('agent', agent)\" name=\"agent\" id=\"frm-agent\" novalidate=\"\"><div class=\"property-details__main-section--agent__contact-form__wrap\"><div class=\"property-details__main-section--agent__contact-form__left\"><p class=\"property-details__main-section--agent__contact-form__prompt\">Inquire about this property</p><div class=\"property-details__main-section--agent__contact-row property-details__main-section--agent__contact-row--dual\"><label class=\"property-details__main-section--agent__contact-form__first-name-label\">First:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.firstName\" type=\"text\" name=\"firstName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.firstName=userData.user.firstName\" data-ng-focus=\"agent.firstName.showErrors=true\" data-ng-blur=\"agent.firstName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.firstName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.firstName.$error.serverMessages\" data-ng-show=\"agent.firstName.showErrors\"><i></i>[[message]]</span></div><label class=\"property-details__main-section--agent__contact-form__last-name-label\">Last:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.lastName\" type=\"text\" name=\"lastName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.lastName=userData.user.lastName\" data-ng-focus=\"agent.lastName.showErrors=true\" data-ng-blur=\"agent.lastName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.lastName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.lastName.$error.serverMessages\" data-ng-show=\"agent.lastName.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__email-label\">Email:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.email\" type=\"email\" name=\"email\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.email=userData.user.email\" data-ng-focus=\"agent.email.showErrors=true\" data-ng-blur=\"agent.email.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.email.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.email.$error.serverMessages\" data-ng-show=\"agent.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__phone-label\">Phone:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><div class=\"grid\"><div class=\"property-details__main-section--agent__contact-form__input--phone\"><input data-ng-model=\"forms.agent.phoneNumber\" type=\"text\" name=\"phoneNumber\" data-ng-init=\"forms.agent.phoneNumber=userData.user.telephone\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-focus=\"agent.phoneNumber.showErrors=true\" data-ng-blur=\"agent.phoneNumber.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.phoneNumber.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.phoneNumber.$error.serverMessages\" data-ng-show=\"agent.phoneNumber.showErrors\"><i></i>[[message]]</span></div><div class=\"property-details__main-section--agent__contact-form__input--phone-type\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.phoneType\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"phoneType\" data-ng-init=\"forms.agent.phoneType=userData.user.telephoneType\"><option value=\"home\" selected=\"selected\">Home</option><option value=\"mobile\">Mobile</option><option value=\"work\">Work</option></select></div></div></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__call-time-label\">Best time to call:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.timeToCall\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"timeToCall\"><option value=\"anytime\" selected=\"selected\">Anytime</option><option value=\"morning\">Morning</option><option value=\"afternoon\">Afternoon</option><option value=\"evening\">Evening</option></select></div></div></div><div class=\"property-details__main-section--agent__contact-form__right\"><p class=\"property-details__main-section--agent__contact-form__terms\">By submitting this form you accept our <a href=\"//plentific.com/terms\" target=\"_blank\">Terms of Use</a>.</p><textarea name=\"message\" placeholder=\"Message (optional)\" data-ng-model=\"forms.agent.message\"></textarea><button type=\"submit\" aria-label=\"Send inquiry\" class=\"btn--blue\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div></form></div></div></div></section>");
    $templateCache.put("/partials/views/property-search/includes/compare/main-section-financials.html", "<section class=\"property-details__main-section property-details__main-section--financials property-details__main-section--shared\" id=\"financials\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.financials\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section--financials__content-wrapper\"><div class=\"property-details__main-section--item-wrapper\"><div class=\"property-details__subsection-box-financials-salary\"><div class=\"property-details__subsection-box__header\">Salary</div><div class=\"property-details__subsection-box__content\"><table><thead><tr><th></th><th>Gross annual income</th><th>Net monthly income</th></tr></thead><tbody data-ng-switch=\"propertyFinancials.applicants.length\"><tr data-ng-repeat=\"applicant in propertyFinancials.applicants\"><td class=\"property-details__subsection-box-financials-salary__avatar\"><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ applicant.avatar_48 ]]\"></td><td class=\"property-details__subsection-box-financials-salary__gross\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"></div></div></td><td class=\"property-details__subsection-box-financials-salary__net\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.netMonthlyIncome\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.netMonthlyIncome\"></div></div></td></tr><tr data-ng-switch-when=\"1\"><td colspan=\"3\" class=\"add-applicant-row\"><button class=\"property-details__add-applicant-button\" data-ng-click=\"addApplicant()\"><i class=\"i i-add-applicant\"></i>Add applicant</button></td></tr></tbody></table></div></div></div><div class=\"property-details__main-section--item-wrapper--savings-and-expenses\"><div class=\"property-details__subsection-box-financials-savings\"><div class=\"property-details__subsection-box__header\">Savings</div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--positive editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.savings\"></div></div></div></div><div class=\"property-details__subsection-box-financials-expenses\"><div class=\"property-details__subsection-box__header\">Household expenses <span>(excl. accommodation)</span></div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--negative editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"></div></div></div></div></div></div><section class=\"property-details__subsection property-details__subsection--scenario-analysis\"><div class=\"property-details__subsection__content\"><h1 class=\"property-details__subsection__heading\">Scenario Analysis</h1><div class=\"property-compare__side-by-side-container\" data-ng-class=\"{ 'is-empty': numProperties < 1 }\"><div class=\"property-compare__column\" data-ng-class=\"{ 'property-compare__column--left': $index == 0, 'property-compare__column--right': $index == 1, 'property-compare__column--empty': !prop }\" data-ng-repeat=\"prop in properties\"><div class=\"property-compare__column__content\"><div class=\"property-compare__dropzone\" data-ng-hide=\"prop\" data-dropzone-id=\"[[$index]]\" data-pl-droppable=\"{ callbacks: { drop: onPropertyDropped }, jquiOptions: { accept: '.property-search-result__link', hoverClass: 'is-hovered', tolerance: 'pointer' } }\"><span class=\"i i-property-dropzone\"></span><p class=\"property-compare__prompt\">Drag and drop a property here to compare</p></div><div class=\"property-details__scenario-analysis-table-outer-wrapper\" data-ng-show=\"prop\"><div class=\"property-details__scenario-analysis-table-inner-wrapper\"><div data-ng-controller=\"ScenarioAnalysisController\" data-ng-init=\"configure([[$index]])\"><button type=\"button\" class=\"btn--link property-details__scenario-analysis__reset-button\" data-ng-click=\"initFinancials(property)\" data-ng-show=\"showResetButton\">Reset to default values</button><table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table><div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div></div><a class=\"property-details__help-prompt__button--view-all-details\" data-ng-href=\"/property-search/property/[[ prop.listing_id ]]/\"><span class=\"i\"></span>View all details</a></div></div></div></div></div><div class=\"property-details__scenario-indicators-legend\"><ul><li><span class=\"indicator indicator--green\"></span>Green means most likely achievable</li><li><span class=\"indicator indicator--amber\"></span>Amber means hard to achieve or slightly above budget</li><li><span class=\"indicator indicator--red\"></span>Red means very hard to achieve or above budget</li></ul></div><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">Need help with you mortgage? Speak to one of our Mortgage Advisors.</p><button class=\"contact-button--mortgage-advisor\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div></div></section></div></section>");
    $templateCache.put("/partials/views/property-search/includes/detail/main-section-contact.html", "<section class=\"property-details__main-section property-details__main-section--agent\" id=\"contact\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.contact\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Contact the Agent</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><div class=\"property-details__main-section__body\"><div class=\"property-details__main-section--agent__agent-details\"><div class=\"property-details__main-section--agent__agent-details__wrap\"><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--logo\"><img class=\"property-details__main-section--agent__agent-logo\" data-ng-src=\"[[ property.agent_logo ]]\" height=\"40\"></div><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--address\"><span data-ng-bind=\"property.agent_name\"></span>, <span data-ng-bind=\"property.agent_address\"></span>, <span class=\"property-details__main-section--agent__agent-details__postcode\" data-ng-bind=\"property.agent_postcode\"></span></div><div class=\"property-details__main-section--agent__agent-details__item property-details__main-section--agent__agent-details__item--call-prompt\">Call on <span class=\"property-details__main-section--agent__agent-details__phone\" data-ng-bind=\"property.agent_phone\"></span></div></div></div><div class=\"property-details__main-section--agent__agent-details-body\"><div ng-switch=\"messages.agent.prompt.type\" data-ng-show=\"messages.agent.prompt.visible\"><div ng-switch-when=\"sending\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">Sending your enquiry...</div></div><div ng-switch-when=\"success\"><div class=\"property-details__main-section--agent__contact-form-submission-message\"><span class=\"i i-contacted-tick\"></span>Thank you. Your enquiry has been sent to <span data-ng-bind=\"property.agent_name\"></span></div></div><div ng-switch-when=\"failure\" data-ng-show=\"messages.agent.prompt.visible\"><div class=\"property-details__main-section--agent__contact-form-submission-message\">There was a problem sending your message, please try again later.<span class=\"property-details__main-section--agent__contact-dismiss-message\"><a href=\"#\" data-ng-click=\"messages.agent.prompt.visible = false\">Try again</a></span></div></div></div><form class=\"property-details__main-section--agent__contact-form submit-on-enter\" data-ng-hide=\"messages.agent.prompt.visible\" data-ng-submit=\"sendMessage('agent', agent)\" name=\"agent\" id=\"frm-agent\" novalidate=\"\"><div class=\"property-details__main-section--agent__contact-form__wrap\"><div class=\"property-details__main-section--agent__contact-form__left\"><p class=\"property-details__main-section--agent__contact-form__prompt\">Inquire about this property</p><div class=\"property-details__main-section--agent__contact-row property-details__main-section--agent__contact-row--dual\"><label class=\"property-details__main-section--agent__contact-form__first-name-label\">First:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.firstName\" type=\"text\" name=\"firstName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.firstName=userData.user.firstName\" data-ng-focus=\"agent.firstName.showErrors=true\" data-ng-blur=\"agent.firstName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.firstName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.firstName.$error.serverMessages\" data-ng-show=\"agent.firstName.showErrors\"><i></i>[[message]]</span></div><label class=\"property-details__main-section--agent__contact-form__last-name-label\">Last:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.lastName\" type=\"text\" name=\"lastName\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.lastName=userData.user.lastName\" data-ng-focus=\"agent.lastName.showErrors=true\" data-ng-blur=\"agent.lastName.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.lastName.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.lastName.$error.serverMessages\" data-ng-show=\"agent.lastName.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__email-label\">Email:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><input data-ng-model=\"forms.agent.email\" type=\"email\" name=\"email\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-init=\"forms.agent.email=userData.user.email\" data-ng-focus=\"agent.email.showErrors=true\" data-ng-blur=\"agent.email.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.email.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.email.$error.serverMessages\" data-ng-show=\"agent.email.showErrors\"><i></i>[[message]]</span></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__phone-label\">Phone:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><div class=\"grid\"><div class=\"property-details__main-section--agent__contact-form__input--phone\"><input data-ng-model=\"forms.agent.phoneNumber\" type=\"text\" name=\"phoneNumber\" data-ng-init=\"forms.agent.phoneNumber=userData.user.telephone\" class=\"property-details__main-section--agent__contact-form__input--full-width\" data-ng-focus=\"agent.phoneNumber.showErrors=true\" data-ng-blur=\"agent.phoneNumber.showErrors=false\" data-ng-class=\"{'ng-invalid': agent.phoneNumber.$error.serverMessages.length}\"><span class=\"account-form__error\" data-ng-repeat=\"message in agent.phoneNumber.$error.serverMessages\" data-ng-show=\"agent.phoneNumber.showErrors\"><i></i>[[message]]</span></div><div class=\"property-details__main-section--agent__contact-form__input--phone-type\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.phoneType\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"phoneType\" data-ng-init=\"forms.agent.phoneType=userData.user.telephoneType\"><option value=\"home\" selected=\"selected\">Home</option><option value=\"mobile\">Mobile</option><option value=\"work\">Work</option></select></div></div></div></div><div class=\"property-details__main-section--agent__contact-row\"><label class=\"property-details__main-section--agent__contact-form__call-time-label\">Best time to call:</label><div class=\"property-details__main-section--agent__contact-form__input-wrapper\"><select class=\"property-details__main-section--agent__contact-form__input--full-width select2-hide\" data-ng-model=\"forms.agent.timeToCall\" data-ui-select2=\"{ minimumResultsForSearch: -1 }\" name=\"timeToCall\"><option value=\"anytime\" selected=\"selected\">Anytime</option><option value=\"morning\">Morning</option><option value=\"afternoon\">Afternoon</option><option value=\"evening\">Evening</option></select></div></div></div><div class=\"property-details__main-section--agent__contact-form__right\"><p class=\"property-details__main-section--agent__contact-form__terms\">By submitting this form you accept our <a href=\"//plentific.com/terms\" target=\"_blank\">Terms of Use</a>.</p><textarea name=\"message\" placeholder=\"Message (optional)\" data-ng-model=\"forms.agent.message\"></textarea><button type=\"submit\" aria-label=\"Send inquiry\" class=\"btn--blue\"><i class=\"i sprite-icon-contact-via-email\"></i></button></div></div></form></div></div></div></section>");
    $templateCache.put("/partials/views/property-search/includes/detail/main-section-financials.html", "<section class=\"property-details__main-section property-details__main-section--financials\" id=\"financials\" data-accordion-group=\"\" data-ng-class=\"{'is-expanded': isOpen, 'is-collapsed': !isOpen}\" data-is-open=\"accordionSections.financials\"><div data-accordion-heading=\"\"><div class=\"property-details__main-section__header\"><h1 class=\"property-details__main-section__title\">Financials</h1><span class=\"property-details__main-section__toggle-button\"><i class=\"i\"></i></span></div></div><div class=\"property-details__main-section__content\"><p class=\"form-prompt\"><i class=\"i i-form-info\"></i>You can change the editable form fields below to run various financial scenarios.</p><div class=\"property-details__main-section--financials__content-wrapper\"><div class=\"property-details__main-section--item-wrapper\"><div class=\"property-details__subsection-box-financials-salary\"><div class=\"property-details__subsection-box__header\">Salary</div><div class=\"property-details__subsection-box__content\"><table><thead><tr><th></th><th>Gross annual income</th><th>Net monthly income</th></tr></thead><tbody data-ng-switch=\"propertyFinancials.applicants.length\"><tr data-ng-repeat=\"applicant in propertyFinancials.applicants\"><td class=\"property-details__subsection-box-financials-salary__avatar\"><img class=\"avatar avatar--round i i-default-avatar--48x48\" data-ng-src=\"[[ applicant.avatar_48 ]]\"></td><td class=\"property-details__subsection-box-financials-salary__gross\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.grossAnnualIncomeIncludingBonus\"></div></div></td><td class=\"property-details__subsection-box-financials-salary__net\"><div class=\"editable-label editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"applicant.netMonthlyIncome\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"applicant.netMonthlyIncome\"></div></div></td></tr><tr data-ng-switch-when=\"1\"><td colspan=\"3\" class=\"add-applicant-row\"><button class=\"property-details__add-applicant-button\" data-ng-click=\"addApplicant()\"><i class=\"i i-add-applicant\"></i>Add applicant</button></td></tr></tbody></table></div></div></div><div class=\"property-details__main-section--item-wrapper--savings-and-expenses\"><div class=\"property-details__subsection-box-financials-savings\"><div class=\"property-details__subsection-box__header\">Savings</div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--positive editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.savings\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.savings\"></div></div></div></div><div class=\"property-details__subsection-box-financials-expenses\"><div class=\"property-details__subsection-box__header\">Household expenses <span>(excl. accommodation)</span></div><div class=\"property-details__subsection-box__content\"><div class=\"editable-label--negative editable-label--small\" data-pl-editable-label=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"><div class=\"input input--prepend inline-fieldset__field\"><span class=\"input__add-on\">£</span><input class=\"input__field\" type=\"text\" pl-number=\"\" data-pl-focus=\"\" data-ng-model=\"propertyFinancials.monthlyExpenses\"></div></div></div></div></div><div class=\"property-details__main-section--item-wrapper--financial-results\"><div class=\"property-details__financials-results\"><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Potential loan size:</span><span class=\"property-details__financials-results__value\"><span data-ng-bind=\"maxLoanMultiple\"></span>x</span></div><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Estimated mortgage loan amount:</span><span class=\"property-details__financials-results__value\" data-ng-bind=\"totalGrossAnnualIncome * maxLoanMultiple | noFractionCurrency:'£'\"></span></div><div class=\"property-details__financials-results__entry\"><span class=\"property-details__financials-results__title\">Estimated purchase price:</span><span class=\"property-details__financials-results__value\" data-ng-bind=\"property.customFields.estimatedPrice | noFractionCurrency:'£'\"></span></div></div></div></div><section class=\"property-details__subsection property-details__subsection--scenario-analysis\"><div class=\"property-details__subsection__content\"><h1 class=\"property-details__subsection__heading\">Scenario Analysis</h1><div class=\"property-details__scenario-analysis-table-outer-wrapper\"><div class=\"property-details__scenario-analysis-table-inner-wrapper\"><div data-ng-controller=\"ScenarioAnalysisController\" data-ng-init=\"configure([[$index]])\"><button type=\"button\" class=\"btn--link property-details__scenario-analysis__reset-button\" data-ng-click=\"initFinancials(property)\" data-ng-show=\"showResetButton\">Reset to default values</button><table class=\"property-details__scenario-analysis-table inline-fieldset\"><thead><tr><th>Mortgage scenarios</th><th data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.title\"></span></th></tr></thead><tbody><tr><td>Purchase price:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--prepend inline-fieldset__field inline-fieldset__field--right\"><span class=\"input__add-on input__add-on--prepend\">£</span><input type=\"text\" pl-number=\"\" name=\"ibe-value\" step=\"any\" min=\"0\" class=\"input__field\" data-ng-model=\"scenario.purchasePrice\" placeholder=\"0\" required=\"\" data-pl-focus=\"\" data-pl-default-value-hider=\"0\"></div></td></tr><tr class=\"table-row--subrow\"><td>% discount:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.discount\"></span></td></tr><tr><td>Price per sq ft:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.pricePerSqFt | noFractionCurrency:'£':'true'\"></span></td></tr><tr><td>LTV:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field inline-fieldset__field--right\"><input class=\"input__field\" type=\"text\" data-pl-focus=\"\" data-ng-model=\"scenario.ltv\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Loan amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.loanAmount | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr><tr><td>Total cash required:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.totalCashRequired | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Deposit:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.deposit | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Stamp duty:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.stampDuty | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td class=\"affordability-results__result--other-fees\">Other fees: <button class=\"btn--link\" data-ng-click=\"feesDialogOpts.showDialog =! feesDialogOpts.showDialog\">Advanced</button><div class=\"affordability-results__mega-tooltip\" data-ng-show=\"feesDialogOpts.showDialog\" data-ng-include=\"'/partials/views/calculators/affordability/dialog-fees.html'\"></div></td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.otherFees | noFractionCurrency:'£'\"></span></td></tr><tr><td>Interest rate:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-interest-rate-field=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.interestRate\" required=\"\"><span class=\"input__add-on\">%</span></div></td></tr><tr><td>Mortgage Term:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"input input--append inline-fieldset__field\"><input class=\"affordability-results__result-value--input input__field\" type=\"text\" pl-number=\"\" step=\"any\" min=\"0\" data-pl-focus=\"\" data-ng-model=\"scenario.mortgageTerm\" required=\"\"><span class=\"input__add-on\">y</span></div></td></tr><tr><td>Monthly mortgage payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.monthlyMortgagePayment | noFractionCurrency:'£'\"></span><span class=\"indicator--small indicator--[[scenario.monthlyMortgagePaymentIndicator]]\"></span></div></td></tr><tr class=\"table-row--subrow\"><td>Interest:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.interestPerMonth | noFractionCurrency:'£'\"></span></td></tr><tr class=\"table-row--subrow\"><td>Principal repayment:</td><td data-ng-repeat=\"scenario in financials.scenarios\"><span data-ng-bind=\"scenario.principalRepayment | noFractionCurrency:'£'\"></span></td></tr><tr><td>Remaining cash:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"property-details__scenario-analysis-value-wrapper table-cell-abs-content__content\"><span data-ng-class=\"{'property-details__scenario-analysis-value-bg--negative': scenario.remainingCash < 0, 'property-details__scenario-analysis-value-bg--positive': scenario.remainingCash >= 0}\"></span><span class=\"property-details__scenario-analysis-value\" data-ng-bind=\"scenario.remainingCash | noFractionCurrency:'£'\"></span></div></td></tr></tbody></table><div class=\"property-details__subsection-box--indicators\"><div class=\"property-details__subsection-box__header\">Indicators</div><div class=\"property-details__subsection-box__content\"><table class=\"property-details__scenario-indicators-table\"><tbody><tr><td>Annual Salary Multiple for Mortgage Amount:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.incomeMultiple | number:2\"></span>x<span class=\"indicator--small indicator--[[scenario.incomeMultipleIndicator]]\"></span></div></td></tr><tr><td>% of Income Used for Mortgage Payment:</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverIncomeIndicator]]\"></span></div></td></tr><tr><td>% of Disposable Income Used for Mortgage Payment</td><td class=\"table-cell-abs-content__cell\" data-ng-repeat=\"scenario in financials.scenarios\"><div class=\"table-cell-abs-content__content\"><span data-ng-bind=\"scenario.mortgageOverDispIncome\"></span>%<span class=\"indicator--small indicator--[[scenario.mortgageOverDispIncomeIndicator]]\"></span></div></td></tr></tbody></table></div></div></div></div></div><div class=\"property-details__scenario-indicators-legend\"><ul><li><span class=\"indicator indicator--green\"></span>Green means most likely achievable</li><li><span class=\"indicator indicator--amber\"></span>Amber means hard to achieve or slightly above budget</li><li><span class=\"indicator indicator--red\"></span>Red means very hard to achieve or above budget</li></ul></div><div class=\"property-details__help-prompt\"><p class=\"property-details__help-prompt__text\">Need help with you mortgage? Speak to one of our Mortgage Advisors.</p><button class=\"contact-button--mortgage-advisor\" data-ng-click=\"openDialog('mortgageAdvisor')\"><span class=\"i\"></span>Speak to a <span class=\"contact-button__help-type\">Mortgage Advisor</span></button></div></div></section></div></section>");
    $templateCache.put("/partials/views/property-search/includes/search/result-disambiguation.html", "<div class=\"property-search-disambiguation\" data-ng-show=\"disambiguationRequired\"><div class=\"property-search-disambiguation__outer-wrap\"><section class=\"property-search-disambiguation__inner-wrap\"><a class=\"property-details__close-button\" href=\"/property-search/\" data-ng-click=\"disambiguationRequired=false;\"></a><div class=\"property-search-disambiguation__content\"><h1 class=\"property-search-disambiguation__heading\">We have found multiple results for '[[searchedArea]]'</h1><h2 class=\"property-search-disambiguation__sub-heading\">Please select one of the links below or <a href=\"/property-search/\" data-ng-click=\"disambiguationRequired=false;\">start search again</a>.</h2><ul><li data-ng-repeat=\"address in disambiguationAddresses\"><a ng-href=\"/property-search/?search.area=[[ address ]]\" data-ng-bind=\"address\"></a></li></ul></div></section></div></div>");
    $templateCache.put("/partials/views/property-search/includes/search/result-link.html", "<a class=\"property-search-result__link\" href=\"/property-search/property/[[ property.listing_id ]]/\" data-ng-click=\"onClusterPropertyClicked($event, property)\" data-property-id=\"[[property.listing_id]]\" data-pl-right-click=\"onClusterPropertyRightClicked($event, property)\" data-pl-draggable=\"{ callbacks: { dragstart: onPropertyDragStart, dragstop: onPropertyDragStop }, jquiOptions: { appendTo: '#fullscreen-scroll-container', helper: 'clone', scroll: false }, setHelperWidth: true }\"><span class=\"property-search-result__no-image\" data-ng-show=\"!property.prettyThumnailUrl\">No Image</span><span class=\"property-search-result__image\" data-ng-show=\"property.prettyThumnailUrl\" data-ng-style=\"{'background-image': 'url(' + property.prettyThumnailUrl + ')'}\"></span><span class=\"property-search-result-info\"><span class=\"property-search-result__price\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.prettyPrice ]]</span><span class=\"property-search-result__price\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span><span class=\"property-search-result__bedrooms\"><span data-ng-bind=\"property.num_bedrooms\"></span> bedroom</span><span class=\"property-search-result__address\" data-ng-bind=\"property.street_name\"></span><span class=\"property-search-result__region\"><span data-ng-bind=\"property.county\"></span> <span data-ng-bind=\"property.outcode\"></span></span><span class=\"property-search-result__age\" data-ng-bind=\"property.prettyPublishDate\"></span><span class=\"property-search-result__price--small-screen\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.price | noFractionCurrency:'£' ]]</span><span class=\"property-search-result__price--small-screen\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span></span></a><button class=\"property-search-result__favourite-button\" aria-label=\"Favourite\" data-ng-class=\"{ 'is-active': property.isFavourite }\" data-ng-click=\"favouriteButtonClick(property, $event)\"><i class=\"i\"></i></button>");
    $templateCache.put("/partials/views/property-search/search.html", "<div data-ui-view=\"property-search-modal\"></div><div class=\"property-search-disambiguation\" data-ng-show=\"disambiguationRequired\"><div class=\"property-search-disambiguation__outer-wrap\"><section class=\"property-search-disambiguation__inner-wrap\"><a class=\"property-details__close-button\" href=\"/property-search/\" data-ng-click=\"disambiguationRequired=false;\"></a><div class=\"property-search-disambiguation__content\"><h1 class=\"property-search-disambiguation__heading\">We have found multiple results for '[[searchedArea]]'</h1><h2 class=\"property-search-disambiguation__sub-heading\">Please select one of the links below or <a href=\"/property-search/\" data-ng-click=\"disambiguationRequired=false;\">start search again</a>.</h2><ul><li data-ng-repeat=\"address in disambiguationAddresses\"><a ng-href=\"/property-search/?search.area=[[ address ]]\" data-ng-bind=\"address\"></a></li></ul></div></section></div></div><div class=\"page-content page-content--property-search\"><div class=\"property-search__toolbar\"><form class=\"property-search__toolbar__form submit-on-enter\" data-ng-submit=\"syncQueryString()\"><div class=\"control-group control-group--inline place-search\" data-pl-places-search=\"\"><div class=\"place-search__query-container\"><input type=\"text\" class=\"input place-search__suggestion-input\" data-ng-model=\"inplaceSuggestion\"><input type=\"text\" class=\"input place-search__query-input\" data-pl-places-search-input=\"\" autocomplete=\"off\" data-ng-model=\"search.params.area\" placeholder=\"Enter a place or postcode\" id=\"ss-property-search-location\"></div><div data-pl-places-search-suggestions=\"\" class=\"place-search__results\" data-ng-model=\"search.params.area\" data-ng-show=\"response.suggestions\"><ul class=\"place-search__results__list place-search__results__list--places\"><li class=\"place-search__results__list-item\" data-ng-repeat=\"suggestion in response.suggestions\" data-ng-class=\"{ 'is-highlighted': $index == highlightedIndex }\" data-ng-click=\"selectAndClose($index)\"><span data-ng-switch=\"suggestion.type\"><span data-ng-switch-when=\"place/area\"><span data-ng-bind-html=\"suggestion.value | plPlacesSearchSuggestionHighlighter:response.original_query\"></span></span><span data-ng-switch-when=\"postcode\"><span class=\"place-search__results__list-item__postcode\" data-ng-bind-html=\"suggestion.code | plPlacesSearchSuggestionHighlighter:response.original_query\"></span> <span class=\"place-search__results__list-item__postcode-area\" data-ng-bind-html=\"suggestion.area\"></span></span></span></li></ul></div></div><div class=\"control-group control-group--inline\"><label class=\"control-group__label\" for=\"ss-property-search-min-price\">Min:</label><select name=\"min\" data-ng-model=\"search.params.minimum_price\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" id=\"ss-property-search-min-price\" class=\"select2-hide property-search__toolbar__price-select\"><option value=\"_DEFAULT_\">No min</option><option value=\"[[ price ]]\" data-ng-repeat=\"price in search.prices\">[[ price | noFractionCurrency:'£' ]]</option></select></div><div class=\"control-group control-group--inline\"><label class=\"control-group__label\" for=\"ss-property-search-max-price\">Max:</label><select name=\"min\" data-ng-model=\"search.params.maximum_price\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" id=\"ss-property-search-max-price\" class=\"select2-hide property-search__toolbar__price-select\"><option value=\"_DEFAULT_\">No max</option><option value=\"[[ price ]]\" data-ng-repeat=\"price in search.prices\">[[ price | noFractionCurrency:'£' ]]</option></select></div><div class=\"control-group control-group--inline\"><label class=\"control-group__label\" for=\"ss-property-search-bedrooms\">Bedrooms:</label><select name=\"minimum_beds\" data-ng-model=\"search.params.minimum_beds\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" id=\"ss-property-search-bedrooms\" class=\"select2-hide property-search__toolbar__bedroom-select\"><option value=\"_DEFAULT_\">Any</option><option value=\"1\">1+</option><option value=\"2\">2+</option><option value=\"3\">3+</option><option value=\"4\">4+</option><option value=\"5\">5+</option><option value=\"6\">6+</option><option value=\"7\">7+</option><option value=\"8\">8+</option><option value=\"9\">9+</option><option value=\"10\">10+</option></select></div><div class=\"property-search__filters\"><a class=\"property-search__filters__link\" data-ng-click=\"filtersVisible = !filtersVisible\"><i class=\"i i-property-search-filter\"></i><span class=\"property-search__filters__count\" data-ng-bind=\"activeFilters\"></span></a><div class=\"property-search__filters__popup\" data-ng-class=\"{'is-visible': filtersVisible}\"><div class=\"control-row\"><div class=\"control-group control-group--inline control-group--full-width\"><label class=\"control-group__label\" for=\"property-search-keywords\">Keywords:</label><span class=\"control-group__field-wrapper\"><input type=\"text\" class=\"input\" autocomplete=\"off\" data-ng-model=\"search.params.keywords\" placeholder=\"eg. &lsquo;garden&rsquo; or &lsquo;wood floors&rsquo;\" id=\"property-search-keywords\"></span></div></div><div class=\"control-row\"><div class=\"control-group control-group--inline control-group--double\"><label class=\"control-group__label\" for=\"property-search-advanced-radius\">Radius:</label><div class=\"control-group__field-wrapper\"><select name=\"radius\" data-ng-model=\"search.params.radius\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" id=\"property-search-advanced-radius\" class=\"select2-hide\"><option value=\"_DEFAULT_\">This area only</option><option value=\"0.25\">Within &frac14; mile</option><option value=\"0.5\">Within &frac12; mile</option><option value=\"1\">Within 1 mile</option><option value=\"3\">Within 3 miles</option><option value=\"5\">Within 5 miles</option><option value=\"10\">Within 10 miles</option><option value=\"20\">Within 20 miles</option><option value=\"30\">Within 30 miles</option><option value=\"40\">Within 40 miles</option></select></div></div><div class=\"control-group control-group--inline control-group--double\"><label class=\"control-group__label\" for=\"property-search-advanced-type\">Type:</label><span class=\"control-group__field-wrapper\"><select name=\"type\" data-ng-model=\"search.params.property_type\" data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" id=\"property-search-advanced-type\" class=\"select2-hide\"><option value=\"_DEFAULT_\">Any</option><option value=\"houses\">Houses</option><option value=\"flats\">Flats</option></select></span></div></div><div class=\"control-row\"><span class=\"control-group__label\">Include:</span><span class=\"checkbox-input\"><label class=\"checkbox-input__label\"><input type=\"checkbox\" class=\"checkbox-input__field\" data-ng-model=\"search.params.new_homes\" data-ng-true-value=\"_DEFAULT_\">New homes<span class=\"checkbox-input__background\"></span><span class=\"checkbox-input__active-icon\"></span></label></span></div></div></div><button type=\"submit\" class=\"btn--primary\">Search</button><span data-ng-switch=\"$state.current.data.subnav_section\"><a data-ng-switch-when=\"search\" href=\"/property-search/compare/[[getQueryStringForSearch()]]\" class=\"btn--compare\"><i class=\"i i-property-search-compare\"></i>Compare</a><a data-ng-switch-when=\"compare\" href=\"/property-search/[[getQueryStringForSearch()]]\" class=\"btn--compare is-active\"><i class=\"i i-property-search-compare\"></i>Compare</a></span></form></div><div class=\"property-search__map\"><div class=\"property-search__map__spinner\" data-pl-spinner=\"showSpinner\" data-pl-spinner-config=\"PROPERTY_SEARCH\"></div><div class=\"property-search__map__progress-overlay\" data-ng-class=\"{'is-showing-filter-prompt': shouldShowRefinePrompt() }\" data-ng-show=\"getNumLoadedResults()\"><span>Showing <strong data-ng-bind=\"getNumLoadedResults()\"></strong> of <strong data-ng-bind=\"results.result_count\"></strong> results. <span data-ng-show=\"shouldShowRefinePrompt()\">Please <button class=\"property-search__map__progress-overlay__refine\" data-ng-click=\"filtersVisible = !filtersVisible\"><i class=\"i i-property-search-filter\"></i>Refine</button> your search</span></span></div><div class=\"property-search__map__progress-overlay is-forced-quarter-mile-search\" data-ng-show=\"!showSpinner && search.isForcedQuarterMileSearch\"><span>Sorry, we were unable to locate any results matching your search. Please find below nearest listings using a <strong>0.25 mile radius</strong> or <button class=\"property-search__map__progress-overlay__refine\" data-ng-click=\"filtersVisible = !filtersVisible\"><i class=\"i i-property-search-filter\"></i>Refine</button> your search.</span></div><div class=\"property-search__map__progress-overlay is-zero-results\" data-ng-show=\"!showSpinner && results.result_count == 0\"><span>Sorry, we were unable to locate any results matching your search.<br>Please <button class=\"property-search__map__progress-overlay__refine\" data-ng-click=\"filtersVisible = !filtersVisible\"><i class=\"i i-property-search-filter\"></i>Refine</button> your search.</span></div><div class=\"property-search__map__container\" data-pl-google-map=\"map\"></div></div><div class=\"property-search__sidebar\"><div data-pl-tabset=\"searchTabset\" data-pl-css-block-modifier=\"main\" class=\"tabs--main property-search__sidebar-tabs\"><section data-pl-tab=\"\"><span data-pl-tab-heading=\"\" class=\"tabs__tab-header__content--results\" title=\"Search Results ([[ results.result_count ]])\"><i class=\"i i-property-search-results\"></i><span class=\"property-search__sidebar__tab-heading-content\">Search Results (<span data-ng-bind=\"results.result_count\"></span>)</span></span> <span class=\"powered-by-zoopla-attribution\"><span class=\"wrapper\"><span class=\"powered-by\">Powered by</span><span class=\"i i-powered-by-zoopla\"></span></span></span> <div class=\"property-search__order-by-dropdown\"><span class=\"property-search__order-by-label\">Sort by:</span><select data-ui-select2=\"DROPDOWN_CONFIG.defaults.options\" name=\"order_value\" class=\"select2-hide\" data-ng-model=\"search.params.order_value\"><option value=\"_AGE_DESCENDING_\">Most recent</option><option value=\"_PRICE_ASCENDING_\">Lowest price</option><option value=\"_PRICE_DESCENDING_\">Highest price</option></select></div><div class=\"property-search__results-list-container\"><div data-ng-show=\"results.result_count > 0\"><ol class=\"property-search__results-list\"><li class=\"property-search-result property-search-result--sidebar\" data-ng-repeat=\"property in results.listing | limitTo:propertyLimit\" data-ng-class=\"{'is-active': isPropertyActive(property.listing_id), 'property-search-result--in-compare': findCompareIndex(property.listing_id) != -1}\"><a class=\"property-search-result__link\" href=\"/property-search/property/[[ property.listing_id ]]/\" data-ng-click=\"onClusterPropertyClicked($event, property)\" data-property-id=\"[[property.listing_id]]\" data-pl-right-click=\"onClusterPropertyRightClicked($event, property)\" data-pl-draggable=\"{ callbacks: { dragstart: onPropertyDragStart, dragstop: onPropertyDragStop }, jquiOptions: { appendTo: '#fullscreen-scroll-container', helper: 'clone', scroll: false }, setHelperWidth: true }\"><span class=\"property-search-result__no-image\" data-ng-show=\"!property.prettyThumnailUrl\">No Image</span><span class=\"property-search-result__image\" data-ng-show=\"property.prettyThumnailUrl\" data-ng-style=\"{'background-image': 'url(' + property.prettyThumnailUrl + ')'}\"></span><span class=\"property-search-result-info\"><span class=\"property-search-result__price\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.prettyPrice ]]</span><span class=\"property-search-result__price\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span><span class=\"property-search-result__bedrooms\"><span data-ng-bind=\"property.num_bedrooms\"></span> bedroom</span><span class=\"property-search-result__address\" data-ng-bind=\"property.street_name\"></span><span class=\"property-search-result__region\"><span data-ng-bind=\"property.county\"></span> <span data-ng-bind=\"property.outcode\"></span></span><span class=\"property-search-result__age\" data-ng-bind=\"property.prettyPublishDate\"></span><span class=\"property-search-result__price--small-screen\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.price | noFractionCurrency:'£' ]]</span><span class=\"property-search-result__price--small-screen\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span></span></a><button class=\"property-search-result__favourite-button\" aria-label=\"Favourite\" data-ng-class=\"{ 'is-active': property.isFavourite }\" data-ng-click=\"favouriteButtonClick(property, $event)\"><i class=\"i\"></i></button></li></ol><div data-ng-hide=\"propertyLimit == SEARCH_MAX_RESULTS || results.listing.length <= propertyLimit\"><button data-ng-disabled=\"loading.listings\" class=\"btn\" name=\"load-more\" data-ng-class=\"{ 'is-disabled': loading.listings }\" data-ng-click=\"onLoadMoreClick()\">Show remaining [[ results.listing.length - SEARCH_RESULTS_LIMIT ]] results</button></div></div><div class=\"property-search__no-results\" data-ng-show=\"results.result_count == 0\" data-ng-cloak=\"\"><p>No results</p></div></div></section><section data-pl-tab=\"\"><span data-pl-tab-heading=\"\" class=\"tabs__tab-header__content--favourites\" title=\"Favourites ([[ favourites.meta.count ]])\"><i class=\"i i-property-search-favourites\"></i><span class=\"property-search__sidebar__tab-heading-content\">Favourites (<span data-ng-bind=\"favourites.meta.count || '0'\"></span>)</span></span><div class=\"property-search__favourites-list-container\"><div data-ng-show=\"favourites.meta.count > 0\"><ol class=\"property-search__favourites-list\"><li class=\"property-search-result property-search-result--sidebar\" data-ng-repeat=\"property in favourites | limitTo:favourites.meta.limit*favourites.meta.page\" data-ng-class=\"{'is-active': isPropertyActive(property.listing_id), 'property-search-result--in-compare': findCompareIndex(property.listing_id) != -1}\"><a class=\"property-search-result__link\" href=\"/property-search/property/[[ property.listing_id ]]/\" data-ng-click=\"onClusterPropertyClicked($event, property)\" data-property-id=\"[[property.listing_id]]\" data-pl-right-click=\"onClusterPropertyRightClicked($event, property)\" data-pl-draggable=\"{ callbacks: { dragstart: onPropertyDragStart, dragstop: onPropertyDragStop }, jquiOptions: { appendTo: '#fullscreen-scroll-container', helper: 'clone', scroll: false }, setHelperWidth: true }\"><span class=\"property-search-result__no-image\" data-ng-show=\"!property.prettyThumnailUrl\">No Image</span><span class=\"property-search-result__image\" data-ng-show=\"property.prettyThumnailUrl\" data-ng-style=\"{'background-image': 'url(' + property.prettyThumnailUrl + ')'}\"></span><span class=\"property-search-result-info\"><span class=\"property-search-result__price\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.prettyPrice ]]</span><span class=\"property-search-result__price\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span><span class=\"property-search-result__bedrooms\"><span data-ng-bind=\"property.num_bedrooms\"></span> bedroom</span><span class=\"property-search-result__address\" data-ng-bind=\"property.street_name\"></span><span class=\"property-search-result__region\"><span data-ng-bind=\"property.county\"></span> <span data-ng-bind=\"property.outcode\"></span></span><span class=\"property-search-result__age\" data-ng-bind=\"property.prettyPublishDate\"></span><span class=\"property-search-result__price--small-screen\" data-ng-hide=\"property.price_modifier == 'price_on_request'\">[[ property.price | noFractionCurrency:'£' ]]</span><span class=\"property-search-result__price--small-screen\" data-ng-show=\"property.price_modifier == 'price_on_request'\">POR</span></span></a><button class=\"property-search-result__favourite-button\" aria-label=\"Favourite\" data-ng-class=\"{ 'is-active': property.isFavourite }\" data-ng-click=\"favouriteButtonClick(property, $event)\"><i class=\"i\"></i></button></li></ol><div data-ng-hide=\"favourites.meta.count <= (favourites | limitTo:favourites.meta.limit*favourites.meta.page).length\"><button data-ng-disabled=\"loading.listings\" class=\"btn\" name=\"load-more\" data-ng-class=\"{ 'is-disabled': loading.listings }\" data-ng-click=\"fetchFavourites(favourites.meta.page + 1)\">Load more</button></div></div><div class=\"property-search__no-results\" data-ng-show=\"favourites.meta.count == 0\" data-ng-cloak=\"\"><p>No Favourites</p></div></div></section></div></div><span style=\"display: none\"><span class=\"property-search__infobox__wrapper property-search__infobox__wrapper--[[clusterMarkers.length]]-items\"><span class=\"property-search__infobox__inner-wrapper\"><span class=\"property-search__infobox__header\" data-ng-show=\"clusterMarkers.length > 1\"><span data-ng-bind=\"clusterMarkers.length\">0</span> <span data-ng-pluralize=\"\" data-count=\"clusterMarkers.length\" data-when=\"{'one': 'Property at this location', 'other': 'Properties at this location'}\"></span></span><span class=\"property-search__infobox__content\"><ol class=\"property-search__cluster-list\"><li class=\"property-search-result property-search-result--cluster\" data-ng-repeat=\"marker in clusterMarkers\"><a class=\"property-search-result__link\" href=\"/property-search/property/[[ marker.data.property.listing_id ]]/\" data-ng-click=\"onClusterPropertyClicked($event, marker.data.property)\" data-pl-right-click=\"onClusterPropertyRightClicked($event, marker.data.property)\"><span data-ng-switch=\"getPropertyImage(marker.data.property.thumbnail_url, 'THUMB')\"><span class=\"property-search-result__no-image\" data-ng-switch-when=\"null\">No Image</span><span class=\"property-search-result__image\" data-ng-switch-default=\"\" data-ng-style=\"{'background-image': 'url(' + getPropertyImage(marker.data.property.thumbnail_url, 'THUMB') + ')'}\"></span></span><span class=\"property-search-result__price\" data-ng-hide=\"marker.data.property.price_modifier == 'price_on_request'\">[[ marker.data.property.price | noFractionCurrency:'£' ]]</span><span class=\"property-search-result__price\" data-ng-show=\"marker.data.property.price_modifier == 'price_on_request'\">POR</span><span class=\"property-search-result__bedrooms\">[[ marker.data.property.num_bedrooms ]] bedroom</span><button class=\"property-search-result__favourite-button\" aria-label=\"Favourite\" data-ng-class=\"{ 'is-active': marker.data.property.isFavourite }\" data-ng-click=\"favouriteButtonClick(marker.data.property, $event)\"><i class=\"i\"></i></button></a></li></ol></span></span></span></span><div class=\"property-search__context-menu\" data-ng-class=\"{'property-search__context-menu--is-active': contextMenuActive }\" style=\"top: [[contextMenuOffsetTop]]; left: [[contextMenuOffsetLeft]]\"><ul class=\"property-search__context-menu__option-list\" data-ng-click=\"contextMenuSetVisible(false)\"><li class=\"property-search__context-menu__option\"><a target=\"_blank\" data-ng-href=\"/property-search/property/[[ rightClickedProperty.listing_id ]]/\">Open in new tab</a></li><li class=\"property-search__context-menu__option\"><a data-ng-href=\"/property-search/compare/?search.area=[[ selectedArea ]]&compare.property1=[[ rightClickedProperty.listing_id ]]\">Compare property</a></li></ul></div></div>");
}]);